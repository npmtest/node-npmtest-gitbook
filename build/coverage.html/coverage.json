{"/home/travis/build/npmtest/node-npmtest-gitbook/test.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/test.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":1,"12":1,"13":1,"14":1,"15":2,"16":2,"17":2,"18":2,"19":1,"20":1,"21":2,"22":2,"23":2,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":2,"40":2,"41":1,"42":2,"43":2,"44":1,"45":2,"46":2,"47":1,"48":2,"49":2,"50":1,"51":1,"52":1,"53":1,"54":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[1,1],"5":[1,1],"6":[1,1],"7":[1,1],"8":[1,1],"9":[1,1],"10":[1,1,1],"11":[1,1],"12":[1,1],"13":[1,1],"14":[1,1],"15":[1,1],"16":[1,1],"17":[1,1]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":1,"7":1,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}},"4":{"name":"(anonymous_4)","line":61,"loc":{"start":{"line":61,"column":5},"end":{"line":61,"column":17}}},"5":{"name":"(anonymous_5)","line":82,"loc":{"start":{"line":82,"column":5},"end":{"line":82,"column":17}}},"6":{"name":"(anonymous_6)","line":91,"loc":{"start":{"line":91,"column":77},"end":{"line":94,"column":10}}},"7":{"name":"(anonymous_7)","line":112,"loc":{"start":{"line":112,"column":83},"end":{"line":115,"column":10}},"skip":true},"8":{"name":"(anonymous_8)","line":123,"loc":{"start":{"line":123,"column":77},"end":{"line":126,"column":10}},"skip":true},"9":{"name":"(anonymous_9)","line":139,"loc":{"start":{"line":139,"column":12},"end":{"line":139,"column":40}},"skip":true},"10":{"name":"(anonymous_10)","line":147,"loc":{"start":{"line":147,"column":77},"end":{"line":150,"column":10}},"skip":true},"11":{"name":"(anonymous_11)","line":158,"loc":{"start":{"line":158,"column":83},"end":{"line":161,"column":10}},"skip":true},"12":{"name":"(anonymous_12)","line":169,"loc":{"start":{"line":169,"column":79},"end":{"line":172,"column":10}},"skip":true},"13":{"name":"(anonymous_13)","line":180,"loc":{"start":{"line":180,"column":75},"end":{"line":183,"column":10}},"skip":true}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":195,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":56,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":40,"column":8},"end":{"line":53,"column":9}},"11":{"start":{"line":43,"column":12},"end":{"line":46,"column":14}},"12":{"start":{"line":47,"column":12},"end":{"line":47,"column":18}},"13":{"start":{"line":50,"column":12},"end":{"line":51,"column":33}},"14":{"start":{"line":52,"column":12},"end":{"line":52,"column":18}},"15":{"start":{"line":55,"column":8},"end":{"line":55,"column":35}},"16":{"start":{"line":61,"column":4},"end":{"line":63,"column":9}},"17":{"start":{"line":62,"column":8},"end":{"line":62,"column":15}},"18":{"start":{"line":64,"column":4},"end":{"line":77,"column":5}},"19":{"start":{"line":70,"column":8},"end":{"line":70,"column":14}},"20":{"start":{"line":76,"column":8},"end":{"line":76,"column":14}},"21":{"start":{"line":82,"column":4},"end":{"line":84,"column":9}},"22":{"start":{"line":83,"column":8},"end":{"line":83,"column":15}},"23":{"start":{"line":85,"column":4},"end":{"line":194,"column":5}},"24":{"start":{"line":91,"column":8},"end":{"line":99,"column":10}},"25":{"start":{"line":98,"column":12},"end":{"line":98,"column":35}},"26":{"start":{"line":102,"column":8},"end":{"line":104,"column":63}},"27":{"start":{"line":105,"column":8},"end":{"line":105,"column":14}},"28":{"start":{"line":112,"column":8},"end":{"line":121,"column":10},"skip":true},"29":{"start":{"line":119,"column":12},"end":{"line":119,"column":55},"skip":true},"30":{"start":{"line":120,"column":12},"end":{"line":120,"column":48},"skip":true},"31":{"start":{"line":123,"column":8},"end":{"line":136,"column":10},"skip":true},"32":{"start":{"line":130,"column":12},"end":{"line":130,"column":76},"skip":true},"33":{"start":{"line":131,"column":12},"end":{"line":131,"column":73},"skip":true},"34":{"start":{"line":132,"column":12},"end":{"line":132,"column":74},"skip":true},"35":{"start":{"line":133,"column":12},"end":{"line":133,"column":79},"skip":true},"36":{"start":{"line":134,"column":12},"end":{"line":134,"column":25},"skip":true},"37":{"start":{"line":135,"column":12},"end":{"line":135,"column":45},"skip":true},"38":{"start":{"line":138,"column":8},"end":{"line":145,"column":14},"skip":true},"39":{"start":{"line":143,"column":16},"end":{"line":143,"column":29},"skip":true},"40":{"start":{"line":144,"column":16},"end":{"line":144,"column":55},"skip":true},"41":{"start":{"line":147,"column":8},"end":{"line":156,"column":10},"skip":true},"42":{"start":{"line":154,"column":12},"end":{"line":154,"column":25},"skip":true},"43":{"start":{"line":155,"column":12},"end":{"line":155,"column":45},"skip":true},"44":{"start":{"line":158,"column":8},"end":{"line":167,"column":10},"skip":true},"45":{"start":{"line":165,"column":12},"end":{"line":165,"column":25},"skip":true},"46":{"start":{"line":166,"column":12},"end":{"line":166,"column":48},"skip":true},"47":{"start":{"line":169,"column":8},"end":{"line":178,"column":10},"skip":true},"48":{"start":{"line":176,"column":12},"end":{"line":176,"column":25},"skip":true},"49":{"start":{"line":177,"column":12},"end":{"line":177,"column":46},"skip":true},"50":{"start":{"line":180,"column":8},"end":{"line":189,"column":10},"skip":true},"51":{"start":{"line":187,"column":12},"end":{"line":187,"column":94},"skip":true},"52":{"start":{"line":188,"column":12},"end":{"line":188,"column":48},"skip":true},"53":{"start":{"line":192,"column":8},"end":{"line":192,"column":35},"skip":true},"54":{"start":{"line":193,"column":8},"end":{"line":193,"column":14},"skip":true}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":40,"type":"switch","locations":[{"start":{"line":42,"column":8},"end":{"line":47,"column":18}},{"start":{"line":49,"column":8},"end":{"line":52,"column":18}}]},"5":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":16},"end":{"line":44,"column":44}},{"start":{"line":44,"column":48},"end":{"line":44,"column":66}}]},"6":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":21},"end":{"line":50,"column":49}},{"start":{"line":50,"column":53},"end":{"line":50,"column":72}}]},"7":{"line":64,"type":"switch","locations":[{"start":{"line":69,"column":4},"end":{"line":70,"column":14}},{"start":{"line":75,"column":4},"end":{"line":76,"column":14}}]},"8":{"line":85,"type":"switch","locations":[{"start":{"line":90,"column":4},"end":{"line":105,"column":14}},{"start":{"line":111,"column":4},"end":{"line":193,"column":14},"skip":true}]},"9":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":42},"end":{"line":91,"column":73}},{"start":{"line":91,"column":77},"end":{"line":99,"column":9}}]},"10":{"line":102,"type":"binary-expr","locations":[{"start":{"line":102,"column":18},"end":{"line":102,"column":32}},{"start":{"line":103,"column":12},"end":{"line":103,"column":53}},{"start":{"line":104,"column":12},"end":{"line":104,"column":61}}]},"11":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":45},"end":{"line":112,"column":79},"skip":true},{"start":{"line":112,"column":83},"end":{"line":121,"column":9},"skip":true}]},"12":{"line":123,"type":"binary-expr","locations":[{"start":{"line":123,"column":42},"end":{"line":123,"column":73},"skip":true},{"start":{"line":123,"column":77},"end":{"line":136,"column":9},"skip":true}]},"13":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":48},"end":{"line":138,"column":85},"skip":true},{"start":{"line":139,"column":12},"end":{"line":145,"column":13},"skip":true}]},"14":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":42},"end":{"line":147,"column":73},"skip":true},{"start":{"line":147,"column":77},"end":{"line":156,"column":9},"skip":true}]},"15":{"line":158,"type":"binary-expr","locations":[{"start":{"line":158,"column":45},"end":{"line":158,"column":79},"skip":true},{"start":{"line":158,"column":83},"end":{"line":167,"column":9},"skip":true}]},"16":{"line":169,"type":"binary-expr","locations":[{"start":{"line":169,"column":43},"end":{"line":169,"column":75},"skip":true},{"start":{"line":169,"column":79},"end":{"line":178,"column":9},"skip":true}]},"17":{"line":180,"type":"binary-expr","locations":[{"start":{"line":180,"column":41},"end":{"line":180,"column":71},"skip":true},{"start":{"line":180,"column":75},"end":{"line":189,"column":9},"skip":true}]}},"code":["/* istanbul instrument in package npmtest_gitbook */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        switch (local.modeJs) {","        // re-init local from window.local","        case 'browser':","            local = local.global.utility2.objectSetDefault(","                local.global.utility2_rollup || local.global.local,","                local.global.utility2","            );","            break;","        // re-init local from example.js","        case 'node':","            local = (local.global.utility2_rollup || require('utility2'))","                .requireReadme();","            break;","        }","        // export local","        local.global.local = local;","    }());","","","","    // run shared js-env code - function","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - function","    case 'browser':","        break;","","","","    // run node js-env code - function","    case 'node':","        break;","    }","","","","    // run shared js-env code - init-after","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - init-after","    case 'browser':","        local.testCase_browser_nullCase = local.testCase_browser_nullCase || function (","            options,","            onError","        ) {","        /*","         * this function will test browsers's null-case handling-behavior-behavior","         */","            onError(null, options);","        };","","        // run tests","        local.nop(local.modeTest &&","            document.querySelector('#testRunButton1') &&","            document.querySelector('#testRunButton1').click());","        break;","","","","    // run node js-env code - init-after","    /* istanbul ignore next */","    case 'node':","        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApidoc's default handling-behavior-behavior","         */","            options = { modulePathList: module.paths };","            local.buildApidoc(options, onError);","        };","","        local.testCase_buildApp_default = local.testCase_buildApp_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApp's default handling-behavior-behavior","         */","            local.testCase_buildReadme_default(options, local.onErrorThrow);","            local.testCase_buildLib_default(options, local.onErrorThrow);","            local.testCase_buildTest_default(options, local.onErrorThrow);","            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);","            options = [];","            local.buildApp(options, onError);","        };","","        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||","            function (options, onError) {","            /*","             * this function will test buildCustomOrg's default handling-behavior","             */","                options = {};","                local.buildCustomOrg(options, onError);","            };","","        local.testCase_buildLib_default = local.testCase_buildLib_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildLib's default handling-behavior","         */","            options = {};","            local.buildLib(options, onError);","        };","","        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildReadme's default handling-behavior-behavior","         */","            options = {};","            local.buildReadme(options, onError);","        };","","        local.testCase_buildTest_default = local.testCase_buildTest_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildTest's default handling-behavior","         */","            options = {};","            local.buildTest(options, onError);","        };","","        local.testCase_webpage_default = local.testCase_webpage_default || function (","            options,","            onError","        ) {","        /*","         * this function will test webpage's default handling-behavior","         */","            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };","            local.browserTest(options, onError);","        };","","        // run test-server","        local.testRunServer(local);","        break;","    }","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"40":2,"43":1,"47":1,"50":1,"52":1,"55":2,"61":2,"62":2,"64":2,"70":1,"76":1,"82":2,"83":2,"85":2,"91":1,"98":1,"102":1,"105":1,"112":1,"119":1,"120":1,"123":1,"130":1,"131":1,"132":1,"133":1,"134":1,"135":1,"138":1,"143":2,"144":2,"147":1,"154":2,"155":2,"158":1,"165":2,"166":2,"169":1,"176":2,"177":2,"180":1,"187":1,"188":1,"192":1,"193":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/lib.npmtest_gitbook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/lib.npmtest_gitbook.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":1,"15":1,"16":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1]},"f":{"1":2,"2":2,"3":2},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":53,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":52,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":41,"column":8},"end":{"line":41,"column":54}},"11":{"start":{"line":43,"column":8},"end":{"line":43,"column":52}},"12":{"start":{"line":45,"column":8},"end":{"line":51,"column":9}},"13":{"start":{"line":46,"column":12},"end":{"line":46,"column":58}},"14":{"start":{"line":48,"column":12},"end":{"line":48,"column":35}},"15":{"start":{"line":49,"column":12},"end":{"line":49,"column":49}},"16":{"start":{"line":50,"column":12},"end":{"line":50,"column":43}}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":16},"end":{"line":41,"column":44}},{"start":{"line":41,"column":48},"end":{"line":41,"column":53}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":45,"column":8}},{"start":{"line":45,"column":8},"end":{"line":45,"column":8}}]}},"code":["/* istanbul instrument in package npmtest_gitbook */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || local;","        // init lib","        local.local = local.npmtest_gitbook = local;","        // init exports","        if (local.modeJs === 'browser') {","            local.global.utility2_npmtest_gitbook = local;","        } else {","            module.exports = local;","            module.exports.__dirname = __dirname;","            module.exports.module = module;","        }","    }());","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"41":2,"43":2,"45":2,"46":1,"48":1,"49":1,"50":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/example.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/example.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":2,"15":2,"16":2,"17":2,"18":2,"19":0,"20":2,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":0,"28":1,"29":1,"30":2,"31":0,"32":0,"33":0,"34":1,"35":2,"36":2,"37":3,"38":3,"39":3,"40":3,"41":0,"42":3,"43":3,"44":3,"45":1,"46":3,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":0,"58":1,"59":6,"60":6,"61":1,"62":2,"63":0,"64":2,"65":1,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1],"6":[1,1],"7":[2,0],"8":[2,1,1,1,1,1],"9":[0,2,0],"10":[1,1],"11":[2,1,1],"12":[1,0],"13":[0,2],"14":[2,0,0,0,0,0,0],"15":[0,3],"16":[3,0],"17":[1,1],"18":[0,1],"19":[1,2,0,2],"20":[1,0],"21":[1,1],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":3,"8":3,"9":3,"10":1,"11":6,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":1},"end":{"line":26,"column":13}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":5},"end":{"line":33,"column":17}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":24},"end":{"line":37,"column":36}}},"4":{"name":"(anonymous_4)","line":69,"loc":{"start":{"line":69,"column":31},"end":{"line":69,"column":48}},"skip":true},"5":{"name":"(anonymous_5)","line":78,"loc":{"start":{"line":78,"column":26},"end":{"line":78,"column":45}},"skip":true},"6":{"name":"(anonymous_6)","line":123,"loc":{"start":{"line":123,"column":33},"end":{"line":123,"column":48}},"skip":true},"7":{"name":"(anonymous_7)","line":125,"loc":{"start":{"line":125,"column":27},"end":{"line":125,"column":39}},"skip":true},"8":{"name":"(anonymous_8)","line":133,"loc":{"start":{"line":133,"column":59},"end":{"line":133,"column":74}},"skip":true},"9":{"name":"(anonymous_9)","line":143,"loc":{"start":{"line":143,"column":45},"end":{"line":143,"column":62}},"skip":true},"10":{"name":"(anonymous_10)","line":144,"loc":{"start":{"line":144,"column":73},"end":{"line":144,"column":92}},"skip":true},"11":{"name":"(anonymous_11)","line":272,"loc":{"start":{"line":272,"column":51},"end":{"line":272,"column":77}},"skip":true},"12":{"name":"(anonymous_12)","line":315,"loc":{"start":{"line":315,"column":32},"end":{"line":315,"column":61}},"skip":true}},"statementMap":{"1":{"start":{"line":26,"column":0},"end":{"line":326,"column":5}},"2":{"start":{"line":28,"column":4},"end":{"line":28,"column":14}},"3":{"start":{"line":33,"column":4},"end":{"line":60,"column":9}},"4":{"start":{"line":35,"column":8},"end":{"line":35,"column":19}},"5":{"start":{"line":37,"column":8},"end":{"line":49,"column":13}},"6":{"start":{"line":38,"column":12},"end":{"line":48,"column":13}},"7":{"start":{"line":39,"column":16},"end":{"line":42,"column":30}},"8":{"start":{"line":44,"column":16},"end":{"line":47,"column":27}},"9":{"start":{"line":51,"column":8},"end":{"line":53,"column":21}},"10":{"start":{"line":55,"column":8},"end":{"line":57,"column":45}},"11":{"start":{"line":59,"column":8},"end":{"line":59,"column":35}},"12":{"start":{"line":61,"column":4},"end":{"line":325,"column":5}},"13":{"start":{"line":69,"column":8},"end":{"line":121,"column":10},"skip":true},"14":{"start":{"line":70,"column":12},"end":{"line":88,"column":13},"skip":true},"15":{"start":{"line":76,"column":16},"end":{"line":87,"column":19},"skip":true},"16":{"start":{"line":79,"column":20},"end":{"line":86,"column":21},"skip":true},"17":{"start":{"line":82,"column":24},"end":{"line":82,"column":43},"skip":true},"18":{"start":{"line":83,"column":24},"end":{"line":83,"column":30},"skip":true},"19":{"start":{"line":85,"column":24},"end":{"line":85,"column":49},"skip":true},"20":{"start":{"line":89,"column":12},"end":{"line":107,"column":13},"skip":true},"21":{"start":{"line":92,"column":16},"end":{"line":102,"column":17},"skip":true},"22":{"start":{"line":93,"column":20},"end":{"line":93,"column":86},"skip":true},"23":{"start":{"line":94,"column":20},"end":{"line":95,"column":45},"skip":true},"24":{"start":{"line":96,"column":20},"end":{"line":96,"column":42},"skip":true},"25":{"start":{"line":97,"column":20},"end":{"line":97,"column":48},"skip":true},"26":{"start":{"line":100,"column":20},"end":{"line":100,"column":85},"skip":true},"27":{"start":{"line":101,"column":20},"end":{"line":101,"column":96},"skip":true},"28":{"start":{"line":103,"column":16},"end":{"line":103,"column":22},"skip":true},"29":{"start":{"line":106,"column":16},"end":{"line":106,"column":22},"skip":true},"30":{"start":{"line":108,"column":12},"end":{"line":120,"column":13},"skip":true},"31":{"start":{"line":114,"column":16},"end":{"line":119,"column":17},"skip":true},"32":{"start":{"line":116,"column":20},"end":{"line":116,"column":78},"skip":true},"33":{"start":{"line":118,"column":20},"end":{"line":118,"column":47},"skip":true},"34":{"start":{"line":123,"column":8},"end":{"line":141,"column":11},"skip":true},"35":{"start":{"line":124,"column":12},"end":{"line":124,"column":54},"skip":true},"36":{"start":{"line":125,"column":12},"end":{"line":140,"column":14},"skip":true},"37":{"start":{"line":126,"column":16},"end":{"line":126,"column":28},"skip":true},"38":{"start":{"line":127,"column":16},"end":{"line":127,"column":69},"skip":true},"39":{"start":{"line":128,"column":16},"end":{"line":128,"column":75},"skip":true},"40":{"start":{"line":129,"column":16},"end":{"line":131,"column":17},"skip":true},"41":{"start":{"line":130,"column":20},"end":{"line":130,"column":27},"skip":true},"42":{"start":{"line":133,"column":16},"end":{"line":137,"column":36},"skip":true},"43":{"start":{"line":134,"column":20},"end":{"line":136,"column":55},"skip":true},"44":{"start":{"line":139,"column":16},"end":{"line":139,"column":57},"skip":true},"45":{"start":{"line":143,"column":8},"end":{"line":147,"column":11},"skip":true},"46":{"start":{"line":144,"column":12},"end":{"line":146,"column":15},"skip":true},"47":{"start":{"line":145,"column":16},"end":{"line":145,"column":70},"skip":true},"48":{"start":{"line":149,"column":8},"end":{"line":149,"column":31},"skip":true},"49":{"start":{"line":150,"column":8},"end":{"line":150,"column":14},"skip":true},"50":{"start":{"line":158,"column":8},"end":{"line":158,"column":31},"skip":true},"51":{"start":{"line":160,"column":8},"end":{"line":160,"column":33},"skip":true},"52":{"start":{"line":161,"column":8},"end":{"line":161,"column":37},"skip":true},"53":{"start":{"line":162,"column":8},"end":{"line":162,"column":35},"skip":true},"54":{"start":{"line":164,"column":8},"end":{"line":164,"column":50},"skip":true},"55":{"start":{"line":166,"column":8},"end":{"line":256,"column":2},"skip":true},"56":{"start":{"line":258,"column":8},"end":{"line":286,"column":9},"skip":true},"57":{"start":{"line":259,"column":12},"end":{"line":269,"column":14},"skip":true},"58":{"start":{"line":271,"column":12},"end":{"line":285,"column":19},"skip":true},"59":{"start":{"line":274,"column":20},"end":{"line":274,"column":35},"skip":true},"60":{"start":{"line":275,"column":20},"end":{"line":284,"column":21},"skip":true},"61":{"start":{"line":277,"column":24},"end":{"line":277,"column":64},"skip":true},"62":{"start":{"line":279,"column":24},"end":{"line":279,"column":40},"skip":true},"63":{"start":{"line":281,"column":24},"end":{"line":281,"column":40},"skip":true},"64":{"start":{"line":283,"column":24},"end":{"line":283,"column":39},"skip":true},"65":{"start":{"line":288,"column":8},"end":{"line":290,"column":9},"skip":true},"66":{"start":{"line":289,"column":12},"end":{"line":289,"column":18},"skip":true},"67":{"start":{"line":291,"column":8},"end":{"line":293,"column":54},"skip":true},"68":{"start":{"line":296,"column":8},"end":{"line":301,"column":37},"skip":true},"69":{"start":{"line":303,"column":8},"end":{"line":303,"column":82},"skip":true},"70":{"start":{"line":306,"column":8},"end":{"line":308,"column":9},"skip":true},"71":{"start":{"line":307,"column":12},"end":{"line":307,"column":82},"skip":true},"72":{"start":{"line":310,"column":8},"end":{"line":312,"column":9},"skip":true},"73":{"start":{"line":311,"column":12},"end":{"line":311,"column":18},"skip":true},"74":{"start":{"line":313,"column":8},"end":{"line":313,"column":54},"skip":true},"75":{"start":{"line":314,"column":8},"end":{"line":314,"column":69},"skip":true},"76":{"start":{"line":315,"column":8},"end":{"line":323,"column":36},"skip":true},"77":{"start":{"line":316,"column":12},"end":{"line":316,"column":61},"skip":true},"78":{"start":{"line":317,"column":12},"end":{"line":320,"column":13},"skip":true},"79":{"start":{"line":318,"column":16},"end":{"line":318,"column":75},"skip":true},"80":{"start":{"line":319,"column":16},"end":{"line":319,"column":23},"skip":true},"81":{"start":{"line":321,"column":12},"end":{"line":321,"column":38},"skip":true},"82":{"start":{"line":322,"column":12},"end":{"line":322,"column":27},"skip":true},"83":{"start":{"line":324,"column":8},"end":{"line":324,"column":14},"skip":true}},"branchMap":{"1":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":23},"end":{"line":39,"column":62}},{"start":{"line":40,"column":20},"end":{"line":40,"column":70}},{"start":{"line":41,"column":20},"end":{"line":41,"column":71}},{"start":{"line":42,"column":20},"end":{"line":42,"column":29}}]},"2":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":23},"end":{"line":44,"column":37}},{"start":{"line":45,"column":20},"end":{"line":45,"column":61}},{"start":{"line":46,"column":20},"end":{"line":46,"column":70}},{"start":{"line":47,"column":20},"end":{"line":47,"column":26}}]},"3":{"line":51,"type":"cond-expr","locations":[{"start":{"line":52,"column":14},"end":{"line":52,"column":20}},{"start":{"line":53,"column":14},"end":{"line":53,"column":20}}]},"4":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":16},"end":{"line":55,"column":44}},{"start":{"line":55,"column":49},"end":{"line":57,"column":43}}]},"5":{"line":55,"type":"cond-expr","locations":[{"start":{"line":56,"column":14},"end":{"line":56,"column":51}},{"start":{"line":57,"column":14},"end":{"line":57,"column":43}}]},"6":{"line":61,"type":"switch","locations":[{"start":{"line":68,"column":4},"end":{"line":150,"column":14},"skip":true},{"start":{"line":156,"column":4},"end":{"line":324,"column":14},"skip":true}]},"7":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true},{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true}]},"8":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":16},"end":{"line":70,"column":22},"skip":true},{"start":{"line":70,"column":27},"end":{"line":70,"column":32},"skip":true},{"start":{"line":71,"column":20},"end":{"line":71,"column":39},"skip":true},{"start":{"line":72,"column":20},"end":{"line":72,"column":49},"skip":true},{"start":{"line":73,"column":20},"end":{"line":73,"column":58},"skip":true},{"start":{"line":74,"column":20},"end":{"line":74,"column":69},"skip":true}]},"9":{"line":79,"type":"switch","locations":[{"start":{"line":80,"column":20},"end":{"line":80,"column":33},"skip":true},{"start":{"line":81,"column":20},"end":{"line":83,"column":30},"skip":true},{"start":{"line":84,"column":20},"end":{"line":85,"column":49},"skip":true}]},"10":{"line":89,"type":"switch","locations":[{"start":{"line":90,"column":12},"end":{"line":103,"column":22},"skip":true},{"start":{"line":105,"column":12},"end":{"line":106,"column":22},"skip":true}]},"11":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":20},"end":{"line":89,"column":25},"skip":true},{"start":{"line":89,"column":29},"end":{"line":89,"column":48},"skip":true},{"start":{"line":89,"column":52},"end":{"line":89,"column":74},"skip":true}]},"12":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true},{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true}]},"13":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true},{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true}]},"14":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":16},"end":{"line":108,"column":61},"skip":true},{"start":{"line":108,"column":66},"end":{"line":108,"column":72},"skip":true},{"start":{"line":108,"column":77},"end":{"line":108,"column":82},"skip":true},{"start":{"line":109,"column":20},"end":{"line":109,"column":39},"skip":true},{"start":{"line":110,"column":20},"end":{"line":110,"column":49},"skip":true},{"start":{"line":111,"column":20},"end":{"line":111,"column":58},"skip":true},{"start":{"line":112,"column":20},"end":{"line":112,"column":68},"skip":true}]},"15":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true},{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true}]},"16":{"line":134,"type":"cond-expr","locations":[{"start":{"line":135,"column":26},"end":{"line":135,"column":29},"skip":true},{"start":{"line":136,"column":26},"end":{"line":136,"column":54},"skip":true}]},"17":{"line":164,"type":"binary-expr","locations":[{"start":{"line":164,"column":27},"end":{"line":164,"column":43},"skip":true},{"start":{"line":164,"column":47},"end":{"line":164,"column":49},"skip":true}]},"18":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true},{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true}]},"19":{"line":275,"type":"switch","locations":[{"start":{"line":276,"column":20},"end":{"line":277,"column":64},"skip":true},{"start":{"line":278,"column":20},"end":{"line":279,"column":40},"skip":true},{"start":{"line":280,"column":20},"end":{"line":281,"column":40},"skip":true},{"start":{"line":282,"column":20},"end":{"line":283,"column":39},"skip":true}]},"20":{"line":288,"type":"if","locations":[{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true},{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true}]},"21":{"line":288,"type":"binary-expr","locations":[{"start":{"line":288,"column":12},"end":{"line":288,"column":40},"skip":true},{"start":{"line":288,"column":44},"end":{"line":288,"column":67},"skip":true}]},"22":{"line":292,"type":"binary-expr","locations":[{"start":{"line":292,"column":12},"end":{"line":292,"column":50},"skip":true},{"start":{"line":293,"column":12},"end":{"line":293,"column":53},"skip":true}]},"23":{"line":297,"type":"binary-expr","locations":[{"start":{"line":297,"column":12},"end":{"line":297,"column":65},"skip":true},{"start":{"line":298,"column":12},"end":{"line":301,"column":36},"skip":true}]},"24":{"line":303,"type":"binary-expr","locations":[{"start":{"line":303,"column":43},"end":{"line":303,"column":75},"skip":true},{"start":{"line":303,"column":79},"end":{"line":303,"column":81},"skip":true}]},"25":{"line":306,"type":"if","locations":[{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true},{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true}]},"26":{"line":310,"type":"if","locations":[{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true},{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true}]},"27":{"line":313,"type":"binary-expr","locations":[{"start":{"line":313,"column":27},"end":{"line":313,"column":43},"skip":true},{"start":{"line":313,"column":47},"end":{"line":313,"column":53},"skip":true}]},"28":{"line":317,"type":"if","locations":[{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true},{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true}]}},"code":["/*","example.js","","quickstart example","","instruction","    1. save this script as example.js","    2. run the shell command:","        $ npm install npmtest-gitbook && PORT=8081 node example.js","    3. play with the browser-demo on http://127.0.0.1:8081","*/","","","","/* istanbul instrument in package npmtest_gitbook */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || (local.modeJs === 'browser'","            ? local.global.utility2_npmtest_gitbook","            : global.utility2_moduleExports);","        // export local","        local.global.local = local;","    }());","    switch (local.modeJs) {","","","","    // init-after","    // run browser js-env code - init-after","    /* istanbul ignore next */","    case 'browser':","        local.testRunBrowser = function (event) {","            if (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('onreset'))) {","                // reset output","                Array.from(","                    document.querySelectorAll('body > .resettable')","                ).forEach(function (element) {","                    switch (element.tagName) {","                    case 'INPUT':","                    case 'TEXTAREA':","                        element.value = '';","                        break;","                    default:","                        element.textContent = '';","                    }","                });","            }","            switch (event && event.currentTarget && event.currentTarget.id) {","            case 'testRunButton1':","                // show tests","                if (document.querySelector('#testReportDiv1').style.display === 'none') {","                    document.querySelector('#testReportDiv1').style.display = 'block';","                    document.querySelector('#testRunButton1').textContent =","                        'hide internal test';","                    local.modeTest = true;","                    local.testRunDefault(local);","                // hide tests","                } else {","                    document.querySelector('#testReportDiv1').style.display = 'none';","                    document.querySelector('#testRunButton1').textContent = 'run internal test';","                }","                break;","            // custom-case","            default:","                break;","            }","            if (document.querySelector('#inputTextareaEval1') && (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('oneval')))) {","                // try to eval input-code","                try {","                    /*jslint evil: true*/","                    eval(document.querySelector('#inputTextareaEval1').value);","                } catch (errorCaught) {","                    console.error(errorCaught);","                }","            }","        };","        // log stderr and stdout to #outputTextareaStdout1","        ['error', 'log'].forEach(function (key) {","            console[key + '_original'] = console[key];","            console[key] = function () {","                var element;","                console[key + '_original'].apply(console, arguments);","                element = document.querySelector('#outputTextareaStdout1');","                if (!element) {","                    return;","                }","                // append text to #outputTextareaStdout1","                element.value += Array.from(arguments).map(function (arg) {","                    return typeof arg === 'string'","                        ? arg","                        : JSON.stringify(arg, null, 4);","                }).join(' ') + '\\n';","                // scroll textarea to bottom","                element.scrollTop = element.scrollHeight;","            };","        });","        // init event-handling","        ['change', 'click', 'keyup'].forEach(function (event) {","            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {","                element.addEventListener(event, local.testRunBrowser);","            });","        });","        // run tests","        local.testRunBrowser();","        break;","","","","    // run node js-env code - init-after","    /* istanbul ignore next */","    case 'node':","        // export local","        module.exports = local;","        // require modules","        local.fs = require('fs');","        local.http = require('http');","        local.url = require('url');","        // init assets","        local.assetsDict = local.assetsDict || {};","        /* jslint-ignore-begin */","        local.assetsDict['/assets.index.template.html'] = '\\","<!doctype html>\\n\\","<html lang=\"en\">\\n\\","<head>\\n\\","<meta charset=\"UTF-8\">\\n\\","<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n\\","<title>{{env.npm_package_name}} (v{{env.npm_package_version}})</title>\\n\\","<style>\\n\\","/*csslint\\n\\","    box-sizing: false,\\n\\","    universal-selector: false\\n\\","*/\\n\\","* {\\n\\","    box-sizing: border-box;\\n\\","}\\n\\","body {\\n\\","    background: #dde;\\n\\","    font-family: Arial, Helvetica, sans-serif;\\n\\","    margin: 2rem;\\n\\","}\\n\\","body > * {\\n\\","    margin-bottom: 1rem;\\n\\","}\\n\\",".utility2FooterDiv {\\n\\","    margin-top: 20px;\\n\\","    text-align: center;\\n\\","}\\n\\","</style>\\n\\","<style>\\n\\","/*csslint\\n\\","*/\\n\\","textarea {\\n\\","    font-family: monospace;\\n\\","    height: 10rem;\\n\\","    width: 100%;\\n\\","}\\n\\","textarea[readonly] {\\n\\","    background: #ddd;\\n\\","}\\n\\","</style>\\n\\","</head>\\n\\","<body>\\n\\","<!-- utility2-comment\\n\\","<div id=\"ajaxProgressDiv1\" style=\"background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;\"></div>\\n\\","utility2-comment -->\\n\\","<h1>\\n\\","<!-- utility2-comment\\n\\","    <a\\n\\","        {{#if env.npm_package_homepage}}\\n\\","        href=\"{{env.npm_package_homepage}}\"\\n\\","        {{/if env.npm_package_homepage}}\\n\\","        target=\"_blank\"\\n\\","    >\\n\\","utility2-comment -->\\n\\","        {{env.npm_package_name}} (v{{env.npm_package_version}})\\n\\","<!-- utility2-comment\\n\\","    </a>\\n\\","utility2-comment -->\\n\\","</h1>\\n\\","<h3>{{env.npm_package_description}}</h3>\\n\\","<!-- utility2-comment\\n\\","<h4><a download href=\"assets.app.js\">download standalone app</a></h4>\\n\\","<button class=\"onclick onreset\" id=\"testRunButton1\">run internal test</button><br>\\n\\","<div id=\"testReportDiv1\" style=\"display: none;\"></div>\\n\\","utility2-comment -->\\n\\","\\n\\","\\n\\","\\n\\","<label>stderr and stdout</label>\\n\\","<textarea class=\"resettable\" id=\"outputTextareaStdout1\" readonly></textarea>\\n\\","<!-- utility2-comment\\n\\","{{#if isRollup}}\\n\\","<script src=\"assets.app.js\"></script>\\n\\","{{#unless isRollup}}\\n\\","utility2-comment -->\\n\\","<script src=\"assets.utility2.rollup.js\"></script>\\n\\","<script src=\"jsonp.utility2._stateInit?callback=window.utility2._stateInit\"></script>\\n\\","<script src=\"assets.npmtest_gitbook.rollup.js\"></script>\\n\\","<script src=\"assets.example.js\"></script>\\n\\","<script src=\"assets.test.js\"></script>\\n\\","<!-- utility2-comment\\n\\","{{/if isRollup}}\\n\\","utility2-comment -->\\n\\","<div class=\"utility2FooterDiv\">\\n\\","    [ this app was created with\\n\\","    <a href=\"https://github.com/kaizhu256/node-utility2\" target=\"_blank\">utility2</a>\\n\\","    ]\\n\\","</div>\\n\\","</body>\\n\\","</html>\\n\\","';","        /* jslint-ignore-end */","        if (local.templateRender) {","            local.assetsDict['/'] = local.templateRender(","                local.assetsDict['/assets.index.template.html'],","                {","                    env: local.objectSetDefault(local.env, {","                        npm_package_description: 'the greatest app in the world!',","                        npm_package_name: 'my-app',","                        npm_package_nameAlias: 'my_app',","                        npm_package_version: '0.0.1'","                    })","                }","            );","        } else {","            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']","                .replace((/\\{\\{env\\.(\\w+?)\\}\\}/g), function (match0, match1) {","                    // jslint-hack","                    String(match0);","                    switch (match1) {","                    case 'npm_package_description':","                        return 'the greatest app in the world!';","                    case 'npm_package_name':","                        return 'my-app';","                    case 'npm_package_nameAlias':","                        return 'my_app';","                    case 'npm_package_version':","                        return '0.0.1';","                    }","                });","        }","        // run the cli","        if (local.global.utility2_rollup || module !== require.main) {","            break;","        }","        local.assetsDict['/assets.example.js'] =","            local.assetsDict['/assets.example.js'] ||","            local.fs.readFileSync(__filename, 'utf8');","        // bug-workaround - long $npm_package_buildCustomOrg","        /* jslint-ignore-begin */","        local.assetsDict['/assets.npmtest_gitbook.rollup.js'] =","            local.assetsDict['/assets.npmtest_gitbook.rollup.js'] ||","            local.fs.readFileSync(","                local.npmtest_gitbook.__dirname + '/lib.npmtest_gitbook.js',","                'utf8'","            ).replace((/^#!/), '//');","        /* jslint-ignore-end */","        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';","        // if $npm_config_timeout_exit exists,","        // then exit this process after $npm_config_timeout_exit ms","        if (Number(process.env.npm_config_timeout_exit)) {","            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));","        }","        // start server","        if (local.global.utility2_serverHttp1) {","            break;","        }","        process.env.PORT = process.env.PORT || '8081';","        console.error('server starting on port ' + process.env.PORT);","        local.http.createServer(function (request, response) {","            request.urlParsed = local.url.parse(request.url);","            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {","                response.end(local.assetsDict[request.urlParsed.pathname]);","                return;","            }","            response.statusCode = 404;","            response.end();","        }).listen(process.env.PORT);","        break;","    }","}());",""],"l":{"26":2,"28":2,"33":2,"35":2,"37":2,"38":2,"39":2,"44":1,"51":2,"55":2,"59":2,"61":2,"69":1,"70":2,"76":2,"79":2,"82":2,"83":2,"85":1,"89":2,"92":1,"93":1,"94":1,"96":1,"97":1,"100":1,"101":1,"103":1,"106":1,"108":2,"114":1,"116":1,"118":1,"123":1,"124":2,"125":2,"126":3,"127":3,"128":3,"129":3,"130":1,"133":3,"134":3,"139":3,"143":1,"144":3,"145":1,"149":1,"150":1,"158":1,"160":1,"161":1,"162":1,"164":1,"166":1,"258":1,"259":1,"271":1,"274":6,"275":6,"277":1,"279":2,"281":1,"283":2,"288":1,"289":1,"291":1,"296":1,"303":1,"306":1,"307":1,"310":1,"311":1,"313":1,"314":1,"315":1,"316":1,"317":1,"318":1,"319":1,"321":1,"322":1,"324":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/index.js","s":{"1":1,"2":1,"3":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":34}},"3":{"start":{"line":5,"column":0},"end":{"line":10,"column":11}}},"branchMap":{},"code":["var extend = require('extend');","","var common = require('./browser');","","module.exports = extend({","    initBook:       require('./init'),","    createNodeFS:   require('./fs/node'),","    Output:         require('./output'),","    commands:       require('./cli')","}, common);",""],"l":{"1":1,"3":1,"5":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/browser.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/browser.js","s":{"1":1,"2":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":39}},"2":{"start":{"line":3,"column":0},"end":{"line":26,"column":2}}},"branchMap":{},"code":["var Modifiers = require('./modifiers');","","module.exports = {","    Parse:              require('./parse'),","","    // Models","    Book:               require('./models/book'),","    FS:                 require('./models/fs'),","    File:               require('./models/file'),","    Summary:            require('./models/summary'),","    Glossary:           require('./models/glossary'),","    Config:             require('./models/config'),","    Page:               require('./models/page'),","    PluginDependency:   require('./models/pluginDependency'),","","    // Modifiers","    SummaryModifier:    Modifiers.Summary,","    ConfigModifier:     Modifiers.Config,","","    // Constants","    CONFIG_FILES:        require('./constants/configFiles.js'),","    IGNORE_FILES:        require('./constants/ignoreFiles.js'),","    DEFAULT_PLUGINS:     require('./constants/defaultPlugins'),","    EXTENSIONS_MARKDOWN: require('./constants/extsMarkdown'),","    EXTENSIONS_ASCIIDOC: require('./constants/extsAsciidoc')","};",""],"l":{"1":1,"3":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":5,"column":2}}},"branchMap":{},"code":["","module.exports = {","    Summary:        require('./summary'),","    Config:         require('./config')","};",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":13,"column":2}}},"branchMap":{},"code":["module.exports = {","    insertArticle:      require('./insertArticle'),","    moveArticle:        require('./moveArticle'),","    moveArticleAfter:   require('./moveArticleAfter'),","    removeArticle:      require('./removeArticle'),","    unshiftArticle:     require('./unshiftArticle'),","    editArticleTitle:   require('./editArticleTitle'),","    editArticleRef:     require('./editArticleRef'),","","    insertPart:         require('./insertPart'),","    removePart:         require('./removePart'),","    editPartTitle:      require('./editPartTitle')","};",""],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/insertArticle.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/insertArticle.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"insertArticle","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":48}}},"2":{"name":"getLeafIndex","line":42,"loc":{"start":{"line":42,"column":0},"end":{"line":42,"column":29}}},"3":{"name":"(anonymous_3)","line":43,"loc":{"start":{"line":43,"column":35},"end":{"line":43,"column":51}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":60}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":57}},"5":{"start":{"line":15,"column":0},"end":{"line":36,"column":1}},"6":{"start":{"line":16,"column":4},"end":{"line":16,"column":38}},"7":{"start":{"line":17,"column":4},"end":{"line":17,"column":55}},"8":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"9":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"10":{"start":{"line":21,"column":8},"end":{"line":21,"column":23}},"11":{"start":{"line":25,"column":4},"end":{"line":25,"column":40}},"12":{"start":{"line":26,"column":4},"end":{"line":26,"column":36}},"13":{"start":{"line":29,"column":4},"end":{"line":29,"column":47}},"14":{"start":{"line":32,"column":4},"end":{"line":32,"column":46}},"15":{"start":{"line":33,"column":4},"end":{"line":33,"column":40}},"16":{"start":{"line":35,"column":4},"end":{"line":35,"column":60}},"17":{"start":{"line":42,"column":0},"end":{"line":47,"column":1}},"18":{"start":{"line":43,"column":4},"end":{"line":45,"column":7}},"19":{"start":{"line":44,"column":8},"end":{"line":44,"column":34}},"20":{"start":{"line":46,"column":4},"end":{"line":46,"column":35}},"21":{"start":{"line":49,"column":0},"end":{"line":49,"column":31}}},"branchMap":{"1":{"line":17,"type":"cond-expr","locations":[{"start":{"line":17,"column":30},"end":{"line":17,"column":35}},{"start":{"line":17,"column":38},"end":{"line":17,"column":54}}]},"2":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":20,"column":4}},{"start":{"line":20,"column":4},"end":{"line":20,"column":4}}]}},"code":["var is = require('is');","var SummaryArticle = require('../../models/summaryArticle');","var mergeAtLevel = require('./mergeAtLevel');","var indexArticleLevels = require('./indexArticleLevels');","","/**","    Returns a new Summary with the article at the given level, with","    subsequent article shifted.","","    @param {Summary} summary","    @param {Article} article","    @param {String|Article} level: level to insert at","    @return {Summary}","*/","function insertArticle(summary, article, level) {","    article = SummaryArticle(article);","    level = is.string(level)? level : level.getLevel();","","    var parent = summary.getParent(level);","    if (!parent) {","        return summary;","    }","","    // Find the index to insert at","    var articles = parent.getArticles();","    var index = getLeafIndex(level);","","    // Insert the article at the right index","    articles = articles.insert(index, article);","","    // Reindex the level from here","    parent = parent.set('articles', articles);","    parent = indexArticleLevels(parent);","","    return mergeAtLevel(summary, parent.getLevel(), parent);","}","","/**","    @param {String}","    @return {Number} The index of this level within its parent's children"," */","function getLeafIndex(level) {","    var arr = level.split('.').map(function (char) {","        return parseInt(char, 10);","    });","    return arr[arr.length - 1] - 1;","}","","module.exports = insertArticle;",""],"l":{"1":1,"2":1,"3":1,"4":1,"15":1,"16":0,"17":0,"19":0,"20":0,"21":0,"25":0,"26":0,"29":0,"32":0,"33":0,"35":0,"42":1,"43":0,"44":0,"46":0,"49":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/summaryArticle.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/summaryArticle.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":1,"11":0,"12":1,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":1,"38":0,"39":1,"40":0,"41":0,"42":0,"43":1,"44":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0,0],"12":[0,0],"13":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"fnMap":{"1":{"name":"(anonymous_1)","line":16,"loc":{"start":{"line":16,"column":36},"end":{"line":16,"column":47}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":36},"end":{"line":20,"column":47}}},"3":{"name":"(anonymous_3)","line":24,"loc":{"start":{"line":24,"column":34},"end":{"line":24,"column":45}}},"4":{"name":"(anonymous_4)","line":28,"loc":{"start":{"line":28,"column":39},"end":{"line":28,"column":50}}},"5":{"name":"(anonymous_5)","line":38,"loc":{"start":{"line":38,"column":36},"end":{"line":38,"column":47}}},"6":{"name":"(anonymous_6)","line":48,"loc":{"start":{"line":48,"column":35},"end":{"line":48,"column":46}}},"7":{"name":"(anonymous_7)","line":71,"loc":{"start":{"line":71,"column":34},"end":{"line":71,"column":45}}},"8":{"name":"(anonymous_8)","line":80,"loc":{"start":{"line":80,"column":37},"end":{"line":80,"column":48}}},"9":{"name":"(anonymous_9)","line":93,"loc":{"start":{"line":93,"column":44},"end":{"line":93,"column":55}}},"10":{"name":"(anonymous_10)","line":106,"loc":{"start":{"line":106,"column":34},"end":{"line":106,"column":45}}},"11":{"name":"(anonymous_11)","line":116,"loc":{"start":{"line":116,"column":34},"end":{"line":116,"column":49}}},"12":{"name":"(anonymous_12)","line":129,"loc":{"start":{"line":129,"column":36},"end":{"line":129,"column":51}}},"13":{"name":"(anonymous_13)","line":141,"loc":{"start":{"line":141,"column":38},"end":{"line":141,"column":49}}},"14":{"name":"(anonymous_14)","line":151,"loc":{"start":{"line":151,"column":24},"end":{"line":151,"column":45}}},"15":{"name":"(anonymous_15)","line":152,"loc":{"start":{"line":152,"column":44},"end":{"line":152,"column":65}}},"16":{"name":"(anonymous_16)","line":174,"loc":{"start":{"line":174,"column":29},"end":{"line":174,"column":50}}},"17":{"name":"(anonymous_17)","line":177,"loc":{"start":{"line":177,"column":27},"end":{"line":177,"column":53}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":44}},"3":{"start":{"line":9,"column":0},"end":{"line":14,"column":21}},"4":{"start":{"line":16,"column":0},"end":{"line":18,"column":2}},"5":{"start":{"line":17,"column":4},"end":{"line":17,"column":29}},"6":{"start":{"line":20,"column":0},"end":{"line":22,"column":2}},"7":{"start":{"line":21,"column":4},"end":{"line":21,"column":29}},"8":{"start":{"line":24,"column":0},"end":{"line":26,"column":2}},"9":{"start":{"line":25,"column":4},"end":{"line":25,"column":27}},"10":{"start":{"line":28,"column":0},"end":{"line":30,"column":2}},"11":{"start":{"line":29,"column":4},"end":{"line":29,"column":32}},"12":{"start":{"line":38,"column":0},"end":{"line":40,"column":2}},"13":{"start":{"line":39,"column":4},"end":{"line":39,"column":51}},"14":{"start":{"line":48,"column":0},"end":{"line":64,"column":2}},"15":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"16":{"start":{"line":50,"column":8},"end":{"line":50,"column":25}},"17":{"start":{"line":53,"column":4},"end":{"line":53,"column":28}},"18":{"start":{"line":54,"column":4},"end":{"line":56,"column":5}},"19":{"start":{"line":55,"column":8},"end":{"line":55,"column":25}},"20":{"start":{"line":58,"column":4},"end":{"line":58,"column":31}},"21":{"start":{"line":60,"column":4},"end":{"line":60,"column":74}},"22":{"start":{"line":63,"column":4},"end":{"line":63,"column":38}},"23":{"start":{"line":71,"column":0},"end":{"line":73,"column":2}},"24":{"start":{"line":72,"column":4},"end":{"line":72,"column":56}},"25":{"start":{"line":80,"column":0},"end":{"line":86,"column":2}},"26":{"start":{"line":81,"column":4},"end":{"line":81,"column":28}},"27":{"start":{"line":82,"column":4},"end":{"line":82,"column":31}},"28":{"start":{"line":84,"column":4},"end":{"line":84,"column":79}},"29":{"start":{"line":85,"column":4},"end":{"line":85,"column":18}},"30":{"start":{"line":93,"column":0},"end":{"line":99,"column":2}},"31":{"start":{"line":94,"column":4},"end":{"line":94,"column":38}},"32":{"start":{"line":95,"column":4},"end":{"line":95,"column":41}},"33":{"start":{"line":96,"column":4},"end":{"line":96,"column":59}},"34":{"start":{"line":98,"column":4},"end":{"line":98,"column":22}},"35":{"start":{"line":106,"column":0},"end":{"line":108,"column":2}},"36":{"start":{"line":107,"column":4},"end":{"line":107,"column":47}},"37":{"start":{"line":116,"column":0},"end":{"line":121,"column":2}},"38":{"start":{"line":117,"column":4},"end":{"line":120,"column":6}},"39":{"start":{"line":129,"column":0},"end":{"line":134,"column":2}},"40":{"start":{"line":130,"column":4},"end":{"line":130,"column":55}},"41":{"start":{"line":131,"column":4},"end":{"line":131,"column":32}},"42":{"start":{"line":133,"column":4},"end":{"line":133,"column":29}},"43":{"start":{"line":141,"column":0},"end":{"line":143,"column":2}},"44":{"start":{"line":142,"column":4},"end":{"line":142,"column":46}},"45":{"start":{"line":151,"column":0},"end":{"line":165,"column":2}},"46":{"start":{"line":152,"column":4},"end":{"line":157,"column":7}},"47":{"start":{"line":153,"column":8},"end":{"line":155,"column":9}},"48":{"start":{"line":154,"column":12},"end":{"line":154,"column":27}},"49":{"start":{"line":156,"column":8},"end":{"line":156,"column":72}},"50":{"start":{"line":159,"column":4},"end":{"line":164,"column":7}},"51":{"start":{"line":174,"column":0},"end":{"line":186,"column":2}},"52":{"start":{"line":175,"column":4},"end":{"line":175,"column":38}},"53":{"start":{"line":177,"column":4},"end":{"line":185,"column":13}},"54":{"start":{"line":178,"column":8},"end":{"line":178,"column":34}},"55":{"start":{"line":178,"column":20},"end":{"line":178,"column":34}},"56":{"start":{"line":180,"column":8},"end":{"line":182,"column":9}},"57":{"start":{"line":181,"column":12},"end":{"line":181,"column":27}},"58":{"start":{"line":184,"column":8},"end":{"line":184,"column":57}},"59":{"start":{"line":189,"column":0},"end":{"line":189,"column":32}}},"branchMap":{"1":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":4},"end":{"line":49,"column":4}},{"start":{"line":49,"column":4},"end":{"line":49,"column":4}}]},"2":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":4},"end":{"line":54,"column":4}},{"start":{"line":54,"column":4},"end":{"line":54,"column":4}}]},"3":{"line":60,"type":"cond-expr","locations":[{"start":{"line":60,"column":38},"end":{"line":60,"column":66}},{"start":{"line":60,"column":69},"end":{"line":60,"column":72}}]},"4":{"line":72,"type":"cond-expr","locations":[{"start":{"line":72,"column":30},"end":{"line":72,"column":43}},{"start":{"line":72,"column":46},"end":{"line":72,"column":55}}]},"5":{"line":84,"type":"cond-expr","locations":[{"start":{"line":84,"column":36},"end":{"line":84,"column":65}},{"start":{"line":84,"column":68},"end":{"line":84,"column":77}}]},"6":{"line":107,"type":"binary-expr","locations":[{"start":{"line":107,"column":11},"end":{"line":107,"column":29}},{"start":{"line":107,"column":33},"end":{"line":107,"column":46}}]},"7":{"line":118,"type":"binary-expr","locations":[{"start":{"line":118,"column":8},"end":{"line":118,"column":41}},{"start":{"line":119,"column":11},"end":{"line":119,"column":41}}]},"8":{"line":130,"type":"cond-expr","locations":[{"start":{"line":130,"column":31},"end":{"line":130,"column":35}},{"start":{"line":130,"column":38},"end":{"line":130,"column":54}}]},"9":{"line":152,"type":"binary-expr","locations":[{"start":{"line":152,"column":20},"end":{"line":152,"column":32}},{"start":{"line":152,"column":36},"end":{"line":152,"column":38}}]},"10":{"line":153,"type":"if","locations":[{"start":{"line":153,"column":8},"end":{"line":153,"column":8}},{"start":{"line":153,"column":8},"end":{"line":153,"column":8}}]},"11":{"line":162,"type":"binary-expr","locations":[{"start":{"line":162,"column":13},"end":{"line":162,"column":20}},{"start":{"line":162,"column":24},"end":{"line":162,"column":32}},{"start":{"line":162,"column":36},"end":{"line":162,"column":38}}]},"12":{"line":178,"type":"if","locations":[{"start":{"line":178,"column":8},"end":{"line":178,"column":8}},{"start":{"line":178,"column":8},"end":{"line":178,"column":8}}]},"13":{"line":180,"type":"if","locations":[{"start":{"line":180,"column":8},"end":{"line":180,"column":8}},{"start":{"line":180,"column":8},"end":{"line":180,"column":8}}]}},"code":["var Immutable = require('immutable');","","var location = require('../utils/location');","","/*","    An article represents an entry in the Summary / table of Contents","*/","","var SummaryArticle = Immutable.Record({","    level:      String(),","    title:      String(),","    ref:        String(),","    articles:   Immutable.List()","}, 'SummaryArticle');","","SummaryArticle.prototype.getLevel = function() {","    return this.get('level');","};","","SummaryArticle.prototype.getTitle = function() {","    return this.get('title');","};","","SummaryArticle.prototype.getRef = function() {","    return this.get('ref');","};","","SummaryArticle.prototype.getArticles = function() {","    return this.get('articles');","};","","/**"," * Return how deep the article is."," * The README has a depth of 1"," *"," * @return {Number}"," */","SummaryArticle.prototype.getDepth = function() {","    return (this.getLevel().split('.').length - 1);","};","","/**"," * Get path (without anchor) to the pointing file."," * It also normalizes the file path."," *"," * @return {String}"," */","SummaryArticle.prototype.getPath = function() {","    if (this.isExternal()) {","        return undefined;","    }","","    var ref = this.getRef();","    if (!ref) {","        return undefined;","    }","","    var parts = ref.split('#');","","    var pathname = (parts.length > 1? parts.slice(0, -1).join('#') : ref);","","    // Normalize path to remove ('./', '/...', etc)","    return location.flatten(pathname);","};","","/**"," * Return url if article is external"," *"," * @return {String}"," */","SummaryArticle.prototype.getUrl = function() {","    return this.isExternal()? this.getRef() : undefined;","};","","/**"," * Get anchor for this article (or undefined)"," *"," * @return {String}"," */","SummaryArticle.prototype.getAnchor = function() {","    var ref = this.getRef();","    var parts = ref.split('#');","","    var anchor = (parts.length > 1? '#' + parts[parts.length - 1] : undefined);","    return anchor;","};","","/**"," * Create a new level for a new child article"," *"," * @return {String}"," */","SummaryArticle.prototype.createChildLevel = function() {","    var level       = this.getLevel();","    var subArticles = this.getArticles();","    var childLevel  = level + '.' + (subArticles.size + 1);","","    return childLevel;","};","","/**"," * Is article pointing to a page of an absolute url"," *"," * @return {Boolean}"," */","SummaryArticle.prototype.isPage = function() {","    return !this.isExternal() && this.getRef();","};","","/**"," * Check if this article is a file (exatcly)"," *"," * @param {File} file"," * @return {Boolean}"," */","SummaryArticle.prototype.isFile = function(file) {","    return (","        file.getPath() === this.getPath()","        && this.getAnchor() === undefined","    );","};","","/**"," * Check if this article is the introduction of the book"," *"," * @param {Book|Readme} book"," * @return {Boolean}"," */","SummaryArticle.prototype.isReadme = function(book) {","    var readme = book.getFile? book : book.getReadme();","    var file = readme.getFile();","","    return this.isFile(file);","};","","/**"," * Is article pointing to aan absolute url"," *"," * @return {Boolean}"," */","SummaryArticle.prototype.isExternal = function() {","    return location.isExternal(this.getRef());","};","","/**"," * Create a SummaryArticle"," *"," * @param {Object} def"," * @return {SummaryArticle}"," */","SummaryArticle.create = function(def, level) {","    var articles = (def.articles || []).map(function(article, i) {","        if (article instanceof SummaryArticle) {","            return article;","        }","        return SummaryArticle.create(article, [level, i + 1].join('.'));","    });","","    return new SummaryArticle({","        level: level,","        title: def.title,","        ref: def.ref || def.path || '',","        articles: Immutable.List(articles)","    });","};","","/**"," * Find an article from a base one"," *"," * @param {Article|Part} base"," * @param {Function(article)} iter"," * @return {Article}"," */","SummaryArticle.findArticle = function(base, iter) {","    var articles = base.getArticles();","","    return articles.reduce(function(result, article) {","        if (result) return result;","","        if (iter(article)) {","            return article;","        }","","        return SummaryArticle.findArticle(article, iter);","    }, null);","};","","","module.exports = SummaryArticle;",""],"l":{"1":1,"3":1,"9":1,"16":1,"17":0,"20":1,"21":0,"24":1,"25":0,"28":1,"29":0,"38":1,"39":0,"48":1,"49":0,"50":0,"53":0,"54":0,"55":0,"58":0,"60":0,"63":0,"71":1,"72":0,"80":1,"81":0,"82":0,"84":0,"85":0,"93":1,"94":0,"95":0,"96":0,"98":0,"106":1,"107":0,"116":1,"117":0,"129":1,"130":0,"131":0,"133":0,"141":1,"142":0,"151":1,"152":0,"153":0,"154":0,"156":0,"159":0,"174":1,"175":0,"177":0,"178":0,"180":0,"181":0,"184":0,"189":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/location.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/location.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":1,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":1,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":1,"39":0,"40":0,"41":1,"42":0,"43":1,"44":0,"45":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"isExternal","line":5,"loc":{"start":{"line":5,"column":0},"end":{"line":5,"column":26}}},"2":{"name":"isDataURI","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":25}}},"3":{"name":"isRelative","line":23,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":26}}},"4":{"name":"isAnchor","line":28,"loc":{"start":{"line":28,"column":0},"end":{"line":28,"column":24}}},"5":{"name":"normalize","line":38,"loc":{"start":{"line":38,"column":0},"end":{"line":38,"column":22}}},"6":{"name":"flatten","line":48,"loc":{"start":{"line":48,"column":0},"end":{"line":48,"column":23}}},"7":{"name":"toAbsolute","line":65,"loc":{"start":{"line":65,"column":0},"end":{"line":65,"column":40}}},"8":{"name":"relative","line":99,"loc":{"start":{"line":99,"column":0},"end":{"line":99,"column":29}}},"9":{"name":"relativeForFile","line":112,"loc":{"start":{"line":112,"column":0},"end":{"line":112,"column":41}}},"10":{"name":"areIdenticalPaths","line":124,"loc":{"start":{"line":124,"column":0},"end":{"line":124,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":25}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":5,"column":0},"end":{"line":11,"column":1}},"4":{"start":{"line":6,"column":4},"end":{"line":10,"column":5}},"5":{"start":{"line":7,"column":8},"end":{"line":7,"column":69}},"6":{"start":{"line":9,"column":8},"end":{"line":9,"column":21}},"7":{"start":{"line":14,"column":0},"end":{"line":20,"column":1}},"8":{"start":{"line":15,"column":4},"end":{"line":19,"column":5}},"9":{"start":{"line":16,"column":8},"end":{"line":16,"column":91}},"10":{"start":{"line":18,"column":8},"end":{"line":18,"column":21}},"11":{"start":{"line":23,"column":0},"end":{"line":25,"column":1}},"12":{"start":{"line":24,"column":4},"end":{"line":24,"column":29}},"13":{"start":{"line":28,"column":0},"end":{"line":35,"column":1}},"14":{"start":{"line":29,"column":4},"end":{"line":34,"column":5}},"15":{"start":{"line":30,"column":8},"end":{"line":30,"column":37}},"16":{"start":{"line":31,"column":8},"end":{"line":31,"column":67}},"17":{"start":{"line":33,"column":8},"end":{"line":33,"column":21}},"18":{"start":{"line":38,"column":0},"end":{"line":40,"column":1}},"19":{"start":{"line":39,"column":4},"end":{"line":39,"column":49}},"20":{"start":{"line":48,"column":0},"end":{"line":55,"column":1}},"21":{"start":{"line":49,"column":4},"end":{"line":49,"column":27}},"22":{"start":{"line":50,"column":4},"end":{"line":52,"column":5}},"23":{"start":{"line":51,"column":8},"end":{"line":51,"column":40}},"24":{"start":{"line":54,"column":4},"end":{"line":54,"column":16}},"25":{"start":{"line":65,"column":0},"end":{"line":89,"column":1}},"26":{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},"27":{"start":{"line":67,"column":8},"end":{"line":67,"column":21}},"28":{"start":{"line":70,"column":4},"end":{"line":70,"column":47}},"29":{"start":{"line":72,"column":4},"end":{"line":72,"column":29}},"30":{"start":{"line":73,"column":4},"end":{"line":73,"column":25}},"31":{"start":{"line":74,"column":4},"end":{"line":74,"column":31}},"32":{"start":{"line":77,"column":4},"end":{"line":77,"column":54}},"33":{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},"34":{"start":{"line":79,"column":8},"end":{"line":79,"column":47}},"35":{"start":{"line":83,"column":4},"end":{"line":83,"column":46}},"36":{"start":{"line":86,"column":4},"end":{"line":86,"column":29}},"37":{"start":{"line":88,"column":4},"end":{"line":88,"column":17}},"38":{"start":{"line":99,"column":0},"end":{"line":102,"column":1}},"39":{"start":{"line":100,"column":4},"end":{"line":100,"column":45}},"40":{"start":{"line":101,"column":4},"end":{"line":101,"column":72}},"41":{"start":{"line":112,"column":0},"end":{"line":114,"column":1}},"42":{"start":{"line":113,"column":4},"end":{"line":113,"column":50}},"43":{"start":{"line":124,"column":0},"end":{"line":126,"column":1}},"44":{"start":{"line":125,"column":4},"end":{"line":125,"column":43}},"45":{"start":{"line":128,"column":0},"end":{"line":139,"column":2}}},"branchMap":{"1":{"line":7,"type":"binary-expr","locations":[{"start":{"line":7,"column":15},"end":{"line":7,"column":48}},{"start":{"line":7,"column":52},"end":{"line":7,"column":68}}]},"2":{"line":16,"type":"binary-expr","locations":[{"start":{"line":16,"column":15},"end":{"line":16,"column":48}},{"start":{"line":16,"column":53},"end":{"line":16,"column":89}}]},"3":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":18},"end":{"line":31,"column":34}},{"start":{"line":31,"column":38},"end":{"line":31,"column":50}},{"start":{"line":31,"column":54},"end":{"line":31,"column":65}}]},"4":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":4},"end":{"line":50,"column":4}},{"start":{"line":50,"column":4},"end":{"line":50,"column":4}}]},"5":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":66,"column":4}},{"start":{"line":66,"column":4},"end":{"line":66,"column":4}}]},"6":{"line":66,"type":"binary-expr","locations":[{"start":{"line":66,"column":8},"end":{"line":66,"column":25}},{"start":{"line":66,"column":29},"end":{"line":66,"column":45}}]},"7":{"line":70,"type":"cond-expr","locations":[{"start":{"line":70,"column":34},"end":{"line":70,"column":37}},{"start":{"line":70,"column":40},"end":{"line":70,"column":46}}]},"8":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":4},"end":{"line":78,"column":4}},{"start":{"line":78,"column":4},"end":{"line":78,"column":4}}]},"9":{"line":101,"type":"cond-expr","locations":[{"start":{"line":101,"column":63},"end":{"line":101,"column":66}},{"start":{"line":101,"column":68},"end":{"line":101,"column":70}}]}},"code":["var url = require('url');","var path = require('path');","","// Is the url an external url","function isExternal(href) {","    try {","        return Boolean(url.parse(href).protocol) && !isDataURI(href);","    } catch(err) {","        return false;","    }","}","","// Is the url an iniline data-uri","function isDataURI(href) {","    try {","        return Boolean(url.parse(href).protocol) && (url.parse(href).protocol === 'data:');","    } catch(err) {","        return false;","    }","}","","// Inverse of isExternal","function isRelative(href) {","    return !isExternal(href);","}","","// Return true if the link is an achor","function isAnchor(href) {","    try {","        var parsed = url.parse(href);","        return !!(!parsed.protocol && !parsed.path && parsed.hash);","    } catch(err) {","        return false;","    }","}","","// Normalize a path to be a link","function normalize(s) {","    return path.normalize(s).replace(/\\\\/g, '/');","}","","/**"," * Flatten a path, it removes the leading \"/\""," *"," * @param {String} href"," * @return {String}"," */","function flatten(href) {","    href = normalize(href);","    if (href[0] == '/') {","        href = normalize(href.slice(1));","    }","","    return href;","}","","/**"," * Convert a relative path to absolute"," *"," * @param {String} href"," * @param {String} dir: directory parent of the file currently in rendering process"," * @param {String} outdir: directory parent from the html output"," * @return {String}"," */","function toAbsolute(_href, dir, outdir) {","    if (isExternal(_href) || isDataURI(_href)) {","        return _href;","    }","","    outdir = outdir == undefined? dir : outdir;","","    _href = normalize(_href);","    dir = normalize(dir);","    outdir = normalize(outdir);","","    // Path \"_href\" inside the base folder","    var hrefInRoot = normalize(path.join(dir, _href));","    if (_href[0] == '/') {","        hrefInRoot = normalize(_href.slice(1));","    }","","    // Make it relative to output","    _href = path.relative(outdir, hrefInRoot);","","    // Normalize windows paths","    _href = normalize(_href);","","    return _href;","}","","/**"," * Convert an absolute path to a relative path for a specific folder (dir)"," * ('test/', 'hello.md') -> '../hello.md'"," *"," * @param {String} dir: current directory"," * @param {String} file: absolute path of file"," * @return {String}"," */","function relative(dir, file) {","    var isDirectory = file.slice(-1) === '/';","    return normalize(path.relative(dir, file)) + (isDirectory? '/': '');","}","","/**"," * Convert an absolute path to a relative path for a specific folder (dir)"," * ('test/test.md', 'hello.md') -> '../hello.md'"," *"," * @param {String} baseFile: current file"," * @param {String} file: absolute path of file"," * @return {String}"," */","function relativeForFile(baseFile, file) {","    return relative(path.dirname(baseFile), file);","}","","/**"," * Compare two paths, return true if they are identical"," * ('README.md', './README.md') -> true"," *"," * @param {String} p1: first path"," * @param {String} p2: second path"," * @return {Boolean}"," */","function areIdenticalPaths(p1, p2) {","    return normalize(p1) === normalize(p2);","}","","module.exports = {","    areIdenticalPaths: areIdenticalPaths,","    isDataURI:         isDataURI,","    isExternal:        isExternal,","    isRelative:        isRelative,","    isAnchor:          isAnchor,","    normalize:         normalize,","    toAbsolute:        toAbsolute,","    relative:          relative,","    relativeForFile:   relativeForFile,","    flatten:           flatten","};",""],"l":{"1":1,"2":1,"5":1,"6":0,"7":0,"9":0,"14":1,"15":0,"16":0,"18":0,"23":1,"24":0,"28":1,"29":0,"30":0,"31":0,"33":0,"38":1,"39":0,"48":1,"49":0,"50":0,"51":0,"54":0,"65":1,"66":0,"67":0,"70":0,"72":0,"73":0,"74":0,"77":0,"78":0,"79":0,"83":0,"86":0,"88":0,"99":1,"100":0,"101":0,"112":1,"113":0,"124":1,"125":0,"128":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/mergeAtLevel.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/mergeAtLevel.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":0,"12":0,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"editArticleInList","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":56}}},"2":{"name":"(anonymous_2)","line":11,"loc":{"start":{"line":11,"column":24},"end":{"line":11,"column":42}}},"3":{"name":"editArticleInPart","line":37,"loc":{"start":{"line":37,"column":0},"end":{"line":37,"column":52}}},"4":{"name":"mergeAtLevel","line":53,"loc":{"start":{"line":53,"column":0},"end":{"line":53,"column":48}}}},"statementMap":{"1":{"start":{"line":10,"column":0},"end":{"line":26,"column":1}},"2":{"start":{"line":11,"column":4},"end":{"line":25,"column":7}},"3":{"start":{"line":12,"column":8},"end":{"line":12,"column":46}},"4":{"start":{"line":14,"column":8},"end":{"line":24,"column":9}},"5":{"start":{"line":16,"column":12},"end":{"line":16,"column":45}},"6":{"start":{"line":17,"column":15},"end":{"line":24,"column":9}},"7":{"start":{"line":19,"column":12},"end":{"line":19,"column":87}},"8":{"start":{"line":20,"column":12},"end":{"line":20,"column":53}},"9":{"start":{"line":23,"column":12},"end":{"line":23,"column":27}},"10":{"start":{"line":37,"column":0},"end":{"line":42,"column":1}},"11":{"start":{"line":38,"column":4},"end":{"line":38,"column":38}},"12":{"start":{"line":39,"column":4},"end":{"line":39,"column":62}},"13":{"start":{"line":41,"column":4},"end":{"line":41,"column":42}},"14":{"start":{"line":53,"column":0},"end":{"line":72,"column":1}},"15":{"start":{"line":54,"column":4},"end":{"line":54,"column":38}},"16":{"start":{"line":55,"column":4},"end":{"line":55,"column":45}},"17":{"start":{"line":57,"column":4},"end":{"line":57,"column":35}},"18":{"start":{"line":58,"column":4},"end":{"line":58,"column":36}},"19":{"start":{"line":59,"column":4},"end":{"line":61,"column":5}},"20":{"start":{"line":60,"column":8},"end":{"line":60,"column":23}},"21":{"start":{"line":63,"column":4},"end":{"line":63,"column":46}},"22":{"start":{"line":64,"column":4},"end":{"line":68,"column":5}},"23":{"start":{"line":65,"column":8},"end":{"line":65,"column":36}},"24":{"start":{"line":67,"column":8},"end":{"line":67,"column":56}},"25":{"start":{"line":70,"column":4},"end":{"line":70,"column":39}},"26":{"start":{"line":71,"column":4},"end":{"line":71,"column":39}},"27":{"start":{"line":75,"column":0},"end":{"line":75,"column":30}}},"branchMap":{"1":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":8},"end":{"line":14,"column":8}},{"start":{"line":14,"column":8},"end":{"line":14,"column":8}}]},"2":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":15},"end":{"line":17,"column":15}},{"start":{"line":17,"column":15},"end":{"line":17,"column":15}}]},"3":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":4},"end":{"line":59,"column":4}},{"start":{"line":59,"column":4},"end":{"line":59,"column":4}}]},"4":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":4},"end":{"line":64,"column":4}},{"start":{"line":64,"column":4},"end":{"line":64,"column":4}}]}},"code":["","/**","    Edit a list of articles","","    @param {List<Article>} articles","    @param {String} level","    @param {Article} newArticle","    @return {List<Article>}","*/","function editArticleInList(articles, level, newArticle) {","    return articles.map(function(article) {","        var articleLevel = article.getLevel();","","        if (articleLevel === level) {","            // it is the article to edit","            return article.merge(newArticle);","        } else if (level.indexOf(articleLevel) === 0) {","            // it is a parent","            var articles = editArticleInList(article.getArticles(), level, newArticle);","            return article.set('articles', articles);","        } else {","            // This is not the article you are looking for","            return article;","        }","    });","}","","","/**","    Edit an article in a part","","    @param {Part} part","    @param {String} level","    @param {Article} newArticle","    @return {Part}","*/","function editArticleInPart(part, level, newArticle) {","    var articles = part.getArticles();","    articles = editArticleInList(articles, level, newArticle);","","    return part.set('articles', articles);","}","","","/**","    Edit an article, or a part, in a summary. Does a shallow merge.","","    @param {Summary} summary","    @param {String} level","    @param {Article|Part} newValue","    @return {Summary}","*/","function mergeAtLevel(summary, level, newValue) {","    var levelParts = level.split('.');","    var partIndex = Number(levelParts[0]) -1;","","    var parts = summary.getParts();","    var part = parts.get(partIndex);","    if (!part) {","        return summary;","    }","","    var isEditingPart = levelParts.length < 2;","    if (isEditingPart) {","        part = part.merge(newValue);","    } else {","        part = editArticleInPart(part, level, newValue);","    }","","    parts = parts.set(partIndex, part);","    return summary.set('parts', parts);","}","","","module.exports = mergeAtLevel;",""],"l":{"10":1,"11":0,"12":0,"14":0,"16":0,"17":0,"19":0,"20":0,"23":0,"37":1,"38":0,"39":0,"41":0,"53":1,"54":0,"55":0,"57":0,"58":0,"59":0,"60":0,"63":0,"64":0,"65":0,"67":0,"70":0,"71":0,"75":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/indexArticleLevels.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/indexArticleLevels.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"indexArticleLevels","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":48}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":28},"end":{"line":13,"column":47}}}},"statementMap":{"1":{"start":{"line":9,"column":0},"end":{"line":21,"column":1}},"2":{"start":{"line":10,"column":4},"end":{"line":10,"column":48}},"3":{"start":{"line":11,"column":4},"end":{"line":11,"column":41}},"4":{"start":{"line":13,"column":4},"end":{"line":15,"column":7}},"5":{"start":{"line":14,"column":8},"end":{"line":14,"column":68}},"6":{"start":{"line":17,"column":4},"end":{"line":20,"column":7}},"7":{"start":{"line":23,"column":0},"end":{"line":23,"column":36}}},"branchMap":{"1":{"line":10,"type":"binary-expr","locations":[{"start":{"line":10,"column":16},"end":{"line":10,"column":25}},{"start":{"line":10,"column":29},"end":{"line":10,"column":47}}]}},"code":["","/**","    Index levels in an article tree","","    @param {Article}","    @param {String} baseLevel","    @return {Article}","*/","function indexArticleLevels(article, baseLevel) {","    baseLevel = baseLevel || article.getLevel();","    var articles = article.getArticles();","","    articles = articles.map(function(inner, i) {","        return indexArticleLevels(inner, baseLevel + '.' + (i + 1));","    });","","    return article.merge({","        level: baseLevel,","        articles: articles","    });","}","","module.exports = indexArticleLevels;",""],"l":{"9":1,"10":0,"11":0,"13":0,"14":0,"17":0,"23":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/moveArticle.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/moveArticle.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"moveArticle","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":46}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":47}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":47}},"4":{"start":{"line":14,"column":0},"end":{"line":23,"column":1}},"5":{"start":{"line":16,"column":4},"end":{"line":16,"column":68}},"6":{"start":{"line":17,"column":4},"end":{"line":17,"column":68}},"7":{"start":{"line":18,"column":4},"end":{"line":18,"column":50}},"8":{"start":{"line":21,"column":4},"end":{"line":21,"column":54}},"9":{"start":{"line":22,"column":4},"end":{"line":22,"column":56}},"10":{"start":{"line":25,"column":0},"end":{"line":25,"column":29}}},"branchMap":{"1":{"line":16,"type":"cond-expr","locations":[{"start":{"line":16,"column":41},"end":{"line":16,"column":47}},{"start":{"line":16,"column":50},"end":{"line":16,"column":67}}]},"2":{"line":17,"type":"cond-expr","locations":[{"start":{"line":17,"column":41},"end":{"line":17,"column":47}},{"start":{"line":17,"column":50},"end":{"line":17,"column":67}}]}},"code":["var is = require('is');","var removeArticle = require('./removeArticle');","var insertArticle = require('./insertArticle');","","/**","    Returns a new summary, with the given article removed from its","    origin level, and placed at the given target level.","","    @param {Summary} summary","    @param {String|SummaryArticle} origin: level to remove","    @param {String|SummaryArticle} target: the level where the article will be found","    @return {Summary}","*/","function moveArticle(summary, origin, target) {","    // Coerce to level","    var originLevel = is.string(origin)? origin : origin.getLevel();","    var targetLevel = is.string(target)? target : target.getLevel();","    var article = summary.getByLevel(originLevel);","","    // Remove first","    var removed = removeArticle(summary, originLevel);","    return insertArticle(removed, article, targetLevel);","}","","module.exports = moveArticle;",""],"l":{"1":1,"2":1,"3":1,"14":1,"16":0,"17":0,"18":0,"21":0,"22":0,"25":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/removeArticle.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/removeArticle.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"removeArticle","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":39}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":35},"end":{"line":20,"column":49}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":45}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":57}},"4":{"start":{"line":12,"column":0},"end":{"line":35,"column":1}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":55}},"6":{"start":{"line":16,"column":4},"end":{"line":16,"column":42}},"7":{"start":{"line":18,"column":4},"end":{"line":18,"column":40}},"8":{"start":{"line":20,"column":4},"end":{"line":22,"column":7}},"9":{"start":{"line":21,"column":8},"end":{"line":21,"column":40}},"10":{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},"11":{"start":{"line":24,"column":8},"end":{"line":24,"column":23}},"12":{"start":{"line":28,"column":4},"end":{"line":28,"column":38}},"13":{"start":{"line":29,"column":4},"end":{"line":29,"column":46}},"14":{"start":{"line":32,"column":4},"end":{"line":32,"column":40}},"15":{"start":{"line":34,"column":4},"end":{"line":34,"column":60}},"16":{"start":{"line":37,"column":0},"end":{"line":37,"column":31}}},"branchMap":{"1":{"line":14,"type":"cond-expr","locations":[{"start":{"line":14,"column":30},"end":{"line":14,"column":35}},{"start":{"line":14,"column":38},"end":{"line":14,"column":54}}]},"2":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":23,"column":4}},{"start":{"line":23,"column":4},"end":{"line":23,"column":4}}]}},"code":["var is = require('is');","var mergeAtLevel = require('./mergeAtLevel');","var indexArticleLevels = require('./indexArticleLevels');","","/**","    Remove an article from a level.","","    @param {Summary} summary","    @param {String|SummaryArticle} level: level to remove","    @return {Summary}","*/","function removeArticle(summary, level) {","    // Coerce to level","    level = is.string(level)? level : level.getLevel();","","    var parent = summary.getParent(level);","","    var articles = parent.getArticles();","    // Find the index to remove","    var index = articles.findIndex(function(art) {","        return art.getLevel() === level;","    });","    if (index === -1) {","        return summary;","    }","","    // Remove from children","    articles = articles.remove(index);","    parent = parent.set('articles', articles);","","    // Reindex the level from here","    parent = indexArticleLevels(parent);","","    return mergeAtLevel(summary, parent.getLevel(), parent);","}","","module.exports = removeArticle;",""],"l":{"1":1,"2":1,"3":1,"12":1,"14":0,"16":0,"18":0,"20":0,"21":0,"23":0,"24":0,"28":0,"29":0,"32":0,"34":0,"37":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/moveArticleAfter.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/moveArticleAfter.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":0,"16":0,"17":1,"18":0,"19":1,"20":0,"21":0,"22":0,"23":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"moveArticleAfter","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":56}}},"2":{"name":"levelToArray","line":40,"loc":{"start":{"line":40,"column":0},"end":{"line":40,"column":25}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":28},"end":{"line":41,"column":44}}},"4":{"name":"arrayToLevel","line":50,"loc":{"start":{"line":50,"column":0},"end":{"line":50,"column":25}}},"5":{"name":"increment","line":54,"loc":{"start":{"line":54,"column":0},"end":{"line":54,"column":26}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":47}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":47}},"4":{"start":{"line":15,"column":0},"end":{"line":34,"column":1}},"5":{"start":{"line":17,"column":4},"end":{"line":17,"column":68}},"6":{"start":{"line":18,"column":4},"end":{"line":18,"column":88}},"7":{"start":{"line":19,"column":4},"end":{"line":19,"column":50}},"8":{"start":{"line":21,"column":4},"end":{"line":21,"column":50}},"9":{"start":{"line":23,"column":4},"end":{"line":33,"column":5}},"10":{"start":{"line":25,"column":8},"end":{"line":25,"column":58}},"11":{"start":{"line":27,"column":8},"end":{"line":27,"column":60}},"12":{"start":{"line":30,"column":8},"end":{"line":30,"column":68}},"13":{"start":{"line":32,"column":8},"end":{"line":32,"column":52}},"14":{"start":{"line":40,"column":0},"end":{"line":44,"column":1}},"15":{"start":{"line":41,"column":4},"end":{"line":43,"column":7}},"16":{"start":{"line":42,"column":8},"end":{"line":42,"column":34}},"17":{"start":{"line":50,"column":0},"end":{"line":52,"column":1}},"18":{"start":{"line":51,"column":4},"end":{"line":51,"column":23}},"19":{"start":{"line":54,"column":0},"end":{"line":58,"column":1}},"20":{"start":{"line":55,"column":4},"end":{"line":55,"column":32}},"21":{"start":{"line":56,"column":4},"end":{"line":56,"column":30}},"22":{"start":{"line":57,"column":4},"end":{"line":57,"column":31}},"23":{"start":{"line":60,"column":0},"end":{"line":60,"column":34}}},"branchMap":{"1":{"line":17,"type":"cond-expr","locations":[{"start":{"line":17,"column":41},"end":{"line":17,"column":47}},{"start":{"line":17,"column":50},"end":{"line":17,"column":67}}]},"2":{"line":18,"type":"cond-expr","locations":[{"start":{"line":18,"column":51},"end":{"line":18,"column":62}},{"start":{"line":18,"column":65},"end":{"line":18,"column":87}}]},"3":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":23,"column":4}},{"start":{"line":23,"column":4},"end":{"line":23,"column":4}}]}},"code":["var is = require('is');","var removeArticle = require('./removeArticle');","var insertArticle = require('./insertArticle');","","/**","    Returns a new summary, with the an article moved after another","    article. Unlike `moveArticle`, does not ensure that the article","    will be found at the target's level plus one.","","    @param {Summary} summary","    @param {String|SummaryArticle} origin","    @param {String|SummaryArticle} afterTarget","    @return {Summary}","*/","function moveArticleAfter(summary, origin, afterTarget) {","    // Coerce to level","    var originLevel = is.string(origin)? origin : origin.getLevel();","    var afterTargetLevel = is.string(afterTarget)? afterTarget : afterTarget.getLevel();","    var article = summary.getByLevel(originLevel);","","    var targetLevel = increment(afterTargetLevel);","","    if (targetLevel < origin) {","        // Remove first","        var removed = removeArticle(summary, originLevel);","        // Insert then","        return insertArticle(removed, article, targetLevel);","    } else {","        // Insert right after first","        var inserted = insertArticle(summary, article, targetLevel);","        // Remove old one","        return removeArticle(inserted, originLevel);","    }","}","","/**","    @param {String}","    @return {Array<Number>}"," */","function levelToArray(l) {","    return l.split('.').map(function (char) {","        return parseInt(char, 10);","    });","}","","/**","    @param {Array<Number>}","    @return {String}"," */","function arrayToLevel(a) {","    return a.join('.');","}","","function increment(level) {","    level = levelToArray(level);","    level[level.length - 1]++;","    return arrayToLevel(level);","}","","module.exports = moveArticleAfter;",""],"l":{"1":1,"2":1,"3":1,"15":1,"17":0,"18":0,"19":0,"21":0,"23":0,"25":0,"27":0,"30":0,"32":0,"40":1,"41":0,"42":0,"50":1,"51":0,"54":1,"55":0,"56":0,"57":0,"60":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/unshiftArticle.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/unshiftArticle.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"unshiftArticle","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":42}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":60}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":54}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":43}},"4":{"start":{"line":13,"column":0},"end":{"line":27,"column":1}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":38}},"6":{"start":{"line":16,"column":4},"end":{"line":16,"column":35}},"7":{"start":{"line":17,"column":4},"end":{"line":17,"column":45}},"8":{"start":{"line":19,"column":4},"end":{"line":19,"column":38}},"9":{"start":{"line":20,"column":4},"end":{"line":20,"column":41}},"10":{"start":{"line":21,"column":4},"end":{"line":21,"column":42}},"11":{"start":{"line":23,"column":4},"end":{"line":23,"column":31}},"12":{"start":{"line":24,"column":4},"end":{"line":24,"column":42}},"13":{"start":{"line":26,"column":4},"end":{"line":26,"column":32}},"14":{"start":{"line":29,"column":0},"end":{"line":29,"column":32}}},"branchMap":{"1":{"line":17,"type":"binary-expr","locations":[{"start":{"line":17,"column":15},"end":{"line":17,"column":27}},{"start":{"line":17,"column":31},"end":{"line":17,"column":44}}]}},"code":["var SummaryArticle = require('../../models/summaryArticle');","var SummaryPart = require('../../models/summaryPart');","","var indexLevels = require('./indexLevels');","","/**","    Insert an article at the beginning of summary","","    @param {Summary} summary","    @param {Article} article","    @return {Summary}","*/","function unshiftArticle(summary, article) {","    article = SummaryArticle(article);","","    var parts = summary.getParts();","    var part = parts.get(0) || SummaryPart();","","    var articles = part.getArticles();","    articles = articles.unshift(article);","    part = part.set('articles', articles);","","    parts = parts.set(0, part);","    summary = summary.set('parts', parts);","","    return indexLevels(summary);","}","","module.exports = unshiftArticle;",""],"l":{"1":1,"2":1,"4":1,"13":1,"14":0,"16":0,"17":0,"19":0,"20":0,"21":0,"23":0,"24":0,"26":0,"29":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/summaryPart.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/summaryPart.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":15,"loc":{"start":{"line":15,"column":33},"end":{"line":15,"column":44}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":33},"end":{"line":19,"column":44}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":36},"end":{"line":23,"column":47}}},"4":{"name":"(anonymous_4)","line":32,"loc":{"start":{"line":32,"column":41},"end":{"line":32,"column":52}}},"5":{"name":"(anonymous_5)","line":46,"loc":{"start":{"line":46,"column":21},"end":{"line":46,"column":42}}},"6":{"name":"(anonymous_6)","line":47,"loc":{"start":{"line":47,"column":44},"end":{"line":47,"column":65}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":49}},"3":{"start":{"line":9,"column":0},"end":{"line":13,"column":3}},"4":{"start":{"line":15,"column":0},"end":{"line":17,"column":2}},"5":{"start":{"line":16,"column":4},"end":{"line":16,"column":29}},"6":{"start":{"line":19,"column":0},"end":{"line":21,"column":2}},"7":{"start":{"line":20,"column":4},"end":{"line":20,"column":29}},"8":{"start":{"line":23,"column":0},"end":{"line":25,"column":2}},"9":{"start":{"line":24,"column":4},"end":{"line":24,"column":32}},"10":{"start":{"line":32,"column":0},"end":{"line":38,"column":2}},"11":{"start":{"line":33,"column":4},"end":{"line":33,"column":38}},"12":{"start":{"line":34,"column":4},"end":{"line":34,"column":41}},"13":{"start":{"line":35,"column":4},"end":{"line":35,"column":59}},"14":{"start":{"line":37,"column":4},"end":{"line":37,"column":22}},"15":{"start":{"line":46,"column":0},"end":{"line":59,"column":2}},"16":{"start":{"line":47,"column":4},"end":{"line":52,"column":7}},"17":{"start":{"line":48,"column":8},"end":{"line":50,"column":9}},"18":{"start":{"line":49,"column":12},"end":{"line":49,"column":27}},"19":{"start":{"line":51,"column":8},"end":{"line":51,"column":72}},"20":{"start":{"line":54,"column":4},"end":{"line":58,"column":7}},"21":{"start":{"line":61,"column":0},"end":{"line":61,"column":29}}},"branchMap":{"1":{"line":47,"type":"binary-expr","locations":[{"start":{"line":47,"column":20},"end":{"line":47,"column":32}},{"start":{"line":47,"column":36},"end":{"line":47,"column":38}}]},"2":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":8},"end":{"line":48,"column":8}},{"start":{"line":48,"column":8},"end":{"line":48,"column":8}}]}},"code":["var Immutable = require('immutable');","","var SummaryArticle = require('./summaryArticle');","","/*","    A part represents a section in the Summary / table of Contents","*/","","var SummaryPart = Immutable.Record({","    level:      String(),","    title:      String(),","    articles:   Immutable.List()","});","","SummaryPart.prototype.getLevel = function() {","    return this.get('level');","};","","SummaryPart.prototype.getTitle = function() {","    return this.get('title');","};","","SummaryPart.prototype.getArticles = function() {","    return this.get('articles');","};","","/**"," * Create a new level for a new child article"," *"," * @return {String}"," */","SummaryPart.prototype.createChildLevel = function() {","    var level       = this.getLevel();","    var subArticles = this.getArticles();","    var childLevel  = level + '.' + (subArticles.size + 1);","","    return childLevel;","};","","/**"," * Create a SummaryPart"," *"," * @param {Object} def"," * @return {SummaryPart}"," */","SummaryPart.create = function(def, level) {","    var articles = (def.articles || []).map(function(article, i) {","        if (article instanceof SummaryArticle) {","            return article;","        }","        return SummaryArticle.create(article, [level, i + 1].join('.'));","    });","","    return new SummaryPart({","        level: String(level),","        title: def.title,","        articles: Immutable.List(articles)","    });","};","","module.exports = SummaryPart;",""],"l":{"1":1,"3":1,"9":1,"15":1,"16":0,"19":1,"20":0,"23":1,"24":0,"32":1,"33":0,"34":0,"35":0,"37":0,"46":1,"47":0,"48":0,"49":0,"51":0,"54":0,"61":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/indexLevels.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/indexLevels.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"indexLevels","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":30}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":51}},"2":{"start":{"line":9,"column":0},"end":{"line":14,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":10,"column":35}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":39}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":39}},"6":{"start":{"line":17,"column":0},"end":{"line":17,"column":29}}},"branchMap":{},"code":["var indexPartLevels = require('./indexPartLevels');","","/**","    Index all levels in the summary","","    @param {Summary}","    @return {Summary}","*/","function indexLevels(summary) {","    var parts = summary.getParts();","    parts = parts.map(indexPartLevels);","","    return summary.set('parts', parts);","}","","","module.exports = indexLevels;",""],"l":{"1":1,"9":1,"10":0,"11":0,"13":0,"17":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/indexPartLevels.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/indexPartLevels.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"indexPartLevels","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":38}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":28},"end":{"line":14,"column":47}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":57}},"2":{"start":{"line":10,"column":0},"end":{"line":22,"column":1}},"3":{"start":{"line":11,"column":4},"end":{"line":11,"column":38}},"4":{"start":{"line":12,"column":4},"end":{"line":12,"column":38}},"5":{"start":{"line":14,"column":4},"end":{"line":16,"column":7}},"6":{"start":{"line":15,"column":8},"end":{"line":15,"column":68}},"7":{"start":{"line":18,"column":4},"end":{"line":21,"column":7}},"8":{"start":{"line":24,"column":0},"end":{"line":24,"column":33}}},"branchMap":{},"code":["var indexArticleLevels = require('./indexArticleLevels');","","/**","    Index levels in a part","","    @param {Part}","    @param {Number} index","    @return {Part}","*/","function indexPartLevels(part, index) {","    var baseLevel = String(index + 1);","    var articles = part.getArticles();","","    articles = articles.map(function(inner, i) {","        return indexArticleLevels(inner, baseLevel + '.' + (i + 1));","    });","","    return part.merge({","        level: baseLevel,","        articles: articles","    });","}","","module.exports = indexPartLevels;",""],"l":{"1":1,"10":1,"11":0,"12":0,"14":0,"15":0,"18":0,"24":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/editArticleTitle.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/editArticleTitle.js","s":{"1":1,"2":1,"3":0,"4":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"editArticleTitle","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":52}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":45}},"2":{"start":{"line":11,"column":0},"end":{"line":15,"column":1}},"3":{"start":{"line":12,"column":4},"end":{"line":14,"column":7}},"4":{"start":{"line":17,"column":0},"end":{"line":17,"column":34}}},"branchMap":{},"code":["var mergeAtLevel = require('./mergeAtLevel');","","/**","    Edit title of an article","","    @param {Summary} summary","    @param {String} level","    @param {String} newTitle","    @return {Summary}","*/","function editArticleTitle(summary, level, newTitle) {","    return mergeAtLevel(summary, level, {","        title: newTitle","    });","}","","module.exports = editArticleTitle;",""],"l":{"1":1,"11":1,"12":0,"17":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/editArticleRef.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/editArticleRef.js","s":{"1":1,"2":1,"3":0,"4":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"editArticleRef","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":48}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":45}},"2":{"start":{"line":11,"column":0},"end":{"line":15,"column":1}},"3":{"start":{"line":12,"column":4},"end":{"line":14,"column":7}},"4":{"start":{"line":17,"column":0},"end":{"line":17,"column":32}}},"branchMap":{},"code":["var mergeAtLevel = require('./mergeAtLevel');","","/**","    Edit the ref of an article","","    @param {Summary} summary","    @param {String} level","    @param {String} newRef","    @return {Summary}","*/","function editArticleRef(summary, level, newRef) {","    return mergeAtLevel(summary, level, {","        ref: newRef","    });","}","","module.exports = editArticleRef;",""],"l":{"1":1,"11":1,"12":0,"17":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/insertPart.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/insertPart.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"insertPart","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":42}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":54}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":43}},"3":{"start":{"line":12,"column":0},"end":{"line":17,"column":1}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":29}},"5":{"start":{"line":15,"column":4},"end":{"line":15,"column":55}},"6":{"start":{"line":16,"column":4},"end":{"line":16,"column":52}},"7":{"start":{"line":19,"column":0},"end":{"line":19,"column":28}}},"branchMap":{},"code":["var SummaryPart = require('../../models/summaryPart');","var indexLevels = require('./indexLevels');","","/**","    Returns a new Summary with a part inserted at given index","","    @param {Summary} summary","    @param {Part} part","    @param {Number} index","    @return {Summary}","*/","function insertPart(summary, part, index) {","    part = SummaryPart(part);","","    var parts = summary.getParts().insert(index, part);","    return indexLevels(summary.set('parts', parts));","}","","module.exports = insertPart;",""],"l":{"1":1,"2":1,"12":1,"13":0,"15":0,"16":0,"19":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/removePart.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/removePart.js","s":{"1":1,"2":1,"3":0,"4":0,"5":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"removePart","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":43}},"2":{"start":{"line":10,"column":0},"end":{"line":13,"column":1}},"3":{"start":{"line":11,"column":4},"end":{"line":11,"column":49}},"4":{"start":{"line":12,"column":4},"end":{"line":12,"column":52}},"5":{"start":{"line":15,"column":0},"end":{"line":15,"column":28}}},"branchMap":{},"code":["var indexLevels = require('./indexLevels');","","/**","    Remove a part at given index","","    @param {Summary} summary","    @param {Number|} index","    @return {Summary}","*/","function removePart(summary, index) {","    var parts = summary.getParts().remove(index);","    return indexLevels(summary.set('parts', parts));","}","","module.exports = removePart;",""],"l":{"1":1,"10":1,"11":0,"12":0,"15":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/editPartTitle.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/summary/editPartTitle.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"editPartTitle","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":49}}}},"statementMap":{"1":{"start":{"line":9,"column":0},"end":{"line":21,"column":1}},"2":{"start":{"line":10,"column":4},"end":{"line":10,"column":35}},"3":{"start":{"line":12,"column":4},"end":{"line":12,"column":32}},"4":{"start":{"line":13,"column":4},"end":{"line":15,"column":5}},"5":{"start":{"line":14,"column":8},"end":{"line":14,"column":23}},"6":{"start":{"line":17,"column":4},"end":{"line":17,"column":39}},"7":{"start":{"line":18,"column":4},"end":{"line":18,"column":35}},"8":{"start":{"line":20,"column":4},"end":{"line":20,"column":39}},"9":{"start":{"line":23,"column":0},"end":{"line":23,"column":31}}},"branchMap":{"1":{"line":13,"type":"if","locations":[{"start":{"line":13,"column":4},"end":{"line":13,"column":4}},{"start":{"line":13,"column":4},"end":{"line":13,"column":4}}]}},"code":["/**","    Edit title of a part in the summary","","    @param {Summary} summary","    @param {Number} index","    @param {String} newTitle","    @return {Summary}","*/","function editPartTitle(summary, index, newTitle) {","    var parts = summary.getParts();","","    var part = parts.get(index);","    if (!part) {","        return summary;","    }","","    part = part.set('title', newTitle);","    parts = parts.set(index, part);","","    return summary.set('parts', parts);","}","","module.exports = editPartTitle;",""],"l":{"9":1,"10":0,"12":0,"13":0,"14":0,"17":0,"18":0,"20":0,"23":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":10,"column":2}}},"branchMap":{},"code":["","module.exports = {","    addPlugin:       require('./addPlugin'),","    removePlugin:    require('./removePlugin'),","    togglePlugin:    require('./togglePlugin'),","    editPlugin:      require('./editPlugin'),","    hasPlugin:       require('./hasPlugin'),","    getPluginConfig: require('./getPluginConfig'),","    isDefaultPlugin: require('./isDefaultPlugin')","};",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/addPlugin.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/addPlugin.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"addPlugin","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":48}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":64}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":45}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":51}},"4":{"start":{"line":12,"column":0},"end":{"line":23,"column":1}},"5":{"start":{"line":14,"column":4},"end":{"line":16,"column":5}},"6":{"start":{"line":15,"column":8},"end":{"line":15,"column":54}},"7":{"start":{"line":18,"column":4},"end":{"line":18,"column":46}},"8":{"start":{"line":19,"column":4},"end":{"line":19,"column":59}},"9":{"start":{"line":21,"column":4},"end":{"line":21,"column":26}},"10":{"start":{"line":22,"column":4},"end":{"line":22,"column":46}},"11":{"start":{"line":25,"column":0},"end":{"line":25,"column":27}}},"branchMap":{"1":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":4},"end":{"line":14,"column":4}},{"start":{"line":14,"column":4},"end":{"line":14,"column":4}}]}},"code":["var PluginDependency = require('../../models/pluginDependency');","var togglePlugin = require('./togglePlugin');","var isDefaultPlugin = require('./isDefaultPlugin');","","/**"," * Add a plugin to a book's configuration"," * @param {Config} config"," * @param {String} pluginName"," * @param {String} version (optional)"," * @return {Config}"," */","function addPlugin(config, pluginName, version) {","    // For default plugin, we only ensure it is enabled","    if (isDefaultPlugin(pluginName, version)) {","        return togglePlugin(config, pluginName, true);","    }","","    var deps = config.getPluginDependencies();","    var dep = PluginDependency.create(pluginName, version);","","    deps = deps.push(dep);","    return config.setPluginDependencies(deps);","}","","module.exports = addPlugin;",""],"l":{"1":1,"2":1,"3":1,"12":1,"14":0,"15":0,"18":0,"19":0,"21":0,"22":0,"25":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/pluginDependency.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/pluginDependency.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":1,"10":0,"11":1,"12":0,"13":1,"14":0,"15":0,"16":0,"17":1,"18":0,"19":1,"20":0,"21":1,"22":6,"23":6,"24":6,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1,"53":6,"54":1},"b":{"1":[0,0],"2":[6,0],"3":[6,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":6,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":6},"fnMap":{"1":{"name":"(anonymous_1)","line":22,"loc":{"start":{"line":22,"column":37},"end":{"line":22,"column":48}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":40},"end":{"line":26,"column":51}}},"3":{"name":"(anonymous_3)","line":30,"loc":{"start":{"line":30,"column":39},"end":{"line":30,"column":50}}},"4":{"name":"(anonymous_4)","line":39,"loc":{"start":{"line":39,"column":36},"end":{"line":39,"column":52}}},"5":{"name":"(anonymous_5)","line":51,"loc":{"start":{"line":51,"column":38},"end":{"line":51,"column":49}}},"6":{"name":"(anonymous_6)","line":59,"loc":{"start":{"line":59,"column":45},"end":{"line":59,"column":56}}},"7":{"name":"(anonymous_7)","line":68,"loc":{"start":{"line":68,"column":26},"end":{"line":68,"column":59}}},"8":{"name":"(anonymous_8)","line":85,"loc":{"start":{"line":85,"column":36},"end":{"line":85,"column":48}}},"9":{"name":"(anonymous_9)","line":108,"loc":{"start":{"line":108,"column":34},"end":{"line":108,"column":46}}},"10":{"name":"(anonymous_10)","line":118,"loc":{"start":{"line":118,"column":33},"end":{"line":118,"column":47}}},"11":{"name":"(anonymous_11)","line":120,"loc":{"start":{"line":120,"column":13},"end":{"line":120,"column":29}}},"12":{"name":"(anonymous_12)","line":130,"loc":{"start":{"line":130,"column":16},"end":{"line":130,"column":30}}},"13":{"name":"(anonymous_13)","line":140,"loc":{"start":{"line":140,"column":31},"end":{"line":140,"column":46}}},"14":{"name":"(anonymous_14)","line":142,"loc":{"start":{"line":142,"column":13},"end":{"line":142,"column":27}}},"15":{"name":"(anonymous_15)","line":164,"loc":{"start":{"line":164,"column":31},"end":{"line":164,"column":43}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":31}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":50}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":26}},"6":{"start":{"line":12,"column":0},"end":{"line":20,"column":23}},"7":{"start":{"line":22,"column":0},"end":{"line":24,"column":2}},"8":{"start":{"line":23,"column":4},"end":{"line":23,"column":28}},"9":{"start":{"line":26,"column":0},"end":{"line":28,"column":2}},"10":{"start":{"line":27,"column":4},"end":{"line":27,"column":31}},"11":{"start":{"line":30,"column":0},"end":{"line":32,"column":2}},"12":{"start":{"line":31,"column":4},"end":{"line":31,"column":31}},"13":{"start":{"line":39,"column":0},"end":{"line":45,"column":2}},"14":{"start":{"line":40,"column":4},"end":{"line":42,"column":5}},"15":{"start":{"line":41,"column":8},"end":{"line":41,"column":34}},"16":{"start":{"line":44,"column":4},"end":{"line":44,"column":38}},"17":{"start":{"line":51,"column":0},"end":{"line":53,"column":2}},"18":{"start":{"line":52,"column":4},"end":{"line":52,"column":56}},"19":{"start":{"line":59,"column":0},"end":{"line":61,"column":2}},"20":{"start":{"line":60,"column":4},"end":{"line":60,"column":49}},"21":{"start":{"line":68,"column":0},"end":{"line":78,"column":2}},"22":{"start":{"line":69,"column":4},"end":{"line":71,"column":5}},"23":{"start":{"line":70,"column":8},"end":{"line":70,"column":23}},"24":{"start":{"line":73,"column":4},"end":{"line":77,"column":7}},"25":{"start":{"line":85,"column":0},"end":{"line":101,"column":2}},"26":{"start":{"line":86,"column":4},"end":{"line":86,"column":29}},"27":{"start":{"line":87,"column":4},"end":{"line":87,"column":24}},"28":{"start":{"line":88,"column":4},"end":{"line":88,"column":43}},"29":{"start":{"line":89,"column":4},"end":{"line":89,"column":23}},"30":{"start":{"line":91,"column":4},"end":{"line":94,"column":5}},"31":{"start":{"line":92,"column":8},"end":{"line":92,"column":24}},"32":{"start":{"line":93,"column":8},"end":{"line":93,"column":29}},"33":{"start":{"line":96,"column":4},"end":{"line":100,"column":7}},"34":{"start":{"line":108,"column":0},"end":{"line":111,"column":2}},"35":{"start":{"line":109,"column":4},"end":{"line":109,"column":29}},"36":{"start":{"line":110,"column":4},"end":{"line":110,"column":49}},"37":{"start":{"line":118,"column":0},"end":{"line":133,"column":2}},"38":{"start":{"line":119,"column":4},"end":{"line":132,"column":11}},"39":{"start":{"line":121,"column":12},"end":{"line":128,"column":13}},"40":{"start":{"line":122,"column":16},"end":{"line":122,"column":64}},"41":{"start":{"line":124,"column":16},"end":{"line":127,"column":19}},"42":{"start":{"line":131,"column":12},"end":{"line":131,"column":42}},"43":{"start":{"line":140,"column":0},"end":{"line":157,"column":2}},"44":{"start":{"line":141,"column":4},"end":{"line":156,"column":16}},"45":{"start":{"line":143,"column":12},"end":{"line":143,"column":28}},"46":{"start":{"line":145,"column":12},"end":{"line":147,"column":13}},"47":{"start":{"line":146,"column":16},"end":{"line":146,"column":30}},"48":{"start":{"line":149,"column":12},"end":{"line":149,"column":36}},"49":{"start":{"line":150,"column":12},"end":{"line":152,"column":13}},"50":{"start":{"line":151,"column":16},"end":{"line":151,"column":49}},"51":{"start":{"line":154,"column":12},"end":{"line":154,"column":26}},"52":{"start":{"line":164,"column":0},"end":{"line":166,"column":2}},"53":{"start":{"line":165,"column":4},"end":{"line":165,"column":22}},"54":{"start":{"line":168,"column":0},"end":{"line":168,"column":34}}},"branchMap":{"1":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":40,"column":4}},{"start":{"line":40,"column":4},"end":{"line":40,"column":4}}]},"2":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":4},"end":{"line":69,"column":4}},{"start":{"line":69,"column":4},"end":{"line":69,"column":4}}]},"3":{"line":75,"type":"binary-expr","locations":[{"start":{"line":75,"column":17},"end":{"line":75,"column":24}},{"start":{"line":75,"column":28},"end":{"line":75,"column":43}}]},"4":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":4},"end":{"line":91,"column":4}},{"start":{"line":91,"column":4},"end":{"line":91,"column":4}}]},"5":{"line":98,"type":"binary-expr","locations":[{"start":{"line":98,"column":17},"end":{"line":98,"column":24}},{"start":{"line":98,"column":28},"end":{"line":98,"column":43}}]},"6":{"line":121,"type":"if","locations":[{"start":{"line":121,"column":12},"end":{"line":121,"column":12}},{"start":{"line":121,"column":12},"end":{"line":121,"column":12}}]},"7":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":12},"end":{"line":145,"column":12}},{"start":{"line":145,"column":12},"end":{"line":145,"column":12}}]},"8":{"line":150,"type":"if","locations":[{"start":{"line":150,"column":12},"end":{"line":150,"column":12}},{"start":{"line":150,"column":12},"end":{"line":150,"column":12}}]}},"code":["var is = require('is');","var semver = require('semver');","var Immutable = require('immutable');","","var PREFIX = require('../constants/pluginPrefix');","var DEFAULT_VERSION = '*';","","/*"," * PluginDependency represents the informations about a plugin"," * stored in config.plugins"," */","var PluginDependency = Immutable.Record({","    name:       String(),","","    // Requirement version (ex: \">1.0.0\")","    version:    String(DEFAULT_VERSION),","","    // Is this plugin enabled or disabled?","    enabled:    Boolean(true)","}, 'PluginDependency');","","PluginDependency.prototype.getName = function() {","    return this.get('name');","};","","PluginDependency.prototype.getVersion = function() {","    return this.get('version');","};","","PluginDependency.prototype.isEnabled = function() {","    return this.get('enabled');","};","","/**"," * Toggle this plugin state"," * @param  {Boolean}"," * @return {PluginDependency}"," */","PluginDependency.prototype.toggle = function(state) {","    if (is.undef(state)) {","        state = !this.isEnabled();","    }","","    return this.set('enabled', state);","};","","/**"," * Return NPM ID for the dependency"," * @return {String}"," */","PluginDependency.prototype.getNpmID = function() {","    return PluginDependency.nameToNpmID(this.getName());","};","","/**"," * Is the plugin using a git dependency"," * @return {Boolean}"," */","PluginDependency.prototype.isGitDependency = function() {","    return !semver.validRange(this.getVersion());","};","","/**"," * Create a plugin with a name and a plugin"," * @param {String}"," * @return {Plugin|undefined}"," */","PluginDependency.create = function(name, version, enabled) {","    if (is.undefined(enabled)) {","        enabled = true;","    }","","    return new PluginDependency({","        name: name,","        version: version || DEFAULT_VERSION,","        enabled: Boolean(enabled)","    });","};","","/**"," * Create a plugin from a string"," * @param {String}"," * @return {Plugin|undefined}"," */","PluginDependency.createFromString = function(s) {","    var parts = s.split('@');","    var name = parts[0];","    var version = parts.slice(1).join('@');","    var enabled = true;","","    if (name[0] === '-') {","        enabled = false;","        name = name.slice(1);","    }","","    return new PluginDependency({","        name: name,","        version: version || DEFAULT_VERSION,","        enabled: enabled","    });","};","","/**"," * Create a PluginDependency from a string"," * @param {String}"," * @return {List<PluginDependency>}"," */","PluginDependency.listFromString = function(s) {","    var parts = s.split(',');","    return PluginDependency.listFromArray(parts);","};","","/**"," * Create a PluginDependency from an array"," * @param {Array}"," * @return {List<PluginDependency>}"," */","PluginDependency.listFromArray = function(arr) {","    return Immutable.List(arr)","        .map(function(entry) {","            if (is.string(entry)) {","                return PluginDependency.createFromString(entry);","            } else {","                return PluginDependency({","                    name: entry.get('name'),","                    version: entry.get('version')","                });","            }","        })","        .filter(function(dep) {","            return Boolean(dep.getName());","        });","};","","/**"," * Export plugin dependencies as an array"," * @param {List<PluginDependency>} list"," * @return {Array<String>}"," */","PluginDependency.listToArray = function(list) {","    return list","        .map(function(dep) {","            var result = '';","","            if (!dep.isEnabled()) {","                result += '-';","            }","","            result += dep.getName();","            if (dep.getVersion() !== DEFAULT_VERSION) {","                result += '@' + dep.getVersion();","            }","","            return result;","        })","        .toJS();","};","","/**"," * Return NPM id for a plugin name"," * @param {String}"," * @return {String}"," */","PluginDependency.nameToNpmID = function(s) {","    return PREFIX + s;","};","","module.exports = PluginDependency;",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"12":1,"22":1,"23":0,"26":1,"27":0,"30":1,"31":0,"39":1,"40":0,"41":0,"44":0,"51":1,"52":0,"59":1,"60":0,"68":1,"69":6,"70":6,"73":6,"85":1,"86":0,"87":0,"88":0,"89":0,"91":0,"92":0,"93":0,"96":0,"108":1,"109":0,"110":0,"118":1,"119":0,"121":0,"122":0,"124":0,"131":0,"140":1,"141":0,"143":0,"145":0,"146":0,"149":0,"150":0,"151":0,"154":0,"164":1,"165":6,"168":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/pluginPrefix.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/pluginPrefix.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":35}}},"branchMap":{},"code":["","/*","    All GitBook plugins are NPM packages starting with this prefix.","*/","module.exports = 'gitbook-plugin-';",""],"l":{"5":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/togglePlugin.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/togglePlugin.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"togglePlugin","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":49}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":20},"end":{"line":20,"column":34}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":64}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":39}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":51}},"4":{"start":{"line":12,"column":0},"end":{"line":29,"column":1}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":46}},"6":{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},"7":{"start":{"line":17,"column":8},"end":{"line":17,"column":62}},"8":{"start":{"line":20,"column":4},"end":{"line":26,"column":7}},"9":{"start":{"line":21,"column":8},"end":{"line":23,"column":9}},"10":{"start":{"line":22,"column":12},"end":{"line":22,"column":37}},"11":{"start":{"line":25,"column":8},"end":{"line":25,"column":19}},"12":{"start":{"line":28,"column":4},"end":{"line":28,"column":46}},"13":{"start":{"line":31,"column":0},"end":{"line":31,"column":30}}},"branchMap":{"1":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":4},"end":{"line":16,"column":4}},{"start":{"line":16,"column":4},"end":{"line":16,"column":4}}]},"2":{"line":16,"type":"binary-expr","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":35}},{"start":{"line":16,"column":39},"end":{"line":16,"column":67}}]},"3":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":21,"column":8}},{"start":{"line":21,"column":8},"end":{"line":21,"column":8}}]}},"code":["var PluginDependency = require('../../models/pluginDependency');","var hasPlugin = require('./hasPlugin');","var isDefaultPlugin = require('./isDefaultPlugin');","","/**"," * Enable/disable a plugin dependency"," * @param {Config} config"," * @param {String} pluginName"," * @param {Boolean} state (optional)"," * @return {Config}"," */","function togglePlugin(config, pluginName, state) {","    var deps = config.getPluginDependencies();","","    // For default plugin, we should ensure it's listed first","    if (isDefaultPlugin(pluginName) && !hasPlugin(deps, pluginName)) {","        deps = deps.push(PluginDependency.create(pluginName));","    }","","    deps = deps.map(function(dep) {","        if (dep.getName() === pluginName) {","            return dep.toggle(state);","        }","","        return dep;","    });","","    return config.setPluginDependencies(deps);","}","","module.exports = togglePlugin;",""],"l":{"1":1,"2":1,"3":1,"12":1,"13":0,"16":0,"17":0,"20":0,"21":0,"22":0,"25":0,"28":0,"31":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/hasPlugin.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/hasPlugin.js","s":{"1":1,"2":0,"3":0,"4":1},"b":{"1":[0,0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"hasPlugin","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":46}}},"2":{"name":"(anonymous_2)","line":10,"loc":{"start":{"line":10,"column":23},"end":{"line":10,"column":37}}}},"statementMap":{"1":{"start":{"line":9,"column":0},"end":{"line":13,"column":1}},"2":{"start":{"line":10,"column":4},"end":{"line":12,"column":7}},"3":{"start":{"line":11,"column":8},"end":{"line":11,"column":90}},"4":{"start":{"line":15,"column":0},"end":{"line":15,"column":27}}},"branchMap":{"1":{"line":11,"type":"binary-expr","locations":[{"start":{"line":11,"column":15},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":11,"column":56}},{"start":{"line":11,"column":60},"end":{"line":11,"column":88}}]}},"code":["","/**"," * Test if a plugin is listed"," * @param { {List<PluginDependency}} deps"," * @param {String} plugin"," * @param {String} version"," * @return {Boolean}"," */","function hasPlugin(deps, pluginName, version) {","    return !!deps.find(function(dep) {","        return dep.getName() === pluginName && (!version || dep.getVersion() === version);","    });","}","","module.exports = hasPlugin;",""],"l":{"9":1,"10":0,"11":0,"15":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/isDefaultPlugin.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/isDefaultPlugin.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"isDefaultPlugin","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":46}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":64}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":39}},"3":{"start":{"line":10,"column":0},"end":{"line":12,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":59}},"5":{"start":{"line":14,"column":0},"end":{"line":14,"column":33}}},"branchMap":{},"code":["var DEFAULT_PLUGINS = require('../../constants/defaultPlugins');","var hasPlugin = require('./hasPlugin');","","/**"," * Test if a plugin is a default one"," * @param {String} plugin"," * @param {String} version"," * @return {Boolean}"," */","function isDefaultPlugin(pluginName, version) {","    return hasPlugin(DEFAULT_PLUGINS, pluginName, version);","}","","module.exports = isDefaultPlugin;",""],"l":{"1":1,"2":1,"10":1,"11":0,"14":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/defaultPlugins.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/defaultPlugins.js","s":{"1":1,"2":1,"3":1,"4":1,"5":6,"6":6,"7":6,"8":1},"b":{},"f":{"1":6},"fnMap":{"1":{"name":"createFromDependency","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":42}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":61}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":40}},"4":{"start":{"line":11,"column":0},"end":{"line":16,"column":1}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":57}},"6":{"start":{"line":13,"column":4},"end":{"line":13,"column":42}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":56}},"8":{"start":{"line":22,"column":0},"end":{"line":29,"column":29}}},"branchMap":{},"code":["var Immutable = require('immutable');","var PluginDependency = require('../models/pluginDependency');","","var pkg = require('../../package.json');","","/**"," * Create a PluginDependency from a dependency of gitbook"," * @param {String} pluginName"," * @return {PluginDependency}"," */","function createFromDependency(pluginName) {","    var npmID = PluginDependency.nameToNpmID(pluginName);","    var version = pkg.dependencies[npmID];","","    return PluginDependency.create(pluginName, version);","}","","/*"," * List of default plugins for all books,"," * default plugins should be installed in node dependencies of GitBook"," */","module.exports = Immutable.List([","    'highlight',","    'search',","    'lunr',","    'sharing',","    'fontsettings',","    'theme-default'","]).map(createFromDependency);",""],"l":{"1":1,"2":1,"4":1,"11":1,"12":6,"13":6,"15":6,"22":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/removePlugin.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/removePlugin.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"removePlugin","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":42}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":26},"end":{"line":19,"column":40}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":45}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":51}},"3":{"start":{"line":10,"column":0},"end":{"line":23,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":46}},"5":{"start":{"line":14,"column":4},"end":{"line":16,"column":5}},"6":{"start":{"line":15,"column":8},"end":{"line":15,"column":55}},"7":{"start":{"line":19,"column":4},"end":{"line":21,"column":7}},"8":{"start":{"line":20,"column":8},"end":{"line":20,"column":44}},"9":{"start":{"line":22,"column":4},"end":{"line":22,"column":46}},"10":{"start":{"line":25,"column":0},"end":{"line":25,"column":30}}},"branchMap":{"1":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":4},"end":{"line":14,"column":4}},{"start":{"line":14,"column":4},"end":{"line":14,"column":4}}]}},"code":["var togglePlugin = require('./togglePlugin');","var isDefaultPlugin = require('./isDefaultPlugin');","","/**"," * Remove a plugin from a book's configuration"," * @param {Config} config"," * @param {String} plugin"," * @return {Config}"," */","function removePlugin(config, pluginName) {","    var deps = config.getPluginDependencies();","","    // For default plugin, we have to disable it instead of removing from the list","    if (isDefaultPlugin(pluginName)) {","        return togglePlugin(config, pluginName, false);","    }","","    // Remove the dependency from the list","    deps = deps.filterNot(function(dep) {","        return dep.getName() === pluginName;","    });","    return config.setPluginDependencies(deps);","}","","module.exports = removePlugin;",""],"l":{"1":1,"2":1,"10":1,"11":0,"14":0,"15":0,"19":0,"20":0,"22":0,"25":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/editPlugin.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/editPlugin.js","s":{"1":1,"2":0,"3":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"editPlugin","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":54}}}},"statementMap":{"1":{"start":{"line":9,"column":0},"end":{"line":11,"column":1}},"2":{"start":{"line":10,"column":4},"end":{"line":10,"column":70}},"3":{"start":{"line":13,"column":0},"end":{"line":13,"column":28}}},"branchMap":{},"code":["","/**"," * Edit configuration of a plugin"," * @param {Config} config"," * @param {String} plugin"," * @param {Object} pluginConfig"," * @return {Config}"," */","function editPlugin(config, pluginName, pluginConfig) {","    return config.setValue('pluginsConfig.'+pluginName, pluginConfig);","}","","module.exports = editPlugin;",""],"l":{"9":1,"10":0,"13":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/getPluginConfig.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/modifiers/config/getPluginConfig.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"getPluginConfig","line":7,"loc":{"start":{"line":7,"column":0},"end":{"line":7,"column":45}}}},"statementMap":{"1":{"start":{"line":7,"column":0},"end":{"line":18,"column":1}},"2":{"start":{"line":8,"column":4},"end":{"line":8,"column":64}},"3":{"start":{"line":9,"column":4},"end":{"line":11,"column":5}},"4":{"start":{"line":10,"column":8},"end":{"line":10,"column":18}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":51}},"6":{"start":{"line":13,"column":4},"end":{"line":17,"column":5}},"7":{"start":{"line":14,"column":8},"end":{"line":14,"column":18}},"8":{"start":{"line":16,"column":8},"end":{"line":16,"column":33}},"9":{"start":{"line":20,"column":0},"end":{"line":20,"column":33}}},"branchMap":{"1":{"line":9,"type":"if","locations":[{"start":{"line":9,"column":4},"end":{"line":9,"column":4}},{"start":{"line":9,"column":4},"end":{"line":9,"column":4}}]},"2":{"line":13,"type":"if","locations":[{"start":{"line":13,"column":4},"end":{"line":13,"column":4}},{"start":{"line":13,"column":4},"end":{"line":13,"column":4}}]}},"code":["/**"," * Return the configuration for a plugin"," * @param {Config} config"," * @param {String} pluginName"," * @return {Object}"," */","function getPluginConfig(config, pluginName) {","    var pluginsConfig = config.getValues().get('pluginsConfig');","    if (pluginsConfig === undefined) {","        return {};","    }","    var pluginConf = pluginsConfig.get(pluginName);","    if (pluginConf === undefined) {","        return {};","    } else {","        return pluginConf.toJS();","    }","}","","module.exports = getPluginConfig;",""],"l":{"7":1,"8":0,"9":0,"10":0,"12":0,"13":0,"14":0,"16":0,"20":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":15,"column":2}}},"branchMap":{},"code":["","module.exports = {","    parseBook:           require('./parseBook'),","    parseSummary:        require('./parseSummary'),","    parseGlossary:       require('./parseGlossary'),","    parseReadme:         require('./parseReadme'),","    parseConfig:         require('./parseConfig'),","    parsePagesList:      require('./parsePagesList'),","    parseIgnore:         require('./parseIgnore'),","    listAssets:          require('./listAssets'),","    parseLanguages:      require('./parseLanguages'),","    parsePage:           require('./parsePage'),","    parsePageFromString: require('./parsePageFromString'),","    lookupStructureFile: require('./lookupStructureFile')","};",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseBook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseBook.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"parseBookContent","line":18,"loc":{"start":{"line":18,"column":0},"end":{"line":18,"column":32}}},"2":{"name":"parseMultilingualBook","line":31,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":37}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":36},"end":{"line":35,"column":64}}},"4":{"name":"(anonymous_4)","line":43,"loc":{"start":{"line":43,"column":14},"end":{"line":43,"column":31}}},"5":{"name":"parseBook","line":60,"loc":{"start":{"line":60,"column":0},"end":{"line":60,"column":25}}},"6":{"name":"(anonymous_6)","line":67,"loc":{"start":{"line":67,"column":14},"end":{"line":67,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":40}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":43}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":43}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":47}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":45}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":43}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":49}},"10":{"start":{"line":18,"column":0},"end":{"line":23,"column":1}},"11":{"start":{"line":19,"column":4},"end":{"line":22,"column":29}},"12":{"start":{"line":31,"column":0},"end":{"line":51,"column":1}},"13":{"start":{"line":32,"column":4},"end":{"line":32,"column":40}},"14":{"start":{"line":33,"column":4},"end":{"line":33,"column":39}},"15":{"start":{"line":35,"column":4},"end":{"line":50,"column":13}},"16":{"start":{"line":36,"column":8},"end":{"line":36,"column":34}},"17":{"start":{"line":37,"column":8},"end":{"line":37,"column":63}},"18":{"start":{"line":38,"column":8},"end":{"line":38,"column":45}},"19":{"start":{"line":40,"column":8},"end":{"line":49,"column":11}},"20":{"start":{"line":45,"column":12},"end":{"line":45,"column":48}},"21":{"start":{"line":46,"column":12},"end":{"line":46,"column":60}},"22":{"start":{"line":48,"column":12},"end":{"line":48,"column":63}},"23":{"start":{"line":60,"column":0},"end":{"line":75,"column":1}},"24":{"start":{"line":61,"column":4},"end":{"line":74,"column":6}},"25":{"start":{"line":68,"column":12},"end":{"line":72,"column":13}},"26":{"start":{"line":69,"column":16},"end":{"line":69,"column":57}},"27":{"start":{"line":71,"column":16},"end":{"line":71,"column":52}},"28":{"start":{"line":77,"column":0},"end":{"line":77,"column":27}}},"branchMap":{"1":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":12},"end":{"line":68,"column":12}},{"start":{"line":68,"column":12},"end":{"line":68,"column":12}}]}},"code":["var Promise = require('../utils/promise');","var timing = require('../utils/timing');","var Book = require('../models/book');","","var parseIgnore = require('./parseIgnore');","var parseConfig = require('./parseConfig');","var parseGlossary = require('./parseGlossary');","var parseSummary = require('./parseSummary');","var parseReadme = require('./parseReadme');","var parseLanguages = require('./parseLanguages');","","/**","    Parse content of a book","","    @param {Book} book","    @return {Promise<Book>}","*/","function parseBookContent(book) {","    return Promise(book)","        .then(parseReadme)","        .then(parseSummary)","        .then(parseGlossary);","}","","/**","    Parse a multilingual book","","    @param {Book} book","    @return {Promise<Book>}","*/","function parseMultilingualBook(book) {","    var languages = book.getLanguages();","    var langList = languages.getList();","","    return Promise.reduce(langList, function(currentBook, lang) {","        var langID = lang.getID();","        var child = Book.createFromParent(currentBook, langID);","        var ignore = currentBook.getIgnore();","","        return Promise(child)","        .then(parseConfig)","        .then(parseBookContent)","        .then(function(result) {","            // Ignore content of this book when generating parent book","            ignore = ignore.add(langID + '/**');","            currentBook = currentBook.set('ignore', ignore);","","            return currentBook.addLanguageBook(langID, result);","        });","    }, book);","}","","","/**","    Parse a whole book from a filesystem","","    @param {Book} book","    @return {Promise<Book>}","*/","function parseBook(book) {","    return timing.measure(","        'parse.book',","        Promise(book)","        .then(parseIgnore)","        .then(parseConfig)","        .then(parseLanguages)","        .then(function(resultBook) {","            if (resultBook.isMultilingual()) {","                return parseMultilingualBook(resultBook);","            } else {","                return parseBookContent(resultBook);","            }","        })","    );","}","","module.exports = parseBook;",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"18":1,"19":0,"31":1,"32":0,"33":0,"35":0,"36":0,"37":0,"38":0,"40":0,"45":0,"46":0,"48":0,"60":1,"61":0,"68":0,"69":0,"71":0,"77":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/promise.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/promise.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":1,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1},"b":{"1":[1,0],"2":[1,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"fnMap":{"1":{"name":"reduce","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":33}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":22},"end":{"line":19,"column":48}}},"3":{"name":"(anonymous_3)","line":21,"loc":{"start":{"line":21,"column":14},"end":{"line":21,"column":28}}},"4":{"name":"forEach","line":34,"loc":{"start":{"line":34,"column":0},"end":{"line":34,"column":28}}},"5":{"name":"(anonymous_5)","line":35,"loc":{"start":{"line":35,"column":23},"end":{"line":35,"column":46}}},"6":{"name":"serie","line":47,"loc":{"start":{"line":47,"column":0},"end":{"line":47,"column":32}}},"7":{"name":"(anonymous_7)","line":48,"loc":{"start":{"line":48,"column":23},"end":{"line":48,"column":51}}},"8":{"name":"(anonymous_8)","line":50,"loc":{"start":{"line":50,"column":14},"end":{"line":50,"column":26}}},"9":{"name":"some","line":64,"loc":{"start":{"line":64,"column":0},"end":{"line":64,"column":25}}},"10":{"name":"(anonymous_10)","line":67,"loc":{"start":{"line":67,"column":22},"end":{"line":67,"column":46}}},"11":{"name":"(anonymous_11)","line":68,"loc":{"start":{"line":68,"column":25},"end":{"line":68,"column":39}}},"12":{"name":"mapAsList","line":83,"loc":{"start":{"line":83,"column":0},"end":{"line":83,"column":30}}},"13":{"name":"(anonymous_13)","line":84,"loc":{"start":{"line":84,"column":23},"end":{"line":84,"column":48}}},"14":{"name":"(anonymous_14)","line":86,"loc":{"start":{"line":86,"column":14},"end":{"line":86,"column":28}}},"15":{"name":"map","line":100,"loc":{"start":{"line":100,"column":0},"end":{"line":100,"column":24}}},"16":{"name":"(anonymous_16)","line":107,"loc":{"start":{"line":107,"column":30},"end":{"line":107,"column":51}}},"17":{"name":"(anonymous_17)","line":109,"loc":{"start":{"line":109,"column":18},"end":{"line":109,"column":35}}},"18":{"name":"(anonymous_18)","line":113,"loc":{"start":{"line":113,"column":14},"end":{"line":113,"column":31}}},"19":{"name":"(anonymous_19)","line":118,"loc":{"start":{"line":118,"column":14},"end":{"line":118,"column":31}}},"20":{"name":"wrap","line":131,"loc":{"start":{"line":131,"column":0},"end":{"line":131,"column":20}}},"21":{"name":"(anonymous_21)","line":132,"loc":{"start":{"line":132,"column":11},"end":{"line":132,"column":22}}},"22":{"name":"(anonymous_22)","line":136,"loc":{"start":{"line":136,"column":14},"end":{"line":136,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":21}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":5,"column":0},"end":{"line":7,"column":1}},"4":{"start":{"line":6,"column":4},"end":{"line":6,"column":30}},"5":{"start":{"line":16,"column":0},"end":{"line":25,"column":1}},"6":{"start":{"line":17,"column":4},"end":{"line":17,"column":72}},"7":{"start":{"line":19,"column":4},"end":{"line":24,"column":16}},"8":{"start":{"line":20,"column":8},"end":{"line":23,"column":11}},"9":{"start":{"line":22,"column":12},"end":{"line":22,"column":40}},"10":{"start":{"line":34,"column":0},"end":{"line":38,"column":1}},"11":{"start":{"line":35,"column":4},"end":{"line":37,"column":7}},"12":{"start":{"line":36,"column":8},"end":{"line":36,"column":29}},"13":{"start":{"line":47,"column":0},"end":{"line":55,"column":1}},"14":{"start":{"line":48,"column":4},"end":{"line":54,"column":11}},"15":{"start":{"line":49,"column":8},"end":{"line":53,"column":11}},"16":{"start":{"line":51,"column":12},"end":{"line":51,"column":27}},"17":{"start":{"line":52,"column":12},"end":{"line":52,"column":26}},"18":{"start":{"line":64,"column":0},"end":{"line":74,"column":1}},"19":{"start":{"line":65,"column":4},"end":{"line":65,"column":30}},"20":{"start":{"line":67,"column":4},"end":{"line":73,"column":12}},"21":{"start":{"line":68,"column":8},"end":{"line":72,"column":11}},"22":{"start":{"line":69,"column":12},"end":{"line":69,"column":32}},"23":{"start":{"line":69,"column":21},"end":{"line":69,"column":32}},"24":{"start":{"line":71,"column":12},"end":{"line":71,"column":33}},"25":{"start":{"line":83,"column":0},"end":{"line":91,"column":1}},"26":{"start":{"line":84,"column":4},"end":{"line":90,"column":11}},"27":{"start":{"line":85,"column":8},"end":{"line":89,"column":11}},"28":{"start":{"line":87,"column":12},"end":{"line":87,"column":27}},"29":{"start":{"line":88,"column":12},"end":{"line":88,"column":24}},"30":{"start":{"line":100,"column":0},"end":{"line":122,"column":1}},"31":{"start":{"line":101,"column":4},"end":{"line":121,"column":5}},"32":{"start":{"line":102,"column":8},"end":{"line":102,"column":25}},"33":{"start":{"line":103,"column":8},"end":{"line":105,"column":9}},"34":{"start":{"line":104,"column":12},"end":{"line":104,"column":32}},"35":{"start":{"line":107,"column":8},"end":{"line":115,"column":11}},"36":{"start":{"line":108,"column":12},"end":{"line":111,"column":15}},"37":{"start":{"line":110,"column":16},"end":{"line":110,"column":37}},"38":{"start":{"line":114,"column":12},"end":{"line":114,"column":43}},"39":{"start":{"line":117,"column":8},"end":{"line":120,"column":11}},"40":{"start":{"line":119,"column":12},"end":{"line":119,"column":42}},"41":{"start":{"line":131,"column":0},"end":{"line":140,"column":1}},"42":{"start":{"line":132,"column":4},"end":{"line":139,"column":6}},"43":{"start":{"line":133,"column":8},"end":{"line":133,"column":60}},"44":{"start":{"line":135,"column":8},"end":{"line":138,"column":11}},"45":{"start":{"line":137,"column":12},"end":{"line":137,"column":42}},"46":{"start":{"line":142,"column":0},"end":{"line":142,"column":19}},"47":{"start":{"line":143,"column":0},"end":{"line":143,"column":33}},"48":{"start":{"line":144,"column":0},"end":{"line":144,"column":31}},"49":{"start":{"line":145,"column":0},"end":{"line":145,"column":25}},"50":{"start":{"line":146,"column":0},"end":{"line":146,"column":29}},"51":{"start":{"line":147,"column":0},"end":{"line":147,"column":27}},"52":{"start":{"line":148,"column":0},"end":{"line":148,"column":29}}},"branchMap":{"1":{"line":5,"type":"if","locations":[{"start":{"line":5,"column":0},"end":{"line":5,"column":0}},{"start":{"line":5,"column":0},"end":{"line":5,"column":0}}]},"2":{"line":5,"type":"binary-expr","locations":[{"start":{"line":5,"column":4},"end":{"line":5,"column":21}},{"start":{"line":5,"column":25},"end":{"line":5,"column":39}}]},"3":{"line":17,"type":"cond-expr","locations":[{"start":{"line":17,"column":46},"end":{"line":17,"column":49}},{"start":{"line":17,"column":52},"end":{"line":17,"column":71}}]},"4":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":12},"end":{"line":69,"column":12}},{"start":{"line":69,"column":12},"end":{"line":69,"column":12}}]},"5":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":4},"end":{"line":101,"column":4}},{"start":{"line":101,"column":4},"end":{"line":101,"column":4}}]},"6":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":8},"end":{"line":103,"column":8}},{"start":{"line":103,"column":8},"end":{"line":103,"column":8}}]}},"code":["var Q = require('q');","var Immutable = require('immutable');","","// Debugging for long stack traces","if (process.env.DEBUG || process.env.CI) {","    Q.longStackSupport = true;","}","","/**"," * Reduce an array to a promise"," *"," * @param {Array|List} arr"," * @param {Function(value, element, index)}"," * @return {Promise<Mixed>}"," */","function reduce(arr, iter, base) {","    arr = Immutable.Iterable.isIterable(arr)? arr : Immutable.List(arr);","","    return arr.reduce(function(prev, elem, key) {","        return prev","        .then(function(val) {","            return iter(val, elem, key);","        });","    }, Q(base));","}","","/**"," * Iterate over an array using an async iter"," *"," * @param {Array|List} arr"," * @param {Function(value, element, index)}"," * @return {Promise}"," */","function forEach(arr, iter) {","    return reduce(arr, function(val, el, key) {","        return iter(el, key);","    });","}","","/**"," * Transform an array"," *"," * @param {Array|List} arr"," * @param {Function(value, element, index)}"," * @return {Promise}"," */","function serie(arr, iter, base) {","    return reduce(arr, function(before, item, key) {","        return Q(iter(item, key))","        .then(function(r) {","            before.push(r);","            return before;","        });","    }, []);","}","","/**"," * Iter over an array and return first result (not null)"," *"," * @param {Array|List} arr"," * @param {Function(element, index)}"," * @return {Promise<Mixed>}"," */","function some(arr, iter) {","    arr = Immutable.List(arr);","","    return arr.reduce(function(prev, elem, i) {","        return prev.then(function(val) {","            if (val) return val;","","            return iter(elem, i);","        });","    }, Q());","}","","/**"," * Map an array using an async (promised) iterator"," *"," * @param {Array|List} arr"," * @param {Function(element, index)}"," * @return {Promise<List>}"," */","function mapAsList(arr, iter) {","    return reduce(arr, function(prev, entry, i) {","        return Q(iter(entry, i))","        .then(function(out) {","            prev.push(out);","            return prev;","        });","    }, []);","}","","/**"," * Map an array or map"," *"," * @param {Array|List|Map|OrderedMap} arr"," * @param {Function(element, key)}"," * @return {Promise<List|Map|OrderedMap>}"," */","function map(arr, iter) {","    if (Immutable.Map.isMap(arr)) {","        var type = 'Map';","        if (Immutable.OrderedMap.isOrderedMap(arr)) {","            type = 'OrderedMap';","        }","","        return mapAsList(arr, function(value, key) {","            return Q(iter(value, key))","            .then(function(result) {","                return [key, result];","            });","        })","        .then(function(result) {","            return Immutable[type](result);","        });","    } else {","        return mapAsList(arr, iter)","        .then(function(result) {","            return Immutable.List(result);","        });","    }","}","","","/**"," * Wrap a function in a promise"," *"," * @param {Function} func"," * @return {Funciton}"," */","function wrap(func) {","    return function() {","        var args = Array.prototype.slice.call(arguments, 0);","","        return Q()","        .then(function() {","            return func.apply(null, args);","        });","    };","}","","module.exports = Q;","module.exports.forEach = forEach;","module.exports.reduce = reduce;","module.exports.map = map;","module.exports.serie = serie;","module.exports.some = some;","module.exports.wrapfn = wrap;",""],"l":{"1":1,"2":1,"5":1,"6":1,"16":1,"17":0,"19":0,"20":0,"22":0,"34":1,"35":0,"36":0,"47":1,"48":0,"49":0,"51":0,"52":0,"64":1,"65":0,"67":0,"68":0,"69":0,"71":0,"83":1,"84":0,"85":0,"87":0,"88":0,"100":1,"101":0,"102":0,"103":0,"104":0,"107":0,"108":0,"110":0,"114":0,"117":0,"119":0,"131":1,"132":0,"133":0,"135":0,"137":0,"142":1,"143":1,"144":1,"145":1,"146":1,"147":1,"148":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/timing.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/timing.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"measure","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":26}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":9},"end":{"line":26,"column":20}}},"3":{"name":"time","line":49,"loc":{"start":{"line":49,"column":0},"end":{"line":49,"column":18}}},"4":{"name":"dump","line":62,"loc":{"start":{"line":62,"column":0},"end":{"line":62,"column":22}}},"5":{"name":"(anonymous_5)","line":73,"loc":{"start":{"line":73,"column":16},"end":{"line":73,"column":32}}},"6":{"name":"(anonymous_6)","line":77,"loc":{"start":{"line":77,"column":17},"end":{"line":77,"column":33}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":23}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":16}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":27}},"5":{"start":{"line":14,"column":0},"end":{"line":41,"column":1}},"6":{"start":{"line":15,"column":4},"end":{"line":21,"column":6}},"7":{"start":{"line":23,"column":4},"end":{"line":23,"column":27}},"8":{"start":{"line":25,"column":4},"end":{"line":40,"column":7}},"9":{"start":{"line":27,"column":8},"end":{"line":27,"column":29}},"10":{"start":{"line":28,"column":8},"end":{"line":28,"column":37}},"11":{"start":{"line":30,"column":8},"end":{"line":30,"column":30}},"12":{"start":{"line":31,"column":8},"end":{"line":31,"column":39}},"13":{"start":{"line":33,"column":8},"end":{"line":37,"column":9}},"14":{"start":{"line":34,"column":12},"end":{"line":34,"column":40}},"15":{"start":{"line":36,"column":12},"end":{"line":36,"column":68}},"16":{"start":{"line":39,"column":8},"end":{"line":39,"column":64}},"17":{"start":{"line":49,"column":0},"end":{"line":55,"column":1}},"18":{"start":{"line":50,"column":4},"end":{"line":52,"column":5}},"19":{"start":{"line":51,"column":8},"end":{"line":51,"column":38}},"20":{"start":{"line":54,"column":4},"end":{"line":54,"column":38}},"21":{"start":{"line":62,"column":0},"end":{"line":92,"column":1}},"22":{"start":{"line":63,"column":4},"end":{"line":63,"column":26}},"23":{"start":{"line":64,"column":4},"end":{"line":64,"column":21}},"24":{"start":{"line":65,"column":4},"end":{"line":65,"column":47}},"25":{"start":{"line":68,"column":4},"end":{"line":68,"column":37}},"26":{"start":{"line":69,"column":4},"end":{"line":69,"column":29}},"27":{"start":{"line":71,"column":4},"end":{"line":85,"column":11}},"28":{"start":{"line":74,"column":12},"end":{"line":74,"column":36}},"29":{"start":{"line":75,"column":12},"end":{"line":75,"column":31}},"30":{"start":{"line":78,"column":12},"end":{"line":78,"column":62}},"31":{"start":{"line":81,"column":12},"end":{"line":81,"column":124}},"32":{"start":{"line":82,"column":12},"end":{"line":82,"column":118}},"33":{"start":{"line":83,"column":12},"end":{"line":83,"column":95}},"34":{"start":{"line":84,"column":12},"end":{"line":84,"column":59}},"35":{"start":{"line":88,"column":4},"end":{"line":88,"column":87}},"36":{"start":{"line":91,"column":4},"end":{"line":91,"column":30}},"37":{"start":{"line":94,"column":0},"end":{"line":97,"column":2}}},"branchMap":{"1":{"line":15,"type":"binary-expr","locations":[{"start":{"line":15,"column":19},"end":{"line":15,"column":31}},{"start":{"line":15,"column":35},"end":{"line":21,"column":5}}]},"2":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":33,"column":8}},{"start":{"line":33,"column":8},"end":{"line":33,"column":8}}]},"3":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":4},"end":{"line":50,"column":4}},{"start":{"line":50,"column":4},"end":{"line":50,"column":4}}]}},"code":["var Immutable = require('immutable');","var is = require('is');","","var timers = {};","var startDate = Date.now();","","/**","    Mesure an operation","","    @parqm {String} type","    @param {Promise} p","    @return {Promise}","*/","function measure(type, p) {","    timers[type] = timers[type] || {","        type: type,","        count: 0,","        total: 0,","        min: undefined,","        max: 0","    };","","    var start = Date.now();","","    return p","    .fin(function() {","        var end = Date.now();","        var duration = (end - start);","","        timers[type].count ++;","        timers[type].total += duration;","","        if (is.undefined(timers[type].min)) {","            timers[type].min = duration;","        } else {","            timers[type].min = Math.min(timers[type].min, duration);","        }","","        timers[type].max = Math.max(timers[type].max, duration);","    });","}","","/**","    Return a milliseconds number as a second string","","    @param {Number} ms","    @return {String}","*/","function time(ms) {","    if (ms < 1000) {","        return (ms.toFixed(0)) + 'ms';","    }","","    return (ms/1000).toFixed(2) + 's';","}","","/**","    Dump all timers to a logger","","    @param {Logger} logger","*/","function dump(logger) {","    var prefix = '    > ';","    var measured = 0;","    var totalDuration = Date.now() - startDate;","","    // Enable debug logging","    var logLevel = logger.getLevel();","    logger.setLevel('debug');","","    Immutable.Map(timers)","        .valueSeq()","        .sortBy(function(timer) {","            measured += timer.total;","            return timer.total;","        })","        .forEach(function(timer) {","            var percent = (timer.total * 100) / totalDuration;","","","            logger.debug.ln((percent.toFixed(1)) + '% of time spent in \"' + timer.type + '\" (' + timer.count + ' times) :');","            logger.debug.ln(prefix + 'Total: ' + time(timer.total)+ ' | Average: ' + time(timer.total / timer.count));","            logger.debug.ln(prefix + 'Min: ' + time(timer.min) + ' | Max: ' + time(timer.max));","            logger.debug.ln('---------------------------');","        });","","","    logger.debug.ln(time(totalDuration - measured) + ' spent in non-mesured sections');","","    // Rollback to previous level","    logger.setLevel(logLevel);","}","","module.exports = {","    measure: measure,","    dump: dump","};",""],"l":{"1":1,"2":1,"4":1,"5":1,"14":1,"15":0,"23":0,"25":0,"27":0,"28":0,"30":0,"31":0,"33":0,"34":0,"36":0,"39":0,"49":1,"50":0,"51":0,"54":0,"62":1,"63":0,"64":0,"65":0,"68":0,"69":0,"71":0,"74":0,"75":0,"78":0,"81":0,"82":0,"83":0,"84":0,"88":0,"91":0,"94":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/book.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/book.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":0,"14":1,"15":0,"16":1,"17":0,"18":1,"19":0,"20":1,"21":0,"22":1,"23":0,"24":1,"25":0,"26":1,"27":0,"28":1,"29":0,"30":1,"31":0,"32":1,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":1,"40":0,"41":0,"42":1,"43":0,"44":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":0,"53":0,"54":0,"55":0,"56":0,"57":1,"58":0,"59":1,"60":0,"61":1,"62":0,"63":1,"64":0,"65":0,"66":1,"67":0,"68":0,"69":0,"70":1,"71":0,"72":1,"73":0,"74":1,"75":0,"76":1,"77":0,"78":1,"79":0,"80":0,"81":1,"82":0,"83":1,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":1,"94":0,"95":0,"96":0,"97":0,"98":1,"99":0,"100":0,"101":0,"102":0,"103":1,"104":0,"105":0,"106":0,"107":0,"108":1,"109":0,"110":0,"111":0,"112":0,"113":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0},"fnMap":{"1":{"name":"(anonymous_1)","line":38,"loc":{"start":{"line":38,"column":27},"end":{"line":38,"column":38}}},"2":{"name":"(anonymous_2)","line":42,"loc":{"start":{"line":42,"column":23},"end":{"line":42,"column":34}}},"3":{"name":"(anonymous_3)","line":46,"loc":{"start":{"line":46,"column":27},"end":{"line":46,"column":38}}},"4":{"name":"(anonymous_4)","line":50,"loc":{"start":{"line":50,"column":27},"end":{"line":50,"column":38}}},"5":{"name":"(anonymous_5)","line":54,"loc":{"start":{"line":54,"column":27},"end":{"line":54,"column":38}}},"6":{"name":"(anonymous_6)","line":58,"loc":{"start":{"line":58,"column":28},"end":{"line":58,"column":39}}},"7":{"name":"(anonymous_7)","line":62,"loc":{"start":{"line":62,"column":29},"end":{"line":62,"column":40}}},"8":{"name":"(anonymous_8)","line":66,"loc":{"start":{"line":66,"column":30},"end":{"line":66,"column":41}}},"9":{"name":"(anonymous_9)","line":70,"loc":{"start":{"line":70,"column":26},"end":{"line":70,"column":37}}},"10":{"name":"(anonymous_10)","line":74,"loc":{"start":{"line":74,"column":29},"end":{"line":74,"column":40}}},"11":{"name":"(anonymous_11)","line":83,"loc":{"start":{"line":83,"column":30},"end":{"line":83,"column":41}}},"12":{"name":"(anonymous_12)","line":100,"loc":{"start":{"line":100,"column":25},"end":{"line":100,"column":36}}},"13":{"name":"(anonymous_13)","line":110,"loc":{"start":{"line":110,"column":32},"end":{"line":110,"column":43}}},"14":{"name":"(anonymous_14)","line":121,"loc":{"start":{"line":121,"column":31},"end":{"line":121,"column":50}}},"15":{"name":"(anonymous_15)","line":139,"loc":{"start":{"line":139,"column":38},"end":{"line":139,"column":57}}},"16":{"name":"(anonymous_16)","line":156,"loc":{"start":{"line":156,"column":25},"end":{"line":156,"column":39}}},"17":{"name":"(anonymous_17)","line":165,"loc":{"start":{"line":165,"column":32},"end":{"line":165,"column":43}}},"18":{"name":"(anonymous_18)","line":174,"loc":{"start":{"line":174,"column":32},"end":{"line":174,"column":43}}},"19":{"name":"(anonymous_19)","line":184,"loc":{"start":{"line":184,"column":33},"end":{"line":184,"column":52}}},"20":{"name":"(anonymous_20)","line":196,"loc":{"start":{"line":196,"column":33},"end":{"line":196,"column":58}}},"21":{"name":"(anonymous_21)","line":209,"loc":{"start":{"line":209,"column":28},"end":{"line":209,"column":46}}},"22":{"name":"(anonymous_22)","line":219,"loc":{"start":{"line":219,"column":27},"end":{"line":219,"column":44}}},"23":{"name":"(anonymous_23)","line":229,"loc":{"start":{"line":229,"column":27},"end":{"line":229,"column":44}}},"24":{"name":"(anonymous_24)","line":239,"loc":{"start":{"line":239,"column":27},"end":{"line":239,"column":44}}},"25":{"name":"(anonymous_25)","line":249,"loc":{"start":{"line":249,"column":29},"end":{"line":249,"column":45}}},"26":{"name":"createForFS","line":260,"loc":{"start":{"line":260,"column":19},"end":{"line":260,"column":44}}},"27":{"name":"(anonymous_27)","line":270,"loc":{"start":{"line":270,"column":31},"end":{"line":270,"column":42}}},"28":{"name":"(anonymous_28)","line":279,"loc":{"start":{"line":279,"column":25},"end":{"line":279,"column":41}}},"29":{"name":"(anonymous_29)","line":291,"loc":{"start":{"line":291,"column":21},"end":{"line":291,"column":34}}},"30":{"name":"(anonymous_30)","line":300,"loc":{"start":{"line":300,"column":38},"end":{"line":300,"column":57}}},"31":{"name":"(anonymous_31)","line":315,"loc":{"start":{"line":315,"column":39},"end":{"line":315,"column":58}}},"32":{"name":"(anonymous_32)","line":330,"loc":{"start":{"line":330,"column":40},"end":{"line":330,"column":59}}},"33":{"name":"createFromParent","line":346,"loc":{"start":{"line":346,"column":24},"end":{"line":346,"column":68}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":40}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":25}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":33}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":33}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":35}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":37}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":39}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":33}},"11":{"start":{"line":14,"column":0},"end":{"line":36,"column":3}},"12":{"start":{"line":38,"column":0},"end":{"line":40,"column":2}},"13":{"start":{"line":39,"column":4},"end":{"line":39,"column":30}},"14":{"start":{"line":42,"column":0},"end":{"line":44,"column":2}},"15":{"start":{"line":43,"column":4},"end":{"line":43,"column":26}},"16":{"start":{"line":46,"column":0},"end":{"line":48,"column":2}},"17":{"start":{"line":47,"column":4},"end":{"line":47,"column":30}},"18":{"start":{"line":50,"column":0},"end":{"line":52,"column":2}},"19":{"start":{"line":51,"column":4},"end":{"line":51,"column":30}},"20":{"start":{"line":54,"column":0},"end":{"line":56,"column":2}},"21":{"start":{"line":55,"column":4},"end":{"line":55,"column":30}},"22":{"start":{"line":58,"column":0},"end":{"line":60,"column":2}},"23":{"start":{"line":59,"column":4},"end":{"line":59,"column":31}},"24":{"start":{"line":62,"column":0},"end":{"line":64,"column":2}},"25":{"start":{"line":63,"column":4},"end":{"line":63,"column":32}},"26":{"start":{"line":66,"column":0},"end":{"line":68,"column":2}},"27":{"start":{"line":67,"column":4},"end":{"line":67,"column":33}},"28":{"start":{"line":70,"column":0},"end":{"line":72,"column":2}},"29":{"start":{"line":71,"column":4},"end":{"line":71,"column":29}},"30":{"start":{"line":74,"column":0},"end":{"line":76,"column":2}},"31":{"start":{"line":75,"column":4},"end":{"line":75,"column":32}},"32":{"start":{"line":83,"column":0},"end":{"line":93,"column":2}},"33":{"start":{"line":84,"column":4},"end":{"line":84,"column":26}},"34":{"start":{"line":85,"column":4},"end":{"line":85,"column":34}},"35":{"start":{"line":86,"column":4},"end":{"line":86,"column":45}},"36":{"start":{"line":88,"column":4},"end":{"line":90,"column":5}},"37":{"start":{"line":89,"column":8},"end":{"line":89,"column":46}},"38":{"start":{"line":92,"column":4},"end":{"line":92,"column":14}},"39":{"start":{"line":100,"column":0},"end":{"line":103,"column":2}},"40":{"start":{"line":101,"column":4},"end":{"line":101,"column":26}},"41":{"start":{"line":102,"column":4},"end":{"line":102,"column":24}},"42":{"start":{"line":110,"column":0},"end":{"line":113,"column":2}},"43":{"start":{"line":111,"column":4},"end":{"line":111,"column":33}},"44":{"start":{"line":112,"column":4},"end":{"line":112,"column":24}},"45":{"start":{"line":121,"column":0},"end":{"line":131,"column":2}},"46":{"start":{"line":122,"column":4},"end":{"line":122,"column":34}},"47":{"start":{"line":123,"column":4},"end":{"line":123,"column":38}},"48":{"start":{"line":126,"column":4},"end":{"line":128,"column":5}},"49":{"start":{"line":127,"column":8},"end":{"line":127,"column":49}},"50":{"start":{"line":130,"column":4},"end":{"line":130,"column":42}},"51":{"start":{"line":139,"column":0},"end":{"line":148,"column":2}},"52":{"start":{"line":140,"column":4},"end":{"line":140,"column":34}},"53":{"start":{"line":141,"column":4},"end":{"line":141,"column":45}},"54":{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},"55":{"start":{"line":144,"column":8},"end":{"line":144,"column":51}},"56":{"start":{"line":147,"column":4},"end":{"line":147,"column":40}},"57":{"start":{"line":156,"column":0},"end":{"line":158,"column":2}},"58":{"start":{"line":157,"column":4},"end":{"line":157,"column":36}},"59":{"start":{"line":165,"column":0},"end":{"line":167,"column":2}},"60":{"start":{"line":166,"column":4},"end":{"line":166,"column":48}},"61":{"start":{"line":174,"column":0},"end":{"line":176,"column":2}},"62":{"start":{"line":175,"column":4},"end":{"line":175,"column":39}},"63":{"start":{"line":184,"column":0},"end":{"line":187,"column":2}},"64":{"start":{"line":185,"column":4},"end":{"line":185,"column":32}},"65":{"start":{"line":186,"column":4},"end":{"line":186,"column":31}},"66":{"start":{"line":196,"column":0},"end":{"line":201,"column":2}},"67":{"start":{"line":197,"column":4},"end":{"line":197,"column":32}},"68":{"start":{"line":198,"column":4},"end":{"line":198,"column":38}},"69":{"start":{"line":200,"column":4},"end":{"line":200,"column":36}},"70":{"start":{"line":209,"column":0},"end":{"line":211,"column":2}},"71":{"start":{"line":210,"column":4},"end":{"line":210,"column":40}},"72":{"start":{"line":219,"column":0},"end":{"line":221,"column":2}},"73":{"start":{"line":220,"column":4},"end":{"line":220,"column":38}},"74":{"start":{"line":229,"column":0},"end":{"line":231,"column":2}},"75":{"start":{"line":230,"column":4},"end":{"line":230,"column":38}},"76":{"start":{"line":239,"column":0},"end":{"line":241,"column":2}},"77":{"start":{"line":240,"column":4},"end":{"line":240,"column":38}},"78":{"start":{"line":249,"column":0},"end":{"line":252,"column":2}},"79":{"start":{"line":250,"column":4},"end":{"line":250,"column":37}},"80":{"start":{"line":251,"column":4},"end":{"line":251,"column":16}},"81":{"start":{"line":260,"column":0},"end":{"line":264,"column":2}},"82":{"start":{"line":261,"column":4},"end":{"line":263,"column":7}},"83":{"start":{"line":270,"column":0},"end":{"line":292,"column":2}},"84":{"start":{"line":272,"column":4},"end":{"line":276,"column":6}},"85":{"start":{"line":279,"column":4},"end":{"line":286,"column":7}},"86":{"start":{"line":280,"column":8},"end":{"line":280,"column":34}},"87":{"start":{"line":281,"column":8},"end":{"line":285,"column":9}},"88":{"start":{"line":282,"column":12},"end":{"line":282,"column":60}},"89":{"start":{"line":284,"column":12},"end":{"line":284,"column":24}},"90":{"start":{"line":288,"column":4},"end":{"line":288,"column":21}},"91":{"start":{"line":291,"column":4},"end":{"line":291,"column":58}},"92":{"start":{"line":291,"column":36},"end":{"line":291,"column":54}},"93":{"start":{"line":300,"column":0},"end":{"line":307,"column":2}},"94":{"start":{"line":301,"column":4},"end":{"line":301,"column":52}},"95":{"start":{"line":302,"column":4},"end":{"line":306,"column":5}},"96":{"start":{"line":303,"column":8},"end":{"line":303,"column":61}},"97":{"start":{"line":305,"column":8},"end":{"line":305,"column":27}},"98":{"start":{"line":315,"column":0},"end":{"line":322,"column":2}},"99":{"start":{"line":316,"column":4},"end":{"line":316,"column":53}},"100":{"start":{"line":317,"column":4},"end":{"line":321,"column":5}},"101":{"start":{"line":318,"column":8},"end":{"line":318,"column":61}},"102":{"start":{"line":320,"column":8},"end":{"line":320,"column":27}},"103":{"start":{"line":330,"column":0},"end":{"line":337,"column":2}},"104":{"start":{"line":331,"column":4},"end":{"line":331,"column":54}},"105":{"start":{"line":332,"column":4},"end":{"line":336,"column":5}},"106":{"start":{"line":333,"column":8},"end":{"line":333,"column":61}},"107":{"start":{"line":335,"column":8},"end":{"line":335,"column":27}},"108":{"start":{"line":346,"column":0},"end":{"line":362,"column":2}},"109":{"start":{"line":347,"column":4},"end":{"line":347,"column":36}},"110":{"start":{"line":348,"column":4},"end":{"line":348,"column":36}},"111":{"start":{"line":351,"column":4},"end":{"line":351,"column":51}},"112":{"start":{"line":353,"column":4},"end":{"line":361,"column":7}},"113":{"start":{"line":364,"column":0},"end":{"line":364,"column":22}}},"branchMap":{"1":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":88,"column":4}},{"start":{"line":88,"column":4},"end":{"line":88,"column":4}}]},"2":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":4},"end":{"line":126,"column":4}},{"start":{"line":126,"column":4},"end":{"line":126,"column":4}}]},"3":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":4},"end":{"line":143,"column":4}},{"start":{"line":143,"column":4},"end":{"line":143,"column":4}}]},"4":{"line":281,"type":"if","locations":[{"start":{"line":281,"column":8},"end":{"line":281,"column":8}},{"start":{"line":281,"column":8},"end":{"line":281,"column":8}}]},"5":{"line":302,"type":"if","locations":[{"start":{"line":302,"column":4},"end":{"line":302,"column":4}},{"start":{"line":302,"column":4},"end":{"line":302,"column":4}}]},"6":{"line":317,"type":"if","locations":[{"start":{"line":317,"column":4},"end":{"line":317,"column":4}},{"start":{"line":317,"column":4},"end":{"line":317,"column":4}}]},"7":{"line":332,"type":"if","locations":[{"start":{"line":332,"column":4},"end":{"line":332,"column":4}},{"start":{"line":332,"column":4},"end":{"line":332,"column":4}}]}},"code":["var path = require('path');","var Immutable = require('immutable');","","var Logger = require('../utils/logger');","","var FS = require('./fs');","var Config = require('./config');","var Readme = require('./readme');","var Summary = require('./summary');","var Glossary = require('./glossary');","var Languages = require('./languages');","var Ignore = require('./ignore');","","var Book = Immutable.Record({","    // Logger for outptu message","    logger:         Logger(),","","    // Filesystem binded to the book scope to read files/directories","    fs:             FS(),","","    // Ignore files parser","    ignore:         Ignore(),","","    // Structure files","    config:         Config(),","    readme:         Readme(),","    summary:        Summary(),","    glossary:       Glossary(),","    languages:      Languages(),","","    // ID of the language for language books","    language:       String(),","","    // List of children, if multilingual (String -> Book)","    books:          Immutable.OrderedMap()","});","","Book.prototype.getLogger = function() {","    return this.get('logger');","};","","Book.prototype.getFS = function() {","    return this.get('fs');","};","","Book.prototype.getIgnore = function() {","    return this.get('ignore');","};","","Book.prototype.getConfig = function() {","    return this.get('config');","};","","Book.prototype.getReadme = function() {","    return this.get('readme');","};","","Book.prototype.getSummary = function() {","    return this.get('summary');","};","","Book.prototype.getGlossary = function() {","    return this.get('glossary');","};","","Book.prototype.getLanguages = function() {","    return this.get('languages');","};","","Book.prototype.getBooks = function() {","    return this.get('books');","};","","Book.prototype.getLanguage = function() {","    return this.get('language');","};","","/**","    Return FS instance to access the content","","    @return {FS}","*/","Book.prototype.getContentFS = function() {","    var fs = this.getFS();","    var config = this.getConfig();","    var rootFolder = config.getValue('root');","","    if (rootFolder) {","        return FS.reduceScope(fs, rootFolder);","    }","","    return fs;","};","","/**","    Return root of the book","","    @return {String}","*/","Book.prototype.getRoot = function() {","    var fs = this.getFS();","    return fs.getRoot();","};","","/**","    Return root for content of the book","","    @return {String}","*/","Book.prototype.getContentRoot = function() {","    var fs = this.getContentFS();","    return fs.getRoot();","};","","/**","    Check if a file is ignore (should not being parsed, etc)","","    @param {String} ref","    @return {Page|undefined}","*/","Book.prototype.isFileIgnored = function(filename) {","    var ignore = this.getIgnore();","    var language = this.getLanguage();","","    // Ignore is always relative to the root of the main book","    if (language) {","        filename = path.join(language, filename);","    }","","    return ignore.isFileIgnored(filename);","};","","/**","    Check if a content file is ignore (should not being parsed, etc)","","    @param {String} ref","    @return {Page|undefined}","*/","Book.prototype.isContentFileIgnored = function(filename) {","    var config = this.getConfig();","    var rootFolder = config.getValue('root');","","    if (rootFolder) {","        filename = path.join(rootFolder, filename);","    }","","    return this.isFileIgnored(filename);","};","","/**","    Return a page from a book by its path","","    @param {String} ref","    @return {Page|undefined}","*/","Book.prototype.getPage = function(ref) {","    return this.getPages().get(ref);","};","","/**","    Is this book the parent of language's books","","    @return {Boolean}","*/","Book.prototype.isMultilingual = function() {","    return (this.getLanguages().getCount() > 0);","};","","/**","    Return true if book is associated to a language","","    @return {Boolean}","*/","Book.prototype.isLanguageBook = function() {","    return Boolean(this.getLanguage());","};","","/**","    Return a languages book","","    @param {String} language","    @return {Book}","*/","Book.prototype.getLanguageBook = function(language) {","    var books = this.getBooks();","    return books.get(language);","};","","/**","    Add a new language book","","    @param {String} language","    @param {Book} book","    @return {Book}","*/","Book.prototype.addLanguageBook = function(language, book) {","    var books = this.getBooks();","    books = books.set(language, book);","","    return this.set('books', books);","};","","/**","    Set the summary for this book","","    @param {Summary}","    @return {Book}","*/","Book.prototype.setSummary = function(summary) {","    return this.set('summary', summary);","};","","/**","    Set the readme for this book","","    @param {Readme}","    @return {Book}","*/","Book.prototype.setReadme = function(readme) {","    return this.set('readme', readme);","};","","/**","    Set the configuration for this book","","    @param {Config}","    @return {Book}","*/","Book.prototype.setConfig = function(config) {","    return this.set('config', config);","};","","/**","    Set the ignore instance for this book","","    @param {Ignore}","    @return {Book}","*/","Book.prototype.setIgnore = function(ignore) {","    return this.set('ignore', ignore);","};","","/**","    Change log level","","    @param {String} level","    @return {Book}","*/","Book.prototype.setLogLevel = function(level) {","    this.getLogger().setLevel(level);","    return this;","};","","/**","    Create a book using a filesystem","","    @param {FS} fs","    @return {Book}","*/","Book.createForFS = function createForFS(fs) {","    return new Book({","        fs: fs","    });","};","","/**","    Infers the default extension for files","    @return {String}","*/","Book.prototype.getDefaultExt = function() {","    // Inferring sources","    var clues = [","        this.getReadme(),","        this.getSummary(),","        this.getGlossary()","    ];","","    // List their extensions","    var exts = clues.map(function (clue) {","        var file = clue.getFile();","        if (file.exists()) {","            return file.getParser().getExtensions().first();","        } else {","            return null;","        }","    });","    // Adds the general default extension","    exts.push('.md');","","    // Choose the first non null","    return exts.find(function (e) { return e !== null; });","};","","/**","    Infer the default path for a Readme.","    @param {Boolean} [absolute=false] False for a path relative to","        this book's content root","    @return {String}","*/","Book.prototype.getDefaultReadmePath = function(absolute) {","    var defaultPath = 'README'+this.getDefaultExt();","    if (absolute) {","        return path.join(this.getContentRoot(), defaultPath);","    } else {","        return defaultPath;","    }","};","","/**","    Infer the default path for a Summary.","    @param {Boolean} [absolute=false] False for a path relative to","        this book's content root","    @return {String}","*/","Book.prototype.getDefaultSummaryPath = function(absolute) {","    var defaultPath = 'SUMMARY'+this.getDefaultExt();","    if (absolute) {","        return path.join(this.getContentRoot(), defaultPath);","    } else {","        return defaultPath;","    }","};","","/**","    Infer the default path for a Glossary.","    @param {Boolean} [absolute=false] False for a path relative to","        this book's content root","    @return {String}","*/","Book.prototype.getDefaultGlossaryPath = function(absolute) {","    var defaultPath = 'GLOSSARY'+this.getDefaultExt();","    if (absolute) {","        return path.join(this.getContentRoot(), defaultPath);","    } else {","        return defaultPath;","    }","};","","/**","    Create a language book from a parent","","    @param {Book} parent","    @param {String} language","    @return {Book}","*/","Book.createFromParent = function createFromParent(parent, language) {","    var ignore = parent.getIgnore();","    var config = parent.getConfig();","","    // Set language in configuration","    config = config.setValue('language', language);","","    return new Book({","        // Inherits config. logegr and list of ignored files","        logger: parent.getLogger(),","        config: config,","        ignore: ignore,","","        language: language,","        fs: FS.reduceScope(parent.getContentFS(), language)","    });","};","","module.exports = Book;",""],"l":{"1":1,"2":1,"4":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"14":1,"38":1,"39":0,"42":1,"43":0,"46":1,"47":0,"50":1,"51":0,"54":1,"55":0,"58":1,"59":0,"62":1,"63":0,"66":1,"67":0,"70":1,"71":0,"74":1,"75":0,"83":1,"84":0,"85":0,"86":0,"88":0,"89":0,"92":0,"100":1,"101":0,"102":0,"110":1,"111":0,"112":0,"121":1,"122":0,"123":0,"126":0,"127":0,"130":0,"139":1,"140":0,"141":0,"143":0,"144":0,"147":0,"156":1,"157":0,"165":1,"166":0,"174":1,"175":0,"184":1,"185":0,"186":0,"196":1,"197":0,"198":0,"200":0,"209":1,"210":0,"219":1,"220":0,"229":1,"230":0,"239":1,"240":0,"249":1,"250":0,"251":0,"260":1,"261":0,"270":1,"272":0,"279":0,"280":0,"281":0,"282":0,"284":0,"288":0,"291":0,"300":1,"301":0,"302":0,"303":0,"305":0,"315":1,"316":0,"317":0,"318":0,"320":0,"330":1,"331":0,"332":0,"333":0,"335":0,"346":1,"347":0,"348":0,"351":0,"353":0,"364":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/logger.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/logger.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":2,"9":1,"10":1,"11":0,"12":0,"13":1,"14":1,"15":1,"16":5,"17":1,"18":4,"19":4,"20":4,"21":4,"22":4,"23":4,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":0,"31":1,"32":0,"33":0,"34":0,"35":1,"36":0,"37":1,"38":0,"39":1,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":0,"54":0,"55":1,"56":0,"57":0,"58":0,"59":0,"60":0,"61":1,"62":0,"63":1,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":1,"71":1},"b":{"1":[1,1],"2":[1,1],"3":[0,0],"4":[1,1],"5":[1,4],"6":[1,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":2,"2":0,"3":5,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"fnMap":{"1":{"name":"Logger","line":21,"loc":{"start":{"line":21,"column":0},"end":{"line":21,"column":33}}},"2":{"name":"(anonymous_2)","line":24,"loc":{"start":{"line":24,"column":27},"end":{"line":24,"column":41}}},"3":{"name":"(anonymous_3)","line":34,"loc":{"start":{"line":34,"column":19},"end":{"line":34,"column":45}}},"4":{"name":"(anonymous_4)","line":53,"loc":{"start":{"line":53,"column":28},"end":{"line":53,"column":47}}},"5":{"name":"(anonymous_5)","line":67,"loc":{"start":{"line":67,"column":28},"end":{"line":67,"column":47}}},"6":{"name":"(anonymous_6)","line":76,"loc":{"start":{"line":76,"column":25},"end":{"line":76,"column":39}}},"7":{"name":"(anonymous_7)","line":85,"loc":{"start":{"line":85,"column":26},"end":{"line":85,"column":37}}},"8":{"name":"(anonymous_8)","line":94,"loc":{"start":{"line":94,"column":27},"end":{"line":94,"column":41}}},"9":{"name":"(anonymous_9)","line":103,"loc":{"start":{"line":103,"column":23},"end":{"line":103,"column":39}}},"10":{"name":"(anonymous_10)","line":106,"loc":{"start":{"line":106,"column":34},"end":{"line":106,"column":46}}},"11":{"name":"(anonymous_11)","line":122,"loc":{"start":{"line":122,"column":25},"end":{"line":122,"column":36}}},"12":{"name":"(anonymous_12)","line":133,"loc":{"start":{"line":133,"column":22},"end":{"line":133,"column":38}}},"13":{"name":"(anonymous_13)","line":146,"loc":{"start":{"line":146,"column":24},"end":{"line":146,"column":40}}},"14":{"name":"(anonymous_14)","line":157,"loc":{"start":{"line":157,"column":27},"end":{"line":157,"column":46}}},"15":{"name":"(anonymous_15)","line":161,"loc":{"start":{"line":161,"column":9},"end":{"line":161,"column":22}}},"16":{"name":"(anonymous_16)","line":164,"loc":{"start":{"line":164,"column":7},"end":{"line":164,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":34}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":37}},"5":{"start":{"line":6,"column":0},"end":{"line":12,"column":3}},"6":{"start":{"line":14,"column":0},"end":{"line":19,"column":3}},"7":{"start":{"line":21,"column":0},"end":{"line":46,"column":1}},"8":{"start":{"line":22,"column":4},"end":{"line":22,"column":70}},"9":{"start":{"line":22,"column":35},"end":{"line":22,"column":70}},"10":{"start":{"line":24,"column":4},"end":{"line":28,"column":6}},"11":{"start":{"line":25,"column":8},"end":{"line":27,"column":9}},"12":{"start":{"line":26,"column":12},"end":{"line":26,"column":38}},"13":{"start":{"line":29,"column":4},"end":{"line":29,"column":25}},"14":{"start":{"line":31,"column":4},"end":{"line":31,"column":38}},"15":{"start":{"line":34,"column":4},"end":{"line":45,"column":13}},"16":{"start":{"line":35,"column":8},"end":{"line":37,"column":9}},"17":{"start":{"line":36,"column":12},"end":{"line":36,"column":19}},"18":{"start":{"line":38,"column":8},"end":{"line":38,"column":42}},"19":{"start":{"line":40,"column":8},"end":{"line":40,"column":63}},"20":{"start":{"line":41,"column":8},"end":{"line":41,"column":65}},"21":{"start":{"line":42,"column":8},"end":{"line":42,"column":62}},"22":{"start":{"line":43,"column":8},"end":{"line":43,"column":64}},"23":{"start":{"line":44,"column":8},"end":{"line":44,"column":67}},"24":{"start":{"line":53,"column":0},"end":{"line":60,"column":2}},"25":{"start":{"line":54,"column":4},"end":{"line":57,"column":5}},"26":{"start":{"line":55,"column":8},"end":{"line":55,"column":42}},"27":{"start":{"line":56,"column":8},"end":{"line":56,"column":40}},"28":{"start":{"line":59,"column":4},"end":{"line":59,"column":29}},"29":{"start":{"line":67,"column":0},"end":{"line":69,"column":2}},"30":{"start":{"line":68,"column":4},"end":{"line":68,"column":25}},"31":{"start":{"line":76,"column":0},"end":{"line":80,"column":2}},"32":{"start":{"line":77,"column":4},"end":{"line":77,"column":25}},"33":{"start":{"line":78,"column":4},"end":{"line":78,"column":40}},"34":{"start":{"line":79,"column":4},"end":{"line":79,"column":28}},"35":{"start":{"line":85,"column":0},"end":{"line":87,"column":2}},"36":{"start":{"line":86,"column":4},"end":{"line":86,"column":46}},"37":{"start":{"line":94,"column":0},"end":{"line":96,"column":2}},"38":{"start":{"line":95,"column":4},"end":{"line":95,"column":40}},"39":{"start":{"line":103,"column":0},"end":{"line":117,"column":2}},"40":{"start":{"line":104,"column":4},"end":{"line":104,"column":38}},"41":{"start":{"line":104,"column":31},"end":{"line":104,"column":38}},"42":{"start":{"line":106,"column":4},"end":{"line":108,"column":7}},"43":{"start":{"line":107,"column":8},"end":{"line":107,"column":27}},"44":{"start":{"line":109,"column":4},"end":{"line":109,"column":59}},"45":{"start":{"line":110,"column":4},"end":{"line":110,"column":44}},"46":{"start":{"line":112,"column":4},"end":{"line":114,"column":5}},"47":{"start":{"line":113,"column":8},"end":{"line":113,"column":71}},"48":{"start":{"line":116,"column":4},"end":{"line":116,"column":27}},"49":{"start":{"line":122,"column":0},"end":{"line":128,"column":2}},"50":{"start":{"line":123,"column":4},"end":{"line":123,"column":48}},"51":{"start":{"line":123,"column":31},"end":{"line":123,"column":48}},"52":{"start":{"line":125,"column":4},"end":{"line":125,"column":54}},"53":{"start":{"line":126,"column":4},"end":{"line":126,"column":20}},"54":{"start":{"line":127,"column":4},"end":{"line":127,"column":38}},"55":{"start":{"line":133,"column":0},"end":{"line":141,"column":2}},"56":{"start":{"line":134,"column":4},"end":{"line":134,"column":59}},"57":{"start":{"line":135,"column":4},"end":{"line":135,"column":44}},"58":{"start":{"line":136,"column":4},"end":{"line":140,"column":5}},"59":{"start":{"line":137,"column":8},"end":{"line":137,"column":96}},"60":{"start":{"line":139,"column":8},"end":{"line":139,"column":49}},"61":{"start":{"line":146,"column":0},"end":{"line":148,"column":2}},"62":{"start":{"line":147,"column":4},"end":{"line":147,"column":54}},"63":{"start":{"line":157,"column":0},"end":{"line":168,"column":2}},"64":{"start":{"line":158,"column":4},"end":{"line":158,"column":20}},"65":{"start":{"line":160,"column":4},"end":{"line":167,"column":7}},"66":{"start":{"line":162,"column":8},"end":{"line":162,"column":23}},"67":{"start":{"line":163,"column":8},"end":{"line":163,"column":18}},"68":{"start":{"line":165,"column":8},"end":{"line":165,"column":25}},"69":{"start":{"line":166,"column":8},"end":{"line":166,"column":18}},"70":{"start":{"line":170,"column":0},"end":{"line":170,"column":23}},"71":{"start":{"line":172,"column":0},"end":{"line":172,"column":25}}},"branchMap":{"1":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":22,"column":4}},{"start":{"line":22,"column":4},"end":{"line":22,"column":4}}]},"2":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":18},"end":{"line":24,"column":23}},{"start":{"line":24,"column":27},"end":{"line":28,"column":5}}]},"3":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":8}},{"start":{"line":25,"column":8},"end":{"line":25,"column":8}}]},"4":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":18},"end":{"line":31,"column":26}},{"start":{"line":31,"column":30},"end":{"line":31,"column":36}}]},"5":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":8}},{"start":{"line":35,"column":8},"end":{"line":35,"column":8}}]},"6":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":4},"end":{"line":54,"column":4}},{"start":{"line":54,"column":4},"end":{"line":54,"column":4}}]},"7":{"line":95,"type":"binary-expr","locations":[{"start":{"line":95,"column":23},"end":{"line":95,"column":26}},{"start":{"line":95,"column":30},"end":{"line":95,"column":32}}]},"8":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":4},"end":{"line":104,"column":4}},{"start":{"line":104,"column":4},"end":{"line":104,"column":4}}]},"9":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":4},"end":{"line":112,"column":4}},{"start":{"line":112,"column":4},"end":{"line":112,"column":4}}]},"10":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":4},"end":{"line":123,"column":4}},{"start":{"line":123,"column":4},"end":{"line":123,"column":4}}]},"11":{"line":136,"type":"if","locations":[{"start":{"line":136,"column":4},"end":{"line":136,"column":4}},{"start":{"line":136,"column":4},"end":{"line":136,"column":4}}]}},"code":["var is = require('is');","var util = require('util');","var color = require('bash-color');","var Immutable = require('immutable');","","var LEVELS = Immutable.Map({","    DEBUG: 0,","    INFO: 1,","    WARN: 2,","    ERROR: 3,","    DISABLED: 10","});","","var COLORS = Immutable.Map({","    DEBUG: color.purple,","    INFO: color.cyan,","    WARN: color.yellow,","    ERROR: color.red","});","","function Logger(write, logLevel) {","    if (!(this instanceof Logger)) return new Logger(write, logLevel);","","    this._write = write || function(msg) {","        if(process.stdout) {","            process.stdout.write(msg);","        }","    };","    this.lastChar = '\\n';","","    this.setLevel(logLevel || 'info');","","    // Create easy-to-use method like \"logger.debug.ln('....')\"","    LEVELS.forEach(function(level, levelKey) {","        if (levelKey === 'DISABLED') {","            return;","        }","        levelKey = levelKey.toLowerCase();","","        this[levelKey] =            this.log.bind(this, level);","        this[levelKey].ln =         this.logLn.bind(this, level);","        this[levelKey].ok =         this.ok.bind(this, level);","        this[levelKey].fail =       this.fail.bind(this, level);","        this[levelKey].promise =    this.promise.bind(this, level);","    }, this);","}","","/**","    Change minimum level","","    @param {String} logLevel","*/","Logger.prototype.setLevel = function(logLevel) {","    if (is.string(logLevel)) {","        logLevel = logLevel.toUpperCase();","        logLevel = LEVELS.get(logLevel);","    }","","    this.logLevel = logLevel;","};","","/**","    Return minimum logging level","","    @return {Number}","*/","Logger.prototype.getLevel = function(logLevel) {","    return this.logLevel;","};","","/**","    Print a simple string","","    @param {String}","*/","Logger.prototype.write = function(msg) {","    msg = msg.toString();","    this.lastChar = msg[msg.length - 1];","    return this._write(msg);","};","","/**","    Format a string using the first argument as a printf-like format.","*/","Logger.prototype.format = function() {","    return util.format.apply(util, arguments);","};","","/**","    Print a line","","    @param {String}","*/","Logger.prototype.writeLn = function(msg) {","    return this.write((msg || '')+'\\n');","};","","/**","    Log/Print a message if level is allowed","","    @param {Number} level","*/","Logger.prototype.log = function(level) {","    if (level < this.logLevel) return;","","    var levelKey = LEVELS.findKey(function(v) {","        return v === level;","    });","    var args = Array.prototype.slice.apply(arguments, [1]);","    var msg = this.format.apply(this, args);","","    if (this.lastChar == '\\n') {","        msg = COLORS.get(levelKey)(levelKey.toLowerCase()+':')+' '+msg;","    }","","    return this.write(msg);","};","","/**","    Log/Print a line if level is allowed","*/","Logger.prototype.logLn = function() {","    if (this.lastChar != '\\n') this.write('\\n');","","    var args = Array.prototype.slice.apply(arguments);","    args.push('\\n');","    return this.log.apply(this, args);","};","","/**","    Log a confirmation [OK]","*/","Logger.prototype.ok = function(level) {","    var args = Array.prototype.slice.apply(arguments, [1]);","    var msg = this.format.apply(this, args);","    if (arguments.length > 1) {","        this.logLn(level, color.green('>> ') + msg.trim().replace(/\\n/g, color.green('\\n>> ')));","    } else {","        this.log(level, color.green('OK'), '\\n');","    }","};","","/**","    Log a \"FAIL\"","*/","Logger.prototype.fail = function(level) {","    return this.log(level, color.red('ERROR') + '\\n');","};","","/**","    Log state of a promise","","    @param {Number} level","    @param {Promise}","    @return {Promise}","*/","Logger.prototype.promise = function(level, p) {","    var that = this;","","    return p.","    then(function(st) {","        that.ok(level);","        return st;","    }, function(err) {","        that.fail(level);","        throw err;","    });","};","","Logger.LEVELS = LEVELS;","","module.exports =  Logger;",""],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"14":1,"21":1,"22":2,"24":1,"25":0,"26":0,"29":1,"31":1,"34":1,"35":5,"36":1,"38":4,"40":4,"41":4,"42":4,"43":4,"44":4,"53":1,"54":1,"55":1,"56":1,"59":1,"67":1,"68":0,"76":1,"77":0,"78":0,"79":0,"85":1,"86":0,"94":1,"95":0,"103":1,"104":0,"106":0,"107":0,"109":0,"110":0,"112":0,"113":0,"116":0,"122":1,"123":0,"125":0,"126":0,"127":0,"133":1,"134":0,"135":0,"136":0,"137":0,"139":0,"146":1,"147":0,"157":1,"158":0,"160":0,"162":0,"163":0,"165":0,"166":0,"170":1,"172":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/fs.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/fs.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":1,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":1,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":1,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":1,"64":0,"65":0,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":1,"80":0,"81":0,"82":0,"83":1,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":1,"96":0,"97":1,"98":0,"99":1,"100":0,"101":0,"102":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},"fnMap":{"1":{"name":"(anonymous_1)","line":27,"loc":{"start":{"line":27,"column":23},"end":{"line":27,"column":34}}},"2":{"name":"(anonymous_2)","line":37,"loc":{"start":{"line":37,"column":25},"end":{"line":37,"column":44}}},"3":{"name":"(anonymous_3)","line":50,"loc":{"start":{"line":50,"column":23},"end":{"line":50,"column":34}}},"4":{"name":"(anonymous_4)","line":72,"loc":{"start":{"line":72,"column":22},"end":{"line":72,"column":41}}},"5":{"name":"(anonymous_5)","line":76,"loc":{"start":{"line":76,"column":10},"end":{"line":76,"column":21}}},"6":{"name":"(anonymous_6)","line":90,"loc":{"start":{"line":90,"column":20},"end":{"line":90,"column":39}}},"7":{"name":"(anonymous_7)","line":94,"loc":{"start":{"line":94,"column":10},"end":{"line":94,"column":21}}},"8":{"name":"(anonymous_8)","line":108,"loc":{"start":{"line":108,"column":28},"end":{"line":108,"column":57}}},"9":{"name":"(anonymous_9)","line":112,"loc":{"start":{"line":112,"column":10},"end":{"line":112,"column":24}}},"10":{"name":"(anonymous_10)","line":123,"loc":{"start":{"line":123,"column":28},"end":{"line":123,"column":47}}},"11":{"name":"(anonymous_11)","line":133,"loc":{"start":{"line":133,"column":10},"end":{"line":133,"column":24}}},"12":{"name":"(anonymous_12)","line":147,"loc":{"start":{"line":147,"column":24},"end":{"line":147,"column":43}}},"13":{"name":"(anonymous_13)","line":151,"loc":{"start":{"line":151,"column":10},"end":{"line":151,"column":21}}},"14":{"name":"(anonymous_14)","line":157,"loc":{"start":{"line":157,"column":10},"end":{"line":157,"column":25}}},"15":{"name":"(anonymous_15)","line":169,"loc":{"start":{"line":169,"column":23},"end":{"line":169,"column":41}}},"16":{"name":"(anonymous_16)","line":173,"loc":{"start":{"line":173,"column":10},"end":{"line":173,"column":21}}},"17":{"name":"(anonymous_17)","line":179,"loc":{"start":{"line":179,"column":10},"end":{"line":179,"column":26}}},"18":{"name":"(anonymous_18)","line":191,"loc":{"start":{"line":191,"column":25},"end":{"line":191,"column":43}}},"19":{"name":"(anonymous_19)","line":193,"loc":{"start":{"line":193,"column":10},"end":{"line":193,"column":26}}},"20":{"name":"(anonymous_20)","line":205,"loc":{"start":{"line":205,"column":28},"end":{"line":205,"column":56}}},"21":{"name":"(anonymous_21)","line":210,"loc":{"start":{"line":210,"column":10},"end":{"line":210,"column":26}}},"22":{"name":"(anonymous_22)","line":211,"loc":{"start":{"line":211,"column":37},"end":{"line":211,"column":57}}},"23":{"name":"(anonymous_23)","line":224,"loc":{"start":{"line":224,"column":18},"end":{"line":224,"column":34}}},"24":{"name":"(anonymous_24)","line":239,"loc":{"start":{"line":239,"column":24},"end":{"line":239,"column":52}}},"25":{"name":"(anonymous_25)","line":241,"loc":{"start":{"line":241,"column":10},"end":{"line":241,"column":26}}},"26":{"name":"(anonymous_26)","line":242,"loc":{"start":{"line":242,"column":26},"end":{"line":242,"column":41}}},"27":{"name":"(anonymous_27)","line":255,"loc":{"start":{"line":255,"column":28},"end":{"line":255,"column":47}}},"28":{"name":"(anonymous_28)","line":260,"loc":{"start":{"line":260,"column":10},"end":{"line":260,"column":27}}},"29":{"name":"(anonymous_29)","line":272,"loc":{"start":{"line":272,"column":18},"end":{"line":272,"column":32}}},"30":{"name":"create","line":285,"loc":{"start":{"line":285,"column":12},"end":{"line":285,"column":33}}},"31":{"name":"reduceScope","line":296,"loc":{"start":{"line":296,"column":17},"end":{"line":296,"column":49}}},"32":{"name":"pathIsFolder","line":302,"loc":{"start":{"line":302,"column":0},"end":{"line":302,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":29}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":42}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":38}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":40}},"8":{"start":{"line":10,"column":0},"end":{"line":20,"column":3}},"9":{"start":{"line":27,"column":0},"end":{"line":29,"column":2}},"10":{"start":{"line":28,"column":4},"end":{"line":28,"column":28}},"11":{"start":{"line":37,"column":0},"end":{"line":42,"column":2}},"12":{"start":{"line":38,"column":4},"end":{"line":38,"column":34}},"13":{"start":{"line":39,"column":4},"end":{"line":39,"column":45}},"14":{"start":{"line":41,"column":4},"end":{"line":41,"column":49}},"15":{"start":{"line":50,"column":0},"end":{"line":64,"column":2}},"16":{"start":{"line":51,"column":4},"end":{"line":51,"column":34}},"17":{"start":{"line":52,"column":4},"end":{"line":52,"column":53}},"18":{"start":{"line":53,"column":4},"end":{"line":53,"column":66}},"19":{"start":{"line":54,"column":4},"end":{"line":54,"column":40}},"20":{"start":{"line":56,"column":4},"end":{"line":61,"column":5}},"21":{"start":{"line":57,"column":8},"end":{"line":60,"column":11}},"22":{"start":{"line":63,"column":4},"end":{"line":63,"column":20}},"23":{"start":{"line":72,"column":0},"end":{"line":82,"column":2}},"24":{"start":{"line":73,"column":4},"end":{"line":73,"column":20}},"25":{"start":{"line":75,"column":4},"end":{"line":81,"column":7}},"26":{"start":{"line":77,"column":8},"end":{"line":77,"column":42}},"27":{"start":{"line":78,"column":8},"end":{"line":78,"column":42}},"28":{"start":{"line":80,"column":8},"end":{"line":80,"column":32}},"29":{"start":{"line":90,"column":0},"end":{"line":100,"column":2}},"30":{"start":{"line":91,"column":4},"end":{"line":91,"column":20}},"31":{"start":{"line":93,"column":4},"end":{"line":99,"column":7}},"32":{"start":{"line":95,"column":8},"end":{"line":95,"column":42}},"33":{"start":{"line":96,"column":8},"end":{"line":96,"column":42}},"34":{"start":{"line":98,"column":8},"end":{"line":98,"column":30}},"35":{"start":{"line":108,"column":0},"end":{"line":115,"column":2}},"36":{"start":{"line":109,"column":4},"end":{"line":109,"column":34}},"37":{"start":{"line":111,"column":4},"end":{"line":114,"column":7}},"38":{"start":{"line":113,"column":8},"end":{"line":113,"column":38}},"39":{"start":{"line":123,"column":0},"end":{"line":139,"column":2}},"40":{"start":{"line":124,"column":4},"end":{"line":124,"column":20}},"41":{"start":{"line":125,"column":4},"end":{"line":125,"column":42}},"42":{"start":{"line":126,"column":4},"end":{"line":126,"column":52}},"43":{"start":{"line":128,"column":4},"end":{"line":130,"column":5}},"44":{"start":{"line":129,"column":8},"end":{"line":129,"column":49}},"45":{"start":{"line":132,"column":4},"end":{"line":138,"column":7}},"46":{"start":{"line":134,"column":8},"end":{"line":134,"column":52}},"47":{"start":{"line":135,"column":8},"end":{"line":135,"column":30}},"48":{"start":{"line":137,"column":8},"end":{"line":137,"column":28}},"49":{"start":{"line":147,"column":0},"end":{"line":160,"column":2}},"50":{"start":{"line":148,"column":4},"end":{"line":148,"column":20}},"51":{"start":{"line":150,"column":4},"end":{"line":159,"column":7}},"52":{"start":{"line":152,"column":8},"end":{"line":152,"column":46}},"53":{"start":{"line":153,"column":8},"end":{"line":153,"column":42}},"54":{"start":{"line":155,"column":8},"end":{"line":155,"column":30}},"55":{"start":{"line":158,"column":8},"end":{"line":158,"column":51}},"56":{"start":{"line":169,"column":0},"end":{"line":182,"column":2}},"57":{"start":{"line":170,"column":4},"end":{"line":170,"column":20}},"58":{"start":{"line":172,"column":4},"end":{"line":181,"column":7}},"59":{"start":{"line":174,"column":8},"end":{"line":174,"column":44}},"60":{"start":{"line":175,"column":8},"end":{"line":175,"column":44}},"61":{"start":{"line":177,"column":8},"end":{"line":177,"column":32}},"62":{"start":{"line":180,"column":8},"end":{"line":180,"column":37}},"63":{"start":{"line":191,"column":0},"end":{"line":196,"column":2}},"64":{"start":{"line":192,"column":4},"end":{"line":195,"column":7}},"65":{"start":{"line":194,"column":8},"end":{"line":194,"column":45}},"66":{"start":{"line":205,"column":0},"end":{"line":229,"column":2}},"67":{"start":{"line":206,"column":4},"end":{"line":206,"column":20}},"68":{"start":{"line":207,"column":4},"end":{"line":207,"column":29}},"69":{"start":{"line":209,"column":4},"end":{"line":228,"column":7}},"70":{"start":{"line":211,"column":8},"end":{"line":227,"column":29}},"71":{"start":{"line":212,"column":12},"end":{"line":212,"column":49}},"72":{"start":{"line":213,"column":12},"end":{"line":213,"column":54}},"73":{"start":{"line":215,"column":12},"end":{"line":217,"column":13}},"74":{"start":{"line":216,"column":16},"end":{"line":216,"column":27}},"75":{"start":{"line":219,"column":12},"end":{"line":221,"column":13}},"76":{"start":{"line":220,"column":16},"end":{"line":220,"column":44}},"77":{"start":{"line":223,"column":12},"end":{"line":226,"column":15}},"78":{"start":{"line":225,"column":16},"end":{"line":225,"column":41}},"79":{"start":{"line":239,"column":0},"end":{"line":246,"column":2}},"80":{"start":{"line":240,"column":4},"end":{"line":245,"column":7}},"81":{"start":{"line":242,"column":8},"end":{"line":244,"column":11}},"82":{"start":{"line":243,"column":12},"end":{"line":243,"column":66}},"83":{"start":{"line":255,"column":0},"end":{"line":277,"column":2}},"84":{"start":{"line":256,"column":4},"end":{"line":256,"column":20}},"85":{"start":{"line":257,"column":4},"end":{"line":257,"column":48}},"86":{"start":{"line":259,"column":4},"end":{"line":276,"column":7}},"87":{"start":{"line":261,"column":8},"end":{"line":266,"column":9}},"88":{"start":{"line":262,"column":12},"end":{"line":262,"column":57}},"89":{"start":{"line":263,"column":12},"end":{"line":263,"column":42}},"90":{"start":{"line":265,"column":12},"end":{"line":265,"column":22}},"91":{"start":{"line":268,"column":8},"end":{"line":275,"column":9}},"92":{"start":{"line":269,"column":12},"end":{"line":269,"column":56}},"93":{"start":{"line":271,"column":12},"end":{"line":274,"column":15}},"94":{"start":{"line":273,"column":16},"end":{"line":273,"column":39}},"95":{"start":{"line":285,"column":0},"end":{"line":287,"column":2}},"96":{"start":{"line":286,"column":4},"end":{"line":286,"column":23}},"97":{"start":{"line":296,"column":0},"end":{"line":298,"column":2}},"98":{"start":{"line":297,"column":4},"end":{"line":297,"column":58}},"99":{"start":{"line":302,"column":0},"end":{"line":305,"column":1}},"100":{"start":{"line":303,"column":4},"end":{"line":303,"column":49}},"101":{"start":{"line":304,"column":4},"end":{"line":304,"column":47}},"102":{"start":{"line":307,"column":0},"end":{"line":307,"column":20}}},"branchMap":{"1":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":56,"column":4}},{"start":{"line":56,"column":4},"end":{"line":56,"column":4}}]},"2":{"line":109,"type":"binary-expr","locations":[{"start":{"line":109,"column":15},"end":{"line":109,"column":23}},{"start":{"line":109,"column":27},"end":{"line":109,"column":33}}]},"3":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":4},"end":{"line":128,"column":4}},{"start":{"line":128,"column":4},"end":{"line":128,"column":4}}]},"4":{"line":207,"type":"binary-expr","locations":[{"start":{"line":207,"column":14},"end":{"line":207,"column":21}},{"start":{"line":207,"column":25},"end":{"line":207,"column":28}}]},"5":{"line":215,"type":"if","locations":[{"start":{"line":215,"column":12},"end":{"line":215,"column":12}},{"start":{"line":215,"column":12},"end":{"line":215,"column":12}}]},"6":{"line":215,"type":"binary-expr","locations":[{"start":{"line":215,"column":16},"end":{"line":215,"column":24}},{"start":{"line":215,"column":28},"end":{"line":215,"column":58}}]},"7":{"line":219,"type":"if","locations":[{"start":{"line":219,"column":12},"end":{"line":219,"column":12}},{"start":{"line":219,"column":12},"end":{"line":219,"column":12}}]},"8":{"line":261,"type":"if","locations":[{"start":{"line":261,"column":8},"end":{"line":261,"column":8}},{"start":{"line":261,"column":8},"end":{"line":261,"column":8}}]},"9":{"line":268,"type":"if","locations":[{"start":{"line":268,"column":8},"end":{"line":268,"column":8}},{"start":{"line":268,"column":8},"end":{"line":268,"column":8}}]},"10":{"line":304,"type":"binary-expr","locations":[{"start":{"line":304,"column":11},"end":{"line":304,"column":26}},{"start":{"line":304,"column":30},"end":{"line":304,"column":46}}]}},"code":["var path = require('path');","var Immutable = require('immutable');","var stream = require('stream');","","var File = require('./file');","var Promise = require('../utils/promise');","var error = require('../utils/error');","var PathUtil = require('../utils/path');","","var FS = Immutable.Record({","    root:           String(),","","    fsExists:         Function(),","    fsReadFile:       Function(),","    fsStatFile:       Function(),","    fsReadDir:        Function(),","","    fsLoadObject:     null,","    fsReadAsStream:   null","});","","/**","    Return path to the root","","    @return {String}","*/","FS.prototype.getRoot = function() {","    return this.get('root');","};","","/**","    Verify that a file is in the fs scope","","    @param {String} filename","    @return {Boolean}","*/","FS.prototype.isInScope = function(filename) {","    var rootPath = this.getRoot();","    filename = path.join(rootPath, filename);","","    return PathUtil.isInRoot(rootPath, filename);","};","","/**","    Resolve a file in this FS","","    @param {String}","    @return {String}","*/","FS.prototype.resolve = function() {","    var rootPath = this.getRoot();","    var args = Array.prototype.slice.call(arguments);","    var filename = path.join.apply(path, [rootPath].concat(args));","    filename = path.normalize(filename);","","    if (!this.isInScope(filename)) {","        throw error.FileOutOfScopeError({","            filename: filename,","            root: this.root","        });","    }","","    return filename;","};","","/**","    Check if a file exists, run a Promise(true) if that's the case, Promise(false) otherwise","","    @param {String} filename","    @return {Promise<Boolean>}","*/","FS.prototype.exists = function(filename) {","    var that = this;","","    return Promise()","    .then(function() {","        filename = that.resolve(filename);","        var exists = that.get('fsExists');","","        return exists(filename);","    });","};","","/**","    Read a file and returns a promise with the content as a buffer","","    @param {String} filename","    @return {Promise<Buffer>}","*/","FS.prototype.read = function(filename) {","    var that = this;","","    return Promise()","    .then(function() {","        filename = that.resolve(filename);","        var read = that.get('fsReadFile');","","        return read(filename);","    });","};","","/**","    Read a file as a string (utf-8)","","    @param {String} filename","    @return {Promise<String>}","*/","FS.prototype.readAsString = function(filename, encoding) {","    encoding = encoding || 'utf8';","","    return this.read(filename)","    .then(function(buf) {","        return buf.toString(encoding);","    });","};","","/**","    Read file as a stream","","    @param {String} filename","    @return {Promise<Stream>}","*/","FS.prototype.readAsStream = function(filename) {","    var that = this;","    var filepath = that.resolve(filename);","    var fsReadAsStream = this.get('fsReadAsStream');","","    if (fsReadAsStream) {","        return Promise(fsReadAsStream(filepath));","    }","","    return this.read(filename)","    .then(function(buf) {","        var bufferStream = new stream.PassThrough();","        bufferStream.end(buf);","","        return bufferStream;","    });","};","","/**","    Read stat infos about a file","","    @param {String} filename","    @return {Promise<File>}","*/","FS.prototype.statFile = function(filename) {","    var that = this;","","    return Promise()","    .then(function() {","        var filepath = that.resolve(filename);","        var stat = that.get('fsStatFile');","","        return stat(filepath);","    })","    .then(function(stat) {","        return File.createFromStat(filename, stat);","    });","};","","/**","    List files/directories in a directory.","    Directories ends with '/'","","    @param {String} dirname","    @return {Promise<List<String>>}","*/","FS.prototype.readDir = function(dirname) {","    var that = this;","","    return Promise()","    .then(function() {","        var dirpath = that.resolve(dirname);","        var readDir = that.get('fsReadDir');","","        return readDir(dirpath);","    })","    .then(function(files) {","        return Immutable.List(files);","    });","};","","/**","    List only files in a diretcory","    Directories ends with '/'","","    @param {String} dirname","    @return {Promise<List<String>>}","*/","FS.prototype.listFiles = function(dirname) {","    return this.readDir(dirname)","    .then(function(files) {","        return files.filterNot(pathIsFolder);","    });","};","","/**","    List all files in a directory","","    @param {String} dirName","    @param {Function(dirName)} filterFn: call it for each file/directory to test if it should stop iterating","    @return {Promise<List<String>>}","*/","FS.prototype.listAllFiles = function(dirName, filterFn) {","    var that = this;","    dirName = dirName || '.';","","    return this.readDir(dirName)","    .then(function(files) {","        return Promise.reduce(files, function(out, file) {","            var isDirectory = pathIsFolder(file);","            var newDirName = path.join(dirName, file);","","            if (filterFn && filterFn(newDirName) === false) {","                return out;","            }","","            if (!isDirectory) {","                return out.push(newDirName);","            }","","            return that.listAllFiles(newDirName, filterFn)","            .then(function(inner) {","                return out.concat(inner);","            });","        }, Immutable.List());","    });","};","","/**","    Find a file in a folder (case insensitive)","    Return the found filename","","    @param {String} dirname","    @param {String} filename","    @return {Promise<String>}","*/","FS.prototype.findFile = function(dirname, filename) {","    return this.listFiles(dirname)","    .then(function(files) {","        return files.find(function(file) {","            return (file.toLowerCase() == filename.toLowerCase());","        });","    });","};","","/**","    Load a JSON file","    By default, fs only supports JSON","","    @param {String} filename","    @return {Promise<Object>}","*/","FS.prototype.loadAsObject = function(filename) {","    var that = this;","    var fsLoadObject = this.get('fsLoadObject');","","    return this.exists(filename)","    .then(function(exists) {","        if (!exists) {","            var err = new Error('Module doesn\\'t exist');","            err.code = 'MODULE_NOT_FOUND';","","            throw err;","        }","","        if (fsLoadObject) {","            return fsLoadObject(that.resolve(filename));","        } else {","            return that.readAsString(filename)","            .then(function(str) {","                return JSON.parse(str);","            });","        }","    });","};","","/**","    Create a FS instance","","    @param {Object} def","    @return {FS}","*/","FS.create = function create(def) {","    return new FS(def);","};","","/**","    Create a new FS instance with a reduced scope","","    @param {FS} fs","    @param {String} scope","    @return {FS}","*/","FS.reduceScope = function reduceScope(fs, scope) {","    return fs.set('root', path.join(fs.getRoot(), scope));","};","","","// .readdir return files/folder as a list of string, folder ending with '/'","function pathIsFolder(filename) {","    var lastChar = filename[filename.length - 1];","    return lastChar == '/' || lastChar == '\\\\';","}","","module.exports = FS;"],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"7":1,"8":1,"10":1,"27":1,"28":0,"37":1,"38":0,"39":0,"41":0,"50":1,"51":0,"52":0,"53":0,"54":0,"56":0,"57":0,"63":0,"72":1,"73":0,"75":0,"77":0,"78":0,"80":0,"90":1,"91":0,"93":0,"95":0,"96":0,"98":0,"108":1,"109":0,"111":0,"113":0,"123":1,"124":0,"125":0,"126":0,"128":0,"129":0,"132":0,"134":0,"135":0,"137":0,"147":1,"148":0,"150":0,"152":0,"153":0,"155":0,"158":0,"169":1,"170":0,"172":0,"174":0,"175":0,"177":0,"180":0,"191":1,"192":0,"194":0,"205":1,"206":0,"207":0,"209":0,"211":0,"212":0,"213":0,"215":0,"216":0,"219":0,"220":0,"223":0,"225":0,"239":1,"240":0,"242":0,"243":0,"255":1,"256":0,"257":0,"259":0,"261":0,"262":0,"263":0,"265":0,"268":0,"269":0,"271":0,"273":0,"285":1,"286":0,"296":1,"297":0,"302":1,"303":0,"304":0,"307":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/file.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/file.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":0,"9":1,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":1,"17":0,"18":1,"19":0,"20":1,"21":0,"22":1,"23":0,"24":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":14,"loc":{"start":{"line":14,"column":25},"end":{"line":14,"column":36}}},"2":{"name":"(anonymous_2)","line":18,"loc":{"start":{"line":18,"column":26},"end":{"line":18,"column":37}}},"3":{"name":"(anonymous_3)","line":27,"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":35}}},"4":{"name":"(anonymous_4)","line":36,"loc":{"start":{"line":36,"column":25},"end":{"line":36,"column":36}}},"5":{"name":"(anonymous_5)","line":50,"loc":{"start":{"line":50,"column":30},"end":{"line":50,"column":41}}},"6":{"name":"(anonymous_6)","line":59,"loc":{"start":{"line":59,"column":27},"end":{"line":59,"column":38}}},"7":{"name":"createFromStat","line":70,"loc":{"start":{"line":70,"column":22},"end":{"line":70,"column":62}}},"8":{"name":"createWithFilepath","line":83,"loc":{"start":{"line":83,"column":26},"end":{"line":83,"column":64}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":36}},"4":{"start":{"line":6,"column":0},"end":{"line":12,"column":3}},"5":{"start":{"line":14,"column":0},"end":{"line":16,"column":2}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":28}},"7":{"start":{"line":18,"column":0},"end":{"line":20,"column":2}},"8":{"start":{"line":19,"column":4},"end":{"line":19,"column":29}},"9":{"start":{"line":27,"column":0},"end":{"line":29,"column":2}},"10":{"start":{"line":28,"column":4},"end":{"line":28,"column":35}},"11":{"start":{"line":36,"column":0},"end":{"line":43,"column":2}},"12":{"start":{"line":37,"column":4},"end":{"line":37,"column":34}},"13":{"start":{"line":38,"column":4},"end":{"line":42,"column":5}},"14":{"start":{"line":39,"column":8},"end":{"line":39,"column":32}},"15":{"start":{"line":41,"column":8},"end":{"line":41,"column":25}},"16":{"start":{"line":50,"column":0},"end":{"line":52,"column":2}},"17":{"start":{"line":51,"column":4},"end":{"line":51,"column":54}},"18":{"start":{"line":59,"column":0},"end":{"line":61,"column":2}},"19":{"start":{"line":60,"column":4},"end":{"line":60,"column":49}},"20":{"start":{"line":70,"column":0},"end":{"line":75,"column":2}},"21":{"start":{"line":71,"column":4},"end":{"line":74,"column":7}},"22":{"start":{"line":83,"column":0},"end":{"line":87,"column":2}},"23":{"start":{"line":84,"column":4},"end":{"line":86,"column":7}},"24":{"start":{"line":89,"column":0},"end":{"line":89,"column":22}}},"branchMap":{"1":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":4},"end":{"line":38,"column":4}},{"start":{"line":38,"column":4},"end":{"line":38,"column":4}}]}},"code":["var path = require('path');","var Immutable = require('immutable');","","var parsers = require('../parsers');","","var File = Immutable.Record({","    // Path of the file, relative to the FS","    path:       String(),","","    // Time when file data last modified","    mtime:      Date()","});","","File.prototype.getPath = function() {","    return this.get('path');","};","","File.prototype.getMTime = function() {","    return this.get('mtime');","};","","/**","    Does the file exists / is set","","    @return {Boolean}","*/","File.prototype.exists = function() {","    return Boolean(this.getPath());","};","","/**","    Return type of file ('markdown' or 'asciidoc')","","    @return {String}","*/","File.prototype.getType = function() {","    var parser = this.getParser();","    if (parser) {","        return parser.getName();","    } else {","        return undefined;","    }","};","","/**","    Return extension of this file (lowercased)","","    @return {String}","*/","File.prototype.getExtension = function() {","    return path.extname(this.getPath()).toLowerCase();","};","","/**","    Return parser for this file","","    @return {Parser}","*/","File.prototype.getParser = function() {","    return parsers.getByExt(this.getExtension());","};","","/**","    Create a file from stats informations","","    @param {String} filepath","    @param {Object|fs.Stats} stat","    @return {File}","*/","File.createFromStat = function createFromStat(filepath, stat) {","    return new File({","        path: filepath,","        mtime: stat.mtime","    });","};","","/**","    Create a file with only a path","","    @param {String} filepath","    @return {File}","*/","File.createWithFilepath = function createWithFilepath(filepath) {","    return new File({","        path: filepath","    });","};","","module.exports = File;",""],"l":{"1":1,"2":1,"4":1,"6":1,"14":1,"15":0,"18":1,"19":0,"27":1,"28":0,"36":1,"37":0,"38":0,"39":0,"41":0,"50":1,"51":0,"59":1,"60":0,"70":1,"71":0,"83":1,"84":0,"89":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parsers.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parsers.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":1,"13":0,"14":0,"15":1,"16":0,"17":1,"18":2,"19":1},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":2},"fnMap":{"1":{"name":"getParser","line":23,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":25}}},"2":{"name":"(anonymous_2)","line":24,"loc":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}}},"3":{"name":"getParserByExt","line":35,"loc":{"start":{"line":35,"column":0},"end":{"line":35,"column":29}}},"4":{"name":"(anonymous_4)","line":36,"loc":{"start":{"line":36,"column":24},"end":{"line":36,"column":41}}},"5":{"name":"getParserForFile","line":47,"loc":{"start":{"line":47,"column":0},"end":{"line":47,"column":36}}},"6":{"name":"(anonymous_6)","line":53,"loc":{"start":{"line":53,"column":9},"end":{"line":53,"column":26}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":49}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":49}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":62}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":62}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":40}},"8":{"start":{"line":12,"column":0},"end":{"line":15,"column":3}},"9":{"start":{"line":23,"column":0},"end":{"line":27,"column":1}},"10":{"start":{"line":24,"column":4},"end":{"line":26,"column":7}},"11":{"start":{"line":25,"column":8},"end":{"line":25,"column":41}},"12":{"start":{"line":35,"column":0},"end":{"line":39,"column":1}},"13":{"start":{"line":36,"column":4},"end":{"line":38,"column":7}},"14":{"start":{"line":37,"column":8},"end":{"line":37,"column":42}},"15":{"start":{"line":47,"column":0},"end":{"line":49,"column":1}},"16":{"start":{"line":48,"column":4},"end":{"line":48,"column":50}},"17":{"start":{"line":52,"column":0},"end":{"line":56,"column":15}},"18":{"start":{"line":54,"column":8},"end":{"line":54,"column":38}},"19":{"start":{"line":58,"column":0},"end":{"line":63,"column":2}}},"branchMap":{},"code":["var path = require('path');","var Immutable = require('immutable');","","var markdownParser = require('gitbook-markdown');","var asciidocParser = require('gitbook-asciidoc');","","var EXTENSIONS_MARKDOWN = require('./constants/extsMarkdown');","var EXTENSIONS_ASCIIDOC = require('./constants/extsAsciidoc');","var Parser = require('./models/parser');","","// This list is ordered by priority of parsers to use","var parsers = Immutable.List([","    Parser.create('markdown', EXTENSIONS_MARKDOWN, markdownParser),","    Parser.create('asciidoc', EXTENSIONS_ASCIIDOC, asciidocParser)","]);","","/**"," * Return a specific parser by its name"," *"," * @param {String} name"," * @return {Parser|undefined}"," */","function getParser(name) {","    return parsers.find(function(parser) {","        return parser.getName() === name;","    });","}","","/**"," * Return a specific parser according to an extension"," *"," * @param {String} ext"," * @return {Parser|undefined}"," */","function getParserByExt(ext) {","    return parsers.find(function(parser) {","        return parser.matchExtension(ext);","    });","}","","/**"," * Return parser for a file"," *"," * @param {String} ext"," * @return {Parser|undefined}"," */","function getParserForFile(filename) {","    return getParserByExt(path.extname(filename));","}","","// List all parsable extensions","var extensions = parsers","    .map(function(parser) {","        return parser.getExtensions();","    })","    .flatten();","","module.exports = {","    extensions: extensions,","    get: getParser,","    getByExt: getParserByExt,","    getForFile: getParserForFile","};",""],"l":{"1":1,"2":1,"4":1,"5":1,"7":1,"8":1,"9":1,"12":1,"23":1,"24":0,"25":0,"35":1,"36":0,"37":0,"47":1,"48":0,"52":1,"54":2,"58":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-markdown/lib/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-markdown/lib/index.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":41}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":29}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":61}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":43}}},"branchMap":{},"code":["var HTMLParser = require('gitbook-html');","","var toHTML = require('./toHTML');","var toMarkdown = require('./toMarkdown');","var page = require('./page');","","module.exports = HTMLParser.createParser(toHTML, toMarkdown);","","// Add the custom page escaping","module.exports.page.prepare = page.prepare;",""],"l":{"1":1,"3":1,"4":1,"5":1,"7":1,"10":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/index.js","s":{"1":1,"2":1,"3":1,"4":1,"5":18,"6":0,"7":0,"8":0,"9":1,"10":3,"11":1,"12":3,"13":3,"14":3,"15":3,"16":3,"17":3,"18":1,"19":1},"b":{"1":[1,2]},"f":{"1":18,"2":0,"3":3},"fnMap":{"1":{"name":"compose","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":29}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":11},"end":{"line":14,"column":22}}},"3":{"name":"createParser","line":23,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":38}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":26}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"3":{"start":{"line":4,"column":0},"end":{"line":10,"column":2}},"4":{"start":{"line":13,"column":0},"end":{"line":20,"column":1}},"5":{"start":{"line":14,"column":4},"end":{"line":19,"column":5}},"6":{"start":{"line":15,"column":8},"end":{"line":15,"column":40}},"7":{"start":{"line":16,"column":8},"end":{"line":16,"column":34}},"8":{"start":{"line":18,"column":8},"end":{"line":18,"column":36}},"9":{"start":{"line":23,"column":0},"end":{"line":46,"column":1}},"10":{"start":{"line":24,"column":4},"end":{"line":29,"column":5}},"11":{"start":{"line":25,"column":8},"end":{"line":28,"column":10}},"12":{"start":{"line":31,"column":4},"end":{"line":38,"column":6}},"13":{"start":{"line":40,"column":4},"end":{"line":40,"column":37}},"14":{"start":{"line":41,"column":4},"end":{"line":41,"column":43}},"15":{"start":{"line":42,"column":4},"end":{"line":42,"column":39}},"16":{"start":{"line":43,"column":4},"end":{"line":43,"column":45}},"17":{"start":{"line":45,"column":4},"end":{"line":45,"column":18}},"18":{"start":{"line":48,"column":0},"end":{"line":48,"column":42}},"19":{"start":{"line":49,"column":0},"end":{"line":49,"column":43}}},"branchMap":{"1":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":4}},{"start":{"line":24,"column":4},"end":{"line":24,"column":4}}]}},"code":["var _ = require('lodash');","var ToText = require('./totext');","","var htmlParser = {","    summary: require('./summary'),","    glossary: require('./glossary'),","    langs: require('./langs'),","    readme: require('./readme'),","    page: require('./page')","};","","// Compose a function with a transform function for the first argument only","function compose(toHTML, fn) {","    return function() {","        var args = _.toArray(arguments);","        args[0] = toHTML(args[0]);","","        return fn.apply(null, args);","    }","}","","// Create a GitBook parser from an HTML converter","function createParser(toHTML, toText) {","    if (_.isFunction(toHTML)) {","        toHTML = {","            inline: toHTML,","            block: toHTML","        };","    }","","    var parser = {","        summary: compose(toHTML.block, htmlParser.summary),","        glossary: compose(toHTML.block, htmlParser.glossary),","        langs: compose(toHTML.block, htmlParser.langs),","        readme: compose(toHTML.block, htmlParser.readme),","        page: compose(toHTML.block, htmlParser.page),","        inline: compose(toHTML.inline, htmlParser.page)","    };","","    var _toText = new ToText(toText);","    parser.summary.toText =_toText.summary;","    parser.langs.toText =_toText.langs;","    parser.glossary.toText =_toText.glossary;","","    return parser;","}","","module.exports = createParser(_.identity);","module.exports.createParser = createParser;",""],"l":{"1":1,"2":1,"4":1,"13":1,"14":18,"15":0,"16":0,"18":0,"23":1,"24":3,"25":1,"31":3,"40":3,"41":3,"42":3,"43":3,"45":3,"48":1,"49":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/totext.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/totext.js","s":{"1":1,"2":1,"3":3,"4":0,"5":3,"6":3,"7":1,"8":0,"9":1,"10":0,"11":1,"12":0,"13":1,"14":0,"15":1,"16":0,"17":1,"18":0,"19":1,"20":0,"21":1,"22":0,"23":1,"24":0,"25":1,"26":0,"27":1,"28":0,"29":1,"30":0,"31":1,"32":0,"33":1,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":1,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":1,"76":0,"77":0,"78":0,"79":0,"80":0,"81":1,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":1,"94":0,"95":1},"b":{"1":[0,3],"2":[3,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":3,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},"fnMap":{"1":{"name":"ToText","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":24}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":24},"end":{"line":19,"column":35}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":26},"end":{"line":23,"column":41}}},"4":{"name":"(anonymous_4)","line":27,"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":35}}},"5":{"name":"(anonymous_5)","line":33,"loc":{"start":{"line":33,"column":32},"end":{"line":33,"column":48}}},"6":{"name":"(anonymous_6)","line":36,"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":46}}},"7":{"name":"(anonymous_7)","line":41,"loc":{"start":{"line":41,"column":36},"end":{"line":41,"column":47}}},"8":{"name":"(anonymous_8)","line":44,"loc":{"start":{"line":44,"column":34},"end":{"line":44,"column":45}}},"9":{"name":"(anonymous_9)","line":49,"loc":{"start":{"line":49,"column":29},"end":{"line":49,"column":40}}},"10":{"name":"(anonymous_10)","line":54,"loc":{"start":{"line":54,"column":31},"end":{"line":54,"column":46}}},"11":{"name":"(anonymous_11)","line":57,"loc":{"start":{"line":57,"column":29},"end":{"line":57,"column":44}}},"12":{"name":"(anonymous_12)","line":62,"loc":{"start":{"line":62,"column":35},"end":{"line":62,"column":51}}},"13":{"name":"(anonymous_13)","line":65,"loc":{"start":{"line":65,"column":33},"end":{"line":65,"column":49}}},"14":{"name":"(anonymous_14)","line":68,"loc":{"start":{"line":68,"column":31},"end":{"line":68,"column":47}}},"15":{"name":"(anonymous_15)","line":71,"loc":{"start":{"line":71,"column":29},"end":{"line":71,"column":45}}},"16":{"name":"(anonymous_16)","line":77,"loc":{"start":{"line":77,"column":25},"end":{"line":77,"column":45}}},"17":{"name":"(anonymous_17)","line":89,"loc":{"start":{"line":89,"column":28},"end":{"line":89,"column":47}}},"18":{"name":"(anonymous_18)","line":96,"loc":{"start":{"line":96,"column":21},"end":{"line":96,"column":37}}},"19":{"name":"(anonymous_19)","line":109,"loc":{"start":{"line":109,"column":35},"end":{"line":109,"column":60}}},"20":{"name":"(anonymous_20)","line":127,"loc":{"start":{"line":127,"column":36},"end":{"line":127,"column":62}}},"21":{"name":"(anonymous_21)","line":134,"loc":{"start":{"line":134,"column":21},"end":{"line":134,"column":39}}},"22":{"name":"(anonymous_22)","line":141,"loc":{"start":{"line":141,"column":32},"end":{"line":141,"column":47}}},"23":{"name":"(anonymous_23)","line":151,"loc":{"start":{"line":151,"column":27},"end":{"line":151,"column":45}}},"24":{"name":"(anonymous_24)","line":158,"loc":{"start":{"line":158,"column":26},"end":{"line":158,"column":44}}},"25":{"name":"(anonymous_25)","line":176,"loc":{"start":{"line":176,"column":28},"end":{"line":176,"column":43}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":26}},"2":{"start":{"line":9,"column":0},"end":{"line":16,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":12,"column":5}},"4":{"start":{"line":11,"column":8},"end":{"line":11,"column":34}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":33}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":41}},"7":{"start":{"line":19,"column":0},"end":{"line":21,"column":2}},"8":{"start":{"line":20,"column":4},"end":{"line":20,"column":16}},"9":{"start":{"line":23,"column":0},"end":{"line":25,"column":2}},"10":{"start":{"line":24,"column":4},"end":{"line":24,"column":16}},"11":{"start":{"line":27,"column":0},"end":{"line":29,"column":2}},"12":{"start":{"line":28,"column":4},"end":{"line":28,"column":20}},"13":{"start":{"line":33,"column":0},"end":{"line":35,"column":2}},"14":{"start":{"line":34,"column":4},"end":{"line":34,"column":26}},"15":{"start":{"line":36,"column":0},"end":{"line":38,"column":2}},"16":{"start":{"line":37,"column":4},"end":{"line":37,"column":27}},"17":{"start":{"line":41,"column":0},"end":{"line":43,"column":2}},"18":{"start":{"line":42,"column":4},"end":{"line":42,"column":17}},"19":{"start":{"line":44,"column":0},"end":{"line":46,"column":2}},"20":{"start":{"line":45,"column":4},"end":{"line":45,"column":18}},"21":{"start":{"line":49,"column":0},"end":{"line":51,"column":2}},"22":{"start":{"line":50,"column":4},"end":{"line":50,"column":23}},"23":{"start":{"line":54,"column":0},"end":{"line":56,"column":2}},"24":{"start":{"line":55,"column":4},"end":{"line":55,"column":37}},"25":{"start":{"line":57,"column":0},"end":{"line":59,"column":2}},"26":{"start":{"line":58,"column":4},"end":{"line":58,"column":18}},"27":{"start":{"line":62,"column":0},"end":{"line":64,"column":2}},"28":{"start":{"line":63,"column":4},"end":{"line":63,"column":50}},"29":{"start":{"line":65,"column":0},"end":{"line":67,"column":2}},"30":{"start":{"line":66,"column":4},"end":{"line":66,"column":65}},"31":{"start":{"line":68,"column":0},"end":{"line":70,"column":2}},"32":{"start":{"line":69,"column":4},"end":{"line":69,"column":58}},"33":{"start":{"line":71,"column":0},"end":{"line":73,"column":2}},"34":{"start":{"line":72,"column":4},"end":{"line":72,"column":59}},"35":{"start":{"line":77,"column":0},"end":{"line":85,"column":2}},"36":{"start":{"line":78,"column":4},"end":{"line":78,"column":21}},"37":{"start":{"line":79,"column":4},"end":{"line":79,"column":84}},"38":{"start":{"line":80,"column":4},"end":{"line":80,"column":32}},"39":{"start":{"line":82,"column":4},"end":{"line":82,"column":48}},"40":{"start":{"line":84,"column":4},"end":{"line":84,"column":19}},"41":{"start":{"line":89,"column":0},"end":{"line":105,"column":2}},"42":{"start":{"line":90,"column":4},"end":{"line":90,"column":20}},"43":{"start":{"line":91,"column":4},"end":{"line":91,"column":21}},"44":{"start":{"line":93,"column":4},"end":{"line":93,"column":83}},"45":{"start":{"line":94,"column":4},"end":{"line":94,"column":32}},"46":{"start":{"line":96,"column":4},"end":{"line":102,"column":7}},"47":{"start":{"line":97,"column":8},"end":{"line":97,"column":87}},"48":{"start":{"line":98,"column":8},"end":{"line":98,"column":43}},"49":{"start":{"line":99,"column":8},"end":{"line":99,"column":50}},"50":{"start":{"line":100,"column":8},"end":{"line":100,"column":41}},"51":{"start":{"line":101,"column":8},"end":{"line":101,"column":36}},"52":{"start":{"line":104,"column":4},"end":{"line":104,"column":19}},"53":{"start":{"line":109,"column":0},"end":{"line":126,"column":2}},"54":{"start":{"line":110,"column":4},"end":{"line":110,"column":21}},"55":{"start":{"line":112,"column":4},"end":{"line":112,"column":43}},"56":{"start":{"line":114,"column":4},"end":{"line":114,"column":61}},"57":{"start":{"line":114,"column":21},"end":{"line":114,"column":61}},"58":{"start":{"line":115,"column":4},"end":{"line":115,"column":41}},"59":{"start":{"line":116,"column":4},"end":{"line":116,"column":60}},"60":{"start":{"line":116,"column":21},"end":{"line":116,"column":60}},"61":{"start":{"line":117,"column":4},"end":{"line":117,"column":27}},"62":{"start":{"line":119,"column":4},"end":{"line":121,"column":5}},"63":{"start":{"line":120,"column":8},"end":{"line":120,"column":70}},"64":{"start":{"line":123,"column":4},"end":{"line":123,"column":41}},"65":{"start":{"line":125,"column":4},"end":{"line":125,"column":19}},"66":{"start":{"line":127,"column":0},"end":{"line":140,"column":2}},"67":{"start":{"line":128,"column":4},"end":{"line":128,"column":20}},"68":{"start":{"line":129,"column":4},"end":{"line":129,"column":21}},"69":{"start":{"line":131,"column":4},"end":{"line":131,"column":23}},"70":{"start":{"line":133,"column":4},"end":{"line":133,"column":39}},"71":{"start":{"line":134,"column":4},"end":{"line":136,"column":7}},"72":{"start":{"line":135,"column":8},"end":{"line":135,"column":56}},"73":{"start":{"line":137,"column":4},"end":{"line":137,"column":37}},"74":{"start":{"line":139,"column":4},"end":{"line":139,"column":19}},"75":{"start":{"line":141,"column":0},"end":{"line":149,"column":2}},"76":{"start":{"line":142,"column":4},"end":{"line":142,"column":21}},"77":{"start":{"line":144,"column":4},"end":{"line":144,"column":99}},"78":{"start":{"line":144,"column":20},"end":{"line":144,"column":99}},"79":{"start":{"line":146,"column":4},"end":{"line":146,"column":52}},"80":{"start":{"line":148,"column":4},"end":{"line":148,"column":19}},"81":{"start":{"line":151,"column":0},"end":{"line":172,"column":2}},"82":{"start":{"line":152,"column":4},"end":{"line":152,"column":20}},"83":{"start":{"line":153,"column":4},"end":{"line":153,"column":21}},"84":{"start":{"line":155,"column":4},"end":{"line":155,"column":82}},"85":{"start":{"line":156,"column":4},"end":{"line":156,"column":32}},"86":{"start":{"line":158,"column":4},"end":{"line":169,"column":7}},"87":{"start":{"line":159,"column":8},"end":{"line":159,"column":40}},"88":{"start":{"line":161,"column":8},"end":{"line":161,"column":43}},"89":{"start":{"line":163,"column":8},"end":{"line":167,"column":9}},"90":{"start":{"line":164,"column":12},"end":{"line":164,"column":63}},"91":{"start":{"line":166,"column":12},"end":{"line":166,"column":40}},"92":{"start":{"line":171,"column":4},"end":{"line":171,"column":19}},"93":{"start":{"line":176,"column":0},"end":{"line":178,"column":1}},"94":{"start":{"line":177,"column":4},"end":{"line":177,"column":39}},"95":{"start":{"line":180,"column":0},"end":{"line":180,"column":24}}},"branchMap":{"1":{"line":10,"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":4}},{"start":{"line":10,"column":4},"end":{"line":10,"column":4}}]},"2":{"line":14,"type":"binary-expr","locations":[{"start":{"line":14,"column":19},"end":{"line":14,"column":25}},{"start":{"line":14,"column":29},"end":{"line":14,"column":31}}]},"3":{"line":114,"type":"if","locations":[{"start":{"line":114,"column":4},"end":{"line":114,"column":4}},{"start":{"line":114,"column":4},"end":{"line":114,"column":4}}]},"4":{"line":116,"type":"if","locations":[{"start":{"line":116,"column":4},"end":{"line":116,"column":4}},{"start":{"line":116,"column":4},"end":{"line":116,"column":4}}]},"5":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":4},"end":{"line":119,"column":4}},{"start":{"line":119,"column":4},"end":{"line":119,"column":4}}]},"6":{"line":119,"type":"binary-expr","locations":[{"start":{"line":119,"column":8},"end":{"line":119,"column":24}},{"start":{"line":119,"column":28},"end":{"line":119,"column":55}}]},"7":{"line":131,"type":"binary-expr","locations":[{"start":{"line":131,"column":12},"end":{"line":131,"column":17}},{"start":{"line":131,"column":21},"end":{"line":131,"column":22}}]},"8":{"line":144,"type":"if","locations":[{"start":{"line":144,"column":4},"end":{"line":144,"column":4}},{"start":{"line":144,"column":4},"end":{"line":144,"column":4}}]},"9":{"line":163,"type":"if","locations":[{"start":{"line":163,"column":8},"end":{"line":163,"column":8}},{"start":{"line":163,"column":8},"end":{"line":163,"column":8}}]},"10":{"line":163,"type":"binary-expr","locations":[{"start":{"line":163,"column":12},"end":{"line":163,"column":16}},{"start":{"line":163,"column":20},"end":{"line":163,"column":31}}]},"11":{"line":177,"type":"binary-expr","locations":[{"start":{"line":177,"column":29},"end":{"line":177,"column":30}},{"start":{"line":177,"column":34},"end":{"line":177,"column":37}}]}},"code":["var _ = require('lodash');","","/*","    This class is extended by gitbook-markdown and gitbook-asciidoc","    to generate back markdown/asciidoc from GitBook metadata.","*/","","","function ToText(markup) {","    if (!(this instanceof ToText)) {","        return new ToText(markup);","    }","","    _.extend(this, markup || {});","    _.bindAll(this, _.functionsIn(this));","};","","// Break line","ToText.prototype.onBL = function() {","    return '\\n';","};","","ToText.prototype.onText = function(text) {","    return text;","};","","ToText.prototype.onHR = function() {","    return '<hr />';","};","","// ---- TITLES","","ToText.prototype.onTitleStart = function(level) {","    return '<h'+level+'>';","};","ToText.prototype.onTitleEnd = function(level) {","    return '</h'+level+'>';","};","","// ---- PARAGRAPHS / SECTIONS","ToText.prototype.onParagraphStart = function() {","    return '<p>';","};","ToText.prototype.onParagraphEnd = function() {","    return '</p>';","};","","","ToText.prototype.onSection = function() {","    return this.onBL();","};","","// ---- LINKS","ToText.prototype.onLinkStart = function(href) {","    return '<a href=\"' + href + '\">';","};","ToText.prototype.onLinkEnd = function(href) {","    return '</a>';","};","","// ---- LISTS","ToText.prototype.onListItemStart = function(level) {","    return this._spaces((level + 1) * 4) + '<li>';","};","ToText.prototype.onListItemEnd = function(level) {","    return this._spaces((level + 1) * 4) + '</li>' + this.onBL();","};","ToText.prototype.onListStart = function(level) {","    return this._spaces(level * 4) + '<ul>' + this.onBL();","};","ToText.prototype.onListEnd = function(level) {","    return this._spaces(level * 4) + '</ul>' + this.onBL();","};","","// ------ LANGS","","ToText.prototype.langs = function(languages) {","    var content = '';","    content += this.onTitleStart(1) + this.onText('Languages') + this.onTitleEnd(1);","    content += this.onSection();","","    content += this._summaryArticles(languages);","","    return content;","};","","// ------ GLOSSARY","","ToText.prototype.glossary = function(glossary) {","    var that = this;","    var content = '';","","    content += that.onTitleStart(1) + that.onText('Glossary') + that.onTitleEnd(1);","    content += that.onSection();","","    _.each(glossary, function(entry) {","        content += that.onTitleStart(2) + that.onText(entry.name) + that.onTitleEnd(2);","        content += that.onParagraphStart();","        content += that.onText(entry.description);","        content += that.onParagraphEnd();","        content += that.onSection();","    });","","    return content;","};","","// ------ SUMMARY","","ToText.prototype._summaryArticle = function(article, level) {","    var content = '';","","    content += this.onListItemStart(level);","","    if (article.ref) content += this.onLinkStart(article.ref)","    content += this.onText(article.title)","    if (article.ref) content += this.onLinkEnd(article.ref);","    content += this.onBL();","","    if (article.articles && article.articles.length > 0) {","        content += this._summaryArticles(article.articles, level + 1);","    }","","    content += this.onListItemEnd(level);","","    return content;","};","ToText.prototype._summaryArticles = function(articles, level) {","    var that = this;","    var content = '';","","    level = level || 0;","","    content += that.onListStart(level);","    _.each(articles, function(article) {","        content += that._summaryArticle(article, level);","    });","    content += that.onListEnd(level);","","    return content;","};","ToText.prototype._summaryPart = function(part) {","    var content = '';","","    if (part.title) content += this.onTitleStart(2) + this.onText(part.title) + this.onTitleEnd(2);","","    content += this._summaryArticles(part.articles);","","    return content;","};","","ToText.prototype.summary = function(summary) {","    var that = this;","    var content = '';","","    content += that.onTitleStart(1) + that.onText('Summary') + that.onTitleEnd(1);","    content += that.onSection();","","    _.each(summary.parts, function(part, i) {","        var next = summary.parts[i + 1];","","        content += that._summaryPart(part);","","        if (next && !next.title) {","            content += that.onBL() + that.onHR() + that.onBL();","        } else {","            content += that.onSection();","        }","","    });","","    return content;","};","","// ---- Utilities","","ToText.prototype._spaces =  function(n, s) {","    return Array(n + 1).join(s || ' ');","}","","module.exports = ToText;","",""],"l":{"1":1,"9":1,"10":3,"11":0,"14":3,"15":3,"19":1,"20":0,"23":1,"24":0,"27":1,"28":0,"33":1,"34":0,"36":1,"37":0,"41":1,"42":0,"44":1,"45":0,"49":1,"50":0,"54":1,"55":0,"57":1,"58":0,"62":1,"63":0,"65":1,"66":0,"68":1,"69":0,"71":1,"72":0,"77":1,"78":0,"79":0,"80":0,"82":0,"84":0,"89":1,"90":0,"91":0,"93":0,"94":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"104":0,"109":1,"110":0,"112":0,"114":0,"115":0,"116":0,"117":0,"119":0,"120":0,"123":0,"125":0,"127":1,"128":0,"129":0,"131":0,"133":0,"134":0,"135":0,"137":0,"139":0,"141":1,"142":0,"144":0,"146":0,"148":0,"151":1,"152":0,"153":0,"155":0,"156":0,"158":0,"159":0,"161":0,"163":0,"164":0,"166":0,"171":0,"176":1,"177":0,"180":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/summary.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/summary.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":0,"48":1,"49":0,"50":1,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"findList","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":27}}},"2":{"name":"parseList","line":30,"loc":{"start":{"line":30,"column":0},"end":{"line":30,"column":27}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":28},"end":{"line":33,"column":39}}},"4":{"name":"findParts","line":66,"loc":{"start":{"line":66,"column":0},"end":{"line":66,"column":31}}},"5":{"name":"(anonymous_5)","line":75,"loc":{"start":{"line":75,"column":23},"end":{"line":75,"column":40}}},"6":{"name":"isPartNode","line":114,"loc":{"start":{"line":114,"column":0},"end":{"line":114,"column":24}}},"7":{"name":"getPartTitle","line":125,"loc":{"start":{"line":125,"column":0},"end":{"line":125,"column":29}}},"8":{"name":"parseSummary","line":135,"loc":{"start":{"line":135,"column":0},"end":{"line":135,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":26}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":29}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":33}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":33}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":14}},"7":{"start":{"line":16,"column":0},"end":{"line":21,"column":1}},"8":{"start":{"line":17,"column":4},"end":{"line":17,"column":48}},"9":{"start":{"line":18,"column":4},"end":{"line":18,"column":60}},"10":{"start":{"line":18,"column":31},"end":{"line":18,"column":60}},"11":{"start":{"line":20,"column":4},"end":{"line":20,"column":43}},"12":{"start":{"line":30,"column":0},"end":{"line":57,"column":1}},"13":{"start":{"line":31,"column":4},"end":{"line":31,"column":22}},"14":{"start":{"line":33,"column":4},"end":{"line":54,"column":7}},"15":{"start":{"line":34,"column":8},"end":{"line":34,"column":25}},"16":{"start":{"line":35,"column":8},"end":{"line":35,"column":26}},"17":{"start":{"line":38,"column":8},"end":{"line":38,"column":35}},"18":{"start":{"line":39,"column":8},"end":{"line":39,"column":72}},"19":{"start":{"line":42,"column":8},"end":{"line":42,"column":41}},"20":{"start":{"line":43,"column":8},"end":{"line":46,"column":9}},"21":{"start":{"line":44,"column":12},"end":{"line":44,"column":46}},"22":{"start":{"line":45,"column":12},"end":{"line":45,"column":82}},"23":{"start":{"line":49,"column":8},"end":{"line":49,"column":33}},"24":{"start":{"line":50,"column":8},"end":{"line":50,"column":46}},"25":{"start":{"line":52,"column":8},"end":{"line":52,"column":35}},"26":{"start":{"line":52,"column":28},"end":{"line":52,"column":35}},"27":{"start":{"line":53,"column":8},"end":{"line":53,"column":31}},"28":{"start":{"line":56,"column":4},"end":{"line":56,"column":20}},"29":{"start":{"line":66,"column":0},"end":{"line":106,"column":1}},"30":{"start":{"line":69,"column":4},"end":{"line":69,"column":79}},"31":{"start":{"line":72,"column":4},"end":{"line":72,"column":19}},"32":{"start":{"line":73,"column":4},"end":{"line":73,"column":28}},"33":{"start":{"line":75,"column":4},"end":{"line":98,"column":7}},"34":{"start":{"line":76,"column":8},"end":{"line":97,"column":9}},"35":{"start":{"line":77,"column":12},"end":{"line":80,"column":13}},"36":{"start":{"line":79,"column":16},"end":{"line":79,"column":41}},"37":{"start":{"line":81,"column":12},"end":{"line":84,"column":14}},"38":{"start":{"line":87,"column":12},"end":{"line":94,"column":13}},"39":{"start":{"line":88,"column":16},"end":{"line":88,"column":39}},"40":{"start":{"line":90,"column":16},"end":{"line":93,"column":18}},"41":{"start":{"line":95,"column":12},"end":{"line":95,"column":37}},"42":{"start":{"line":96,"column":12},"end":{"line":96,"column":32}},"43":{"start":{"line":101,"column":4},"end":{"line":103,"column":5}},"44":{"start":{"line":102,"column":8},"end":{"line":102,"column":33}},"45":{"start":{"line":105,"column":4},"end":{"line":105,"column":17}},"46":{"start":{"line":114,"column":0},"end":{"line":116,"column":1}},"47":{"start":{"line":115,"column":4},"end":{"line":115,"column":49}},"48":{"start":{"line":125,"column":0},"end":{"line":127,"column":1}},"49":{"start":{"line":126,"column":4},"end":{"line":126,"column":31}},"50":{"start":{"line":135,"column":0},"end":{"line":155,"column":1}},"51":{"start":{"line":136,"column":4},"end":{"line":136,"column":28}},"52":{"start":{"line":137,"column":4},"end":{"line":137,"column":44}},"53":{"start":{"line":139,"column":4},"end":{"line":139,"column":36}},"54":{"start":{"line":142,"column":4},"end":{"line":142,"column":25}},"55":{"start":{"line":143,"column":4},"end":{"line":143,"column":13}},"56":{"start":{"line":144,"column":4},"end":{"line":150,"column":5}},"57":{"start":{"line":145,"column":8},"end":{"line":145,"column":24}},"58":{"start":{"line":146,"column":8},"end":{"line":149,"column":11}},"59":{"start":{"line":152,"column":4},"end":{"line":154,"column":6}},"60":{"start":{"line":157,"column":0},"end":{"line":157,"column":30}}},"branchMap":{"1":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":18,"column":4}},{"start":{"line":18,"column":4},"end":{"line":18,"column":4}}]},"2":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":25},"end":{"line":39,"column":34}},{"start":{"line":39,"column":39},"end":{"line":39,"column":63}}]},"3":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":8},"end":{"line":43,"column":8}},{"start":{"line":43,"column":8},"end":{"line":43,"column":8}}]},"4":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":8},"end":{"line":52,"column":8}},{"start":{"line":52,"column":8},"end":{"line":52,"column":8}}]},"5":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":8},"end":{"line":76,"column":8}},{"start":{"line":76,"column":8},"end":{"line":76,"column":8}}]},"6":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":12},"end":{"line":77,"column":12}},{"start":{"line":77,"column":12},"end":{"line":77,"column":12}}]},"7":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":12},"end":{"line":87,"column":12}},{"start":{"line":87,"column":12},"end":{"line":87,"column":12}}]},"8":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":4},"end":{"line":101,"column":4}},{"start":{"line":101,"column":4},"end":{"line":101,"column":4}}]}},"code":["var _ = require('lodash');","var dom = require('./dom');","","var SELECTOR_LIST = 'ol, ul';","var SELECTOR_LINK = '> a, p > a';","var SELECTOR_PART = 'h2, h3, h4';","","var BL = '\\n';","","/**","    Find a list","","    @param {cheerio.Node}","    @return {cheerio.Node}","*/","function findList($parent) {","    var $container = $parent.children('.olist');","    if ($container.length > 0) $parent = $container.first();","","    return $parent.children(SELECTOR_LIST);","}","","/**","    Parse a ul list and return list of chapters recursvely","","    @param {cheerio.Node}","    @param {cheerio.DOM}","    @return {Array}","*/","function parseList($ul, $) {","    var articles = [];","","    $ul.children('li').each(function() {","        var article = {};","        var $li = $(this);","","        // Get text for the entry","        var $p = $li.children('p');","        article.title = ($p.text() ||  dom.textNode($li.get(0))).trim();","","        // Parse link","        var $a = $li.find(SELECTOR_LINK);","        if ($a.length > 0) {","            article.title = $a.first().text();","            article.ref = $a.attr('href').replace(/\\\\/g, '/').replace(/^\\/+/, '');","        }","","        // Sub articles","        var $sub = findList($li);","        article.articles = parseList($sub, $);","","        if (!article.title) return;","        articles.push(article);","    });","","    return articles;","}","","/**","     Find all parts and their corresponding lists","","     @param {cheerio.Node}","     @param {cheerio.DOM}","     @return {Array<{title: String, list: cheerio.Node}>}"," */","function findParts($parent, $) {","    // Find parts and lists","    // TODO asciidoc compatibility","    var partsAndLists = $parent.children(SELECTOR_LIST + ', ' + SELECTOR_PART);","","    // Group each part with the list after","    var parts = [];","    var previousPart = null;","","    partsAndLists.each(function (i, el) {","        if (isPartNode(el)) {","            if (previousPart !== null) {","                // The previous part was empty","                parts.push(previousPart);","            }","            previousPart = {","                title: getPartTitle(el, $),","                list: null","            };","","        } else { // It is a list","            if (previousPart !== null) {","                previousPart.list = el;","            } else {","                previousPart = {","                    title: '',","                    list: el","                };","            }","            parts.push(previousPart);","            previousPart = null;","        }","    });","","    // Last part might be empty","    if (previousPart !== null) {","        parts.push(previousPart);","    }","","    return parts;","}","","/**","    True if the element is a part","","    @param el","    @return {Boolean}"," */","function isPartNode(el) {","    return SELECTOR_PART.indexOf(el.name) !== -1;","}","","/**","    Parse the title of a part element","","    @param el","    @param {cheerio.DOM} $","    @return {String}"," */","function getPartTitle(el, $) {","    return $(el).text().trim();","}","","/**","    Parse an HTML content into a tree of articles/parts","","    @param {String} html","    @return {Object}","*/","function parseSummary(html) {","    var $ = dom.parse(html);","    var $root = dom.cleanup(dom.root($), $);","","    var parts = findParts($root, $);","","    // Parse each list","    var parsedParts = [];","    var part;","    for (var i = 0; i < parts.length; ++i) {","        part = parts[i];","        parsedParts.push({","            title: part.title,","            articles: parseList($(part.list), $)","        });","    }","","    return {","        parts: parsedParts","    };","}","","module.exports = parseSummary;",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"8":1,"16":1,"17":0,"18":0,"20":0,"30":1,"31":0,"33":0,"34":0,"35":0,"38":0,"39":0,"42":0,"43":0,"44":0,"45":0,"49":0,"50":0,"52":0,"53":0,"56":0,"66":1,"69":0,"72":0,"73":0,"75":0,"76":0,"77":0,"79":0,"81":0,"87":0,"88":0,"90":0,"95":0,"96":0,"101":0,"102":0,"105":0,"114":1,"115":0,"125":1,"126":0,"135":1,"136":0,"137":0,"139":0,"142":0,"143":0,"144":0,"145":0,"146":0,"152":0,"157":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/dom.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/dom.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":1,"8":0,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"parse","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":21}}},"2":{"name":"root","line":23,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":17}}},"3":{"name":"textNode","line":34,"loc":{"start":{"line":34,"column":0},"end":{"line":34,"column":23}}},"4":{"name":"(anonymous_4)","line":35,"loc":{"start":{"line":35,"column":34},"end":{"line":35,"column":52}}},"5":{"name":"cleanup","line":48,"loc":{"start":{"line":48,"column":0},"end":{"line":48,"column":25}}},"6":{"name":"(anonymous_6)","line":49,"loc":{"start":{"line":49,"column":25},"end":{"line":49,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":26}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"3":{"start":{"line":10,"column":0},"end":{"line":15,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":31}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":38}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":35}},"7":{"start":{"line":23,"column":0},"end":{"line":26,"column":1}},"8":{"start":{"line":24,"column":4},"end":{"line":24,"column":45}},"9":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"10":{"start":{"line":34,"column":0},"end":{"line":39,"column":1}},"11":{"start":{"line":35,"column":4},"end":{"line":38,"column":11}},"12":{"start":{"line":36,"column":8},"end":{"line":36,"column":45}},"13":{"start":{"line":36,"column":30},"end":{"line":36,"column":45}},"14":{"start":{"line":37,"column":8},"end":{"line":37,"column":20}},"15":{"start":{"line":48,"column":0},"end":{"line":57,"column":1}},"16":{"start":{"line":49,"column":4},"end":{"line":54,"column":7}},"17":{"start":{"line":50,"column":8},"end":{"line":50,"column":27}},"18":{"start":{"line":51,"column":8},"end":{"line":51,"column":25}},"19":{"start":{"line":53,"column":8},"end":{"line":53,"column":38}},"20":{"start":{"line":56,"column":4},"end":{"line":56,"column":15}},"21":{"start":{"line":59,"column":0},"end":{"line":64,"column":2}}},"branchMap":{"1":{"line":14,"type":"cond-expr","locations":[{"start":{"line":14,"column":27},"end":{"line":14,"column":30}},{"start":{"line":14,"column":33},"end":{"line":14,"column":34}}]},"2":{"line":25,"type":"cond-expr","locations":[{"start":{"line":25,"column":27},"end":{"line":25,"column":30}},{"start":{"line":25,"column":33},"end":{"line":25,"column":41}}]},"3":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":8},"end":{"line":36,"column":8}},{"start":{"line":36,"column":8},"end":{"line":36,"column":8}}]}},"code":["var _ = require('lodash');","var cheerio = require('cheerio');","","/**","    Parse an HTML string and return its content","","    @param {String}","    @return {cheerio.DOM}","*/","function parse(html) {","    var $ = cheerio.load(html);","    var $el = $('html, body').first();","","    return $el.length > 0? $el : $;","}","","/**","    Return main element for a DOM","","    @param {cheerio.DOM}","    @return {cheerio.Node}","*/","function root($) {","    var $el = $('html, body, > div').first();","    return $el.length > 0? $el : $.root();","}","","/**","    Return text node of an element","","    @param {cheerio.Node}","    @return {String}","*/","function textNode($el) {","    return _.reduce($el.children, function(text, e) {","        if (e.type == 'text') text += e.data;","        return text;","    }, '');","}","","/**","    Cleanup a DOM by removing all useless divs","","    @param {cheerio.Node}","    @param {cheerio.DOM}","    @return {cheerio.Node}","*/","function cleanup($el, $) {","    $el.find('div').each(function() {","        var $div = $(this);","        cleanup($div, $);","","        $div.replaceWith($div.html());","    });","","    return $el;","}","","module.exports = {","    parse: parse,","    textNode: textNode,","    root: root,","    cleanup: cleanup","};",""],"l":{"1":1,"2":1,"10":1,"11":0,"12":0,"14":0,"23":1,"24":0,"25":0,"34":1,"35":0,"36":0,"37":0,"48":1,"49":0,"50":0,"51":0,"53":0,"56":0,"59":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/glossary.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/glossary.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"parseGlossary","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":29}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":17},"end":{"line":15,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":26}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":10,"column":0},"end":{"line":29,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":28}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":21}},"6":{"start":{"line":15,"column":4},"end":{"line":26,"column":7}},"7":{"start":{"line":16,"column":8},"end":{"line":16,"column":31}},"8":{"start":{"line":17,"column":8},"end":{"line":17,"column":35}},"9":{"start":{"line":18,"column":8},"end":{"line":18,"column":73}},"10":{"start":{"line":20,"column":8},"end":{"line":20,"column":23}},"11":{"start":{"line":22,"column":8},"end":{"line":22,"column":37}},"12":{"start":{"line":23,"column":8},"end":{"line":23,"column":38}},"13":{"start":{"line":25,"column":8},"end":{"line":25,"column":28}},"14":{"start":{"line":28,"column":4},"end":{"line":28,"column":19}},"15":{"start":{"line":31,"column":0},"end":{"line":31,"column":31}}},"branchMap":{"1":{"line":18,"type":"cond-expr","locations":[{"start":{"line":18,"column":33},"end":{"line":18,"column":46}},{"start":{"line":18,"column":49},"end":{"line":18,"column":72}}]}},"code":["var _ = require('lodash');","var dom = require('./dom');","","/**","    Parse an HTML content into a list of glossary entry","","    @param {String} html","    @return {Array}","*/","function parseGlossary(html) {","    var $ = dom.parse(html);","","    var entries = [];","","    $('h2').each(function() {","        var $heading = $(this);","        var $next = $heading.next()","        var $p =  $next.is('p')? $next.first() : $next.find('p').first();","","        var entry = {};","","        entry.name = $heading.text();","        entry.description = $p.text();","","        entries.push(entry);","    });","","    return entries;","}","","module.exports = parseGlossary;",""],"l":{"1":1,"2":1,"10":1,"11":0,"13":0,"15":0,"16":0,"17":0,"18":0,"20":0,"22":0,"23":0,"25":0,"28":0,"31":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/langs.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/langs.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":1},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"parseLangs","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":29}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":26}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":40}},"3":{"start":{"line":10,"column":0},"end":{"line":17,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":44}},"5":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"6":{"start":{"line":13,"column":8},"end":{"line":13,"column":33}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":14}},"8":{"start":{"line":19,"column":0},"end":{"line":19,"column":28}}},"branchMap":{"1":{"line":12,"type":"if","locations":[{"start":{"line":12,"column":4},"end":{"line":12,"column":4}},{"start":{"line":12,"column":4},"end":{"line":12,"column":4}}]}},"code":["var _ = require('lodash');","var parseSummary = require('./summary');","","/**","    Parse an HTML content into a list of language","","    @param {String} html","    @return {Array}","*/","function parseLangs(content) {","    var parts = parseSummary(content).parts;","    if (parts.length > 0) {","        return parts[0].articles;","    }","","    return [];","}","","module.exports = parseLangs;","",""],"l":{"1":1,"2":1,"10":1,"11":0,"12":0,"13":0,"16":0,"19":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/readme.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/readme.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"parseReadme","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":27}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":26}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":10,"column":0},"end":{"line":17,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":28}},"5":{"start":{"line":13,"column":4},"end":{"line":16,"column":6}},"6":{"start":{"line":21,"column":0},"end":{"line":21,"column":29}}},"branchMap":{},"code":["var _ = require('lodash');","var dom = require('./dom');","","/**","    Parse an HTML content into metadata about a readme","","    @param {String} html","    @return {Object}","*/","function parseReadme(html) {","    var $ = dom.parse(html);","","    return {","        title: $('h1:first-child').text().trim(),","        description: $('div.paragraph,p').first().text().trim()","    };","}","","","// Exports","module.exports = parseReadme;",""],"l":{"1":1,"2":1,"10":1,"11":0,"13":0,"21":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/page.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-html/lib/page.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"parsePage","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":21}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":26}},"3":{"start":{"line":10,"column":0},"end":{"line":14,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":13,"column":6}},"5":{"start":{"line":16,"column":0},"end":{"line":16,"column":27}}},"branchMap":{},"code":["var Q = require('q');","var _ = require('lodash');","","/**","    Parse content of a page","","    @param {String} html","    @return {Object}","*/","function parsePage(html) {","    return {","        content: html","    };","}","","module.exports = parsePage;",""],"l":{"1":1,"2":1,"10":1,"11":0,"16":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-markdown/lib/toHTML.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-markdown/lib/toHTML.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":0,"7":1,"8":0,"9":0,"10":1,"11":0,"12":1},"b":{},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"getRenderer","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":23}}},"2":{"name":"getOption","line":24,"loc":{"start":{"line":24,"column":0},"end":{"line":24,"column":21}}},"3":{"name":"convertMdToHTMLBlock","line":36,"loc":{"start":{"line":36,"column":0},"end":{"line":36,"column":35}}},"4":{"name":"convertMdToHTMLInline","line":50,"loc":{"start":{"line":50,"column":0},"end":{"line":50,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":26}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":31}},"3":{"start":{"line":9,"column":0},"end":{"line":17,"column":1}},"4":{"start":{"line":10,"column":4},"end":{"line":16,"column":7}},"5":{"start":{"line":24,"column":0},"end":{"line":28,"column":1}},"6":{"start":{"line":25,"column":4},"end":{"line":27,"column":7}},"7":{"start":{"line":36,"column":0},"end":{"line":42,"column":1}},"8":{"start":{"line":37,"column":4},"end":{"line":39,"column":7}},"9":{"start":{"line":41,"column":4},"end":{"line":41,"column":32}},"10":{"start":{"line":50,"column":0},"end":{"line":52,"column":1}},"11":{"start":{"line":51,"column":4},"end":{"line":51,"column":63}},"12":{"start":{"line":54,"column":0},"end":{"line":57,"column":2}}},"branchMap":{},"code":["var _ = require('lodash');","var kramed = require('kramed');","","/**","    Get renderer for kramed with correct configuration","","    @return {kramed.Renderer}","*/","function getRenderer() {","    return new kramed.Renderer({","        langPrefix: 'lang-',","        smartypants: false,","        headerPrefix: '',","        headerAutoId: false,","        xhtml: false","    });","}","","/**","    Get options for markdown parsing","","    @return {Object}","*/","function getOption() {","    return _.extend({}, kramed.defaults, {","        mathjax: false","    });","}","","/**","    Convert Markdown block to HTML","","    @param {String} src (markdown)","    @return {String} (html)","*/","function convertMdToHTMLBlock(src) {","    var options = _.extend(getOption(), {","        renderer: getRenderer()","    });","","    return kramed(src, options);","}","","/**","    Convert Markdown inline to HTML","","    @param {String} src (markdown)","    @return {String} (html)","*/","function convertMdToHTMLInline(src) {","    return kramed.inlineLexer(src, getOption(), getRenderer());","}","","module.exports = {","    block: convertMdToHTMLBlock,","    inline: convertMdToHTMLInline","};",""],"l":{"1":1,"2":1,"9":1,"10":0,"24":1,"25":0,"36":1,"37":0,"41":0,"50":1,"51":0,"54":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-markdown/lib/toMarkdown.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-markdown/lib/toMarkdown.js","s":{"1":1,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"ns","line":3,"loc":{"start":{"line":3,"column":0},"end":{"line":3,"column":18}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":18},"end":{"line":12,"column":34}}},"3":{"name":"(anonymous_3)","line":15,"loc":{"start":{"line":15,"column":16},"end":{"line":15,"column":32}}},"4":{"name":"(anonymous_4)","line":19,"loc":{"start":{"line":19,"column":22},"end":{"line":19,"column":33}}},"5":{"name":"(anonymous_5)","line":22,"loc":{"start":{"line":22,"column":20},"end":{"line":22,"column":31}}},"6":{"name":"(anonymous_6)","line":26,"loc":{"start":{"line":26,"column":17},"end":{"line":26,"column":28}}},"7":{"name":"(anonymous_7)","line":29,"loc":{"start":{"line":29,"column":15},"end":{"line":29,"column":30}}},"8":{"name":"(anonymous_8)","line":33,"loc":{"start":{"line":33,"column":17},"end":{"line":33,"column":33}}},"9":{"name":"(anonymous_9)","line":36,"loc":{"start":{"line":36,"column":15},"end":{"line":36,"column":26}}},"10":{"name":"(anonymous_10)","line":40,"loc":{"start":{"line":40,"column":21},"end":{"line":40,"column":37}}},"11":{"name":"(anonymous_11)","line":43,"loc":{"start":{"line":43,"column":19},"end":{"line":43,"column":30}}},"12":{"name":"(anonymous_12)","line":47,"loc":{"start":{"line":47,"column":10},"end":{"line":47,"column":21}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":5,"column":1}},"2":{"start":{"line":4,"column":4},"end":{"line":4,"column":32}},"3":{"start":{"line":11,"column":0},"end":{"line":50,"column":2}},"4":{"start":{"line":13,"column":8},"end":{"line":13,"column":36}},"5":{"start":{"line":16,"column":8},"end":{"line":16,"column":27}},"6":{"start":{"line":20,"column":8},"end":{"line":20,"column":32}},"7":{"start":{"line":23,"column":8},"end":{"line":23,"column":32}},"8":{"start":{"line":27,"column":8},"end":{"line":27,"column":19}},"9":{"start":{"line":30,"column":8},"end":{"line":30,"column":32}},"10":{"start":{"line":34,"column":8},"end":{"line":34,"column":18}},"11":{"start":{"line":37,"column":8},"end":{"line":37,"column":18}},"12":{"start":{"line":41,"column":8},"end":{"line":41,"column":41}},"13":{"start":{"line":44,"column":8},"end":{"line":44,"column":18}},"14":{"start":{"line":48,"column":8},"end":{"line":48,"column":23}}},"branchMap":{},"code":["","// Return N time a string","function ns(s, n) {","    return Array(n + 1).join(s);","}","","/*","    This module provides markup rules for gitbook-html","    These rules are being used to generate SUMMARY/GLOSSARY/LANGS","*/","module.exports = {","    onTitleStart: function(level) {","        return ns('#', level) + ' ';","    },","    onTitleEnd: function(level) {","        return this.onBL();","    },","","    onParagraphStart: function() {","        return this.onSection();","    },","    onParagraphEnd: function() {","        return this.onSection();","    },","","    onLinkStart: function() {","        return '[';","    },","    onLinkEnd: function(href) {","        return '](' + href +')';","    },","","    onListStart: function(level) {","        return '';","    },","    onListEnd: function() {","        return '';","    },","","    onListItemStart: function(level) {","        return ns(' ', level * 4) + '* ';","    },","    onListItemEnd: function() {","        return '';","    },","","    onHR: function() {","        return '-----';","    }","};","",""],"l":{"3":1,"4":0,"11":1,"13":0,"16":0,"20":0,"23":0,"27":0,"30":0,"34":0,"37":0,"41":0,"44":0,"48":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-markdown/lib/page.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-markdown/lib/page.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":1,"9":0,"10":1,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"escape","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":21}}},"2":{"name":"combine","line":24,"loc":{"start":{"line":24,"column":0},"end":{"line":24,"column":24}}},"3":{"name":"preparePage","line":35,"loc":{"start":{"line":35,"column":0},"end":{"line":35,"column":26}}},"4":{"name":"escapeCodeElement","line":39,"loc":{"start":{"line":39,"column":4},"end":{"line":39,"column":35}}},"5":{"name":"(anonymous_5)","line":53,"loc":{"start":{"line":53,"column":31},"end":{"line":53,"column":44}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":26}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":31}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":47}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":28}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":29}},"6":{"start":{"line":14,"column":0},"end":{"line":16,"column":1}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"8":{"start":{"line":24,"column":0},"end":{"line":26,"column":1}},"9":{"start":{"line":25,"column":4},"end":{"line":25,"column":40}},"10":{"start":{"line":35,"column":0},"end":{"line":71,"column":1}},"11":{"start":{"line":36,"column":4},"end":{"line":36,"column":37}},"12":{"start":{"line":37,"column":4},"end":{"line":37,"column":21}},"13":{"start":{"line":39,"column":4},"end":{"line":51,"column":5}},"14":{"start":{"line":40,"column":8},"end":{"line":49,"column":9}},"15":{"start":{"line":41,"column":12},"end":{"line":41,"column":36}},"16":{"start":{"line":42,"column":15},"end":{"line":49,"column":9}},"17":{"start":{"line":43,"column":12},"end":{"line":43,"column":37}},"18":{"start":{"line":44,"column":12},"end":{"line":48,"column":13}},"19":{"start":{"line":45,"column":16},"end":{"line":45,"column":40}},"20":{"start":{"line":46,"column":19},"end":{"line":48,"column":13}},"21":{"start":{"line":47,"column":16},"end":{"line":47,"column":29}},"22":{"start":{"line":50,"column":8},"end":{"line":50,"column":18}},"23":{"start":{"line":53,"column":4},"end":{"line":68,"column":7}},"24":{"start":{"line":55,"column":8},"end":{"line":67,"column":9}},"25":{"start":{"line":56,"column":12},"end":{"line":56,"column":47}},"26":{"start":{"line":59,"column":12},"end":{"line":59,"column":47}},"27":{"start":{"line":62,"column":12},"end":{"line":62,"column":35}},"28":{"start":{"line":64,"column":12},"end":{"line":64,"column":22}},"29":{"start":{"line":66,"column":12},"end":{"line":66,"column":41}},"30":{"start":{"line":70,"column":4},"end":{"line":70,"column":28}},"31":{"start":{"line":73,"column":0},"end":{"line":75,"column":2}}},"branchMap":{"1":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":8},"end":{"line":40,"column":8}},{"start":{"line":40,"column":8},"end":{"line":40,"column":8}}]},"2":{"line":40,"type":"binary-expr","locations":[{"start":{"line":40,"column":12},"end":{"line":40,"column":29}},{"start":{"line":40,"column":33},"end":{"line":40,"column":46}}]},"3":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":15},"end":{"line":42,"column":15}},{"start":{"line":42,"column":15},"end":{"line":42,"column":15}}]},"4":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":12},"end":{"line":44,"column":12}},{"start":{"line":44,"column":12},"end":{"line":44,"column":12}}]},"5":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":19},"end":{"line":46,"column":19}},{"start":{"line":46,"column":19},"end":{"line":46,"column":19}}]},"6":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":8},"end":{"line":55,"column":8}},{"start":{"line":55,"column":8},"end":{"line":55,"column":8}}]},"7":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":11},"end":{"line":55,"column":33}},{"start":{"line":55,"column":37},"end":{"line":55,"column":57}}]}},"code":["var _ = require('lodash');","var kramed = require('kramed');","var annotate = require('kramed/lib/annotate/');","","var RAW_START = '{% raw %}';","var RAW_END = '{% endraw %}';","","/**","    Escape a code block's content using raw blocks","","    @param {String}","    @return {String}","*/","function escape(str) {","    return RAW_START + str + RAW_END;","}","","/**","    Combines annotated nodes","","    @param {Array}","    @return {String}","*/","function combine(nodes) {","    return _.map(nodes, 'raw').join('');","}","","/**","    Add templating \"raw\" to code blocks to","    avoid nunjucks processing their content.","","    @param {String} src","    @return {String}","*/","function preparePage(src) {","    var lexed = annotate.blocks(src);","    var levelRaw = 0;","","    function escapeCodeElement(el) {","        if (el.type == 'code' && levelRaw == 0) {","            el.raw = escape(el.raw);","        } else if (el.type == 'tplexpr') {","            var expr = el.matches[0];","            if(expr === 'raw') {","                levelRaw = levelRaw + 1;","            } else if(expr === 'endraw') {","                levelRaw = 0;","            }","        }","        return el;","    }","","    var escaped = _.map(lexed, function(el) {","        // Only escape paragraphs and headings","        if(el.type == 'paragraph' || el.type == 'heading') {","            var line = annotate.inline(el.raw);","","            // Escape inline code blocks","            line = line.map(escapeCodeElement);","","            // Change raw source code","            el.raw = combine(line);","","            return el;","        } else {","            return escapeCodeElement(el);","        }","    });","","    return combine(escaped);","}","","module.exports = {","    prepare: preparePage","};",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"14":1,"15":0,"24":1,"25":0,"35":1,"36":0,"37":0,"39":1,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"50":0,"53":0,"55":0,"56":0,"59":0,"62":0,"64":0,"66":0,"70":0,"73":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-asciidoc/lib/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-asciidoc/lib/index.js","s":{"1":1,"2":1,"3":1,"4":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":41}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":61}}},"branchMap":{},"code":["var HTMLParser = require('gitbook-html');","var toHTML = require('./toHTML');","var toAsciidoc = require('./toAsciidoc');","","module.exports = HTMLParser.createParser(toHTML, toAsciidoc);",""],"l":{"1":1,"2":1,"3":1,"5":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-asciidoc/lib/toHTML.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-asciidoc/lib/toHTML.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":1,"9":0,"10":0,"11":0,"12":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"asciidocToHTML","line":6,"loc":{"start":{"line":6,"column":0},"end":{"line":6,"column":33}}},"2":{"name":"asciidocToHTMLInline","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":39}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":46}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":28}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":46}},"4":{"start":{"line":6,"column":0},"end":{"line":11,"column":1}},"5":{"start":{"line":7,"column":4},"end":{"line":7,"column":74}},"6":{"start":{"line":9,"column":4},"end":{"line":9,"column":52}},"7":{"start":{"line":10,"column":4},"end":{"line":10,"column":16}},"8":{"start":{"line":14,"column":0},"end":{"line":19,"column":1}},"9":{"start":{"line":15,"column":4},"end":{"line":15,"column":76}},"10":{"start":{"line":17,"column":4},"end":{"line":17,"column":52}},"11":{"start":{"line":18,"column":4},"end":{"line":18,"column":16}},"12":{"start":{"line":21,"column":0},"end":{"line":24,"column":2}}},"branchMap":{},"code":["var asciidoctor = require('asciidoctor.js')();","var opal = asciidoctor.Opal;","var processor = asciidoctor.Asciidoctor(true);","","// Render Asciidoc to HTML (block)","function asciidocToHTML(content) {","    var options = opal.hash2(['attributes'], {'attributes': 'showtitle'});","","    var html = processor.$convert(content, options);","    return html;","};","","// Render Asciidoc to HTML (inline)","function asciidocToHTMLInline(content) {","    var options = Opal.hash({doctype: 'inline', attributes: ['showtitle']});","","    var html = processor.$convert(content, options);","    return html;","};","","module.exports = {","    block: asciidocToHTML,","    inline: asciidocToHTMLInline","};",""],"l":{"1":1,"2":1,"3":1,"6":1,"7":0,"9":0,"10":0,"14":1,"15":0,"17":0,"18":0,"21":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-asciidoc/lib/toAsciidoc.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook-asciidoc/lib/toAsciidoc.js","s":{"1":1,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"ns","line":3,"loc":{"start":{"line":3,"column":0},"end":{"line":3,"column":18}}},"2":{"name":"(anonymous_2)","line":8,"loc":{"start":{"line":8,"column":18},"end":{"line":8,"column":34}}},"3":{"name":"(anonymous_3)","line":11,"loc":{"start":{"line":11,"column":16},"end":{"line":11,"column":32}}},"4":{"name":"(anonymous_4)","line":15,"loc":{"start":{"line":15,"column":22},"end":{"line":15,"column":33}}},"5":{"name":"(anonymous_5)","line":18,"loc":{"start":{"line":18,"column":20},"end":{"line":18,"column":31}}},"6":{"name":"(anonymous_6)","line":22,"loc":{"start":{"line":22,"column":17},"end":{"line":22,"column":32}}},"7":{"name":"(anonymous_7)","line":25,"loc":{"start":{"line":25,"column":15},"end":{"line":25,"column":26}}},"8":{"name":"(anonymous_8)","line":29,"loc":{"start":{"line":29,"column":17},"end":{"line":29,"column":33}}},"9":{"name":"(anonymous_9)","line":32,"loc":{"start":{"line":32,"column":15},"end":{"line":32,"column":26}}},"10":{"name":"(anonymous_10)","line":36,"loc":{"start":{"line":36,"column":21},"end":{"line":36,"column":37}}},"11":{"name":"(anonymous_11)","line":39,"loc":{"start":{"line":39,"column":19},"end":{"line":39,"column":30}}},"12":{"name":"(anonymous_12)","line":43,"loc":{"start":{"line":43,"column":10},"end":{"line":43,"column":21}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":5,"column":1}},"2":{"start":{"line":4,"column":4},"end":{"line":4,"column":32}},"3":{"start":{"line":7,"column":0},"end":{"line":46,"column":2}},"4":{"start":{"line":9,"column":8},"end":{"line":9,"column":36}},"5":{"start":{"line":12,"column":8},"end":{"line":12,"column":27}},"6":{"start":{"line":16,"column":8},"end":{"line":16,"column":32}},"7":{"start":{"line":19,"column":8},"end":{"line":19,"column":32}},"8":{"start":{"line":23,"column":8},"end":{"line":23,"column":36}},"9":{"start":{"line":26,"column":8},"end":{"line":26,"column":19}},"10":{"start":{"line":30,"column":8},"end":{"line":30,"column":18}},"11":{"start":{"line":33,"column":8},"end":{"line":33,"column":18}},"12":{"start":{"line":37,"column":8},"end":{"line":37,"column":40}},"13":{"start":{"line":40,"column":8},"end":{"line":40,"column":18}},"14":{"start":{"line":44,"column":8},"end":{"line":44,"column":21}}},"branchMap":{},"code":["","// Return N time a string","function ns(s, n) {","    return Array(n + 1).join(s);","}","","module.exports = {","    onTitleStart: function(level) {","        return ns('=', level) + ' ';","    },","    onTitleEnd: function(level) {","        return this.onBL();","    },","","    onParagraphStart: function() {","        return this.onSection();","    },","    onParagraphEnd: function() {","        return this.onSection();","    },","","    onLinkStart: function(href) {","        return 'link:' + href + '[';","    },","    onLinkEnd: function() {","        return ']';","    },","","    onListStart: function(level) {","        return '';","    },","    onListEnd: function() {","        return '';","    },","","    onListItemStart: function(level) {","        return ns('.', level + 1) + ' ';","    },","    onListItemEnd: function() {","        return '';","    },","","    onHR: function() {","        return \"'''\";","    }","};","",""],"l":{"3":1,"4":0,"7":1,"9":0,"12":0,"16":0,"19":0,"23":0,"26":0,"30":0,"33":0,"37":0,"40":0,"44":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/extsMarkdown.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/extsMarkdown.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":5,"column":2}}},"branchMap":{},"code":["module.exports = [","    '.md',","    '.markdown',","    '.mdown'","];",""],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/extsAsciidoc.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/extsAsciidoc.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":4,"column":2}}},"branchMap":{},"code":["module.exports = [","    '.adoc',","    '.asciidoc'","];",""],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/parser.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/parser.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":2,"8":1,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":1,"26":0,"27":0,"28":1,"29":0,"30":0,"31":1,"32":0,"33":0,"34":1,"35":0,"36":0,"37":1,"38":0,"39":0,"40":1,"41":0,"42":0,"43":1,"44":0,"45":0,"46":1,"47":2,"48":1},"b":{"1":[0,0]},"f":{"1":0,"2":2,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":2},"fnMap":{"1":{"name":"(anonymous_1)","line":19,"loc":{"start":{"line":19,"column":27},"end":{"line":19,"column":38}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":33},"end":{"line":23,"column":44}}},"3":{"name":"(anonymous_3)","line":29,"loc":{"start":{"line":29,"column":31},"end":{"line":29,"column":49}}},"4":{"name":"(anonymous_4)","line":34,"loc":{"start":{"line":34,"column":32},"end":{"line":34,"column":50}}},"5":{"name":"(anonymous_5)","line":39,"loc":{"start":{"line":39,"column":33},"end":{"line":39,"column":51}}},"6":{"name":"(anonymous_6)","line":44,"loc":{"start":{"line":44,"column":31},"end":{"line":44,"column":49}}},"7":{"name":"(anonymous_7)","line":53,"loc":{"start":{"line":53,"column":29},"end":{"line":53,"column":47}}},"8":{"name":"(anonymous_8)","line":58,"loc":{"start":{"line":58,"column":31},"end":{"line":58,"column":49}}},"9":{"name":"(anonymous_9)","line":63,"loc":{"start":{"line":63,"column":34},"end":{"line":63,"column":52}}},"10":{"name":"(anonymous_10)","line":68,"loc":{"start":{"line":68,"column":31},"end":{"line":68,"column":49}}},"11":{"name":"(anonymous_11)","line":75,"loc":{"start":{"line":75,"column":35},"end":{"line":75,"column":53}}},"12":{"name":"(anonymous_12)","line":80,"loc":{"start":{"line":80,"column":33},"end":{"line":80,"column":51}}},"13":{"name":"(anonymous_13)","line":85,"loc":{"start":{"line":85,"column":34},"end":{"line":85,"column":52}}},"14":{"name":"(anonymous_14)","line":96,"loc":{"start":{"line":96,"column":34},"end":{"line":96,"column":48}}},"15":{"name":"(anonymous_15)","line":109,"loc":{"start":{"line":109,"column":16},"end":{"line":109,"column":51}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":42}},"3":{"start":{"line":4,"column":0},"end":{"line":17,"column":3}},"4":{"start":{"line":19,"column":0},"end":{"line":21,"column":2}},"5":{"start":{"line":20,"column":4},"end":{"line":20,"column":28}},"6":{"start":{"line":23,"column":0},"end":{"line":25,"column":2}},"7":{"start":{"line":24,"column":4},"end":{"line":24,"column":34}},"8":{"start":{"line":29,"column":0},"end":{"line":32,"column":2}},"9":{"start":{"line":30,"column":4},"end":{"line":30,"column":36}},"10":{"start":{"line":31,"column":4},"end":{"line":31,"column":36}},"11":{"start":{"line":34,"column":0},"end":{"line":37,"column":2}},"12":{"start":{"line":35,"column":4},"end":{"line":35,"column":38}},"13":{"start":{"line":36,"column":4},"end":{"line":36,"column":37}},"14":{"start":{"line":39,"column":0},"end":{"line":42,"column":2}},"15":{"start":{"line":40,"column":4},"end":{"line":40,"column":40}},"16":{"start":{"line":41,"column":4},"end":{"line":41,"column":38}},"17":{"start":{"line":44,"column":0},"end":{"line":51,"column":2}},"18":{"start":{"line":45,"column":4},"end":{"line":45,"column":32}},"19":{"start":{"line":46,"column":4},"end":{"line":48,"column":5}},"20":{"start":{"line":47,"column":8},"end":{"line":47,"column":32}},"21":{"start":{"line":50,"column":4},"end":{"line":50,"column":42}},"22":{"start":{"line":53,"column":0},"end":{"line":56,"column":2}},"23":{"start":{"line":54,"column":4},"end":{"line":54,"column":32}},"24":{"start":{"line":55,"column":4},"end":{"line":55,"column":34}},"25":{"start":{"line":58,"column":0},"end":{"line":61,"column":2}},"26":{"start":{"line":59,"column":4},"end":{"line":59,"column":36}},"27":{"start":{"line":60,"column":4},"end":{"line":60,"column":36}},"28":{"start":{"line":63,"column":0},"end":{"line":66,"column":2}},"29":{"start":{"line":64,"column":4},"end":{"line":64,"column":34}},"30":{"start":{"line":65,"column":4},"end":{"line":65,"column":35}},"31":{"start":{"line":68,"column":0},"end":{"line":71,"column":2}},"32":{"start":{"line":69,"column":4},"end":{"line":69,"column":36}},"33":{"start":{"line":70,"column":4},"end":{"line":70,"column":36}},"34":{"start":{"line":75,"column":0},"end":{"line":78,"column":2}},"35":{"start":{"line":76,"column":4},"end":{"line":76,"column":34}},"36":{"start":{"line":77,"column":4},"end":{"line":77,"column":42}},"37":{"start":{"line":80,"column":0},"end":{"line":83,"column":2}},"38":{"start":{"line":81,"column":4},"end":{"line":81,"column":38}},"39":{"start":{"line":82,"column":4},"end":{"line":82,"column":44}},"40":{"start":{"line":85,"column":0},"end":{"line":88,"column":2}},"41":{"start":{"line":86,"column":4},"end":{"line":86,"column":40}},"42":{"start":{"line":87,"column":4},"end":{"line":87,"column":45}},"43":{"start":{"line":96,"column":0},"end":{"line":99,"column":2}},"44":{"start":{"line":97,"column":4},"end":{"line":97,"column":36}},"45":{"start":{"line":98,"column":4},"end":{"line":98,"column":44}},"46":{"start":{"line":109,"column":0},"end":{"line":120,"column":2}},"47":{"start":{"line":110,"column":4},"end":{"line":119,"column":7}},"48":{"start":{"line":122,"column":0},"end":{"line":122,"column":24}}},"branchMap":{"1":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":4},"end":{"line":46,"column":4}},{"start":{"line":46,"column":4},"end":{"line":46,"column":4}}]}},"code":["var Immutable = require('immutable');","var Promise = require('../utils/promise');","","var Parser = Immutable.Record({","    name:           String(),","","    // List of extensions that can be processed using this parser","    extensions:     Immutable.List(),","","    // Parsing functions","    readme:         Function(),","    langs:          Function(),","    summary:        Function(),","    glossary:       Function(),","    page:           Function(),","    inline:         Function()","});","","Parser.prototype.getName = function() {","    return this.get('name');","};","","Parser.prototype.getExtensions = function() {","    return this.get('extensions');","};","","// PARSE","","Parser.prototype.parseReadme = function(content) {","    var readme = this.get('readme');","    return Promise(readme(content));","};","","Parser.prototype.parseSummary = function(content) {","    var summary = this.get('summary');","    return Promise(summary(content));","};","","Parser.prototype.parseGlossary = function(content) {","    var glossary = this.get('glossary');","    return Promise(glossary(content));","};","","Parser.prototype.preparePage = function(content) {","    var page = this.get('page');","    if (!page.prepare) {","        return Promise(content);","    }","","    return Promise(page.prepare(content));","};","","Parser.prototype.parsePage = function(content) {","    var page = this.get('page');","    return Promise(page(content));","};","","Parser.prototype.parseInline = function(content) {","    var inline = this.get('inline');","    return Promise(inline(content));","};","","Parser.prototype.parseLanguages = function(content) {","    var langs = this.get('langs');","    return Promise(langs(content));","};","","Parser.prototype.parseInline = function(content) {","    var inline = this.get('inline');","    return Promise(inline(content));","};","","// TO TEXT","","Parser.prototype.renderLanguages = function(content) {","    var langs = this.get('langs');","    return Promise(langs.toText(content));","};","","Parser.prototype.renderSummary = function(content) {","    var summary = this.get('summary');","    return Promise(summary.toText(content));","};","","Parser.prototype.renderGlossary = function(content) {","    var glossary = this.get('glossary');","    return Promise(glossary.toText(content));","};","","/**","    Test if this parser matches an extension","","    @param {String} ext","    @return {Boolean}","*/","Parser.prototype.matchExtension = function(ext) {","    var exts = this.getExtensions();","    return exts.includes(ext.toLowerCase());","};","","/**","    Create a new parser using a module (gitbook-markdown, etc)","","    @param {String} name","    @param {Array<String>} extensions","    @param {Object} module","    @return {Parser}","*/","Parser.create = function(name, extensions, module) {","    return new Parser({","        name: name,","        extensions: Immutable.List(extensions),","        readme:         module.readme,","        langs:          module.langs,","        summary:        module.summary,","        glossary:       module.glossary,","        page:           module.page,","        inline:         module.inline","    });","};","","module.exports = Parser;",""],"l":{"1":1,"2":1,"4":1,"19":1,"20":0,"23":1,"24":2,"29":1,"30":0,"31":0,"34":1,"35":0,"36":0,"39":1,"40":0,"41":0,"44":1,"45":0,"46":0,"47":0,"50":0,"53":1,"54":0,"55":0,"58":1,"59":0,"60":0,"63":1,"64":0,"65":0,"68":1,"69":0,"70":0,"75":1,"76":0,"77":0,"80":1,"81":0,"82":0,"85":1,"86":0,"87":0,"96":1,"97":0,"98":0,"109":1,"110":2,"122":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/error.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/error.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"enforce","line":8,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":22}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":40}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":44}},"4":{"start":{"line":8,"column":0},"end":{"line":13,"column":1}},"5":{"start":{"line":9,"column":4},"end":{"line":9,"column":45}},"6":{"start":{"line":9,"column":24},"end":{"line":9,"column":45}},"7":{"start":{"line":10,"column":4},"end":{"line":10,"column":54}},"8":{"start":{"line":12,"column":4},"end":{"line":12,"column":15}},"9":{"start":{"line":16,"column":0},"end":{"line":19,"column":3}},"10":{"start":{"line":20,"column":0},"end":{"line":23,"column":3}},"11":{"start":{"line":26,"column":0},"end":{"line":30,"column":3}},"12":{"start":{"line":33,"column":0},"end":{"line":37,"column":3}},"13":{"start":{"line":40,"column":0},"end":{"line":46,"column":3}},"14":{"start":{"line":49,"column":0},"end":{"line":55,"column":3}},"15":{"start":{"line":58,"column":0},"end":{"line":62,"column":3}},"16":{"start":{"line":65,"column":0},"end":{"line":69,"column":3}},"17":{"start":{"line":72,"column":0},"end":{"line":75,"column":3}},"18":{"start":{"line":78,"column":0},"end":{"line":82,"column":3}},"19":{"start":{"line":84,"column":0},"end":{"line":99,"column":2}}},"branchMap":{"1":{"line":9,"type":"if","locations":[{"start":{"line":9,"column":4},"end":{"line":9,"column":4}},{"start":{"line":9,"column":4},"end":{"line":9,"column":4}}]}},"code":["var is = require('is');","","var TypedError = require('error/typed');","var WrappedError = require('error/wrapped');","","","// Enforce as an Error object, and cleanup message","function enforce(err) {","    if (is.string(err)) err = new Error(err);","    err.message = err.message.replace(/^Error: /, '');","","    return err;","}","","// Random error wrappers during parsing/generation","var ParsingError = WrappedError({","    message: 'Parsing Error: {origMessage}',","    type: 'parse'","});","var OutputError = WrappedError({","    message: 'Output Error: {origMessage}',","    type: 'generate'","});","","// A file does not exists","var FileNotFoundError = TypedError({","    type: 'file.not-found',","    message: 'No \"{filename}\" file (or is ignored)',","    filename: null","});","","// A file cannot be parsed","var FileNotParsableError = TypedError({","    type: 'file.not-parsable',","    message: '\"{filename}\" file cannot be parsed',","    filename: null","});","","// A file is outside the scope","var FileOutOfScopeError = TypedError({","    type: 'file.out-of-scope',","    message: '\"{filename}\" not in \"{root}\"',","    filename: null,","    root: null,","    code: 'EACCESS'","});","","// A file is outside the scope","var RequireInstallError = TypedError({","    type: 'install.required',","    message: '\"{cmd}\" is not installed.\\n{install}',","    cmd: null,","    code: 'ENOENT',","    install: ''","});","","// Error for nunjucks templates","var TemplateError = WrappedError({","    message: 'Error compiling template \"{filename}\": {origMessage}',","    type: 'template',","    filename: null","});","","// Error for nunjucks templates","var PluginError = WrappedError({","    message: 'Error with plugin \"{plugin}\": {origMessage}',","    type: 'plugin',","    plugin: null","});","","// Error with the book's configuration","var ConfigurationError = WrappedError({","    message: 'Error with book\\'s configuration: {origMessage}',","    type: 'configuration'","});","","// Error during ebook generation","var EbookError = WrappedError({","    message: 'Error during ebook generation: {origMessage}\\n{stdout}',","    type: 'ebook',","    stdout: ''","});","","module.exports = {","    enforce: enforce,","","    ParsingError: ParsingError,","    OutputError: OutputError,","    RequireInstallError: RequireInstallError,","","    FileNotParsableError: FileNotParsableError,","    FileNotFoundError: FileNotFoundError,","    FileOutOfScopeError: FileOutOfScopeError,","","    TemplateError: TemplateError,","    PluginError: PluginError,","    ConfigurationError: ConfigurationError,","    EbookError: EbookError","};",""],"l":{"1":1,"3":1,"4":1,"8":1,"9":0,"10":0,"12":0,"16":1,"20":1,"26":1,"33":1,"40":1,"49":1,"58":1,"65":1,"72":1,"78":1,"84":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/path.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/path.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":0,"26":1,"27":0,"28":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"normalizePath","line":5,"loc":{"start":{"line":5,"column":0},"end":{"line":5,"column":33}}},"2":{"name":"isInRoot","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":34}}},"3":{"name":"resolveInRoot","line":26,"loc":{"start":{"line":26,"column":0},"end":{"line":26,"column":29}}},"4":{"name":"(anonymous_4)","line":31,"loc":{"start":{"line":31,"column":16},"end":{"line":31,"column":37}}},"5":{"name":"setExtension","line":51,"loc":{"start":{"line":51,"column":0},"end":{"line":51,"column":37}}},"6":{"name":"isPureRelative","line":64,"loc":{"start":{"line":64,"column":0},"end":{"line":64,"column":34}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":31}},"3":{"start":{"line":5,"column":0},"end":{"line":7,"column":1}},"4":{"start":{"line":6,"column":4},"end":{"line":6,"column":36}},"5":{"start":{"line":10,"column":0},"end":{"line":22,"column":1}},"6":{"start":{"line":11,"column":4},"end":{"line":11,"column":32}},"7":{"start":{"line":12,"column":4},"end":{"line":12,"column":40}},"8":{"start":{"line":14,"column":4},"end":{"line":16,"column":5}},"9":{"start":{"line":15,"column":8},"end":{"line":15,"column":20}},"10":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"11":{"start":{"line":18,"column":8},"end":{"line":18,"column":31}},"12":{"start":{"line":21,"column":4},"end":{"line":21,"column":54}},"13":{"start":{"line":26,"column":0},"end":{"line":48,"column":1}},"14":{"start":{"line":27,"column":4},"end":{"line":27,"column":22}},"15":{"start":{"line":28,"column":4},"end":{"line":28,"column":56}},"16":{"start":{"line":30,"column":4},"end":{"line":36,"column":15}},"17":{"start":{"line":33,"column":12},"end":{"line":33,"column":63}},"18":{"start":{"line":33,"column":45},"end":{"line":33,"column":63}},"19":{"start":{"line":35,"column":12},"end":{"line":35,"column":70}},"20":{"start":{"line":38,"column":4},"end":{"line":38,"column":39}},"21":{"start":{"line":40,"column":4},"end":{"line":45,"column":5}},"22":{"start":{"line":41,"column":8},"end":{"line":44,"column":11}},"23":{"start":{"line":47,"column":4},"end":{"line":47,"column":18}},"24":{"start":{"line":51,"column":0},"end":{"line":56,"column":1}},"25":{"start":{"line":52,"column":4},"end":{"line":55,"column":6}},"26":{"start":{"line":64,"column":0},"end":{"line":66,"column":1}},"27":{"start":{"line":65,"column":4},"end":{"line":65,"column":75}},"28":{"start":{"line":68,"column":0},"end":{"line":74,"column":2}}},"branchMap":{"1":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":4},"end":{"line":14,"column":4}},{"start":{"line":14,"column":4},"end":{"line":14,"column":4}}]},"2":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":17,"column":4}},{"start":{"line":17,"column":4},"end":{"line":17,"column":4}}]},"3":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":12},"end":{"line":33,"column":12}},{"start":{"line":33,"column":12},"end":{"line":33,"column":12}}]},"4":{"line":33,"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":27}},{"start":{"line":33,"column":31},"end":{"line":33,"column":43}}]},"5":{"line":35,"type":"cond-expr","locations":[{"start":{"line":35,"column":28},"end":{"line":35,"column":49}},{"start":{"line":35,"column":52},"end":{"line":35,"column":69}}]},"6":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":40,"column":4}},{"start":{"line":40,"column":4},"end":{"line":40,"column":4}}]},"7":{"line":65,"type":"binary-expr","locations":[{"start":{"line":65,"column":12},"end":{"line":65,"column":40}},{"start":{"line":65,"column":44},"end":{"line":65,"column":73}}]}},"code":["var path = require('path');","var error = require('./error');","","// Normalize a filename","function normalizePath(filename) {","    return path.normalize(filename);","}","","// Return true if file path is inside a folder","function isInRoot(root, filename) {","    root = path.normalize(root);","    filename = path.normalize(filename);","","    if (root === '.') {","        return true;","    }","    if (root[root.length - 1] != path.sep) {","        root = root + path.sep;","    }","","    return (filename.substr(0, root.length) === root);","}","","// Resolve paths in a specific folder","// Throw error if file is outside this folder","function resolveInRoot(root) {","    var input, result;","    var args = Array.prototype.slice.call(arguments, 1);","","    input = args","        .reduce(function(current, p) {","            // Handle path relative to book root (\"/README.md\")","            if (p[0] == '/' || p[0] == '\\\\') return p.slice(1);","","            return current? path.join(current, p) : path.normalize(p);","        }, '');","","    result = path.resolve(root, input);","","    if (!isInRoot(root, result)) {","        throw new error.FileOutOfScopeError({","            filename: result,","            root: root","        });","    }","","    return result;","}","","// Chnage extension of a file","function setExtension(filename, ext) {","    return path.join(","        path.dirname(filename),","        path.basename(filename, path.extname(filename)) + ext","    );","}","","/*","    Return true if a filename is relative.","","    @param {String}","    @return {Boolean}","*/","function isPureRelative(filename) {","    return (filename.indexOf('./') === 0 || filename.indexOf('../') === 0);","}","","module.exports = {","    isInRoot: isInRoot,","    resolveInRoot: resolveInRoot,","    normalize: normalizePath,","    setExtension: setExtension,","    isPureRelative: isPureRelative","};",""],"l":{"1":1,"2":1,"5":1,"6":0,"10":1,"11":0,"12":0,"14":0,"15":0,"17":0,"18":0,"21":0,"26":1,"27":0,"28":0,"30":0,"33":0,"35":0,"38":0,"40":0,"41":0,"47":0,"51":1,"52":0,"64":1,"65":0,"68":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/config.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/config.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":0,"12":1,"13":0,"14":1,"15":0,"16":1,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":1,"40":0,"41":0,"42":1,"43":0,"44":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":1,"51":0,"52":1,"53":0,"54":1,"55":0,"56":0,"57":0,"58":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"fnMap":{"1":{"name":"(anonymous_1)","line":14,"loc":{"start":{"line":14,"column":27},"end":{"line":14,"column":38}}},"2":{"name":"(anonymous_2)","line":18,"loc":{"start":{"line":18,"column":29},"end":{"line":18,"column":40}}},"3":{"name":"(anonymous_3)","line":27,"loc":{"start":{"line":27,"column":36},"end":{"line":27,"column":47}}},"4":{"name":"(anonymous_4)","line":35,"loc":{"start":{"line":35,"column":26},"end":{"line":35,"column":37}}},"5":{"name":"(anonymous_5)","line":44,"loc":{"start":{"line":44,"column":27},"end":{"line":44,"column":42}}},"6":{"name":"(anonymous_6)","line":53,"loc":{"start":{"line":53,"column":28},"end":{"line":53,"column":51}}},"7":{"name":"(anonymous_7)","line":70,"loc":{"start":{"line":70,"column":28},"end":{"line":70,"column":53}}},"8":{"name":"(anonymous_8)","line":85,"loc":{"start":{"line":85,"column":41},"end":{"line":85,"column":52}}},"9":{"name":"(anonymous_9)","line":100,"loc":{"start":{"line":100,"column":39},"end":{"line":100,"column":54}}},"10":{"name":"(anonymous_10)","line":103,"loc":{"start":{"line":103,"column":24},"end":{"line":103,"column":38}}},"11":{"name":"(anonymous_11)","line":113,"loc":{"start":{"line":113,"column":41},"end":{"line":113,"column":56}}},"12":{"name":"(anonymous_12)","line":125,"loc":{"start":{"line":125,"column":32},"end":{"line":125,"column":49}}},"13":{"name":"(anonymous_13)","line":137,"loc":{"start":{"line":137,"column":31},"end":{"line":137,"column":48}}},"14":{"name":"(anonymous_14)","line":152,"loc":{"start":{"line":152,"column":16},"end":{"line":152,"column":39}}},"15":{"name":"(anonymous_15)","line":164,"loc":{"start":{"line":164,"column":26},"end":{"line":164,"column":43}}},"16":{"name":"(anonymous_16)","line":176,"loc":{"start":{"line":176,"column":22},"end":{"line":176,"column":40}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":29}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":53}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":58}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":54}},"7":{"start":{"line":9,"column":0},"end":{"line":12,"column":13}},"8":{"start":{"line":14,"column":0},"end":{"line":16,"column":2}},"9":{"start":{"line":15,"column":4},"end":{"line":15,"column":28}},"10":{"start":{"line":18,"column":0},"end":{"line":20,"column":2}},"11":{"start":{"line":19,"column":4},"end":{"line":19,"column":30}},"12":{"start":{"line":27,"column":0},"end":{"line":29,"column":2}},"13":{"start":{"line":28,"column":4},"end":{"line":28,"column":58}},"14":{"start":{"line":35,"column":0},"end":{"line":37,"column":2}},"15":{"start":{"line":36,"column":4},"end":{"line":36,"column":67}},"16":{"start":{"line":44,"column":0},"end":{"line":46,"column":2}},"17":{"start":{"line":45,"column":4},"end":{"line":45,"column":34}},"18":{"start":{"line":53,"column":0},"end":{"line":62,"column":2}},"19":{"start":{"line":54,"column":4},"end":{"line":54,"column":34}},"20":{"start":{"line":55,"column":4},"end":{"line":55,"column":43}},"21":{"start":{"line":57,"column":4},"end":{"line":59,"column":5}},"22":{"start":{"line":58,"column":8},"end":{"line":58,"column":37}},"23":{"start":{"line":61,"column":4},"end":{"line":61,"column":33}},"24":{"start":{"line":70,"column":0},"end":{"line":79,"column":2}},"25":{"start":{"line":71,"column":4},"end":{"line":71,"column":43}},"26":{"start":{"line":73,"column":4},"end":{"line":73,"column":36}},"27":{"start":{"line":75,"column":4},"end":{"line":75,"column":34}},"28":{"start":{"line":76,"column":4},"end":{"line":76,"column":42}},"29":{"start":{"line":78,"column":4},"end":{"line":78,"column":38}},"30":{"start":{"line":85,"column":0},"end":{"line":93,"column":2}},"31":{"start":{"line":86,"column":4},"end":{"line":86,"column":43}},"32":{"start":{"line":88,"column":4},"end":{"line":92,"column":5}},"33":{"start":{"line":89,"column":8},"end":{"line":89,"column":56}},"34":{"start":{"line":91,"column":8},"end":{"line":91,"column":55}},"35":{"start":{"line":100,"column":0},"end":{"line":106,"column":2}},"36":{"start":{"line":101,"column":4},"end":{"line":101,"column":47}},"37":{"start":{"line":103,"column":4},"end":{"line":105,"column":7}},"38":{"start":{"line":104,"column":8},"end":{"line":104,"column":38}},"39":{"start":{"line":113,"column":0},"end":{"line":117,"column":2}},"40":{"start":{"line":114,"column":4},"end":{"line":114,"column":53}},"41":{"start":{"line":116,"column":4},"end":{"line":116,"column":45}},"42":{"start":{"line":125,"column":0},"end":{"line":129,"column":2}},"43":{"start":{"line":126,"column":4},"end":{"line":126,"column":38}},"44":{"start":{"line":128,"column":4},"end":{"line":128,"column":38}},"45":{"start":{"line":137,"column":0},"end":{"line":144,"column":2}},"46":{"start":{"line":138,"column":4},"end":{"line":138,"column":41}},"47":{"start":{"line":139,"column":4},"end":{"line":139,"column":38}},"48":{"start":{"line":141,"column":4},"end":{"line":141,"column":52}},"49":{"start":{"line":143,"column":4},"end":{"line":143,"column":45}},"50":{"start":{"line":152,"column":0},"end":{"line":157,"column":2}},"51":{"start":{"line":153,"column":4},"end":{"line":156,"column":7}},"52":{"start":{"line":164,"column":0},"end":{"line":168,"column":2}},"53":{"start":{"line":165,"column":4},"end":{"line":167,"column":7}},"54":{"start":{"line":176,"column":0},"end":{"line":179,"column":2}},"55":{"start":{"line":177,"column":4},"end":{"line":177,"column":57}},"56":{"start":{"line":177,"column":28},"end":{"line":177,"column":57}},"57":{"start":{"line":178,"column":4},"end":{"line":178,"column":19}},"58":{"start":{"line":181,"column":0},"end":{"line":181,"column":24}}},"branchMap":{"1":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":4},"end":{"line":57,"column":4}},{"start":{"line":57,"column":4},"end":{"line":57,"column":4}}]},"2":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":88,"column":4}},{"start":{"line":88,"column":4},"end":{"line":88,"column":4}}]},"3":{"line":177,"type":"if","locations":[{"start":{"line":177,"column":4},"end":{"line":177,"column":4}},{"start":{"line":177,"column":4},"end":{"line":177,"column":4}}]}},"code":["var is = require('is');","var Immutable = require('immutable');","","var File = require('./file');","var PluginDependency = require('./pluginDependency');","var configDefault = require('../constants/configDefault');","var reducedObject = require('../utils/reducedObject');","","var Config = Immutable.Record({","    file:       File(),","    values:     configDefault","}, 'Config');","","Config.prototype.getFile = function() {","    return this.get('file');","};","","Config.prototype.getValues = function() {","    return this.get('values');","};","","/**"," * Return minimum version of configuration,"," * Basically it returns the current config minus the default one"," * @return {Map}"," */","Config.prototype.toReducedVersion = function() {","    return reducedObject(configDefault, this.getValues());","};","","/**"," * Render config as text"," * @return {Promise<String>}"," */","Config.prototype.toText = function() {","    return JSON.stringify(this.toReducedVersion().toJS(), null, 4);","};","","/**"," * Change the file for the configuration"," * @param {File} file"," * @return {Config}"," */","Config.prototype.setFile = function(file) {","    return this.set('file', file);","};","","/**"," * Return a configuration value by its key path"," * @param {String} key"," * @return {Mixed}"," */","Config.prototype.getValue = function(keyPath, def) {","    var values = this.getValues();","    keyPath = Config.keyToKeyPath(keyPath);","","    if (!values.hasIn(keyPath)) {","        return Immutable.fromJS(def);","    }","","    return values.getIn(keyPath);","};","","/**"," * Update a configuration value"," * @param {String} key"," * @param {Mixed} value"," * @return {Config}"," */","Config.prototype.setValue = function(keyPath, value) {","    keyPath = Config.keyToKeyPath(keyPath);","","    value = Immutable.fromJS(value);","","    var values = this.getValues();","    values = values.setIn(keyPath, value);","","    return this.set('values', values);","};","","/**"," * Return a list of plugin dependencies"," * @return {List<PluginDependency>}"," */","Config.prototype.getPluginDependencies = function() {","    var plugins = this.getValue('plugins');","","    if (is.string(plugins)) {","        return PluginDependency.listFromString(plugins);","    } else {","        return PluginDependency.listFromArray(plugins);","    }","};","","/**"," * Return a plugin dependency by its name"," * @param {String} name"," * @return {PluginDependency}"," */","Config.prototype.getPluginDependency = function(name) {","    var plugins = this.getPluginDependencies();","","    return plugins.find(function(dep) {","        return dep.getName() === name;","    });","};","","/**"," * Update the list of plugins dependencies"," * @param {List<PluginDependency>}"," * @return {Config}"," */","Config.prototype.setPluginDependencies = function(deps) {","    var plugins = PluginDependency.listToArray(deps);","","    return this.setValue('plugins', plugins);","};","","","/**"," * Update values for an existing configuration"," * @param {Object} values"," * @returns {Config}"," */","Config.prototype.updateValues = function(values) {","    values = Immutable.fromJS(values);","","    return this.set('values', values);","};","","/**"," * Update values for an existing configuration"," * @param {Config} config"," * @param {Object} values"," * @returns {Config}"," */","Config.prototype.mergeValues = function(values) {","    var currentValues = this.getValues();","    values = Immutable.fromJS(values);","","    currentValues = currentValues.mergeDeep(values);","","    return this.set('values', currentValues);","};","","/**"," * Create a new config for a file"," * @param {File} file"," * @param {Object} values"," * @returns {Config}"," */","Config.create = function(file, values) {","    return new Config({","        file: file,","        values: Immutable.fromJS(values)","    });","};","","/**"," * Create a new config"," * @param {Object} values"," * @returns {Config}"," */","Config.createWithValues = function(values) {","    return new Config({","        values: Immutable.fromJS(values)","    });","};","","","/**"," * Convert a keyPath to an array of keys"," * @param {String|Array}"," * @return {Array}"," */","Config.keyToKeyPath = function(keyPath) {","    if (is.string(keyPath)) keyPath = keyPath.split('.');","    return keyPath;","};","","module.exports = Config;",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"7":1,"9":1,"14":1,"15":0,"18":1,"19":0,"27":1,"28":0,"35":1,"36":0,"44":1,"45":0,"53":1,"54":0,"55":0,"57":0,"58":0,"61":0,"70":1,"71":0,"73":0,"75":0,"76":0,"78":0,"85":1,"86":0,"88":0,"89":0,"91":0,"100":1,"101":0,"103":0,"104":0,"113":1,"114":0,"116":0,"125":1,"126":0,"128":0,"137":1,"138":0,"139":0,"141":0,"143":0,"152":1,"153":0,"164":1,"165":0,"176":1,"177":0,"178":0,"181":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/configDefault.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/configDefault.js","s":{"1":1,"2":1,"3":1,"4":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":57}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":39}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":62}}},"branchMap":{},"code":["var Immutable = require('immutable');","var jsonSchemaDefaults = require('json-schema-defaults');","","var schema = require('./configSchema');","","module.exports = Immutable.fromJS(jsonSchemaDefaults(schema));",""],"l":{"1":1,"2":1,"4":1,"6":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/configSchema.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/configSchema.js","s":{"1":1,"2":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":43}},"2":{"start":{"line":3,"column":0},"end":{"line":194,"column":2}}},"branchMap":{},"code":["var FILENAME_REGEX = '^[a-zA-Z-._\\d,\\s]+$';","","module.exports = {","    '$schema': 'http://json-schema.org/schema#',","    'id': 'https://gitbook.com/schemas/book.json',","    'title': 'GitBook Configuration',","    'type': 'object',","    'properties': {","        'root': {","            'type': 'string',","            'title': 'Path fro the root folder containing the book\\'s content'","        },","        'title': {","            'type': 'string',","            'title': 'Title of the book, default is extracted from README'","        },","        'isbn': {","            'type': 'string',","            'title': 'ISBN for published book'","        },","        'language': {","            'type': 'string',","            'title': 'Language of the book'","        },","        'author': {","            'type': 'string',","            'title': 'Name of the author'","        },","        'gitbook': {","            'type': 'string',","            'default': '*',","            'title': 'GitBook version to match'","        },","        'direction': {","            'type': 'string',","            'enum': ['ltr', 'rtl'],","            'title': 'Direction of texts, default is detected in the pages'","        },","        'theme': {","            'type': 'string',","            'default': 'default',","            'title': 'Name of the theme plugin to use'","        },","        'variables': {","            'type': 'object',","            'title': 'Templating context variables'","        },","        'plugins': {","            'oneOf': [","                { '$ref': '#/definitions/pluginsArray' },","                { '$ref': '#/definitions/pluginsString' }","            ],","            'default': []","        },","        'pluginsConfig': {","            'type': 'object',","            'title': 'Configuration for plugins'","        },","        'structure': {","            'type': 'object',","            'properties': {","                'langs': {","                    'default': 'LANGS.md',","                    'type': 'string',","                    'title': 'File to use as languages index',","                    'pattern': FILENAME_REGEX","                },","                'readme': {","                    'default': 'README.md',","                    'type': 'string',","                    'title': 'File to use as preface',","                    'pattern': FILENAME_REGEX","                },","                'glossary': {","                    'default': 'GLOSSARY.md',","                    'type': 'string',","                    'title': 'File to use as glossary index',","                    'pattern': FILENAME_REGEX","                },","                'summary': {","                    'default': 'SUMMARY.md',","                    'type': 'string',","                    'title': 'File to use as table of contents',","                    'pattern': FILENAME_REGEX","                }","            },","            'additionalProperties': false","        },","        'pdf': {","            'type': 'object',","            'title': 'PDF specific configurations',","            'properties': {","                'pageNumbers': {","                    'type': 'boolean',","                    'default': true,","                    'title': 'Add page numbers to the bottom of every page'","                },","                'fontSize': {","                    'type': 'integer',","                    'minimum': 8,","                    'maximum': 30,","                    'default': 12,","                    'title': 'Font size for the PDF output'","                },","                'fontFamily': {","                    'type': 'string',","                    'default': 'Arial',","                    'title': 'Font family for the PDF output'","                },","                'paperSize': {","                    'type': 'string',","                    'enum': ['a0', 'a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'b0', 'b1', 'b2', 'b3', 'b4', 'b5', 'b6', 'legal', 'letter'],","                    'default': 'a4',","                    'title': 'Paper size for the PDF'","                },","                'chapterMark': {","                    'type': 'string',","                    'enum': ['pagebreak', 'rule', 'both', 'none'],","                    'default': 'pagebreak',","                    'title': 'How to mark detected chapters'","                },","                'pageBreaksBefore': {","                    'type': 'string',","                    'default': '/',","                    'title': 'An XPath expression. Page breaks are inserted before the specified elements. To disable use the expression: \"/\"'","                },","                'margin': {","                    'type': 'object',","                    'properties': {","                        'right': {","                            'type': 'integer',","                            'title': 'Right Margin',","                            'minimum': 0,","                            'maximum': 100,","                            'default': 62","                        },","                        'left': {","                            'type': 'integer',","                            'title': 'Left Margin',","                            'minimum': 0,","                            'maximum': 100,","                            'default': 62","                        },","                        'top': {","                            'type': 'integer',","                            'title': 'Top Margin',","                            'minimum': 0,","                            'maximum': 100,","                            'default': 56","                        },","                        'bottom': {","                            'type': 'integer',","                            'title': 'Bottom Margin',","                            'minimum': 0,","                            'maximum': 100,","                            'default': 56","                        }","                    }","                }","            }","        }","    },","    'required': [],","    'definitions': {","        'pluginsArray': {","            'type': 'array',","            'items': {","                'oneOf': [","                    { '$ref': '#/definitions/pluginObject' },","                    { '$ref': '#/definitions/pluginString' }","                ]","            }","        },","        'pluginsString': {","            'type': 'string'","        },","        'pluginString': {","            'type': 'string'","        },","        'pluginObject': {","            'type': 'object',","            'properties': {","                'name': {","                    'type': 'string'","                },","                'version': {","                    'type': 'string'","                }","            },","            'additionalProperties': false,","            'required': ['name']","        }","    }","};",""],"l":{"1":1,"3":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/reducedObject.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/reducedObject.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"reducedObject","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":55}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":33},"end":{"line":14,"column":62}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":9,"column":0},"end":{"line":31,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":12,"column":5}},"4":{"start":{"line":11,"column":8},"end":{"line":11,"column":30}},"5":{"start":{"line":14,"column":4},"end":{"line":30,"column":24}},"6":{"start":{"line":15,"column":8},"end":{"line":15,"column":51}},"7":{"start":{"line":17,"column":8},"end":{"line":23,"column":9}},"8":{"start":{"line":18,"column":12},"end":{"line":18,"column":59}},"9":{"start":{"line":20,"column":12},"end":{"line":22,"column":13}},"10":{"start":{"line":21,"column":16},"end":{"line":21,"column":46}},"11":{"start":{"line":25,"column":8},"end":{"line":27,"column":9}},"12":{"start":{"line":26,"column":12},"end":{"line":26,"column":26}},"13":{"start":{"line":29,"column":8},"end":{"line":29,"column":38}},"14":{"start":{"line":33,"column":0},"end":{"line":33,"column":31}}},"branchMap":{"1":{"line":10,"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":4}},{"start":{"line":10,"column":4},"end":{"line":10,"column":4}}]},"2":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":8},"end":{"line":17,"column":8}},{"start":{"line":17,"column":8},"end":{"line":17,"column":8}}]},"3":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":12},"end":{"line":20,"column":12}},{"start":{"line":20,"column":12},"end":{"line":20,"column":12}}]},"4":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":8}},{"start":{"line":25,"column":8},"end":{"line":25,"column":8}}]}},"code":["var Immutable = require('immutable');","","/**"," *  Reduce the difference between a map and its default version"," *  @param {Map} defaultVersion"," *  @param {Map} currentVersion"," *  @return {Map} The properties of currentVersion that differs from defaultVersion"," */","function reducedObject(defaultVersion, currentVersion) {","    if(defaultVersion === undefined) {","        return currentVersion;","    }","","    return currentVersion.reduce(function(result, value, key) {","        var defaultValue = defaultVersion.get(key);","","        if (Immutable.Map.isMap(value)) {","            var diffs = reducedObject(defaultValue, value);","","            if (diffs.size > 0) {","                return result.set(key, diffs);","            }","        }","","        if (Immutable.is(defaultValue, value)) {","            return result;","        }","","        return result.set(key, value);","    }, Immutable.Map());","}","","module.exports = reducedObject;",""],"l":{"1":1,"9":1,"10":0,"11":0,"14":0,"15":0,"17":0,"18":0,"20":0,"21":0,"25":0,"26":0,"29":0,"33":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/readme.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/readme.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":1,"11":0,"12":0,"13":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":27},"end":{"line":11,"column":38}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":28},"end":{"line":15,"column":39}}},"3":{"name":"(anonymous_3)","line":19,"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":45}}},"4":{"name":"(anonymous_4)","line":30,"loc":{"start":{"line":30,"column":16},"end":{"line":30,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"3":{"start":{"line":5,"column":0},"end":{"line":9,"column":3}},"4":{"start":{"line":11,"column":0},"end":{"line":13,"column":2}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":28}},"6":{"start":{"line":15,"column":0},"end":{"line":17,"column":2}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":29}},"8":{"start":{"line":19,"column":0},"end":{"line":21,"column":2}},"9":{"start":{"line":20,"column":4},"end":{"line":20,"column":35}},"10":{"start":{"line":30,"column":0},"end":{"line":38,"column":2}},"11":{"start":{"line":31,"column":4},"end":{"line":31,"column":20}},"12":{"start":{"line":33,"column":4},"end":{"line":37,"column":7}},"13":{"start":{"line":40,"column":0},"end":{"line":40,"column":24}}},"branchMap":{"1":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":10},"end":{"line":31,"column":13}},{"start":{"line":31,"column":17},"end":{"line":31,"column":19}}]},"2":{"line":35,"type":"binary-expr","locations":[{"start":{"line":35,"column":15},"end":{"line":35,"column":24}},{"start":{"line":35,"column":28},"end":{"line":35,"column":30}}]},"3":{"line":36,"type":"binary-expr","locations":[{"start":{"line":36,"column":21},"end":{"line":36,"column":36}},{"start":{"line":36,"column":40},"end":{"line":36,"column":42}}]}},"code":["var Immutable = require('immutable');","","var File = require('./file');","","var Readme = Immutable.Record({","    file:           File(),","    title:          String(),","    description:    String()","});","","Readme.prototype.getFile = function() {","    return this.get('file');","};","","Readme.prototype.getTitle = function() {","    return this.get('title');","};","","Readme.prototype.getDescription = function() {","    return this.get('description');","};","","/**","    Create a new readme","","    @param {File} file","    @param {Object} def","    @return {Readme}","*/","Readme.create = function(file, def) {","    def = def || {};","","    return new Readme({","        file: file,","        title: def.title || '',","        description: def.description || ''","    });","};","","module.exports = Readme;",""],"l":{"1":1,"3":1,"5":1,"11":1,"12":0,"15":1,"16":0,"19":1,"20":0,"30":1,"31":0,"33":0,"40":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/summary.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/summary.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":1,"13":0,"14":1,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":1,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":1,"34":0,"35":0,"36":1,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":1,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":1,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":1,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":1,"68":0,"69":0,"70":0,"71":0,"72":1,"73":0,"74":0,"75":0,"76":0,"77":0,"78":1,"79":0,"80":0,"81":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"fnMap":{"1":{"name":"(anonymous_1)","line":16,"loc":{"start":{"line":16,"column":28},"end":{"line":16,"column":39}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":29},"end":{"line":20,"column":40}}},"3":{"name":"(anonymous_3)","line":30,"loc":{"start":{"line":30,"column":28},"end":{"line":30,"column":40}}},"4":{"name":"(anonymous_4)","line":43,"loc":{"start":{"line":43,"column":31},"end":{"line":43,"column":56}}},"5":{"name":"(anonymous_5)","line":46,"loc":{"start":{"line":46,"column":24},"end":{"line":46,"column":47}}},"6":{"name":"(anonymous_6)","line":61,"loc":{"start":{"line":61,"column":31},"end":{"line":61,"column":47}}},"7":{"name":"iterByLevel","line":62,"loc":{"start":{"line":62,"column":4},"end":{"line":62,"column":34}}},"8":{"name":"(anonymous_8)","line":75,"loc":{"start":{"line":75,"column":30},"end":{"line":75,"column":49}}},"9":{"name":"(anonymous_9)","line":76,"loc":{"start":{"line":76,"column":27},"end":{"line":76,"column":45}}},"10":{"name":"(anonymous_10)","line":91,"loc":{"start":{"line":91,"column":36},"end":{"line":91,"column":47}}},"11":{"name":"(anonymous_11)","line":92,"loc":{"start":{"line":92,"column":27},"end":{"line":92,"column":45}}},"12":{"name":"(anonymous_12)","line":103,"loc":{"start":{"line":103,"column":35},"end":{"line":103,"column":53}}},"13":{"name":"(anonymous_13)","line":107,"loc":{"start":{"line":107,"column":27},"end":{"line":107,"column":45}}},"14":{"name":"(anonymous_14)","line":121,"loc":{"start":{"line":121,"column":35},"end":{"line":121,"column":53}}},"15":{"name":"(anonymous_15)","line":125,"loc":{"start":{"line":125,"column":20},"end":{"line":125,"column":38}}},"16":{"name":"(anonymous_16)","line":143,"loc":{"start":{"line":143,"column":30},"end":{"line":143,"column":47}}},"17":{"name":"(anonymous_17)","line":164,"loc":{"start":{"line":164,"column":27},"end":{"line":164,"column":46}}},"18":{"name":"(anonymous_18)","line":186,"loc":{"start":{"line":186,"column":38},"end":{"line":186,"column":49}}},"19":{"name":"(anonymous_19)","line":189,"loc":{"start":{"line":189,"column":20},"end":{"line":189,"column":38}}},"20":{"name":"createFromParts","line":202,"loc":{"start":{"line":202,"column":26},"end":{"line":202,"column":64}}},"21":{"name":"(anonymous_21)","line":203,"loc":{"start":{"line":203,"column":22},"end":{"line":203,"column":40}}},"22":{"name":"getParentLevel","line":223,"loc":{"start":{"line":223,"column":0},"end":{"line":223,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":38}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":49}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":29}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":43}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":49}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":36}},"9":{"start":{"line":11,"column":0},"end":{"line":14,"column":14}},"10":{"start":{"line":16,"column":0},"end":{"line":18,"column":2}},"11":{"start":{"line":17,"column":4},"end":{"line":17,"column":28}},"12":{"start":{"line":20,"column":0},"end":{"line":22,"column":2}},"13":{"start":{"line":21,"column":4},"end":{"line":21,"column":29}},"14":{"start":{"line":30,"column":0},"end":{"line":33,"column":2}},"15":{"start":{"line":31,"column":4},"end":{"line":31,"column":32}},"16":{"start":{"line":32,"column":4},"end":{"line":32,"column":24}},"17":{"start":{"line":43,"column":0},"end":{"line":52,"column":2}},"18":{"start":{"line":44,"column":4},"end":{"line":44,"column":32}},"19":{"start":{"line":46,"column":4},"end":{"line":51,"column":13}},"20":{"start":{"line":47,"column":8},"end":{"line":47,"column":34}},"21":{"start":{"line":47,"column":20},"end":{"line":47,"column":34}},"22":{"start":{"line":49,"column":8},"end":{"line":49,"column":52}},"23":{"start":{"line":49,"column":40},"end":{"line":49,"column":52}},"24":{"start":{"line":50,"column":8},"end":{"line":50,"column":54}},"25":{"start":{"line":61,"column":0},"end":{"line":67,"column":2}},"26":{"start":{"line":62,"column":4},"end":{"line":64,"column":5}},"27":{"start":{"line":63,"column":8},"end":{"line":63,"column":46}},"28":{"start":{"line":66,"column":4},"end":{"line":66,"column":53}},"29":{"start":{"line":75,"column":0},"end":{"line":84,"column":2}},"30":{"start":{"line":76,"column":4},"end":{"line":83,"column":7}},"31":{"start":{"line":77,"column":8},"end":{"line":77,"column":44}},"32":{"start":{"line":79,"column":8},"end":{"line":82,"column":10}},"33":{"start":{"line":91,"column":0},"end":{"line":95,"column":2}},"34":{"start":{"line":92,"column":4},"end":{"line":94,"column":7}},"35":{"start":{"line":93,"column":8},"end":{"line":93,"column":20}},"36":{"start":{"line":103,"column":0},"end":{"line":113,"column":2}},"37":{"start":{"line":104,"column":4},"end":{"line":104,"column":65}},"38":{"start":{"line":105,"column":4},"end":{"line":105,"column":24}},"39":{"start":{"line":107,"column":4},"end":{"line":112,"column":7}},"40":{"start":{"line":108,"column":8},"end":{"line":108,"column":33}},"41":{"start":{"line":108,"column":21},"end":{"line":108,"column":33}},"42":{"start":{"line":110,"column":8},"end":{"line":110,"column":46}},"43":{"start":{"line":111,"column":8},"end":{"line":111,"column":21}},"44":{"start":{"line":121,"column":0},"end":{"line":135,"column":2}},"45":{"start":{"line":122,"column":4},"end":{"line":122,"column":65}},"46":{"start":{"line":123,"column":4},"end":{"line":123,"column":25}},"47":{"start":{"line":125,"column":4},"end":{"line":132,"column":7}},"48":{"start":{"line":126,"column":8},"end":{"line":128,"column":9}},"49":{"start":{"line":127,"column":12},"end":{"line":127,"column":24}},"50":{"start":{"line":130,"column":8},"end":{"line":130,"column":23}},"51":{"start":{"line":131,"column":8},"end":{"line":131,"column":21}},"52":{"start":{"line":134,"column":4},"end":{"line":134,"column":16}},"53":{"start":{"line":143,"column":0},"end":{"line":156,"column":2}},"54":{"start":{"line":145,"column":4},"end":{"line":145,"column":55}},"55":{"start":{"line":148,"column":4},"end":{"line":148,"column":44}},"56":{"start":{"line":149,"column":4},"end":{"line":151,"column":5}},"57":{"start":{"line":150,"column":8},"end":{"line":150,"column":20}},"58":{"start":{"line":154,"column":4},"end":{"line":154,"column":53}},"59":{"start":{"line":155,"column":4},"end":{"line":155,"column":33}},"60":{"start":{"line":164,"column":0},"end":{"line":179,"column":2}},"61":{"start":{"line":165,"column":4},"end":{"line":165,"column":30}},"62":{"start":{"line":166,"column":4},"end":{"line":166,"column":32}},"63":{"start":{"line":168,"column":4},"end":{"line":168,"column":73}},"64":{"start":{"line":170,"column":4},"end":{"line":174,"column":5}},"65":{"start":{"line":171,"column":8},"end":{"line":173,"column":11}},"66":{"start":{"line":176,"column":4},"end":{"line":178,"column":7}},"67":{"start":{"line":186,"column":0},"end":{"line":194,"column":2}},"68":{"start":{"line":187,"column":4},"end":{"line":187,"column":18}},"69":{"start":{"line":189,"column":4},"end":{"line":191,"column":7}},"70":{"start":{"line":190,"column":8},"end":{"line":190,"column":27}},"71":{"start":{"line":193,"column":4},"end":{"line":193,"column":32}},"72":{"start":{"line":202,"column":0},"end":{"line":215,"column":2}},"73":{"start":{"line":203,"column":4},"end":{"line":209,"column":7}},"74":{"start":{"line":204,"column":8},"end":{"line":206,"column":9}},"75":{"start":{"line":205,"column":12},"end":{"line":205,"column":24}},"76":{"start":{"line":208,"column":8},"end":{"line":208,"column":47}},"77":{"start":{"line":211,"column":4},"end":{"line":214,"column":7}},"78":{"start":{"line":223,"column":0},"end":{"line":226,"column":1}},"79":{"start":{"line":224,"column":4},"end":{"line":224,"column":33}},"80":{"start":{"line":225,"column":4},"end":{"line":225,"column":40}},"81":{"start":{"line":228,"column":0},"end":{"line":228,"column":25}}},"branchMap":{"1":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":8},"end":{"line":47,"column":8}},{"start":{"line":47,"column":8},"end":{"line":47,"column":8}}]},"2":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":8},"end":{"line":49,"column":8}},{"start":{"line":49,"column":8},"end":{"line":49,"column":8}}]},"3":{"line":49,"type":"binary-expr","locations":[{"start":{"line":49,"column":12},"end":{"line":49,"column":20}},{"start":{"line":49,"column":24},"end":{"line":49,"column":38}}]},"4":{"line":80,"type":"binary-expr","locations":[{"start":{"line":80,"column":12},"end":{"line":80,"column":23}},{"start":{"line":81,"column":12},"end":{"line":81,"column":66}}]},"5":{"line":104,"type":"cond-expr","locations":[{"start":{"line":104,"column":36},"end":{"line":104,"column":43}},{"start":{"line":104,"column":46},"end":{"line":104,"column":64}}]},"6":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":8},"end":{"line":108,"column":8}},{"start":{"line":108,"column":8},"end":{"line":108,"column":8}}]},"7":{"line":122,"type":"cond-expr","locations":[{"start":{"line":122,"column":36},"end":{"line":122,"column":43}},{"start":{"line":122,"column":46},"end":{"line":122,"column":64}}]},"8":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":8},"end":{"line":126,"column":8}},{"start":{"line":126,"column":8},"end":{"line":126,"column":8}}]},"9":{"line":145,"type":"cond-expr","locations":[{"start":{"line":145,"column":30},"end":{"line":145,"column":35}},{"start":{"line":145,"column":38},"end":{"line":145,"column":54}}]},"10":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":4},"end":{"line":149,"column":4}},{"start":{"line":149,"column":4},"end":{"line":149,"column":4}}]},"11":{"line":155,"type":"binary-expr","locations":[{"start":{"line":155,"column":11},"end":{"line":155,"column":24}},{"start":{"line":155,"column":28},"end":{"line":155,"column":32}}]},"12":{"line":168,"type":"cond-expr","locations":[{"start":{"line":168,"column":27},"end":{"line":168,"column":53}},{"start":{"line":168,"column":56},"end":{"line":168,"column":72}}]},"13":{"line":170,"type":"if","locations":[{"start":{"line":170,"column":4},"end":{"line":170,"column":4}},{"start":{"line":170,"column":4},"end":{"line":170,"column":4}}]},"14":{"line":204,"type":"if","locations":[{"start":{"line":204,"column":8},"end":{"line":204,"column":8}},{"start":{"line":204,"column":8},"end":{"line":204,"column":8}}]}},"code":["var is = require('is');","var Immutable = require('immutable');","","var error = require('../utils/error');","var LocationUtils = require('../utils/location');","var File = require('./file');","var SummaryPart = require('./summaryPart');","var SummaryArticle = require('./summaryArticle');","var parsers = require('../parsers');","","var Summary = Immutable.Record({","    file:       File(),","    parts:      Immutable.List()","}, 'Summary');","","Summary.prototype.getFile = function() {","    return this.get('file');","};","","Summary.prototype.getParts = function() {","    return this.get('parts');","};","","/**","    Return a part by its index","","    @param {Number}","    @return {Part}","*/","Summary.prototype.getPart = function(i) {","    var parts = this.getParts();","    return parts.get(i);","};","","/**","    Return an article using an iterator to find it.","    if \"partIter\" is set, it can also return a Part.","","    @param {Function} iter","    @param {Function} partIter","    @return {Article|Part}","*/","Summary.prototype.getArticle = function(iter, partIter) {","    var parts = this.getParts();","","    return parts.reduce(function(result, part) {","        if (result) return result;","","        if (partIter && partIter(part)) return part;","        return SummaryArticle.findArticle(part, iter);","    }, null);","};","","","/**","    Return a part/article by its level","","    @param {String} level","    @return {Article|Part}","*/","Summary.prototype.getByLevel = function(level) {","    function iterByLevel(article) {","        return (article.getLevel() === level);","    }","","    return this.getArticle(iterByLevel, iterByLevel);","};","","/**","    Return an article by its path","","    @param {String} filePath","    @return {Article}","*/","Summary.prototype.getByPath = function(filePath) {","    return this.getArticle(function(article) {","        var articlePath = article.getPath();","","        return (","            articlePath &&","            LocationUtils.areIdenticalPaths(articlePath, filePath)","        );","    });","};","","/**","    Return the first article","","    @return {Article}","*/","Summary.prototype.getFirstArticle = function() {","    return this.getArticle(function(article) {","        return true;","    });","};","","/**","    Return next article of an article","","    @param {Article} current","    @return {Article}","*/","Summary.prototype.getNextArticle = function(current) {","    var level = is.string(current)? current : current.getLevel();","    var wasPrev = false;","","    return this.getArticle(function(article) {","        if (wasPrev) return true;","","        wasPrev = article.getLevel() == level;","        return false;","    });","};","","/**","    Return previous article of an article","","    @param {Article} current","    @return {Article}","*/","Summary.prototype.getPrevArticle = function(current) {","    var level = is.string(current)? current : current.getLevel();","    var prev = undefined;","","    this.getArticle(function(article) {","        if (article.getLevel() == level) {","            return true;","        }","","        prev = article;","        return false;","    });","","    return prev;","};","","/**","    Return the parent article, or parent part of an article","","    @param {String|Article} current","    @return {Article|Part|Null}","*/","Summary.prototype.getParent = function (level) {","    // Coerce to level","    level = is.string(level)? level : level.getLevel();","","    // Get parent level","    var parentLevel = getParentLevel(level);","    if (!parentLevel) {","        return null;","    }","","    // Get parent of the position","    var parentArticle = this.getByLevel(parentLevel);","    return parentArticle || null;","};","","/**","    Render summary as text","","    @param {String} parseExt Extension of the parser to use","    @return {Promise<String>}","*/","Summary.prototype.toText = function(parseExt) {","    var file = this.getFile();","    var parts = this.getParts();","","    var parser = parseExt? parsers.getByExt(parseExt) : file.getParser();","","    if (!parser) {","        throw error.FileNotParsableError({","            filename: file.getPath()","        });","    }","","    return parser.renderSummary({","        parts: parts.toJS()","    });","};","","/**","    Return all articles as a list","","    @return {List<Article>}","*/","Summary.prototype.getArticlesAsList = function() {","    var accu = [];","","    this.getArticle(function(article) {","        accu.push(article);","    });","","    return Immutable.List(accu);","};","","/**","    Create a new summary for a list of parts","","    @param {Lust|Array} parts","    @return {Summary}","*/","Summary.createFromParts = function createFromParts(file, parts) {","    parts = parts.map(function(part, i) {","        if (part instanceof SummaryPart) {","            return part;","        }","","        return SummaryPart.create(part, i + 1);","    });","","    return new Summary({","        file: file,","        parts: new Immutable.List(parts)","    });","};","","/**","    Returns parent level of a level","","    @param {String} level","    @return {String}","*/","function getParentLevel(level) {","    var parts = level.split('.');","    return parts.slice(0, -1).join('.');","}","","module.exports = Summary;",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"11":1,"16":1,"17":0,"20":1,"21":0,"30":1,"31":0,"32":0,"43":1,"44":0,"46":0,"47":0,"49":0,"50":0,"61":1,"62":1,"63":0,"66":0,"75":1,"76":0,"77":0,"79":0,"91":1,"92":0,"93":0,"103":1,"104":0,"105":0,"107":0,"108":0,"110":0,"111":0,"121":1,"122":0,"123":0,"125":0,"126":0,"127":0,"130":0,"131":0,"134":0,"143":1,"145":0,"148":0,"149":0,"150":0,"154":0,"155":0,"164":1,"165":0,"166":0,"168":0,"170":0,"171":0,"176":0,"186":1,"187":0,"189":0,"190":0,"193":0,"202":1,"203":0,"204":0,"205":0,"208":0,"211":0,"223":1,"224":0,"225":0,"228":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/glossary.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/glossary.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":1,"10":0,"11":1,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":1,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":29},"end":{"line":13,"column":40}}},"2":{"name":"(anonymous_2)","line":17,"loc":{"start":{"line":17,"column":32},"end":{"line":17,"column":43}}},"3":{"name":"(anonymous_3)","line":27,"loc":{"start":{"line":27,"column":30},"end":{"line":27,"column":45}}},"4":{"name":"(anonymous_4)","line":39,"loc":{"start":{"line":39,"column":28},"end":{"line":39,"column":45}}},"5":{"name":"addEntry","line":62,"loc":{"start":{"line":62,"column":20},"end":{"line":62,"column":55}}},"6":{"name":"addEntryByName","line":77,"loc":{"start":{"line":77,"column":26},"end":{"line":77,"column":79}}},"7":{"name":"createFromEntries","line":93,"loc":{"start":{"line":93,"column":29},"end":{"line":93,"column":71}}},"8":{"name":"(anonymous_8)","line":94,"loc":{"start":{"line":94,"column":26},"end":{"line":94,"column":42}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":38}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":29}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":47}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":36}},"6":{"start":{"line":8,"column":0},"end":{"line":11,"column":3}},"7":{"start":{"line":13,"column":0},"end":{"line":15,"column":2}},"8":{"start":{"line":14,"column":4},"end":{"line":14,"column":28}},"9":{"start":{"line":17,"column":0},"end":{"line":19,"column":2}},"10":{"start":{"line":18,"column":4},"end":{"line":18,"column":31}},"11":{"start":{"line":27,"column":0},"end":{"line":32,"column":2}},"12":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"13":{"start":{"line":29,"column":4},"end":{"line":29,"column":42}},"14":{"start":{"line":31,"column":4},"end":{"line":31,"column":27}},"15":{"start":{"line":39,"column":0},"end":{"line":52,"column":2}},"16":{"start":{"line":40,"column":4},"end":{"line":40,"column":30}},"17":{"start":{"line":41,"column":4},"end":{"line":41,"column":36}},"18":{"start":{"line":43,"column":4},"end":{"line":43,"column":65}},"19":{"start":{"line":45,"column":4},"end":{"line":49,"column":5}},"20":{"start":{"line":46,"column":8},"end":{"line":48,"column":11}},"21":{"start":{"line":51,"column":4},"end":{"line":51,"column":49}},"22":{"start":{"line":62,"column":0},"end":{"line":68,"column":2}},"23":{"start":{"line":63,"column":4},"end":{"line":63,"column":27}},"24":{"start":{"line":64,"column":4},"end":{"line":64,"column":40}},"25":{"start":{"line":66,"column":4},"end":{"line":66,"column":37}},"26":{"start":{"line":67,"column":4},"end":{"line":67,"column":44}},"27":{"start":{"line":77,"column":0},"end":{"line":84,"column":2}},"28":{"start":{"line":78,"column":4},"end":{"line":81,"column":7}},"29":{"start":{"line":83,"column":4},"end":{"line":83,"column":46}},"30":{"start":{"line":93,"column":0},"end":{"line":106,"column":2}},"31":{"start":{"line":94,"column":4},"end":{"line":100,"column":7}},"32":{"start":{"line":95,"column":8},"end":{"line":97,"column":9}},"33":{"start":{"line":96,"column":12},"end":{"line":96,"column":45}},"34":{"start":{"line":99,"column":8},"end":{"line":99,"column":38}},"35":{"start":{"line":102,"column":4},"end":{"line":105,"column":7}},"36":{"start":{"line":109,"column":0},"end":{"line":109,"column":26}}},"branchMap":{"1":{"line":43,"type":"cond-expr","locations":[{"start":{"line":43,"column":21},"end":{"line":43,"column":45}},{"start":{"line":43,"column":48},"end":{"line":43,"column":64}}]},"2":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":4},"end":{"line":45,"column":4}},{"start":{"line":45,"column":4},"end":{"line":45,"column":4}}]},"3":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":8},"end":{"line":95,"column":8}},{"start":{"line":95,"column":8},"end":{"line":95,"column":8}}]}},"code":["var Immutable = require('immutable');","","var error = require('../utils/error');","var File = require('./file');","var GlossaryEntry = require('./glossaryEntry');","var parsers = require('../parsers');","","var Glossary = Immutable.Record({","    file:       File(),","    entries:    Immutable.OrderedMap()","});","","Glossary.prototype.getFile = function() {","    return this.get('file');","};","","Glossary.prototype.getEntries = function() {","    return this.get('entries');","};","","/**","    Return an entry by its name","","    @param {String} name","    @return {GlossaryEntry}","*/","Glossary.prototype.getEntry = function(name) {","    var entries = this.getEntries();","    var id = GlossaryEntry.nameToID(name);","","    return entries.get(id);","};","","/**","    Render glossary as text","","    @return {Promise<String>}","*/","Glossary.prototype.toText = function(parser) {","    var file = this.getFile();","    var entries = this.getEntries();","","    parser = parser? parsers.getByExt(parser) : file.getParser();","","    if (!parser) {","        throw error.FileNotParsableError({","            filename: file.getPath()","        });","    }","","    return parser.renderGlossary(entries.toJS());","};","","","/**","    Add/Replace an entry to a glossary","","    @param {Glossary} glossary","    @param {GlossaryEntry} entry","    @return {Glossary}","*/","Glossary.addEntry = function addEntry(glossary, entry) {","    var id = entry.getID();","    var entries = glossary.getEntries();","","    entries = entries.set(id, entry);","    return glossary.set('entries', entries);","};","","/**","    Add/Replace an entry to a glossary by name/description","","    @param {Glossary} glossary","    @param {GlossaryEntry} entry","    @return {Glossary}","*/","Glossary.addEntryByName = function addEntryByName(glossary, name, description) {","    var entry = new GlossaryEntry({","        name: name,","        description: description","    });","","    return Glossary.addEntry(glossary, entry);","};","","/**","    Create a glossary from a list of entries","","    @param {String} filename","    @param {Array|List} entries","    @return {Glossary}","*/","Glossary.createFromEntries = function createFromEntries(file, entries) {","    entries = entries.map(function(entry) {","        if (!(entry instanceof GlossaryEntry)) {","            entry = new GlossaryEntry(entry);","        }","","        return [entry.getID(), entry];","    });","","    return new Glossary({","        file: file,","        entries: Immutable.OrderedMap(entries)","    });","};","","","module.exports = Glossary;",""],"l":{"1":1,"3":1,"4":1,"5":1,"6":1,"8":1,"13":1,"14":0,"17":1,"18":0,"27":1,"28":0,"29":0,"31":0,"39":1,"40":0,"41":0,"43":0,"45":0,"46":0,"51":0,"62":1,"63":0,"64":0,"66":0,"67":0,"77":1,"78":0,"83":0,"93":1,"94":0,"95":0,"96":0,"99":0,"102":0,"109":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/glossaryEntry.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/glossaryEntry.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":1,"11":0,"12":1},"b":{},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":34},"end":{"line":13,"column":45}}},"2":{"name":"(anonymous_2)","line":17,"loc":{"start":{"line":17,"column":41},"end":{"line":17,"column":52}}},"3":{"name":"(anonymous_3)","line":27,"loc":{"start":{"line":27,"column":32},"end":{"line":27,"column":43}}},"4":{"name":"nameToID","line":38,"loc":{"start":{"line":38,"column":25},"end":{"line":38,"column":49}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":36}},"3":{"start":{"line":8,"column":0},"end":{"line":11,"column":3}},"4":{"start":{"line":13,"column":0},"end":{"line":15,"column":2}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":28}},"6":{"start":{"line":17,"column":0},"end":{"line":19,"column":2}},"7":{"start":{"line":18,"column":4},"end":{"line":18,"column":35}},"8":{"start":{"line":27,"column":0},"end":{"line":29,"column":2}},"9":{"start":{"line":28,"column":4},"end":{"line":28,"column":50}},"10":{"start":{"line":38,"column":0},"end":{"line":40,"column":2}},"11":{"start":{"line":39,"column":4},"end":{"line":39,"column":22}},"12":{"start":{"line":43,"column":0},"end":{"line":43,"column":31}}},"branchMap":{},"code":["var Immutable = require('immutable');","var slug = require('github-slugid');","","/*","    A definition represents an entry in the glossary","*/","","var GlossaryEntry = Immutable.Record({","    name:               String(),","    description:        String()","});","","GlossaryEntry.prototype.getName = function() {","    return this.get('name');","};","","GlossaryEntry.prototype.getDescription = function() {","    return this.get('description');","};","","","/**","    Get identifier for this entry","","    @retrun {Boolean}","*/","GlossaryEntry.prototype.getID = function() {","    return GlossaryEntry.nameToID(this.getName());","};","","","/**","    Normalize a glossary entry name into a unique id","","    @param {String}","    @return {String}","*/","GlossaryEntry.nameToID = function nameToID(name) {","    return slug(name);","};","","","module.exports = GlossaryEntry;",""],"l":{"1":1,"2":1,"8":1,"13":1,"14":0,"17":1,"18":0,"27":1,"28":0,"38":1,"39":0,"43":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/languages.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/languages.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":0,"9":1,"10":0,"11":1,"12":0,"13":1,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":30},"end":{"line":11,"column":41}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":30},"end":{"line":15,"column":41}}},"3":{"name":"(anonymous_3)","line":24,"loc":{"start":{"line":24,"column":41},"end":{"line":24,"column":52}}},"4":{"name":"(anonymous_4)","line":34,"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":49}}},"5":{"name":"(anonymous_5)","line":43,"loc":{"start":{"line":43,"column":31},"end":{"line":43,"column":42}}},"6":{"name":"(anonymous_6)","line":54,"loc":{"start":{"line":54,"column":27},"end":{"line":54,"column":49}}},"7":{"name":"(anonymous_7)","line":57,"loc":{"start":{"line":57,"column":18},"end":{"line":57,"column":33}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":37}},"4":{"start":{"line":6,"column":0},"end":{"line":9,"column":3}},"5":{"start":{"line":11,"column":0},"end":{"line":13,"column":2}},"6":{"start":{"line":12,"column":4},"end":{"line":12,"column":28}},"7":{"start":{"line":15,"column":0},"end":{"line":17,"column":2}},"8":{"start":{"line":16,"column":4},"end":{"line":16,"column":28}},"9":{"start":{"line":24,"column":0},"end":{"line":26,"column":2}},"10":{"start":{"line":25,"column":4},"end":{"line":25,"column":34}},"11":{"start":{"line":34,"column":0},"end":{"line":36,"column":2}},"12":{"start":{"line":35,"column":4},"end":{"line":35,"column":36}},"13":{"start":{"line":43,"column":0},"end":{"line":45,"column":2}},"14":{"start":{"line":44,"column":4},"end":{"line":44,"column":31}},"15":{"start":{"line":54,"column":0},"end":{"line":69,"column":2}},"16":{"start":{"line":55,"column":4},"end":{"line":55,"column":38}},"17":{"start":{"line":57,"column":4},"end":{"line":63,"column":7}},"18":{"start":{"line":58,"column":8},"end":{"line":61,"column":11}},"19":{"start":{"line":62,"column":8},"end":{"line":62,"column":44}},"20":{"start":{"line":65,"column":4},"end":{"line":68,"column":7}},"21":{"start":{"line":71,"column":0},"end":{"line":71,"column":27}}},"branchMap":{},"code":["var Immutable = require('immutable');","","var File = require('./file');","var Language = require('./language');","","var Languages = Immutable.Record({","    file:       File(),","    list:       Immutable.OrderedMap()","});","","Languages.prototype.getFile = function() {","    return this.get('file');","};","","Languages.prototype.getList = function() {","    return this.get('list');","};","","/**","    Get default languages","","    @return {Language}","*/","Languages.prototype.getDefaultLanguage = function() {","    return this.getList().first();","};","","/**","    Get a language by its ID","","    @param {String} lang","    @return {Language}","*/","Languages.prototype.getLanguage = function(lang) {","    return this.getList().get(lang);","};","","/**","    Return count of langs","","    @return {Number}","*/","Languages.prototype.getCount = function() {","    return this.getList().size;","};","","/**","    Create a languages list from a JS object","","    @param {File}","    @param {Array}","    @return {Language}","*/","Languages.createFromList = function(file, langs) {","    var list = Immutable.OrderedMap();","","    langs.forEach(function(lang) {","        lang = Language({","            title: lang.title,","            path: lang.ref","        });","        list = list.set(lang.getID(), lang);","    });","","    return Languages({","        file: file,","        list: list","    });","};","","module.exports = Languages;",""],"l":{"1":1,"3":1,"4":1,"6":1,"11":1,"12":0,"15":1,"16":0,"24":1,"25":0,"34":1,"35":0,"43":1,"44":0,"54":1,"55":0,"57":0,"58":0,"62":0,"65":0,"71":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/language.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/language.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":1},"b":{},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":9,"loc":{"start":{"line":9,"column":30},"end":{"line":9,"column":41}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":29},"end":{"line":13,"column":40}}},"3":{"name":"(anonymous_3)","line":17,"loc":{"start":{"line":17,"column":27},"end":{"line":17,"column":38}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":7,"column":3}},"4":{"start":{"line":9,"column":0},"end":{"line":11,"column":2}},"5":{"start":{"line":10,"column":4},"end":{"line":10,"column":29}},"6":{"start":{"line":13,"column":0},"end":{"line":15,"column":2}},"7":{"start":{"line":14,"column":4},"end":{"line":14,"column":28}},"8":{"start":{"line":17,"column":0},"end":{"line":19,"column":2}},"9":{"start":{"line":18,"column":4},"end":{"line":18,"column":41}},"10":{"start":{"line":21,"column":0},"end":{"line":21,"column":26}}},"branchMap":{},"code":["var path = require('path');","var Immutable = require('immutable');","","var Language = Immutable.Record({","    title:      String(),","    path:       String()","});","","Language.prototype.getTitle = function() {","    return this.get('title');","};","","Language.prototype.getPath = function() {","    return this.get('path');","};","","Language.prototype.getID = function() {","    return path.basename(this.getPath());","};","","module.exports = Language;",""],"l":{"1":1,"2":1,"4":1,"9":1,"10":0,"13":1,"14":0,"17":1,"18":0,"21":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/ignore.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/ignore.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1},"b":{},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":29},"end":{"line":11,"column":40}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":33},"end":{"line":21,"column":52}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":23},"end":{"line":32,"column":38}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":38}},"3":{"start":{"line":7,"column":0},"end":{"line":9,"column":13}},"4":{"start":{"line":11,"column":0},"end":{"line":13,"column":2}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":30}},"6":{"start":{"line":21,"column":0},"end":{"line":24,"column":2}},"7":{"start":{"line":22,"column":4},"end":{"line":22,"column":34}},"8":{"start":{"line":23,"column":4},"end":{"line":23,"column":49}},"9":{"start":{"line":32,"column":0},"end":{"line":40,"column":2}},"10":{"start":{"line":33,"column":4},"end":{"line":33,"column":34}},"11":{"start":{"line":34,"column":4},"end":{"line":34,"column":40}},"12":{"start":{"line":36,"column":4},"end":{"line":36,"column":26}},"13":{"start":{"line":37,"column":4},"end":{"line":37,"column":24}},"14":{"start":{"line":39,"column":4},"end":{"line":39,"column":41}},"15":{"start":{"line":42,"column":0},"end":{"line":42,"column":24}}},"branchMap":{},"code":["var Immutable = require('immutable');","var IgnoreMutable = require('ignore');","","/*","    Immutable version of node-ignore","*/","var Ignore = Immutable.Record({","    ignore: new IgnoreMutable()","}, 'Ignore');","","Ignore.prototype.getIgnore = function() {","    return this.get('ignore');","};","","/**","    Test if a file is ignored by these rules","","    @param {String} filePath","    @return {Boolean}","*/","Ignore.prototype.isFileIgnored = function(filename) {","    var ignore = this.getIgnore();","    return ignore.filter([filename]).length == 0;","};","","/**","    Add rules","","    @param {String}","    @return {Ignore}","*/","Ignore.prototype.add = function(rule) {","    var ignore = this.getIgnore();","    var newIgnore = new IgnoreMutable();","","    newIgnore.add(ignore);","    newIgnore.add(rule);","","    return this.set('ignore', newIgnore);","};","","module.exports = Ignore;",""],"l":{"1":1,"2":1,"7":1,"11":1,"12":0,"21":1,"22":0,"23":0,"32":1,"33":0,"34":0,"36":0,"37":0,"39":0,"42":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseIgnore.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseIgnore.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"parseIgnore","line":27,"loc":{"start":{"line":27,"column":0},"end":{"line":27,"column":27}}},"2":{"name":"(anonymous_2)","line":37,"loc":{"start":{"line":37,"column":39},"end":{"line":37,"column":58}}},"3":{"name":"(anonymous_3)","line":39,"loc":{"start":{"line":39,"column":14},"end":{"line":39,"column":32}}},"4":{"name":"(anonymous_4)","line":41,"loc":{"start":{"line":41,"column":11},"end":{"line":41,"column":25}}},"5":{"name":"(anonymous_5)","line":46,"loc":{"start":{"line":46,"column":10},"end":{"line":46,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":55}},"3":{"start":{"line":4,"column":0},"end":{"line":19,"column":2}},"4":{"start":{"line":27,"column":0},"end":{"line":49,"column":1}},"5":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"6":{"start":{"line":29,"column":8},"end":{"line":29,"column":92}},"7":{"start":{"line":32,"column":4},"end":{"line":32,"column":26}},"8":{"start":{"line":33,"column":4},"end":{"line":33,"column":34}},"9":{"start":{"line":35,"column":4},"end":{"line":35,"column":41}},"10":{"start":{"line":37,"column":4},"end":{"line":48,"column":7}},"11":{"start":{"line":38,"column":8},"end":{"line":43,"column":11}},"12":{"start":{"line":40,"column":12},"end":{"line":40,"column":67}},"13":{"start":{"line":42,"column":12},"end":{"line":42,"column":29}},"14":{"start":{"line":47,"column":8},"end":{"line":47,"column":38}},"15":{"start":{"line":51,"column":0},"end":{"line":51,"column":29}}},"branchMap":{"1":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":28,"column":4}},{"start":{"line":28,"column":4},"end":{"line":28,"column":4}}]}},"code":["var Promise = require('../utils/promise');","var IGNORE_FILES = require('../constants/ignoreFiles');","","var DEFAULT_IGNORES = [","    // Skip Git stuff","    '.git/',","","    // Skip OS X meta data","    '.DS_Store',","","    // Skip stuff installed by plugins","    'node_modules',","","    // Skip book outputs","    '_book',","","    // Ignore files in the templates folder","    '_layouts'","];","","/**","    Parse ignore files","","    @param {Book}","    @return {Book}","*/","function parseIgnore(book) {","    if (book.isLanguageBook()) {","        return Promise.reject(new Error('Ignore files could be parsed for language books'));","    }","","    var fs = book.getFS();","    var ignore = book.getIgnore();","","    ignore = ignore.add(DEFAULT_IGNORES);","","    return Promise.serie(IGNORE_FILES, function(filename) {","        return fs.readAsString(filename)","        .then(function(content) {","            ignore = ignore.add(content.toString().split(/\\r?\\n/));","        }, function(err) {","            return Promise();","        });","    })","","    .then(function() {","        return book.setIgnore(ignore);","    });","}","","module.exports = parseIgnore;",""],"l":{"1":1,"2":1,"4":1,"27":1,"28":0,"29":0,"32":0,"33":0,"35":0,"37":0,"38":0,"40":0,"42":0,"47":0,"51":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/ignoreFiles.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/ignoreFiles.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":6,"column":2}}},"branchMap":{},"code":["// Files containing ignore pattner (sorted by priority)","module.exports = [","    '.ignore',","    '.gitignore',","    '.bookignore'","];",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseConfig.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseConfig.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"parseConfig","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":27}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":38},"end":{"line":16,"column":57}}},"3":{"name":"(anonymous_3)","line":24,"loc":{"start":{"line":24,"column":14},"end":{"line":24,"column":28}}},"4":{"name":"(anonymous_4)","line":26,"loc":{"start":{"line":26,"column":18},"end":{"line":26,"column":33}}},"5":{"name":"(anonymous_5)","line":33,"loc":{"start":{"line":33,"column":14},"end":{"line":33,"column":28}}},"6":{"name":"(anonymous_6)","line":39,"loc":{"start":{"line":39,"column":10},"end":{"line":39,"column":27}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":49}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":55}},"4":{"start":{"line":12,"column":0},"end":{"line":53,"column":1}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":26}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":34}},"7":{"start":{"line":16,"column":4},"end":{"line":52,"column":7}},"8":{"start":{"line":18,"column":8},"end":{"line":20,"column":9}},"9":{"start":{"line":19,"column":12},"end":{"line":19,"column":19}},"10":{"start":{"line":23,"column":8},"end":{"line":36,"column":11}},"11":{"start":{"line":25,"column":12},"end":{"line":31,"column":15}},"12":{"start":{"line":27,"column":16},"end":{"line":30,"column":18}},"13":{"start":{"line":34,"column":12},"end":{"line":35,"column":39}},"14":{"start":{"line":34,"column":48},"end":{"line":34,"column":59}},"15":{"start":{"line":35,"column":17},"end":{"line":35,"column":39}},"16":{"start":{"line":40,"column":8},"end":{"line":40,"column":48}},"17":{"start":{"line":41,"column":8},"end":{"line":41,"column":40}},"18":{"start":{"line":44,"column":8},"end":{"line":46,"column":9}},"19":{"start":{"line":45,"column":12},"end":{"line":45,"column":49}},"20":{"start":{"line":49,"column":8},"end":{"line":49,"column":44}},"21":{"start":{"line":51,"column":8},"end":{"line":51,"column":38}},"22":{"start":{"line":55,"column":0},"end":{"line":55,"column":29}}},"branchMap":{"1":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":8},"end":{"line":18,"column":8}},{"start":{"line":18,"column":8},"end":{"line":18,"column":8}}]},"2":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":12},"end":{"line":34,"column":12}},{"start":{"line":34,"column":12},"end":{"line":34,"column":12}}]},"3":{"line":40,"type":"cond-expr","locations":[{"start":{"line":40,"column":29},"end":{"line":40,"column":42}},{"start":{"line":40,"column":45},"end":{"line":40,"column":47}}]},"4":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":8},"end":{"line":44,"column":8}},{"start":{"line":44,"column":8},"end":{"line":44,"column":8}}]}},"code":["var Promise = require('../utils/promise');","","var validateConfig = require('./validateConfig');","var CONFIG_FILES = require('../constants/configFiles');","","/**","    Parse configuration from \"book.json\" or \"book.js\"","","    @param {Book} book","    @return {Promise<Book>}","*/","function parseConfig(book) {","    var fs = book.getFS();","    var config = book.getConfig();","","    return Promise.some(CONFIG_FILES, function(filename) {","        // Is this file ignored?","        if (book.isFileIgnored(filename)) {","            return;","        }","","        // Try loading it","        return fs.loadAsObject(filename)","        .then(function(cfg) {","            return fs.statFile(filename)","            .then(function(file) {","                return {","                    file: file,","                    values: cfg","                };","            });","        })","        .fail(function(err) {","            if (err.code != 'MODULE_NOT_FOUND') throw(err);","            else return Promise(false);","        });","    })","","    .then(function(result) {","        var values = result? result.values : {};","        values = validateConfig(values);","","        // Set the file","        if (result.file) {","            config = config.setFile(result.file);","        }","","        // Merge with old values","        config = config.mergeValues(values);","","        return book.setConfig(config);","    });","}","","module.exports = parseConfig;",""],"l":{"1":1,"3":1,"4":1,"12":1,"13":0,"14":0,"16":0,"18":0,"19":0,"23":0,"25":0,"27":0,"34":0,"35":0,"40":0,"41":0,"44":0,"45":0,"49":0,"51":0,"55":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/validateConfig.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/validateConfig.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"validateConfig","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":34}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":39}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":57}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":50}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":38}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":54}},"6":{"start":{"line":15,"column":0},"end":{"line":29,"column":1}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":39}},"8":{"start":{"line":17,"column":4},"end":{"line":19,"column":7}},"9":{"start":{"line":22,"column":4},"end":{"line":24,"column":5}},"10":{"start":{"line":23,"column":8},"end":{"line":23,"column":78}},"11":{"start":{"line":27,"column":4},"end":{"line":27,"column":46}},"12":{"start":{"line":28,"column":4},"end":{"line":28,"column":45}},"13":{"start":{"line":31,"column":0},"end":{"line":31,"column":32}}},"branchMap":{"1":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":22,"column":4}},{"start":{"line":22,"column":4},"end":{"line":22,"column":4}}]}},"code":["var jsonschema = require('jsonschema');","var jsonSchemaDefaults = require('json-schema-defaults');","","var schema = require('../constants/configSchema');","var error = require('../utils/error');","var mergeDefaults = require('../utils/mergeDefaults');","","/**","    Validate a book.json content","    And return a mix with the default value","","    @param {Object} bookJson","    @return {Object}","*/","function validateConfig(bookJson) {","    var v = new jsonschema.Validator();","    var result = v.validate(bookJson, schema, {","        propertyName: 'config'","    });","","    // Throw error","    if (result.errors.length > 0) {","        throw new error.ConfigurationError(new Error(result.errors[0].stack));","    }","","    // Insert default values","    var defaults = jsonSchemaDefaults(schema);","    return mergeDefaults(bookJson, defaults);","}","","module.exports = validateConfig;",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"15":1,"16":0,"17":0,"22":0,"23":0,"27":0,"28":0,"31":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/mergeDefaults.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/mergeDefaults.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"mergeDefaults","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":33}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":9,"column":0},"end":{"line":14,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":10,"column":41}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":41}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":47}},"6":{"start":{"line":16,"column":0},"end":{"line":16,"column":31}}},"branchMap":{},"code":["var Immutable = require('immutable');","","/**"," * Merge"," * @param  {Object|Map} obj"," * @param  {Object|Map} src"," * @return {Object}"," */","function mergeDefaults(obj, src) {","    var objValue = Immutable.fromJS(obj);","    var srcValue = Immutable.fromJS(src);","","    return srcValue.mergeDeep(objValue).toJS();","}","","module.exports = mergeDefaults;",""],"l":{"1":1,"9":1,"10":0,"11":0,"13":0,"16":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/configFiles.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/configFiles.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":5,"column":2}}},"branchMap":{},"code":["// Configuration files to test (sorted)","module.exports = [","    'book.js',","    'book.json'","];",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseGlossary.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseGlossary.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"parseGlossary","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":29}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":12},"end":{"line":14,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":57}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":45}},"3":{"start":{"line":10,"column":0},"end":{"line":24,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":34}},"5":{"start":{"line":13,"column":4},"end":{"line":23,"column":7}},"6":{"start":{"line":15,"column":8},"end":{"line":17,"column":9}},"7":{"start":{"line":16,"column":12},"end":{"line":16,"column":24}},"8":{"start":{"line":19,"column":8},"end":{"line":19,"column":72}},"9":{"start":{"line":21,"column":8},"end":{"line":21,"column":65}},"10":{"start":{"line":22,"column":8},"end":{"line":22,"column":46}},"11":{"start":{"line":26,"column":0},"end":{"line":26,"column":31}}},"branchMap":{"1":{"line":15,"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":8}},{"start":{"line":15,"column":8},"end":{"line":15,"column":8}}]}},"code":["var parseStructureFile = require('./parseStructureFile');","var Glossary = require('../models/glossary');","","/**","    Parse glossary","","    @param {Book} book","    @return {Promise<Book>}","*/","function parseGlossary(book) {","    var logger = book.getLogger();","","    return parseStructureFile(book, 'glossary')","    .spread(function(file, entries) {","        if (!file) {","            return book;","        }","","        logger.debug.ln('glossary index file found at', file.getPath());","","        var glossary = Glossary.createFromEntries(file, entries);","        return book.set('glossary', glossary);","    });","}","","module.exports = parseGlossary;",""],"l":{"1":1,"2":1,"10":1,"11":0,"13":0,"15":0,"16":0,"19":0,"21":0,"22":0,"26":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseStructureFile.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseStructureFile.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"parseFile","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":35}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":10},"end":{"line":26,"column":28}}},"3":{"name":"(anonymous_3)","line":39,"loc":{"start":{"line":39,"column":10},"end":{"line":39,"column":27}}},"4":{"name":"parseStructureFile","line":56,"loc":{"start":{"line":56,"column":0},"end":{"line":56,"column":40}}},"5":{"name":"(anonymous_5)","line":60,"loc":{"start":{"line":60,"column":10},"end":{"line":60,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":38}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":59}},"4":{"start":{"line":13,"column":0},"end":{"line":45,"column":1}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":34}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":34}},"7":{"start":{"line":17,"column":4},"end":{"line":23,"column":5}},"8":{"start":{"line":18,"column":8},"end":{"line":22,"column":10}},"9":{"start":{"line":25,"column":4},"end":{"line":44,"column":7}},"10":{"start":{"line":27,"column":8},"end":{"line":37,"column":9}},"11":{"start":{"line":28,"column":12},"end":{"line":28,"column":47}},"12":{"start":{"line":29,"column":15},"end":{"line":37,"column":9}},"13":{"start":{"line":30,"column":12},"end":{"line":30,"column":49}},"14":{"start":{"line":31,"column":15},"end":{"line":37,"column":9}},"15":{"start":{"line":32,"column":12},"end":{"line":32,"column":48}},"16":{"start":{"line":33,"column":15},"end":{"line":37,"column":9}},"17":{"start":{"line":34,"column":12},"end":{"line":34,"column":50}},"18":{"start":{"line":36,"column":12},"end":{"line":36,"column":67}},"19":{"start":{"line":40,"column":8},"end":{"line":43,"column":10}},"20":{"start":{"line":56,"column":0},"end":{"line":65,"column":1}},"21":{"start":{"line":57,"column":4},"end":{"line":57,"column":33}},"22":{"start":{"line":59,"column":4},"end":{"line":64,"column":7}},"23":{"start":{"line":61,"column":8},"end":{"line":61,"column":49}},"24":{"start":{"line":61,"column":19},"end":{"line":61,"column":49}},"25":{"start":{"line":63,"column":8},"end":{"line":63,"column":41}},"26":{"start":{"line":67,"column":0},"end":{"line":67,"column":36}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":17,"column":4}},{"start":{"line":17,"column":4},"end":{"line":17,"column":4}}]},"2":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":8},"end":{"line":27,"column":8}},{"start":{"line":27,"column":8},"end":{"line":27,"column":8}}]},"3":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":15},"end":{"line":29,"column":15}},{"start":{"line":29,"column":15},"end":{"line":29,"column":15}}]},"4":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":15},"end":{"line":31,"column":15}},{"start":{"line":31,"column":15},"end":{"line":31,"column":15}}]},"5":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":15},"end":{"line":33,"column":15}},{"start":{"line":33,"column":15},"end":{"line":33,"column":15}}]},"6":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":8},"end":{"line":61,"column":8}},{"start":{"line":61,"column":8},"end":{"line":61,"column":8}}]}},"code":["var Promise = require('../utils/promise');","var error = require('../utils/error');","var lookupStructureFile = require('./lookupStructureFile');","","/**","    Parse a ParsableFile using a specific method","","    @param {FS} fs","    @param {ParsableFile} file","    @param {String} type","    @return {Promise<Array<String, List|Map>>}","*/","function parseFile(fs, file, type) {","    var filepath = file.getPath();","    var parser = file.getParser();","","    if (!parser) {","        return Promise.reject(","            error.FileNotParsableError({","                filename: filepath","            })","        );","    }","","    return fs.readAsString(filepath)","    .then(function(content) {","        if (type === 'readme') {","            return parser.parseReadme(content);","        } else if (type === 'glossary') {","            return parser.parseGlossary(content);","        } else if (type === 'summary') {","            return parser.parseSummary(content);","        } else if (type === 'langs') {","            return parser.parseLanguages(content);","        } else {","            throw new Error('Parsing invalid type \"' + type + '\"');","        }","    })","    .then(function(result) {","        return [","            file,","            result","        ];","    });","}","","","/**","    Parse a structure file (ex: SUMMARY.md, GLOSSARY.md).","    It uses the configuration to find the specified file.","","    @param {Book} book","    @param {String} type: one of [\"glossary\", \"readme\", \"summary\"]","    @return {Promise<List|Map>}","*/","function parseStructureFile(book, type) {","    var fs = book.getContentFS();","","    return lookupStructureFile(book, type)","    .then(function(file) {","        if (!file) return [undefined, undefined];","","        return parseFile(fs, file, type);","    });","}","","module.exports = parseStructureFile;",""],"l":{"1":1,"2":1,"3":1,"13":1,"14":0,"15":0,"17":0,"18":0,"25":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"36":0,"40":0,"56":1,"57":0,"59":0,"61":0,"63":0,"67":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/lookupStructureFile.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/lookupStructureFile.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"lookupStructureFile","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":41}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":53}},"2":{"start":{"line":12,"column":0},"end":{"line":18,"column":1}},"3":{"start":{"line":13,"column":4},"end":{"line":13,"column":34}},"4":{"start":{"line":15,"column":4},"end":{"line":15,"column":60}},"5":{"start":{"line":17,"column":4},"end":{"line":17,"column":48}},"6":{"start":{"line":20,"column":0},"end":{"line":20,"column":37}}},"branchMap":{},"code":["var findParsableFile = require('./findParsableFile');","","/**","    Lookup a structure file (ex: SUMMARY.md, GLOSSARY.md) in a book. Uses","    book's config to find it.","","    @param {Book} book","    @param {String} type: one of [\"glossary\", \"readme\", \"summary\", \"langs\"]","    @return {Promise<File | Undefined>} The path of the file found, relative","    to the book content root.","*/","function lookupStructureFile(book, type) {","    var config = book.getConfig();","","    var fileToSearch = config.getValue(['structure', type]);","","    return findParsableFile(book, fileToSearch);","}","","module.exports = lookupStructureFile;",""],"l":{"1":1,"12":1,"13":0,"15":0,"17":0,"20":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/findParsableFile.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/findParsableFile.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"findParsableFile","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":42}}},"2":{"name":"(anonymous_2)","line":22,"loc":{"start":{"line":22,"column":30},"end":{"line":22,"column":44}}},"3":{"name":"(anonymous_3)","line":26,"loc":{"start":{"line":26,"column":14},"end":{"line":26,"column":30}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":36}},"4":{"start":{"line":13,"column":0},"end":{"line":34,"column":1}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":33}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":48}},"8":{"start":{"line":17,"column":4},"end":{"line":17,"column":41}},"9":{"start":{"line":20,"column":4},"end":{"line":20,"column":34}},"10":{"start":{"line":22,"column":4},"end":{"line":33,"column":7}},"11":{"start":{"line":23,"column":8},"end":{"line":23,"column":38}},"12":{"start":{"line":25,"column":8},"end":{"line":32,"column":11}},"13":{"start":{"line":27,"column":12},"end":{"line":29,"column":13}},"14":{"start":{"line":28,"column":16},"end":{"line":28,"column":33}},"15":{"start":{"line":31,"column":12},"end":{"line":31,"column":38}},"16":{"start":{"line":36,"column":0},"end":{"line":36,"column":34}}},"branchMap":{"1":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":12},"end":{"line":27,"column":12}},{"start":{"line":27,"column":12},"end":{"line":27,"column":12}}]},"2":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":16},"end":{"line":27,"column":22}},{"start":{"line":27,"column":26},"end":{"line":27,"column":58}}]}},"code":["var path = require('path');","","var Promise = require('../utils/promise');","var parsers = require('../parsers');","","/**","    Find a file parsable (Markdown or AsciiDoc) in a book","","    @param {Book} book","    @param {String} filename","    @return {Promise<File | Undefined>}","*/","function findParsableFile(book, filename) {","    var fs = book.getContentFS();","    var ext = path.extname(filename);","    var basename = path.basename(filename, ext);","    var basedir = path.dirname(filename);","","    // Ordered list of extensions to test","    var exts = parsers.extensions;","","    return Promise.some(exts, function(ext) {","        var filepath = basename + ext;","","        return fs.findFile(basedir, filepath)","        .then(function(found) {","            if (!found || book.isContentFileIgnored(found)) {","                return undefined;","            }","","            return fs.statFile(found);","        });","    });","}","","module.exports = findParsableFile;",""],"l":{"1":1,"3":1,"4":1,"13":1,"14":0,"15":0,"16":0,"17":0,"20":0,"22":0,"23":0,"25":0,"27":0,"28":0,"31":0,"36":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseSummary.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseSummary.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"parseSummary","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":28}}},"2":{"name":"(anonymous_2)","line":18,"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":57}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":43}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":54}},"4":{"start":{"line":12,"column":0},"end":{"line":42,"column":1}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":34}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":34}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":38}},"8":{"start":{"line":17,"column":4},"end":{"line":41,"column":7}},"9":{"start":{"line":19,"column":8},"end":{"line":19,"column":20}},"10":{"start":{"line":21,"column":8},"end":{"line":27,"column":9}},"11":{"start":{"line":22,"column":12},"end":{"line":22,"column":59}},"12":{"start":{"line":23,"column":12},"end":{"line":23,"column":32}},"13":{"start":{"line":25,"column":12},"end":{"line":25,"column":69}},"14":{"start":{"line":26,"column":12},"end":{"line":26,"column":66}},"15":{"start":{"line":30,"column":8},"end":{"line":30,"column":68}},"16":{"start":{"line":32,"column":8},"end":{"line":37,"column":9}},"17":{"start":{"line":33,"column":12},"end":{"line":36,"column":15}},"18":{"start":{"line":40,"column":8},"end":{"line":40,"column":40}},"19":{"start":{"line":44,"column":0},"end":{"line":44,"column":30}}},"branchMap":{"1":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":21,"column":8}},{"start":{"line":21,"column":8},"end":{"line":21,"column":8}}]},"2":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":8},"end":{"line":32,"column":8}},{"start":{"line":32,"column":8},"end":{"line":32,"column":8}}]},"3":{"line":32,"type":"binary-expr","locations":[{"start":{"line":32,"column":12},"end":{"line":32,"column":31}},{"start":{"line":32,"column":35},"end":{"line":32,"column":49}}]}},"code":["var parseStructureFile = require('./parseStructureFile');","var Summary = require('../models/summary');","var SummaryModifier = require('../modifiers').Summary;","","/**","    Parse summary in a book, the summary can only be parsed","    if the readme as be detected before.","","    @param {Book} book","    @return {Promise<Book>}","*/","function parseSummary(book) {","    var readme = book.getReadme();","    var logger = book.getLogger();","    var readmeFile = readme.getFile();","","    return parseStructureFile(book, 'summary')","    .spread(function(file, result) {","        var summary;","","        if (!file) {","            logger.warn.ln('no summary file in this book');","            summary = Summary();","        } else {","            logger.debug.ln('summary file found at', file.getPath());","            summary = Summary.createFromParts(file, result.parts);","        }","","        // Insert readme as first entry if not in SUMMARY.md","        var readmeArticle = summary.getByPath(readmeFile.getPath());","","        if (readmeFile.exists() && !readmeArticle) {","            summary = SummaryModifier.unshiftArticle(summary, {","                title: 'Introduction',","                ref: readmeFile.getPath()","            });","        }","","        // Set new summary","        return book.setSummary(summary);","    });","}","","module.exports = parseSummary;",""],"l":{"1":1,"2":1,"3":1,"12":1,"13":0,"14":0,"15":0,"17":0,"19":0,"21":0,"22":0,"23":0,"25":0,"26":0,"30":0,"32":0,"33":0,"40":0,"44":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseReadme.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseReadme.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"parseReadme","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":27}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":12},"end":{"line":16,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":57}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":41}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":38}},"4":{"start":{"line":12,"column":0},"end":{"line":26,"column":1}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":34}},"6":{"start":{"line":15,"column":4},"end":{"line":25,"column":7}},"7":{"start":{"line":17,"column":8},"end":{"line":19,"column":9}},"8":{"start":{"line":18,"column":12},"end":{"line":18,"column":70}},"9":{"start":{"line":21,"column":8},"end":{"line":21,"column":59}},"10":{"start":{"line":23,"column":8},"end":{"line":23,"column":49}},"11":{"start":{"line":24,"column":8},"end":{"line":24,"column":42}},"12":{"start":{"line":28,"column":0},"end":{"line":28,"column":29}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":8},"end":{"line":17,"column":8}},{"start":{"line":17,"column":8},"end":{"line":17,"column":8}}]}},"code":["var parseStructureFile = require('./parseStructureFile');","var Readme = require('../models/readme');","","var error = require('../utils/error');","","/**","    Parse readme from book","","    @param {Book} book","    @return {Promise<Book>}","*/","function parseReadme(book) {","    var logger = book.getLogger();","","    return parseStructureFile(book, 'readme')","    .spread(function(file, result) {","        if (!file) {","            throw new error.FileNotFoundError({ filename: 'README' });","        }","","        logger.debug.ln('readme found at', file.getPath());","","        var readme = Readme.create(file, result);","        return book.set('readme', readme);","    });","}","","module.exports = parseReadme;",""],"l":{"1":1,"2":1,"4":1,"12":1,"13":0,"15":0,"17":0,"18":0,"21":0,"23":0,"24":0,"28":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseLanguages.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parseLanguages.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"parseLanguages","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":30}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":12},"end":{"line":14,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":57}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":47}},"3":{"start":{"line":10,"column":0},"end":{"line":26,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":34}},"5":{"start":{"line":13,"column":4},"end":{"line":25,"column":7}},"6":{"start":{"line":15,"column":8},"end":{"line":17,"column":9}},"7":{"start":{"line":16,"column":12},"end":{"line":16,"column":24}},"8":{"start":{"line":19,"column":8},"end":{"line":19,"column":63}},"9":{"start":{"line":21,"column":8},"end":{"line":21,"column":73}},"10":{"start":{"line":22,"column":8},"end":{"line":22,"column":97}},"11":{"start":{"line":24,"column":8},"end":{"line":24,"column":48}},"12":{"start":{"line":28,"column":0},"end":{"line":28,"column":32}}},"branchMap":{"1":{"line":15,"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":8}},{"start":{"line":15,"column":8},"end":{"line":15,"column":8}}]}},"code":["var parseStructureFile = require('./parseStructureFile');","var Languages = require('../models/languages');","","/**","    Parse languages list from book","","    @param {Book} book","    @return {Promise<Book>}","*/","function parseLanguages(book) {","    var logger = book.getLogger();","","    return parseStructureFile(book, 'langs')","    .spread(function(file, result) {","        if (!file) {","            return book;","        }","","        var languages = Languages.createFromList(file, result);","","        logger.debug.ln('languages index file found at', file.getPath());","        logger.info.ln('parsing multilingual book, with', languages.getList().size, 'languages');","","        return book.set('languages', languages);","    });","}","","module.exports = parseLanguages;",""],"l":{"1":1,"2":1,"10":1,"11":0,"13":0,"15":0,"16":0,"19":0,"21":0,"22":0,"24":0,"28":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parsePagesList.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parsePagesList.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"parseFilePage","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":39}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":8},"end":{"line":21,"column":23}}},"3":{"name":"(anonymous_3)","line":25,"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":22}}},"4":{"name":"(anonymous_4)","line":30,"loc":{"start":{"line":30,"column":10},"end":{"line":30,"column":24}}},"5":{"name":"parsePagesList","line":44,"loc":{"start":{"line":44,"column":0},"end":{"line":44,"column":30}}},"6":{"name":"(anonymous_6)","line":52,"loc":{"start":{"line":52,"column":29},"end":{"line":52,"column":47}}},"7":{"name":"(anonymous_7)","line":61,"loc":{"start":{"line":61,"column":18},"end":{"line":61,"column":33}}},"8":{"name":"(anonymous_8)","line":73,"loc":{"start":{"line":73,"column":10},"end":{"line":73,"column":21}}},"9":{"name":"(anonymous_9)","line":81,"loc":{"start":{"line":81,"column":14},"end":{"line":81,"column":29}}},"10":{"name":"(anonymous_10)","line":91,"loc":{"start":{"line":91,"column":10},"end":{"line":91,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":40}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":37}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":43}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":39}},"6":{"start":{"line":16,"column":0},"end":{"line":35,"column":1}},"7":{"start":{"line":17,"column":4},"end":{"line":17,"column":33}},"8":{"start":{"line":19,"column":4},"end":{"line":34,"column":7}},"9":{"start":{"line":22,"column":12},"end":{"line":22,"column":48}},"10":{"start":{"line":23,"column":12},"end":{"line":23,"column":41}},"11":{"start":{"line":27,"column":12},"end":{"line":27,"column":24}},"12":{"start":{"line":31,"column":8},"end":{"line":31,"column":38}},"13":{"start":{"line":32,"column":8},"end":{"line":32,"column":72}},"14":{"start":{"line":33,"column":8},"end":{"line":33,"column":18}},"15":{"start":{"line":44,"column":0},"end":{"line":94,"column":1}},"16":{"start":{"line":45,"column":4},"end":{"line":45,"column":36}},"17":{"start":{"line":46,"column":4},"end":{"line":46,"column":38}},"18":{"start":{"line":47,"column":4},"end":{"line":47,"column":37}},"19":{"start":{"line":50,"column":4},"end":{"line":93,"column":7}},"20":{"start":{"line":53,"column":12},"end":{"line":53,"column":42}},"21":{"start":{"line":53,"column":35},"end":{"line":53,"column":42}},"22":{"start":{"line":55,"column":12},"end":{"line":55,"column":45}},"23":{"start":{"line":58,"column":12},"end":{"line":58,"column":60}},"24":{"start":{"line":58,"column":53},"end":{"line":58,"column":60}},"25":{"start":{"line":60,"column":12},"end":{"line":68,"column":15}},"26":{"start":{"line":63,"column":16},"end":{"line":65,"column":17}},"27":{"start":{"line":64,"column":20},"end":{"line":64,"column":27}},"28":{"start":{"line":67,"column":16},"end":{"line":67,"column":46}},"29":{"start":{"line":74,"column":8},"end":{"line":74,"column":38}},"30":{"start":{"line":76,"column":8},"end":{"line":78,"column":9}},"31":{"start":{"line":77,"column":12},"end":{"line":77,"column":19}},"32":{"start":{"line":80,"column":8},"end":{"line":88,"column":11}},"33":{"start":{"line":83,"column":12},"end":{"line":85,"column":13}},"34":{"start":{"line":84,"column":16},"end":{"line":84,"column":23}},"35":{"start":{"line":87,"column":12},"end":{"line":87,"column":48}},"36":{"start":{"line":92,"column":8},"end":{"line":92,"column":19}},"37":{"start":{"line":97,"column":0},"end":{"line":97,"column":32}}},"branchMap":{"1":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":12},"end":{"line":53,"column":12}},{"start":{"line":53,"column":12},"end":{"line":53,"column":12}}]},"2":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":12},"end":{"line":58,"column":12}},{"start":{"line":58,"column":12},"end":{"line":58,"column":12}}]},"3":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":16},"end":{"line":63,"column":16}},{"start":{"line":63,"column":16},"end":{"line":63,"column":16}}]},"4":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":8},"end":{"line":76,"column":8}},{"start":{"line":76,"column":8},"end":{"line":76,"column":8}}]},"5":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":12},"end":{"line":83,"column":12}},{"start":{"line":83,"column":12},"end":{"line":83,"column":12}}]}},"code":["var Immutable = require('immutable');","","var timing = require('../utils/timing');","var Page = require('../models/page');","var walkSummary = require('./walkSummary');","var parsePage = require('./parsePage');","","","/**","    Parse a page from a path","","    @param {Book} book","    @param {String} filePath","    @return {Page?}","*/","function parseFilePage(book, filePath) {","    var fs = book.getContentFS();","","    return fs.statFile(filePath)","    .then(","        function(file) {","            var page = Page.createForFile(file);","            return parsePage(book, page);","        },","        function(err) {","            // file doesn't exist","            return null;","        }","    )","    .fail(function(err) {","        var logger = book.getLogger();","        logger.error.ln('error while parsing page \"' + filePath + '\":');","        throw err;","    });","}","","","/**","    Parse all pages from a book as an OrderedMap","","    @param {Book} book","    @return {Promise<OrderedMap<Page>>}","*/","function parsePagesList(book) {","    var summary = book.getSummary();","    var glossary = book.getGlossary();","    var map = Immutable.OrderedMap();","","    // Parse pages from summary","    return timing.measure(","        'parse.listPages',","        walkSummary(summary, function(article) {","            if (!article.isPage()) return;","","            var filepath = article.getPath();","","            // Is the page ignored?","            if (book.isContentFileIgnored(filepath)) return;","","            return parseFilePage(book, filepath)","            .then(function(page) {","                // file doesn't exist","                if (!page) {","                    return;","                }","","                map = map.set(filepath, page);","            });","        })","    )","","    // Parse glossary","    .then(function() {","        var file = glossary.getFile();","","        if (!file.exists()) {","            return;","        }","","        return parseFilePage(book, file.getPath())","        .then(function(page) {","            // file doesn't exist","            if (!page) {","                return;","            }","","            map = map.set(file.getPath(), page);","        });","    })","","    .then(function() {","        return map;","    });","}","","","module.exports = parsePagesList;",""],"l":{"1":1,"3":1,"4":1,"5":1,"6":1,"16":1,"17":0,"19":0,"22":0,"23":0,"27":0,"31":0,"32":0,"33":0,"44":1,"45":0,"46":0,"47":0,"50":0,"53":0,"55":0,"58":0,"60":0,"63":0,"64":0,"67":0,"74":0,"76":0,"77":0,"80":0,"83":0,"84":0,"87":0,"92":0,"97":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/page.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/page.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":0,"9":1,"10":0,"11":1,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":0,"22":1,"23":0,"24":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":19,"loc":{"start":{"line":19,"column":25},"end":{"line":19,"column":36}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":31},"end":{"line":23,"column":42}}},"3":{"name":"(anonymous_3)","line":27,"loc":{"start":{"line":27,"column":28},"end":{"line":27,"column":39}}},"4":{"name":"(anonymous_4)","line":31,"loc":{"start":{"line":31,"column":24},"end":{"line":31,"column":35}}},"5":{"name":"(anonymous_5)","line":39,"loc":{"start":{"line":39,"column":24},"end":{"line":39,"column":35}}},"6":{"name":"(anonymous_6)","line":55,"loc":{"start":{"line":55,"column":25},"end":{"line":55,"column":36}}},"7":{"name":"(anonymous_7)","line":64,"loc":{"start":{"line":64,"column":21},"end":{"line":64,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":30}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":29}},"4":{"start":{"line":6,"column":0},"end":{"line":17,"column":3}},"5":{"start":{"line":19,"column":0},"end":{"line":21,"column":2}},"6":{"start":{"line":20,"column":4},"end":{"line":20,"column":28}},"7":{"start":{"line":23,"column":0},"end":{"line":25,"column":2}},"8":{"start":{"line":24,"column":4},"end":{"line":24,"column":34}},"9":{"start":{"line":27,"column":0},"end":{"line":29,"column":2}},"10":{"start":{"line":28,"column":4},"end":{"line":28,"column":31}},"11":{"start":{"line":31,"column":0},"end":{"line":33,"column":2}},"12":{"start":{"line":32,"column":4},"end":{"line":32,"column":27}},"13":{"start":{"line":39,"column":0},"end":{"line":49,"column":2}},"14":{"start":{"line":40,"column":4},"end":{"line":40,"column":37}},"15":{"start":{"line":41,"column":4},"end":{"line":41,"column":36}},"16":{"start":{"line":43,"column":4},"end":{"line":45,"column":5}},"17":{"start":{"line":44,"column":8},"end":{"line":44,"column":23}},"18":{"start":{"line":47,"column":4},"end":{"line":47,"column":95}},"19":{"start":{"line":48,"column":4},"end":{"line":48,"column":35}},"20":{"start":{"line":55,"column":0},"end":{"line":57,"column":2}},"21":{"start":{"line":56,"column":4},"end":{"line":56,"column":36}},"22":{"start":{"line":64,"column":0},"end":{"line":68,"column":2}},"23":{"start":{"line":65,"column":4},"end":{"line":67,"column":7}},"24":{"start":{"line":70,"column":0},"end":{"line":70,"column":22}}},"branchMap":{"1":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":4},"end":{"line":43,"column":4}},{"start":{"line":43,"column":4},"end":{"line":43,"column":4}}]}},"code":["var Immutable = require('immutable');","var yaml = require('js-yaml');","","var File = require('./file');","","var Page = Immutable.Record({","    file:           File(),","","    // Attributes extracted from the YAML header","    attributes:     Immutable.Map(),","","    // Content of the page","    content:        String(),","","    // Direction of the text","    dir:            String('ltr')","});","","Page.prototype.getFile = function() {","    return this.get('file');","};","","Page.prototype.getAttributes = function() {","    return this.get('attributes');","};","","Page.prototype.getContent = function() {","    return this.get('content');","};","","Page.prototype.getDir = function() {","    return this.get('dir');","};","","/**"," * Return page as text"," * @return {String}","*/","Page.prototype.toText = function() {","    var attrs = this.getAttributes();","    var content = this.getContent();","","    if (attrs.size === 0) {","        return content;","    }","","    var frontMatter = '---\\n' + yaml.safeDump(attrs.toJS(), { skipInvalid: true }) + '---\\n\\n';","    return (frontMatter + content);","};","","/**"," * Return path of the page"," * @return {String}","*/","Page.prototype.getPath = function() {","    return this.getFile().getPath();","};","","/**"," * Create a page for a file"," * @param {File} file"," * @return {Page}","*/","Page.createForFile = function(file) {","    return new Page({","        file: file","    });","};","","module.exports = Page;",""],"l":{"1":1,"2":1,"4":1,"6":1,"19":1,"20":0,"23":1,"24":0,"27":1,"28":0,"31":1,"32":0,"39":1,"40":0,"41":0,"43":0,"44":0,"47":0,"48":0,"55":1,"56":0,"64":1,"65":0,"70":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/walkSummary.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/walkSummary.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":1},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"walkArticles","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":36}}},"2":{"name":"(anonymous_2)","line":11,"loc":{"start":{"line":11,"column":37},"end":{"line":11,"column":55}}},"3":{"name":"(anonymous_3)","line":13,"loc":{"start":{"line":13,"column":14},"end":{"line":13,"column":25}}},"4":{"name":"walkSummary","line":26,"loc":{"start":{"line":26,"column":0},"end":{"line":26,"column":34}}},"5":{"name":"(anonymous_5)","line":29,"loc":{"start":{"line":29,"column":34},"end":{"line":29,"column":49}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":10,"column":0},"end":{"line":17,"column":1}},"3":{"start":{"line":11,"column":4},"end":{"line":16,"column":7}},"4":{"start":{"line":12,"column":8},"end":{"line":15,"column":11}},"5":{"start":{"line":14,"column":12},"end":{"line":14,"column":59}},"6":{"start":{"line":26,"column":0},"end":{"line":32,"column":1}},"7":{"start":{"line":27,"column":4},"end":{"line":27,"column":35}},"8":{"start":{"line":29,"column":4},"end":{"line":31,"column":7}},"9":{"start":{"line":30,"column":8},"end":{"line":30,"column":52}},"10":{"start":{"line":34,"column":0},"end":{"line":34,"column":29}}},"branchMap":{},"code":["var Promise = require('../utils/promise');","","/**","    Walk over a list of articles","","    @param {List<Article>} articles","    @param {Function(article)}","    @return {Promise}","*/","function walkArticles(articles, fn) {","    return Promise.forEach(articles, function(article) {","        return Promise(fn(article))","        .then(function() {","            return walkArticles(article.getArticles(), fn);","        });","    });","}","","/**","    Walk over summary and execute \"fn\" on each article","","    @param {Summary} summary","    @param {Function(article)}","    @return {Promise}","*/","function walkSummary(summary, fn) {","    var parts = summary.getParts();","","    return Promise.forEach(parts, function(part) {","        return walkArticles(part.getArticles(), fn);","    });","}","","module.exports = walkSummary;",""],"l":{"1":1,"10":1,"11":0,"12":0,"14":0,"26":1,"27":0,"29":0,"30":0,"34":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parsePage.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parsePage.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"parsePage","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":31}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":10},"end":{"line":15,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":59}},"2":{"start":{"line":10,"column":0},"end":{"line":18,"column":1}},"3":{"start":{"line":11,"column":4},"end":{"line":11,"column":33}},"4":{"start":{"line":12,"column":4},"end":{"line":12,"column":30}},"5":{"start":{"line":14,"column":4},"end":{"line":17,"column":7}},"6":{"start":{"line":16,"column":8},"end":{"line":16,"column":50}},"7":{"start":{"line":21,"column":0},"end":{"line":21,"column":27}}},"branchMap":{},"code":["var parsePageFromString = require('./parsePageFromString');","","/**"," * Parse a page, read its content and parse the YAMl header"," *"," * @param {Book} book"," * @param {Page} page"," * @return {Promise<Page>}"," */","function parsePage(book, page) {","    var fs = book.getContentFS();","    var file = page.getFile();","","    return fs.readAsString(file.getPath())","    .then(function(content) {","        return parsePageFromString(page, content);","    });","}","","","module.exports = parsePage;",""],"l":{"1":1,"10":1,"11":0,"12":0,"14":0,"16":0,"21":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parsePageFromString.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/parsePageFromString.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"parsePageFromString","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":44}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"4":{"start":{"line":11,"column":0},"end":{"line":20,"column":1}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":29}},"6":{"start":{"line":15,"column":4},"end":{"line":19,"column":7}},"7":{"start":{"line":23,"column":0},"end":{"line":23,"column":37}}},"branchMap":{},"code":["var Immutable = require('immutable');","var fm = require('front-matter');","var direction = require('direction');","","/**"," * Parse a page, its content and the YAMl header"," *"," * @param {Page} page"," * @return {Page}"," */","function parsePageFromString(page, content) {","    // Parse page YAML","    var parsed = fm(content);","","    return page.merge({","        content:    parsed.body,","        attributes: Immutable.fromJS(parsed.attributes),","        dir:        direction(parsed.body)","    });","}","","","module.exports = parsePageFromString;",""],"l":{"1":1,"2":1,"3":1,"11":1,"13":0,"15":0,"23":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/listAssets.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/parse/listAssets.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":1},"b":{"1":[0,0,0,0,0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"listAssets","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":33}}},"2":{"name":"filterFile","line":26,"loc":{"start":{"line":26,"column":4},"end":{"line":26,"column":30}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":40}},"2":{"start":{"line":11,"column":0},"end":{"line":41,"column":1}},"3":{"start":{"line":12,"column":4},"end":{"line":12,"column":33}},"4":{"start":{"line":14,"column":4},"end":{"line":14,"column":36}},"5":{"start":{"line":15,"column":4},"end":{"line":15,"column":50}},"6":{"start":{"line":17,"column":4},"end":{"line":17,"column":38}},"7":{"start":{"line":18,"column":4},"end":{"line":18,"column":52}},"8":{"start":{"line":20,"column":4},"end":{"line":20,"column":36}},"9":{"start":{"line":21,"column":4},"end":{"line":21,"column":46}},"10":{"start":{"line":23,"column":4},"end":{"line":23,"column":34}},"11":{"start":{"line":24,"column":4},"end":{"line":24,"column":48}},"12":{"start":{"line":26,"column":4},"end":{"line":35,"column":5}},"13":{"start":{"line":27,"column":8},"end":{"line":34,"column":10}},"14":{"start":{"line":37,"column":4},"end":{"line":40,"column":6}},"15":{"start":{"line":43,"column":0},"end":{"line":43,"column":28}}},"branchMap":{"1":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":12},"end":{"line":28,"column":32}},{"start":{"line":29,"column":12},"end":{"line":29,"column":33}},{"start":{"line":30,"column":12},"end":{"line":30,"column":30}},{"start":{"line":31,"column":12},"end":{"line":31,"column":31}},{"start":{"line":32,"column":12},"end":{"line":32,"column":43}},{"start":{"line":33,"column":12},"end":{"line":33,"column":27}}]}},"code":["var timing = require('../utils/timing');","","/**","    List all assets in a book","    Assets are file not ignored and not a page","","    @param {Book} book","    @param {List<String>} pages","    @param","*/","function listAssets(book, pages) {","    var fs = book.getContentFS();","","    var summary = book.getSummary();","    var summaryFile = summary.getFile().getPath();","","    var glossary = book.getGlossary();","    var glossaryFile = glossary.getFile().getPath();","","    var langs = book.getLanguages();","    var langsFile = langs.getFile().getPath();","","    var config = book.getConfig();","    var configFile = config.getFile().getPath();","","    function filterFile(file) {","        return !(","            file === summaryFile ||","            file === glossaryFile ||","            file === langsFile ||","            file === configFile ||","            book.isContentFileIgnored(file) ||","            pages.has(file)","        );","    }","","    return timing.measure(","        'parse.listAssets',","        fs.listAllFiles('.', filterFile)","    );","}","","module.exports = listAssets;",""],"l":{"1":1,"11":1,"12":0,"14":0,"15":0,"17":0,"18":0,"20":0,"21":0,"23":0,"24":0,"26":1,"27":0,"37":0,"43":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/init.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/init.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"initBook","line":19,"loc":{"start":{"line":19,"column":0},"end":{"line":19,"column":30}}},"2":{"name":"(anonymous_2)","line":25,"loc":{"start":{"line":25,"column":10},"end":{"line":25,"column":21}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":14},"end":{"line":32,"column":25}}},"4":{"name":"(anonymous_4)","line":40,"loc":{"start":{"line":40,"column":10},"end":{"line":40,"column":25}}},"5":{"name":"(anonymous_5)","line":49,"loc":{"start":{"line":49,"column":41},"end":{"line":49,"column":59}}},"6":{"name":"(anonymous_6)","line":56,"loc":{"start":{"line":56,"column":43},"end":{"line":56,"column":54}}},"7":{"name":"(anonymous_7)","line":58,"loc":{"start":{"line":58,"column":22},"end":{"line":58,"column":33}}},"8":{"name":"(anonymous_8)","line":66,"loc":{"start":{"line":66,"column":14},"end":{"line":66,"column":25}}},"9":{"name":"(anonymous_9)","line":70,"loc":{"start":{"line":70,"column":18},"end":{"line":70,"column":29}}},"10":{"name":"(anonymous_10)","line":77,"loc":{"start":{"line":77,"column":14},"end":{"line":77,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":40}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":31}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":41}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":36}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":40}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":36}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":31}},"9":{"start":{"line":19,"column":0},"end":{"line":81,"column":1}},"10":{"start":{"line":20,"column":4},"end":{"line":20,"column":26}},"11":{"start":{"line":22,"column":4},"end":{"line":80,"column":7}},"12":{"start":{"line":26,"column":8},"end":{"line":26,"column":42}},"13":{"start":{"line":27,"column":8},"end":{"line":27,"column":40}},"14":{"start":{"line":29,"column":8},"end":{"line":36,"column":11}},"15":{"start":{"line":33,"column":12},"end":{"line":33,"column":75}},"16":{"start":{"line":34,"column":12},"end":{"line":34,"column":51}},"17":{"start":{"line":35,"column":12},"end":{"line":35,"column":42}},"18":{"start":{"line":41,"column":8},"end":{"line":41,"column":38}},"19":{"start":{"line":42,"column":8},"end":{"line":42,"column":40}},"20":{"start":{"line":43,"column":8},"end":{"line":43,"column":44}},"21":{"start":{"line":44,"column":8},"end":{"line":44,"column":79}},"22":{"start":{"line":46,"column":8},"end":{"line":46,"column":51}},"23":{"start":{"line":49,"column":8},"end":{"line":79,"column":11}},"24":{"start":{"line":50,"column":12},"end":{"line":50,"column":48}},"25":{"start":{"line":51,"column":12},"end":{"line":51,"column":82}},"26":{"start":{"line":52,"column":12},"end":{"line":54,"column":13}},"27":{"start":{"line":53,"column":16},"end":{"line":53,"column":23}},"28":{"start":{"line":56,"column":12},"end":{"line":62,"column":15}},"29":{"start":{"line":57,"column":16},"end":{"line":61,"column":19}},"30":{"start":{"line":59,"column":20},"end":{"line":59,"column":64}},"31":{"start":{"line":60,"column":20},"end":{"line":60,"column":86}},"32":{"start":{"line":67,"column":12},"end":{"line":67,"column":66}},"33":{"start":{"line":69,"column":12},"end":{"line":73,"column":15}},"34":{"start":{"line":71,"column":16},"end":{"line":71,"column":68}},"35":{"start":{"line":72,"column":16},"end":{"line":72,"column":73}},"36":{"start":{"line":78,"column":12},"end":{"line":78,"column":57}},"37":{"start":{"line":83,"column":0},"end":{"line":83,"column":26}}},"branchMap":{"1":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":30},"end":{"line":44,"column":51}},{"start":{"line":44,"column":56},"end":{"line":44,"column":77}}]},"2":{"line":51,"type":"cond-expr","locations":[{"start":{"line":51,"column":40},"end":{"line":51,"column":74}},{"start":{"line":51,"column":77},"end":{"line":51,"column":81}}]},"3":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":12},"end":{"line":52,"column":12}},{"start":{"line":52,"column":12},"end":{"line":52,"column":12}}]}},"code":["var path = require('path');","","var createNodeFS = require('./fs/node');","var fs = require('./utils/fs');","var Promise = require('./utils/promise');","var File = require('./models/file');","var Readme = require('./models/readme');","var Book = require('./models/book');","var Parse = require('./parse');","","/**","    Initialize folder structure for a book","    Read SUMMARY to created the right chapter","","    @param {Book}","    @param {String}","    @return {Promise}","*/","function initBook(rootFolder) {","    var extension = '.md';","","    return fs.mkdirp(rootFolder)","","    // Parse the summary and readme","    .then(function() {","        var fs = createNodeFS(rootFolder);","        var book = Book.createForFS(fs);","","        return Parse.parseReadme(book)","","        // Setup default readme if doesn't found one","        .fail(function() {","            var readmeFile = File.createWithFilepath('README' + extension);","            var readme = Readme.create(readmeFile);","            return book.setReadme(readme);","        });","    })","    .then(Parse.parseSummary)","","    .then(function(book) {","        var logger = book.getLogger();","        var summary = book.getSummary();","        var summaryFile = summary.getFile();","        var summaryFilename = summaryFile.getPath() || ('SUMMARY' + extension);","","        var articles = summary.getArticlesAsList();","","        // Write pages","        return Promise.forEach(articles, function(article) {","            var articlePath = article.getPath();","            var filePath = articlePath? path.join(rootFolder, articlePath) : null;","            if (!filePath) {","                return;","            }","","            return fs.assertFile(filePath, function() {","                return fs.ensureFile(filePath)","                .then(function() {","                    logger.info.ln('create', article.getPath());","                    return fs.writeFile(filePath, '# ' + article.getTitle() + '\\n\\n');","                });","            });","        })","","        // Write summary","        .then(function() {","            var filePath = path.join(rootFolder, summaryFilename);","","            return fs.ensureFile(filePath)","            .then(function() {","                logger.info.ln('create ' + path.basename(filePath));","                return fs.writeFile(filePath, summary.toText(extension));","            });","        })","","        // Log end","        .then(function() {","            logger.info.ln('initialization is finished');","        });","    });","}","","module.exports = initBook;",""],"l":{"1":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"19":1,"20":0,"22":0,"26":0,"27":0,"29":0,"33":0,"34":0,"35":0,"41":0,"42":0,"43":0,"44":0,"46":0,"49":0,"50":0,"51":0,"52":0,"53":0,"56":0,"57":0,"59":0,"60":0,"67":0,"69":0,"71":0,"72":0,"78":0,"83":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/fs/node.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/fs/node.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1,"18":0,"19":1,"20":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"fsReadDir","line":8,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":27}}},"2":{"name":"(anonymous_2)","line":10,"loc":{"start":{"line":10,"column":10},"end":{"line":10,"column":26}}},"3":{"name":"(anonymous_3)","line":14,"loc":{"start":{"line":14,"column":17},"end":{"line":14,"column":32}}},"4":{"name":"(anonymous_4)","line":21,"loc":{"start":{"line":21,"column":20},"end":{"line":21,"column":35}}},"5":{"name":"fsLoadObject","line":27,"loc":{"start":{"line":27,"column":0},"end":{"line":27,"column":32}}},"6":{"name":"createNodeFS","line":31,"loc":{"start":{"line":31,"column":17},"end":{"line":31,"column":45}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":32}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":33}},"6":{"start":{"line":8,"column":0},"end":{"line":25,"column":1}},"7":{"start":{"line":9,"column":4},"end":{"line":24,"column":7}},"8":{"start":{"line":11,"column":8},"end":{"line":11,"column":38}},"9":{"start":{"line":13,"column":8},"end":{"line":23,"column":15}},"10":{"start":{"line":15,"column":16},"end":{"line":15,"column":56}},"11":{"start":{"line":15,"column":49},"end":{"line":15,"column":56}},"12":{"start":{"line":17,"column":16},"end":{"line":17,"column":64}},"13":{"start":{"line":18,"column":16},"end":{"line":18,"column":63}},"14":{"start":{"line":18,"column":40},"end":{"line":18,"column":63}},"15":{"start":{"line":19,"column":16},"end":{"line":19,"column":28}},"16":{"start":{"line":22,"column":16},"end":{"line":22,"column":37}},"17":{"start":{"line":27,"column":0},"end":{"line":29,"column":1}},"18":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"19":{"start":{"line":31,"column":0},"end":{"line":42,"column":2}},"20":{"start":{"line":32,"column":4},"end":{"line":41,"column":7}}},"branchMap":{"1":{"line":15,"type":"if","locations":[{"start":{"line":15,"column":16},"end":{"line":15,"column":16}},{"start":{"line":15,"column":16},"end":{"line":15,"column":16}}]},"2":{"line":15,"type":"binary-expr","locations":[{"start":{"line":15,"column":20},"end":{"line":15,"column":31}},{"start":{"line":15,"column":35},"end":{"line":15,"column":47}}]},"3":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":16},"end":{"line":18,"column":16}},{"start":{"line":18,"column":16},"end":{"line":18,"column":16}}]}},"code":["var path = require('path');","var Immutable = require('immutable');","var fresh = require('fresh-require');","","var fs = require('../utils/fs');","var FS = require('../models/fs');","","function fsReadDir(folder) {","    return fs.readdir(folder)","    .then(function(files) {","        files = Immutable.List(files);","","        return files","            .map(function(file) {","                if (file == '.' || file == '..') return;","","                var stat = fs.statSync(path.join(folder, file));","                if (stat.isDirectory()) file = file + path.sep;","                return file;","            })","            .filter(function(file) {","                return Boolean(file);","            });","    });","}","","function fsLoadObject(filename) {","    return fresh(filename, require);","}","","module.exports = function createNodeFS(root) {","    return FS.create({","        root: root,","","        fsExists: fs.exists,","        fsReadFile: fs.readFile,","        fsStatFile: fs.stat,","        fsReadDir: fsReadDir,","        fsLoadObject: fsLoadObject,","        fsReadAsStream: fs.readStream","    });","};",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"8":1,"9":0,"11":0,"13":0,"15":0,"17":0,"18":0,"19":0,"22":0,"27":1,"28":0,"31":1,"32":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/fs.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/fs.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":0,"30":0,"31":0,"32":0,"33":1,"34":0,"35":1,"36":0,"37":1,"38":0,"39":1,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":1,"53":0,"54":1,"55":0,"56":0,"57":0,"58":0,"59":1,"60":0,"61":0,"62":0,"63":0,"64":1,"65":0,"66":0,"67":0,"68":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"fnMap":{"1":{"name":"writeStream","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":35}}},"2":{"name":"(anonymous_2)","line":18,"loc":{"start":{"line":18,"column":18},"end":{"line":18,"column":29}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":25},"end":{"line":23,"column":37}}},"4":{"name":"(anonymous_4)","line":27,"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":39}}},"5":{"name":"(anonymous_5)","line":32,"loc":{"start":{"line":32,"column":19},"end":{"line":32,"column":33}}},"6":{"name":"fileExists","line":43,"loc":{"start":{"line":43,"column":0},"end":{"line":43,"column":30}}},"7":{"name":"(anonymous_7)","line":46,"loc":{"start":{"line":46,"column":24},"end":{"line":46,"column":41}}},"8":{"name":"genTmpFile","line":54,"loc":{"start":{"line":54,"column":0},"end":{"line":54,"column":26}}},"9":{"name":"genTmpDir","line":60,"loc":{"start":{"line":60,"column":0},"end":{"line":60,"column":25}}},"10":{"name":"download","line":66,"loc":{"start":{"line":66,"column":0},"end":{"line":66,"column":29}}},"11":{"name":"uniqueFilename","line":71,"loc":{"start":{"line":71,"column":0},"end":{"line":71,"column":40}}},"12":{"name":"ensureFile","line":88,"loc":{"start":{"line":88,"column":0},"end":{"line":88,"column":30}}},"13":{"name":"rmDir","line":94,"loc":{"start":{"line":94,"column":0},"end":{"line":94,"column":21}}},"14":{"name":"assertFile","line":107,"loc":{"start":{"line":107,"column":0},"end":{"line":107,"column":41}}},"15":{"name":"(anonymous_15)","line":109,"loc":{"start":{"line":109,"column":10},"end":{"line":109,"column":27}}},"16":{"name":"pickFile","line":123,"loc":{"start":{"line":123,"column":0},"end":{"line":123,"column":40}}},"17":{"name":"ensureFolder","line":138,"loc":{"start":{"line":138,"column":0},"end":{"line":138,"column":34}}},"18":{"name":"(anonymous_18)","line":140,"loc":{"start":{"line":140,"column":10},"end":{"line":140,"column":21}}},"19":{"name":"(anonymous_19)","line":143,"loc":{"start":{"line":143,"column":10},"end":{"line":143,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":32}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":31}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":33}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":29}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":25}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":33}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":27}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":23}},"9":{"start":{"line":9,"column":0},"end":{"line":9,"column":25}},"10":{"start":{"line":11,"column":0},"end":{"line":11,"column":35}},"11":{"start":{"line":14,"column":0},"end":{"line":40,"column":1}},"12":{"start":{"line":15,"column":4},"end":{"line":15,"column":28}},"13":{"start":{"line":17,"column":4},"end":{"line":17,"column":49}},"14":{"start":{"line":18,"column":4},"end":{"line":21,"column":6}},"15":{"start":{"line":19,"column":8},"end":{"line":19,"column":25}},"16":{"start":{"line":20,"column":8},"end":{"line":20,"column":37}},"17":{"start":{"line":23,"column":4},"end":{"line":26,"column":7}},"18":{"start":{"line":24,"column":8},"end":{"line":24,"column":18}},"19":{"start":{"line":25,"column":8},"end":{"line":25,"column":20}},"20":{"start":{"line":27,"column":4},"end":{"line":30,"column":7}},"21":{"start":{"line":28,"column":8},"end":{"line":28,"column":18}},"22":{"start":{"line":29,"column":8},"end":{"line":29,"column":22}},"23":{"start":{"line":32,"column":4},"end":{"line":35,"column":7}},"24":{"start":{"line":33,"column":8},"end":{"line":33,"column":18}},"25":{"start":{"line":34,"column":8},"end":{"line":34,"column":22}},"26":{"start":{"line":37,"column":4},"end":{"line":37,"column":21}},"27":{"start":{"line":39,"column":4},"end":{"line":39,"column":21}},"28":{"start":{"line":43,"column":0},"end":{"line":51,"column":1}},"29":{"start":{"line":44,"column":4},"end":{"line":44,"column":28}},"30":{"start":{"line":46,"column":4},"end":{"line":48,"column":7}},"31":{"start":{"line":47,"column":8},"end":{"line":47,"column":26}},"32":{"start":{"line":50,"column":4},"end":{"line":50,"column":21}},"33":{"start":{"line":54,"column":0},"end":{"line":57,"column":1}},"34":{"start":{"line":55,"column":4},"end":{"line":56,"column":16}},"35":{"start":{"line":60,"column":0},"end":{"line":63,"column":1}},"36":{"start":{"line":61,"column":4},"end":{"line":62,"column":16}},"37":{"start":{"line":66,"column":0},"end":{"line":68,"column":1}},"38":{"start":{"line":67,"column":4},"end":{"line":67,"column":43}},"39":{"start":{"line":71,"column":0},"end":{"line":85,"column":1}},"40":{"start":{"line":72,"column":4},"end":{"line":72,"column":37}},"41":{"start":{"line":73,"column":4},"end":{"line":73,"column":44}},"42":{"start":{"line":74,"column":4},"end":{"line":74,"column":79}},"43":{"start":{"line":76,"column":4},"end":{"line":76,"column":33}},"44":{"start":{"line":78,"column":4},"end":{"line":78,"column":14}},"45":{"start":{"line":79,"column":4},"end":{"line":82,"column":5}},"46":{"start":{"line":80,"column":8},"end":{"line":80,"column":45}},"47":{"start":{"line":81,"column":8},"end":{"line":81,"column":18}},"48":{"start":{"line":84,"column":4},"end":{"line":84,"column":51}},"49":{"start":{"line":88,"column":0},"end":{"line":91,"column":1}},"50":{"start":{"line":89,"column":4},"end":{"line":89,"column":38}},"51":{"start":{"line":90,"column":4},"end":{"line":90,"column":40}},"52":{"start":{"line":94,"column":0},"end":{"line":98,"column":1}},"53":{"start":{"line":95,"column":4},"end":{"line":97,"column":7}},"54":{"start":{"line":107,"column":0},"end":{"line":114,"column":1}},"55":{"start":{"line":108,"column":4},"end":{"line":113,"column":7}},"56":{"start":{"line":110,"column":8},"end":{"line":110,"column":27}},"57":{"start":{"line":110,"column":20},"end":{"line":110,"column":27}},"58":{"start":{"line":112,"column":8},"end":{"line":112,"column":27}},"59":{"start":{"line":123,"column":0},"end":{"line":130,"column":1}},"60":{"start":{"line":124,"column":4},"end":{"line":124,"column":49}},"61":{"start":{"line":125,"column":4},"end":{"line":127,"column":5}},"62":{"start":{"line":126,"column":8},"end":{"line":126,"column":22}},"63":{"start":{"line":129,"column":4},"end":{"line":129,"column":21}},"64":{"start":{"line":138,"column":0},"end":{"line":146,"column":1}},"65":{"start":{"line":139,"column":4},"end":{"line":145,"column":7}},"66":{"start":{"line":141,"column":8},"end":{"line":141,"column":25}},"67":{"start":{"line":144,"column":8},"end":{"line":144,"column":50}},"68":{"start":{"line":148,"column":0},"end":{"line":170,"column":2}}},"branchMap":{"1":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":8},"end":{"line":110,"column":8}},{"start":{"line":110,"column":8},"end":{"line":110,"column":8}}]},"2":{"line":125,"type":"if","locations":[{"start":{"line":125,"column":4},"end":{"line":125,"column":4}},{"start":{"line":125,"column":4},"end":{"line":125,"column":4}}]}},"code":["var fs = require('graceful-fs');","var mkdirp = require('mkdirp');","var destroy = require('destroy');","var rmdir = require('rmdir');","var tmp = require('tmp');","var request = require('request');","var path = require('path');","var cp = require('cp');","var cpr = require('cpr');","","var Promise = require('./promise');","","// Write a stream to a file","function writeStream(filename, st) {","    var d = Promise.defer();","","    var wstream = fs.createWriteStream(filename);","    var cleanup = function() {","        destroy(wstream);","        wstream.removeAllListeners();","    };","","    wstream.on('finish', function () {","        cleanup();","        d.resolve();","    });","    wstream.on('error', function (err) {","        cleanup();","        d.reject(err);","    });","","    st.on('error', function(err) {","        cleanup();","        d.reject(err);","    });","","    st.pipe(wstream);","","    return d.promise;","}","","// Return a promise resolved with a boolean","function fileExists(filename) {","    var d = Promise.defer();","","    fs.exists(filename, function(exists) {","        d.resolve(exists);","    });","","    return d.promise;","}","","// Generate temporary file","function genTmpFile(opts) {","    return Promise.nfcall(tmp.file, opts)","        .get(0);","}","","// Generate temporary dir","function genTmpDir(opts) {","    return Promise.nfcall(tmp.dir, opts)","        .get(0);","}","","// Download an image","function download(uri, dest) {","    return writeStream(dest, request(uri));","}","","// Find a filename available in a folder","function uniqueFilename(base, filename) {","    var ext = path.extname(filename);","    filename = path.resolve(base, filename);","    filename = path.join(path.dirname(filename), path.basename(filename, ext));","","    var _filename = filename+ext;","","    var i = 0;","    while (fs.existsSync(filename)) {","        _filename = filename + '_' + i + ext;","        i = i + 1;","    }","","    return Promise(path.relative(base, _filename));","}","","// Create all required folder to create a file","function ensureFile(filename) {","    var base = path.dirname(filename);","    return Promise.nfcall(mkdirp, base);","}","","// Remove a folder","function rmDir(base) {","    return Promise.nfcall(rmdir, base, {","        fs: fs","    });","}","","/**","    Assert a file, if it doesn't exist, call \"generator\"","","    @param {String} filePath","    @param {Function} generator","    @return {Promise}","*/","function assertFile(filePath, generator) {","    return fileExists(filePath)","    .then(function(exists) {","        if (exists) return;","","        return generator();","    });","}","","/**","    Pick a file, returns the absolute path if exists, undefined otherwise","","    @param {String} rootFolder","    @param {String} fileName","    @return {String}","*/","function pickFile(rootFolder, fileName) {","    var result = path.join(rootFolder, fileName);","    if (fs.existsSync(result)) {","        return result;","    }","","    return undefined;","}","","/**","    Ensure that a directory exists and is empty","","    @param {String} folder","    @return {Promise}","*/","function ensureFolder(rootFolder) {","    return rmDir(rootFolder)","    .fail(function() {","        return Promise();","    })","    .then(function() {","        return Promise.nfcall(mkdirp, rootFolder);","    });","}","","module.exports = {","    exists: fileExists,","    existsSync: fs.existsSync,","    mkdirp: Promise.nfbind(mkdirp),","    readFile: Promise.nfbind(fs.readFile),","    writeFile: Promise.nfbind(fs.writeFile),","    assertFile: assertFile,","    pickFile: pickFile,","    stat: Promise.nfbind(fs.stat),","    statSync: fs.statSync,","    readdir: Promise.nfbind(fs.readdir),","    writeStream: writeStream,","    readStream: fs.createReadStream,","    copy: Promise.nfbind(cp),","    copyDir: Promise.nfbind(cpr),","    tmpFile: genTmpFile,","    tmpDir: genTmpDir,","    download: download,","    uniqueFilename: uniqueFilename,","    ensureFile: ensureFile,","    ensureFolder: ensureFolder,","    rmDir: rmDir","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"11":1,"14":1,"15":0,"17":0,"18":0,"19":0,"20":0,"23":0,"24":0,"25":0,"27":0,"28":0,"29":0,"32":0,"33":0,"34":0,"37":0,"39":0,"43":1,"44":0,"46":0,"47":0,"50":0,"54":1,"55":0,"60":1,"61":0,"66":1,"67":0,"71":1,"72":0,"73":0,"74":0,"76":0,"78":0,"79":0,"80":0,"81":0,"84":0,"88":1,"89":0,"90":0,"94":1,"95":0,"107":1,"108":0,"110":0,"112":0,"123":1,"124":0,"125":0,"126":0,"129":0,"138":1,"139":0,"141":0,"144":0,"148":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/index.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"getGenerator","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":28}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":27},"end":{"line":16,"column":47}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":7,"column":3}},"3":{"start":{"line":15,"column":0},"end":{"line":19,"column":1}},"4":{"start":{"line":16,"column":4},"end":{"line":18,"column":7}},"5":{"start":{"line":17,"column":8},"end":{"line":17,"column":38}},"6":{"start":{"line":21,"column":0},"end":{"line":24,"column":2}}},"branchMap":{},"code":["var Immutable = require('immutable');","","var generators = Immutable.List([","    require('./json'),","    require('./website'),","    require('./ebook')","]);","","/**","    Return a specific generator by its name","","    @param {String}","    @return {Generator}","*/","function getGenerator(name) {","    return generators.find(function(generator) {","        return generator.name == name;","    });","}","","module.exports = {","    generate:           require('./generateBook'),","    getGenerator:       getGenerator","};",""],"l":{"1":1,"3":1,"15":1,"16":0,"17":0,"21":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/json/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/json/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":7,"column":2}}},"branchMap":{},"code":["","module.exports = {","    name:       'json',","    Options:    require('./options'),","    onPage:     require('./onPage'),","    onFinish:   require('./onFinish')","};",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/json/options.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/json/options.js","s":{"1":1,"2":1,"3":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":6,"column":3}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":25}}},"branchMap":{},"code":["var Immutable = require('immutable');","","var Options = Immutable.Record({","    // Root folder for the output","    root:       String()","});","","module.exports = Options;",""],"l":{"1":1,"3":1,"8":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/json/onPage.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/json/onPage.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"onPage","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":30}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":10},"end":{"line":20,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":38}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":44}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":40}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":47}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":46}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":23}},"7":{"start":{"line":15,"column":0},"end":{"line":41,"column":1}},"8":{"start":{"line":16,"column":4},"end":{"line":16,"column":30}},"9":{"start":{"line":17,"column":4},"end":{"line":17,"column":56}},"10":{"start":{"line":19,"column":4},"end":{"line":40,"column":7}},"11":{"start":{"line":22,"column":8},"end":{"line":22,"column":78}},"12":{"start":{"line":25,"column":8},"end":{"line":25,"column":27}},"13":{"start":{"line":28,"column":8},"end":{"line":28,"column":36}},"14":{"start":{"line":31,"column":8},"end":{"line":31,"column":90}},"15":{"start":{"line":32,"column":8},"end":{"line":32,"column":61}},"16":{"start":{"line":35,"column":8},"end":{"line":39,"column":10}},"17":{"start":{"line":43,"column":0},"end":{"line":43,"column":24}}},"branchMap":{"1":{"line":31,"type":"cond-expr","locations":[{"start":{"line":31,"column":59},"end":{"line":31,"column":72}},{"start":{"line":31,"column":75},"end":{"line":31,"column":89}}]}},"code":["var JSONUtils = require('../../json');","var PathUtils = require('../../utils/path');","var Modifiers = require('../modifiers');","var writeFile = require('../helper/writeFile');","var getModifiers = require('../getModifiers');","","var JSON_VERSION = '3';","","/**"," * Write a page as a json file"," *"," * @param {Output} output"," * @param {Page} page"," */","function onPage(output, page) {","    var file = page.getFile();","    var readme = output.getBook().getReadme().getFile();","","    return Modifiers.modifyHTML(page, getModifiers(output, page))","    .then(function(resultPage) {","        // Generate the JSON","        var json = JSONUtils.encodeBookWithPage(output.getBook(), resultPage);","","        // Delete some private properties","        delete json.config;","","        // Specify JSON output version","        json.version = JSON_VERSION;","","        // File path in the output folder","        var filePath = file.getPath() == readme.getPath()? 'README.json' : file.getPath();","        filePath = PathUtils.setExtension(filePath, '.json');","","        // Write it to the disk","        return writeFile(","            output,","            filePath,","            JSON.stringify(json, null, 4)","        );","    });","}","","module.exports = onPage;",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"7":1,"15":1,"16":0,"17":0,"19":0,"22":0,"25":0,"28":0,"31":0,"32":0,"35":0,"43":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":13,"column":2}}},"branchMap":{},"code":["","module.exports = {","    encodeOutput:           require('./encodeOutput'),","    encodeBookWithPage:     require('./encodeBookWithPage'),","    encodeOutputWithPage:   require('./encodeOutputWithPage'),","    encodeBook:             require('./encodeBook'),","    encodeFile:             require('./encodeFile'),","    encodePage:             require('./encodePage'),","    encodeSummary:          require('./encodeSummary'),","    encodeSummaryArticle:   require('./encodeSummaryArticle'),","    encodeReadme:           require('./encodeReadme'),","    encodeLanguages:        require('./encodeLanguages')","};",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeOutput.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeOutput.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"encodeOutputToJson","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}},"2":{"start":{"line":9,"column":0},"end":{"line":23,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":10,"column":32}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":42}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":38}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":34}},"7":{"start":{"line":16,"column":4},"end":{"line":18,"column":6}},"8":{"start":{"line":20,"column":4},"end":{"line":20,"column":36}},"9":{"start":{"line":22,"column":4},"end":{"line":22,"column":18}},"10":{"start":{"line":25,"column":0},"end":{"line":25,"column":36}}},"branchMap":{},"code":["var encodeBook = require('./encodeBook');","","/**"," * Encode an output to JSON"," *"," * @param {Output}"," * @return {Object}"," */","function encodeOutputToJson(output) {","    var book = output.getBook();","    var generator = output.getGenerator();","    var options = output.getOptions();","","    var result = encodeBook(book);","","    result.output = {","        name: generator","    };","","    result.options = options.toJS();","","    return result;","}","","module.exports = encodeOutputToJson;",""],"l":{"1":1,"9":1,"10":0,"11":0,"12":0,"14":0,"16":0,"20":0,"22":0,"25":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeBook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeBook.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"encodeBookToJson","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":36}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":47}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":49}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":45}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":51}},"7":{"start":{"line":15,"column":0},"end":{"line":37,"column":1}},"8":{"start":{"line":16,"column":4},"end":{"line":16,"column":34}},"9":{"start":{"line":17,"column":4},"end":{"line":17,"column":38}},"10":{"start":{"line":19,"column":4},"end":{"line":19,"column":53}},"11":{"start":{"line":21,"column":4},"end":{"line":36,"column":6}},"12":{"start":{"line":39,"column":0},"end":{"line":39,"column":34}}},"branchMap":{"1":{"line":27,"type":"cond-expr","locations":[{"start":{"line":27,"column":42},"end":{"line":27,"column":78}},{"start":{"line":27,"column":81},"end":{"line":27,"column":90}}]},"2":{"line":34,"type":"cond-expr","locations":[{"start":{"line":34,"column":32},"end":{"line":34,"column":40}},{"start":{"line":34,"column":43},"end":{"line":34,"column":52}}]}},"code":["var extend = require('extend');","","var gitbook = require('../gitbook');","var encodeSummary = require('./encodeSummary');","var encodeGlossary = require('./encodeGlossary');","var encodeReadme = require('./encodeReadme');","var encodeLanguages = require('./encodeLanguages');","","/**","    Encode a book to JSON","","    @param {Book}","    @return {Object}","*/","function encodeBookToJson(book) {","    var config = book.getConfig();","    var language = book.getLanguage();","","    var variables = config.getValue('variables', {});","","    return {","        summary: encodeSummary(book.getSummary()),","        glossary: encodeGlossary(book.getGlossary()),","        readme: encodeReadme(book.getReadme()),","        config: book.getConfig().getValues().toJS(),","","        languages: book.isMultilingual()? encodeLanguages(book.getLanguages()) : undefined,","","        gitbook: {","            version: gitbook.version,","            time: gitbook.START_TIME","        },","        book: extend({","            language: language? language : undefined","        }, variables.toJS())","    };","}","","module.exports = encodeBookToJson;",""],"l":{"1":1,"3":1,"4":1,"5":1,"6":1,"7":1,"15":1,"16":0,"17":0,"19":0,"21":0,"39":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/gitbook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/gitbook.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":1},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"satisfies","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":30}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":26}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":53}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":28}},"6":{"start":{"line":16,"column":0},"end":{"line":22,"column":1}},"7":{"start":{"line":18,"column":4},"end":{"line":18,"column":58}},"8":{"start":{"line":18,"column":46},"end":{"line":18,"column":58}},"9":{"start":{"line":21,"column":4},"end":{"line":21,"column":55}},"10":{"start":{"line":24,"column":0},"end":{"line":28,"column":2}}},"branchMap":{"1":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":18,"column":4}},{"start":{"line":18,"column":4},"end":{"line":18,"column":4}}]}},"code":["var semver = require('semver');","var pkg = require('../package.json');","","var VERSION = pkg.version;","var VERSION_STABLE = VERSION.replace(/\\-(\\S+)/g, '');","","var START_TIME = new Date();","","/**","    Verify that this gitbook version satisfies a requirement","    We can't directly use samver.satisfies since it will break all plugins when gitbook version is a prerelease (beta, alpha)","","    @param {String} condition","    @return {Boolean}","*/","function satisfies(condition) {","    // Test with real version","    if (semver.satisfies(VERSION, condition)) return true;","","    // Test with future stable release","    return semver.satisfies(VERSION_STABLE, condition);","}","","module.exports = {","    version: pkg.version,","    satisfies: satisfies,","    START_TIME: START_TIME","};",""],"l":{"1":1,"2":1,"4":1,"5":1,"7":1,"16":1,"18":0,"21":0,"24":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeSummary.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeSummary.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"encodeSummary","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":55}},"3":{"start":{"line":10,"column":0},"end":{"line":18,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":33}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":35}},"6":{"start":{"line":14,"column":4},"end":{"line":17,"column":6}},"7":{"start":{"line":20,"column":0},"end":{"line":20,"column":31}}},"branchMap":{},"code":["var encodeFile = require('./encodeFile');","var encodeSummaryPart = require('./encodeSummaryPart');","","/**","    Encode a summary to JSON","","    @param {Summary}","    @return {Object}","*/","function encodeSummary(summary) {","    var file = summary.getFile();","    var parts = summary.getParts();","","    return {","        file: encodeFile(file),","        parts: parts.map(encodeSummaryPart).toJS()","    };","}","","module.exports = encodeSummary;",""],"l":{"1":1,"2":1,"10":1,"11":0,"12":0,"14":0,"20":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeFile.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeFile.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":1},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"encodeFileToJson","line":8,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":32}}}},"statementMap":{"1":{"start":{"line":8,"column":0},"end":{"line":19,"column":1}},"2":{"start":{"line":9,"column":4},"end":{"line":9,"column":34}},"3":{"start":{"line":10,"column":4},"end":{"line":12,"column":5}},"4":{"start":{"line":11,"column":8},"end":{"line":11,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":18,"column":6}},"6":{"start":{"line":21,"column":0},"end":{"line":21,"column":34}}},"branchMap":{"1":{"line":10,"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":4}},{"start":{"line":10,"column":4},"end":{"line":10,"column":4}}]}},"code":["","/**","    Return a JSON representation of a file","","    @param {File} file","    @return {Object}","*/","function encodeFileToJson(file) {","    var filePath = file.getPath();","    if (!filePath) {","        return undefined;","    }","","    return {","        path: filePath,","        mtime: file.getMTime(),","        type: file.getType()","    };","}","","module.exports = encodeFileToJson;",""],"l":{"8":1,"9":0,"10":0,"11":0,"14":0,"21":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeSummaryPart.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeSummaryPart.js","s":{"1":1,"2":1,"3":0,"4":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"encodeSummaryPart","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":33}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":61}},"2":{"start":{"line":9,"column":0},"end":{"line":15,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":14,"column":6}},"4":{"start":{"line":17,"column":0},"end":{"line":17,"column":35}}},"branchMap":{},"code":["var encodeSummaryArticle = require('./encodeSummaryArticle');","","/**","    Encode a SummaryPart to JSON","","    @param {SummaryPart}","    @return {Object}","*/","function encodeSummaryPart(part) {","    return {","        title: part.getTitle(),","        articles: part.getArticles()","            .map(encodeSummaryArticle).toJS()","    };","}","","module.exports = encodeSummaryPart;",""],"l":{"1":1,"9":1,"10":0,"17":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeSummaryArticle.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeSummaryArticle.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":1},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"encodeSummaryArticle","line":8,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":50}}}},"statementMap":{"1":{"start":{"line":8,"column":0},"end":{"line":26,"column":1}},"2":{"start":{"line":9,"column":4},"end":{"line":9,"column":29}},"3":{"start":{"line":10,"column":4},"end":{"line":14,"column":5}},"4":{"start":{"line":11,"column":8},"end":{"line":13,"column":20}},"5":{"start":{"line":16,"column":4},"end":{"line":25,"column":6}},"6":{"start":{"line":28,"column":0},"end":{"line":28,"column":38}}},"branchMap":{"1":{"line":10,"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":4}},{"start":{"line":10,"column":4},"end":{"line":10,"column":4}}]}},"code":["","/**","    Encode a SummaryArticle to JSON","","    @param {SummaryArticle}","    @return {Object}","*/","function encodeSummaryArticle(article, recursive) {","    var articles = undefined;","    if (recursive !== false) {","        articles = article.getArticles()","            .map(encodeSummaryArticle)","            .toJS();","    }","","    return {","        title: article.getTitle(),","        level: article.getLevel(),","        depth: article.getDepth(),","        anchor: article.getAnchor(),","        url: article.getUrl(),","        path: article.getPath(),","        ref: article.getRef(),","        articles: articles","    };","}","","module.exports = encodeSummaryArticle;",""],"l":{"8":1,"9":0,"10":0,"11":0,"16":0,"28":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeGlossary.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeGlossary.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"encodeGlossary","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":34}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":59}},"3":{"start":{"line":10,"column":0},"end":{"line":19,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":34}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":40}},"6":{"start":{"line":14,"column":4},"end":{"line":18,"column":6}},"7":{"start":{"line":21,"column":0},"end":{"line":21,"column":32}}},"branchMap":{},"code":["var encodeFile = require('./encodeFile');","var encodeGlossaryEntry = require('./encodeGlossaryEntry');","","/**","    Encode a glossary to JSON","","    @param {Glossary}","    @return {Object}","*/","function encodeGlossary(glossary) {","    var file = glossary.getFile();","    var entries = glossary.getEntries();","","    return {","        file: encodeFile(file),","        entries: entries","            .map(encodeGlossaryEntry).toJS()","    };","}","","module.exports = encodeGlossary;",""],"l":{"1":1,"2":1,"10":1,"11":0,"12":0,"14":0,"21":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeGlossaryEntry.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeGlossaryEntry.js","s":{"1":1,"2":0,"3":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"encodeGlossaryEntry","line":8,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":36}}}},"statementMap":{"1":{"start":{"line":8,"column":0},"end":{"line":14,"column":1}},"2":{"start":{"line":9,"column":4},"end":{"line":13,"column":6}},"3":{"start":{"line":16,"column":0},"end":{"line":16,"column":37}}},"branchMap":{},"code":["","/**","    Encode a SummaryArticle to JSON","","    @param {GlossaryEntry}","    @return {Object}","*/","function encodeGlossaryEntry(entry) {","    return {","        id: entry.getID(),","        name: entry.getName(),","        description: entry.getDescription()","    };","}","","module.exports = encodeGlossaryEntry;",""],"l":{"8":1,"9":0,"16":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeReadme.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeReadme.js","s":{"1":1,"2":1,"3":0,"4":0,"5":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"encodeReadme","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":30}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}},"2":{"start":{"line":9,"column":0},"end":{"line":15,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":10,"column":32}},"4":{"start":{"line":12,"column":4},"end":{"line":14,"column":6}},"5":{"start":{"line":17,"column":0},"end":{"line":17,"column":30}}},"branchMap":{},"code":["var encodeFile = require('./encodeFile');","","/**","    Encode a readme to JSON","","    @param {Readme}","    @return {Object}","*/","function encodeReadme(readme) {","    var file = readme.getFile();","","    return {","        file: encodeFile(file)","    };","}","","module.exports = encodeReadme;",""],"l":{"1":1,"9":1,"10":0,"12":0,"17":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeLanguages.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeLanguages.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"encodeLanguages","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":36}}},"2":{"name":"(anonymous_2)","line":17,"loc":{"start":{"line":17,"column":17},"end":{"line":17,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}},"2":{"start":{"line":9,"column":0},"end":{"line":24,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":10,"column":35}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":35}},"5":{"start":{"line":13,"column":4},"end":{"line":23,"column":6}},"6":{"start":{"line":18,"column":16},"end":{"line":21,"column":18}},"7":{"start":{"line":26,"column":0},"end":{"line":26,"column":33}}},"branchMap":{},"code":["var encodeFile = require('./encodeFile');","","/**","    Encode a languages listing to JSON","","    @param {Languages}","    @return {Object}","*/","function encodeLanguages(languages) {","    var file = languages.getFile();","    var list = languages.getList();","","    return {","        file: encodeFile(file),","        list: list","            .valueSeq()","            .map(function(lang) {","                return {","                    id: lang.getID(),","                    title: lang.getTitle()","                };","            }).toJS()","    };","}","","module.exports = encodeLanguages;",""],"l":{"1":1,"9":1,"10":0,"11":0,"13":0,"18":0,"26":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeBookWithPage.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeBookWithPage.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"encodeBookWithPage","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":40}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":41}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":41}},"4":{"start":{"line":12,"column":0},"end":{"line":20,"column":1}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":30}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":34}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":54}},"8":{"start":{"line":17,"column":4},"end":{"line":17,"column":35}},"9":{"start":{"line":19,"column":4},"end":{"line":19,"column":18}},"10":{"start":{"line":22,"column":0},"end":{"line":22,"column":36}}},"branchMap":{},"code":["var encodeBook = require('./encodeBook');","var encodePage = require('./encodePage');","var encodeFile = require('./encodeFile');","","/**"," * Return a JSON representation of a book with a specific file"," *"," * @param {Book} output"," * @param {Page} page"," * @return {Object}"," */","function encodeBookWithPage(book, page) {","    var file = page.getFile();","","    var result = encodeBook(book);","    result.page = encodePage(page, book.getSummary());","    result.file = encodeFile(file);","","    return result;","}","","module.exports = encodeBookWithPage;",""],"l":{"1":1,"2":1,"3":1,"12":1,"13":0,"15":0,"16":0,"17":0,"19":0,"22":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodePage.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodePage.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"encodePage","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":61}},"2":{"start":{"line":10,"column":0},"end":{"line":37,"column":1}},"3":{"start":{"line":11,"column":4},"end":{"line":11,"column":30}},"4":{"start":{"line":12,"column":4},"end":{"line":12,"column":42}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":52}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":35}},"7":{"start":{"line":17,"column":4},"end":{"line":31,"column":5}},"8":{"start":{"line":18,"column":8},"end":{"line":18,"column":42}},"9":{"start":{"line":19,"column":8},"end":{"line":19,"column":42}},"10":{"start":{"line":20,"column":8},"end":{"line":20,"column":42}},"11":{"start":{"line":22,"column":8},"end":{"line":22,"column":58}},"12":{"start":{"line":23,"column":8},"end":{"line":25,"column":9}},"13":{"start":{"line":24,"column":12},"end":{"line":24,"column":60}},"14":{"start":{"line":27,"column":8},"end":{"line":27,"column":58}},"15":{"start":{"line":28,"column":8},"end":{"line":30,"column":9}},"16":{"start":{"line":29,"column":12},"end":{"line":29,"column":64}},"17":{"start":{"line":33,"column":4},"end":{"line":33,"column":39}},"18":{"start":{"line":34,"column":4},"end":{"line":34,"column":31}},"19":{"start":{"line":36,"column":4},"end":{"line":36,"column":18}},"20":{"start":{"line":39,"column":0},"end":{"line":39,"column":28}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":17,"column":4}},{"start":{"line":17,"column":4},"end":{"line":17,"column":4}}]},"2":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":23,"column":8}},{"start":{"line":23,"column":8},"end":{"line":23,"column":8}}]},"3":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":28,"column":8}},{"start":{"line":28,"column":8},"end":{"line":28,"column":8}}]}},"code":["var encodeSummaryArticle = require('./encodeSummaryArticle');","","/**","    Return a JSON representation of a page","","    @param {Page} page","    @param {Summary} summary","    @return {Object}","*/","function encodePage(page, summary) {","    var file = page.getFile();","    var attributes = page.getAttributes();","    var article = summary.getByPath(file.getPath());","","    var result = attributes.toJS();","","    if (article) {","        result.title = article.getTitle();","        result.level = article.getLevel();","        result.depth = article.getDepth();","","        var nextArticle = summary.getNextArticle(article);","        if (nextArticle) {","            result.next = encodeSummaryArticle(nextArticle);","        }","","        var prevArticle = summary.getPrevArticle(article);","        if (prevArticle) {","            result.previous = encodeSummaryArticle(prevArticle);","        }","    }","","    result.content = page.getContent();","    result.dir = page.getDir();","","    return result;","}","","module.exports = encodePage;",""],"l":{"1":1,"10":1,"11":0,"12":0,"13":0,"15":0,"17":0,"18":0,"19":0,"20":0,"22":0,"23":0,"24":0,"27":0,"28":0,"29":0,"33":0,"34":0,"36":0,"39":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeOutputWithPage.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/json/encodeOutputWithPage.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"encodeOutputWithPage","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":44}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":45}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":41}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":41}},"4":{"start":{"line":12,"column":0},"end":{"line":21,"column":1}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":30}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":32}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":38}},"8":{"start":{"line":17,"column":4},"end":{"line":17,"column":54}},"9":{"start":{"line":18,"column":4},"end":{"line":18,"column":35}},"10":{"start":{"line":20,"column":4},"end":{"line":20,"column":18}},"11":{"start":{"line":23,"column":0},"end":{"line":23,"column":38}}},"branchMap":{},"code":["var encodeOutput = require('./encodeOutput');","var encodePage = require('./encodePage');","var encodeFile = require('./encodeFile');","","/**"," * Return a JSON representation of a book with a specific file"," *"," * @param {Book} output"," * @param {Page} page"," * @return {Object}"," */","function encodeOutputWithPage(output, page) {","    var file = page.getFile();","    var book = output.getBook();","","    var result = encodeOutput(output);","    result.page = encodePage(page, book.getSummary());","    result.file = encodeFile(file);","","    return result;","}","","module.exports = encodeOutputWithPage;",""],"l":{"1":1,"2":1,"3":1,"12":1,"13":0,"14":0,"16":0,"17":0,"18":0,"20":0,"23":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":15,"column":2}}},"branchMap":{},"code":["","module.exports = {","    modifyHTML:         require('./modifyHTML'),","    inlineAssets:       require('./inlineAssets'),","","    // HTML transformations","    addHeadingId:       require('./addHeadingId'),","    svgToImg:           require('./svgToImg'),","    fetchRemoteImages:  require('./fetchRemoteImages'),","    svgToPng:           require('./svgToPng'),","    resolveLinks:       require('./resolveLinks'),","    resolveImages:      require('./resolveImages'),","    annotateText:       require('./annotateText'),","    highlightCode:      require('./highlightCode')","};",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/modifyHTML.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/modifyHTML.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1},"b":{},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"modifyHTML","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":38}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":39},"end":{"line":16,"column":52}}},"3":{"name":"(anonymous_3)","line":19,"loc":{"start":{"line":19,"column":10},"end":{"line":19,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":33}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":45}},"3":{"start":{"line":12,"column":0},"end":{"line":23,"column":1}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":33}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":31}},"6":{"start":{"line":16,"column":4},"end":{"line":22,"column":7}},"7":{"start":{"line":17,"column":8},"end":{"line":17,"column":21}},"8":{"start":{"line":20,"column":8},"end":{"line":20,"column":34}},"9":{"start":{"line":21,"column":8},"end":{"line":21,"column":47}},"10":{"start":{"line":25,"column":0},"end":{"line":25,"column":28}}},"branchMap":{},"code":["var cheerio = require('cheerio');","var Promise = require('../../utils/promise');","","/**","    Apply a list of operations to a page and","    output the new page.","","    @param {Page}","    @param {List|Array<Transformation>}","    @return {Promise<Page>}","*/","function modifyHTML(page, operations) {","    var html = page.getContent();","    var $ = cheerio.load(html);","","    return Promise.forEach(operations, function(op) {","        return op($);","    })","    .then(function() {","        var resultHTML = $.html();","        return page.set('content', resultHTML);","    });","}","","module.exports = modifyHTML;",""],"l":{"1":1,"2":1,"12":1,"13":0,"14":0,"16":0,"17":0,"20":0,"21":0,"25":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/inlineAssets.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/inlineAssets.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"inlineAssets","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":47}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":11},"end":{"line":15,"column":23}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":39}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":47}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":55}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":45}},"7":{"start":{"line":14,"column":0},"end":{"line":27,"column":1}},"8":{"start":{"line":15,"column":4},"end":{"line":26,"column":6}},"9":{"start":{"line":16,"column":8},"end":{"line":25,"column":64}},"10":{"start":{"line":29,"column":0},"end":{"line":29,"column":30}}},"branchMap":{},"code":["var svgToImg = require('./svgToImg');","var svgToPng = require('./svgToPng');","var inlinePng = require('./inlinePng');","var resolveImages = require('./resolveImages');","var fetchRemoteImages = require('./fetchRemoteImages');","","var Promise = require('../../utils/promise');","","/**","    Inline all assets in a page","","    @param {String} rootFolder","*/","function inlineAssets(rootFolder, currentFile) {","    return function($) {","        return Promise()","","        // Resolving images and fetching external images should be","        // done before svg conversion","        .then(resolveImages.bind(null, currentFile, $))","        .then(fetchRemoteImages.bind(null, rootFolder, currentFile, $))","","        .then(svgToImg.bind(null, rootFolder, currentFile, $))","        .then(svgToPng.bind(null, rootFolder, currentFile, $))","        .then(inlinePng.bind(null, rootFolder, currentFile, $));","    };","}","","module.exports = inlineAssets;",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"7":1,"14":1,"15":0,"16":0,"29":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/svgToImg.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/svgToImg.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1},"b":{"1":[0,0],"2":[0,0,0],"3":[0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"renderDOM","line":17,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":36}}},"2":{"name":"svgToImg","line":31,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":46}}},"3":{"name":"(anonymous_3)","line":34,"loc":{"start":{"line":34,"column":37},"end":{"line":34,"column":52}}},"4":{"name":"(anonymous_4)","line":44,"loc":{"start":{"line":44,"column":39},"end":{"line":44,"column":50}}},"5":{"name":"(anonymous_5)","line":49,"loc":{"start":{"line":49,"column":14},"end":{"line":49,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":25}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":46}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":51}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":35}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":52}},"7":{"start":{"line":17,"column":0},"end":{"line":23,"column":1}},"8":{"start":{"line":18,"column":4},"end":{"line":20,"column":5}},"9":{"start":{"line":19,"column":8},"end":{"line":19,"column":31}},"10":{"start":{"line":21,"column":4},"end":{"line":21,"column":50}},"11":{"start":{"line":22,"column":4},"end":{"line":22,"column":39}},"12":{"start":{"line":31,"column":0},"end":{"line":54,"column":1}},"13":{"start":{"line":32,"column":4},"end":{"line":32,"column":53}},"14":{"start":{"line":34,"column":4},"end":{"line":53,"column":7}},"15":{"start":{"line":35,"column":8},"end":{"line":36,"column":31}},"16":{"start":{"line":39,"column":8},"end":{"line":39,"column":51}},"17":{"start":{"line":40,"column":8},"end":{"line":40,"column":37}},"18":{"start":{"line":41,"column":8},"end":{"line":41,"column":55}},"19":{"start":{"line":44,"column":8},"end":{"line":52,"column":11}},"20":{"start":{"line":45,"column":12},"end":{"line":45,"column":59}},"21":{"start":{"line":50,"column":12},"end":{"line":50,"column":73}},"22":{"start":{"line":51,"column":12},"end":{"line":51,"column":58}},"23":{"start":{"line":56,"column":0},"end":{"line":56,"column":26}}},"branchMap":{"1":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":18,"column":4}},{"start":{"line":18,"column":4},"end":{"line":18,"column":4}}]},"2":{"line":18,"type":"binary-expr","locations":[{"start":{"line":18,"column":8},"end":{"line":18,"column":12}},{"start":{"line":18,"column":16},"end":{"line":18,"column":23}},{"start":{"line":18,"column":27},"end":{"line":18,"column":43}}]},"3":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":14},"end":{"line":21,"column":21}},{"start":{"line":21,"column":24},"end":{"line":21,"column":35}},{"start":{"line":21,"column":39},"end":{"line":21,"column":49}}]}},"code":["var path = require('path');","var crc = require('crc');","var domSerializer = require('dom-serializer');","","var editHTMLElement = require('./editHTMLElement');","var fs = require('../../utils/fs');","var LocationUtils = require('../../utils/location');","","/**","    Render a cheerio DOM as html","","    @param {HTMLDom} $","    @param {HTMLElement} dom","    @param {Object}","    @return {String}","*/","function renderDOM($, dom, options) {","    if (!dom && $._root && $._root.children) {","        dom = $._root.children;","    }","    options = options|| dom.options || $._options;","    return domSerializer(dom, options);","}","","/**","    Replace SVG tag by IMG","","    @param {String} baseFolder","    @param {HTMLDom} $","*/","function svgToImg(baseFolder, currentFile, $) {","    var currentDirectory = path.dirname(currentFile);","","    return editHTMLElement($, 'svg', function($svg) {","        var content = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' +","            renderDOM($, $svg);","","        // We avoid generating twice the same PNG","        var hash = crc.crc32(content).toString(16);","        var fileName = hash + '.svg';","        var filePath = path.join(baseFolder, fileName);","","        // Write the svg to the file","        return fs.assertFile(filePath, function() {","            return fs.writeFile(filePath, content, 'utf8');","        })","","        // Return as image","        .then(function() {","            var src = LocationUtils.relative(currentDirectory, fileName);","            $svg.replaceWith('<img src=\"' + src + '\" />');","        });","    });","}","","module.exports = svgToImg;",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"7":1,"17":1,"18":0,"19":0,"21":0,"22":0,"31":1,"32":0,"34":0,"35":0,"39":0,"40":0,"41":0,"44":0,"45":0,"50":0,"51":0,"56":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/editHTMLElement.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/editHTMLElement.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"editHTMLElement","line":6,"loc":{"start":{"line":6,"column":0},"end":{"line":6,"column":42}}},"2":{"name":"(anonymous_2)","line":9,"loc":{"start":{"line":9,"column":38},"end":{"line":9,"column":51}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":45}},"2":{"start":{"line":6,"column":0},"end":{"line":13,"column":1}},"3":{"start":{"line":7,"column":4},"end":{"line":7,"column":32}},"4":{"start":{"line":9,"column":4},"end":{"line":12,"column":7}},"5":{"start":{"line":10,"column":8},"end":{"line":10,"column":24}},"6":{"start":{"line":11,"column":8},"end":{"line":11,"column":23}},"7":{"start":{"line":15,"column":0},"end":{"line":15,"column":33}}},"branchMap":{},"code":["var Promise = require('../../utils/promise');","","/**","    Edit all elements matching a selector","*/","function editHTMLElement($, selector, fn) {","    var $elements = $(selector);","","    return Promise.forEach($elements, function(el) {","        var $el = $(el);","        return fn($el);","    });","}","","module.exports = editHTMLElement;",""],"l":{"1":1,"6":1,"7":0,"9":0,"10":0,"11":0,"15":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/svgToPng.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/svgToPng.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"svgToPng","line":17,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":46}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":37},"end":{"line":20,"column":52}}},"3":{"name":"(anonymous_3)","line":39,"loc":{"start":{"line":39,"column":39},"end":{"line":39,"column":50}}},"4":{"name":"(anonymous_4)","line":42,"loc":{"start":{"line":42,"column":14},"end":{"line":42,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":25}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":47}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":35}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":52}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":51}},"7":{"start":{"line":17,"column":0},"end":{"line":50,"column":1}},"8":{"start":{"line":18,"column":4},"end":{"line":18,"column":53}},"9":{"start":{"line":20,"column":4},"end":{"line":49,"column":7}},"10":{"start":{"line":21,"column":8},"end":{"line":21,"column":35}},"11":{"start":{"line":22,"column":8},"end":{"line":24,"column":9}},"12":{"start":{"line":23,"column":12},"end":{"line":23,"column":19}},"13":{"start":{"line":27,"column":8},"end":{"line":27,"column":67}},"14":{"start":{"line":30,"column":8},"end":{"line":30,"column":47}},"15":{"start":{"line":31,"column":8},"end":{"line":31,"column":37}},"16":{"start":{"line":34,"column":8},"end":{"line":34,"column":51}},"17":{"start":{"line":37,"column":8},"end":{"line":37,"column":55}},"18":{"start":{"line":39,"column":8},"end":{"line":48,"column":11}},"19":{"start":{"line":40,"column":12},"end":{"line":40,"column":67}},"20":{"start":{"line":44,"column":12},"end":{"line":44,"column":74}},"21":{"start":{"line":47,"column":12},"end":{"line":47,"column":39}},"22":{"start":{"line":53,"column":0},"end":{"line":53,"column":26}}},"branchMap":{"1":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":8},"end":{"line":22,"column":8}},{"start":{"line":22,"column":8},"end":{"line":22,"column":8}}]}},"code":["var crc = require('crc');","var path = require('path');","","var imagesUtil = require('../../utils/images');","var fs = require('../../utils/fs');","var LocationUtils = require('../../utils/location');","","var editHTMLElement = require('./editHTMLElement');","","/**","    Convert all SVG images to PNG","","    @param {String} rootFolder","    @param {HTMLDom} $","    @return {Promise}","*/","function svgToPng(rootFolder, currentFile, $) {","    var currentDirectory = path.dirname(currentFile);","","    return editHTMLElement($, 'img', function($img) {","        var src = $img.attr('src');","        if (path.extname(src) !== '.svg') {","            return;","        }","","        // Calcul absolute path for this","        src = LocationUtils.toAbsolute(src, currentDirectory, '.');","","        // We avoid generating twice the same PNG","        var hash = crc.crc32(src).toString(16);","        var fileName = hash + '.png';","","        // Input file path","        var inputPath = path.join(rootFolder, src);","","        // Result file path","        var filePath = path.join(rootFolder, fileName);","","        return fs.assertFile(filePath, function() {","            return imagesUtil.convertSVGToPNG(inputPath, filePath);","        })","        .then(function() {","            // Convert filename to a relative filename","            fileName = LocationUtils.relative(currentDirectory, fileName);","","            // Replace src","            $img.attr('src', fileName);","        });","    });","}","","","module.exports = svgToPng;",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"8":1,"17":1,"18":0,"20":0,"21":0,"22":0,"23":0,"27":0,"30":0,"31":0,"34":0,"37":0,"39":0,"40":0,"44":0,"47":0,"53":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/images.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/images.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"convertSVGToPNG","line":7,"loc":{"start":{"line":7,"column":0},"end":{"line":7,"column":48}}},"2":{"name":"(anonymous_2)","line":11,"loc":{"start":{"line":11,"column":10},"end":{"line":11,"column":24}}},"3":{"name":"(anonymous_3)","line":20,"loc":{"start":{"line":20,"column":10},"end":{"line":20,"column":21}}},"4":{"name":"convertSVGBufferToPNG","line":28,"loc":{"start":{"line":28,"column":0},"end":{"line":28,"column":42}}},"5":{"name":"(anonymous_5)","line":33,"loc":{"start":{"line":33,"column":10},"end":{"line":33,"column":27}}},"6":{"name":"(anonymous_6)","line":35,"loc":{"start":{"line":35,"column":14},"end":{"line":35,"column":25}}},"7":{"name":"convertInlinePNG","line":42,"loc":{"start":{"line":42,"column":0},"end":{"line":42,"column":40}}},"8":{"name":"(anonymous_8)","line":49,"loc":{"start":{"line":49,"column":10},"end":{"line":49,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":35}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":25}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":31}},"5":{"start":{"line":7,"column":0},"end":{"line":25,"column":1}},"6":{"start":{"line":8,"column":4},"end":{"line":8,"column":105}},"7":{"start":{"line":8,"column":32},"end":{"line":8,"column":105}},"8":{"start":{"line":10,"column":4},"end":{"line":24,"column":7}},"9":{"start":{"line":12,"column":8},"end":{"line":17,"column":9}},"10":{"start":{"line":13,"column":12},"end":{"line":16,"column":15}},"11":{"start":{"line":18,"column":8},"end":{"line":18,"column":18}},"12":{"start":{"line":21,"column":8},"end":{"line":21,"column":40}},"13":{"start":{"line":21,"column":33},"end":{"line":21,"column":40}},"14":{"start":{"line":23,"column":8},"end":{"line":23,"column":66}},"15":{"start":{"line":28,"column":0},"end":{"line":39,"column":1}},"16":{"start":{"line":30,"column":4},"end":{"line":38,"column":7}},"17":{"start":{"line":34,"column":8},"end":{"line":37,"column":11}},"18":{"start":{"line":36,"column":12},"end":{"line":36,"column":49}},"19":{"start":{"line":42,"column":0},"end":{"line":54,"column":1}},"20":{"start":{"line":43,"column":4},"end":{"line":43,"column":108}},"21":{"start":{"line":43,"column":43},"end":{"line":43,"column":108}},"22":{"start":{"line":45,"column":4},"end":{"line":45,"column":63}},"23":{"start":{"line":46,"column":4},"end":{"line":46,"column":47}},"24":{"start":{"line":48,"column":4},"end":{"line":53,"column":7}},"25":{"start":{"line":50,"column":8},"end":{"line":50,"column":40}},"26":{"start":{"line":50,"column":33},"end":{"line":50,"column":40}},"27":{"start":{"line":52,"column":8},"end":{"line":52,"column":66}},"28":{"start":{"line":56,"column":0},"end":{"line":60,"column":2}}},"branchMap":{"1":{"line":8,"type":"if","locations":[{"start":{"line":8,"column":4},"end":{"line":8,"column":4}},{"start":{"line":8,"column":4},"end":{"line":8,"column":4}}]},"2":{"line":12,"type":"if","locations":[{"start":{"line":12,"column":8},"end":{"line":12,"column":8}},{"start":{"line":12,"column":8},"end":{"line":12,"column":8}}]},"3":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":21,"column":8}},{"start":{"line":21,"column":8},"end":{"line":21,"column":8}}]},"4":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":4},"end":{"line":43,"column":4}},{"start":{"line":43,"column":4},"end":{"line":43,"column":4}}]},"5":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":8},"end":{"line":50,"column":8}},{"start":{"line":50,"column":8},"end":{"line":50,"column":8}}]}},"code":["var Promise = require('./promise');","var command = require('./command');","var fs = require('./fs');","var error = require('./error');","","// Convert a svg file to a pmg","function convertSVGToPNG(source, dest, options) {","    if (!fs.existsSync(source)) return Promise.reject(new error.FileNotFoundError({ filename: source }));","","    return command.spawn('svgexport', [source, dest])","    .fail(function(err) {","        if (err.code == 'ENOENT') {","            err = error.RequireInstallError({","                cmd: 'svgexport',","                install: 'Install it using: \"npm install svgexport -g\"'","            });","        }","        throw err;","    })","    .then(function() {","        if (fs.existsSync(dest)) return;","","        throw new Error('Error converting '+source+' into '+dest);","    });","}","","// Convert a svg buffer to a png file","function convertSVGBufferToPNG(buf, dest) {","    // Create a temporary SVG file to convert","    return fs.tmpFile({","        postfix: '.svg'","    })","    .then(function(tmpSvg) {","        return fs.writeFile(tmpSvg, buf)","        .then(function() {","            return convertSVGToPNG(tmpSvg, dest);","        });","    });","}","","// Converts a inline data: to png file","function convertInlinePNG(source, dest) {","    if (!/^data\\:image\\/png/.test(source)) return Promise.reject(new Error('Source is not a PNG data-uri'));","","    var base64data = source.split('data:image/png;base64,')[1];","    var buf = new Buffer(base64data, 'base64');","","    return fs.writeFile(dest, buf)","    .then(function() {","        if (fs.existsSync(dest)) return;","","        throw new Error('Error converting '+source+' into '+dest);","    });","}","","module.exports = {","    convertSVGToPNG: convertSVGToPNG,","    convertSVGBufferToPNG: convertSVGBufferToPNG,","    convertInlinePNG: convertInlinePNG","};"],"l":{"1":1,"2":1,"3":1,"4":1,"7":1,"8":0,"10":0,"12":0,"13":0,"18":0,"21":0,"23":0,"28":1,"30":0,"34":0,"36":0,"42":1,"43":0,"45":0,"46":0,"48":0,"50":0,"52":0,"56":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/command.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/command.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"exec","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":32}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":52},"end":{"line":16,"column":82}}},"3":{"name":"(anonymous_3)","line":25,"loc":{"start":{"line":25,"column":28},"end":{"line":25,"column":44}}},"4":{"name":"(anonymous_4)","line":29,"loc":{"start":{"line":29,"column":28},"end":{"line":29,"column":44}}},"5":{"name":"spawnCmd","line":44,"loc":{"start":{"line":44,"column":0},"end":{"line":44,"column":42}}},"6":{"name":"(anonymous_6)","line":48,"loc":{"start":{"line":48,"column":22},"end":{"line":48,"column":38}}},"7":{"name":"(anonymous_7)","line":52,"loc":{"start":{"line":52,"column":28},"end":{"line":52,"column":44}}},"8":{"name":"(anonymous_8)","line":56,"loc":{"start":{"line":56,"column":28},"end":{"line":56,"column":44}}},"9":{"name":"(anonymous_9)","line":60,"loc":{"start":{"line":60,"column":22},"end":{"line":60,"column":37}}},"10":{"name":"escapeShellArg","line":77,"loc":{"start":{"line":77,"column":0},"end":{"line":77,"column":31}}},"11":{"name":"optionsToShellArgs","line":94,"loc":{"start":{"line":94,"column":0},"end":{"line":94,"column":37}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":44}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":39}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":35}},"5":{"start":{"line":13,"column":0},"end":{"line":34,"column":1}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":28}},"7":{"start":{"line":16,"column":4},"end":{"line":23,"column":7}},"8":{"start":{"line":17,"column":8},"end":{"line":19,"column":9}},"9":{"start":{"line":18,"column":12},"end":{"line":18,"column":31}},"10":{"start":{"line":21,"column":8},"end":{"line":21,"column":72}},"11":{"start":{"line":22,"column":8},"end":{"line":22,"column":22}},"12":{"start":{"line":25,"column":4},"end":{"line":27,"column":7}},"13":{"start":{"line":26,"column":8},"end":{"line":26,"column":23}},"14":{"start":{"line":29,"column":4},"end":{"line":31,"column":7}},"15":{"start":{"line":30,"column":8},"end":{"line":30,"column":23}},"16":{"start":{"line":33,"column":4},"end":{"line":33,"column":21}},"17":{"start":{"line":44,"column":0},"end":{"line":69,"column":1}},"18":{"start":{"line":45,"column":4},"end":{"line":45,"column":28}},"19":{"start":{"line":46,"column":4},"end":{"line":46,"column":46}},"20":{"start":{"line":48,"column":4},"end":{"line":50,"column":7}},"21":{"start":{"line":49,"column":8},"end":{"line":49,"column":31}},"22":{"start":{"line":52,"column":4},"end":{"line":54,"column":7}},"23":{"start":{"line":53,"column":8},"end":{"line":53,"column":23}},"24":{"start":{"line":56,"column":4},"end":{"line":58,"column":7}},"25":{"start":{"line":57,"column":8},"end":{"line":57,"column":23}},"26":{"start":{"line":60,"column":4},"end":{"line":66,"column":7}},"27":{"start":{"line":61,"column":8},"end":{"line":65,"column":9}},"28":{"start":{"line":62,"column":12},"end":{"line":62,"column":24}},"29":{"start":{"line":64,"column":12},"end":{"line":64,"column":68}},"30":{"start":{"line":68,"column":4},"end":{"line":68,"column":21}},"31":{"start":{"line":77,"column":0},"end":{"line":86,"column":1}},"32":{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},"33":{"start":{"line":79,"column":8},"end":{"line":79,"column":21}},"34":{"start":{"line":82,"column":4},"end":{"line":82,"column":26}},"35":{"start":{"line":83,"column":4},"end":{"line":83,"column":39}},"36":{"start":{"line":85,"column":4},"end":{"line":85,"column":29}},"37":{"start":{"line":94,"column":0},"end":{"line":112,"column":1}},"38":{"start":{"line":95,"column":4},"end":{"line":95,"column":20}},"39":{"start":{"line":97,"column":4},"end":{"line":109,"column":5}},"40":{"start":{"line":98,"column":8},"end":{"line":98,"column":33}},"41":{"start":{"line":100,"column":8},"end":{"line":102,"column":9}},"42":{"start":{"line":101,"column":12},"end":{"line":101,"column":21}},"43":{"start":{"line":104,"column":8},"end":{"line":108,"column":9}},"44":{"start":{"line":105,"column":12},"end":{"line":105,"column":29}},"45":{"start":{"line":107,"column":12},"end":{"line":107,"column":59}},"46":{"start":{"line":111,"column":4},"end":{"line":111,"column":28}},"47":{"start":{"line":114,"column":0},"end":{"line":118,"column":2}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":8},"end":{"line":17,"column":8}},{"start":{"line":17,"column":8},"end":{"line":17,"column":8}}]},"2":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":8},"end":{"line":61,"column":8}},{"start":{"line":61,"column":8},"end":{"line":61,"column":8}}]},"3":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":4},"end":{"line":78,"column":4}},{"start":{"line":78,"column":4},"end":{"line":78,"column":4}}]},"4":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":8},"end":{"line":100,"column":8}},{"start":{"line":100,"column":8},"end":{"line":100,"column":8}}]},"5":{"line":100,"type":"binary-expr","locations":[{"start":{"line":100,"column":12},"end":{"line":100,"column":26}},{"start":{"line":100,"column":30},"end":{"line":100,"column":49}},{"start":{"line":100,"column":53},"end":{"line":100,"column":68}}]},"6":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":8},"end":{"line":104,"column":8}},{"start":{"line":104,"column":8},"end":{"line":104,"column":8}}]}},"code":["var is = require('is');","var childProcess = require('child_process');","var spawn = require('spawn-cmd').spawn;","var Promise = require('./promise');","","/**","    Execute a command","","    @param {String} command","    @param {Object} options","    @return {Promise}","*/","function exec(command, options) {","    var d = Promise.defer();","","    var child = childProcess.exec(command, options, function(err, stdout, stderr) {","        if (!err) {","            return d.resolve();","        }","","        err.message = stdout.toString('utf8') + stderr.toString('utf8');","        d.reject(err);","    });","","    child.stdout.on('data', function (data) {","        d.notify(data);","    });","","    child.stderr.on('data', function (data) {","        d.notify(data);","    });","","    return d.promise;","}","","/**","    Spawn an executable","","    @param {String} command","    @param {Array} args","    @param {Object} options","    @return {Promise}","*/","function spawnCmd(command, args, options) {","    var d = Promise.defer();","    var child = spawn(command, args, options);","","    child.on('error', function(error) {","        return d.reject(error);","    });","","    child.stdout.on('data', function (data) {","        d.notify(data);","    });","","    child.stderr.on('data', function (data) {","        d.notify(data);","    });","","    child.on('close', function(code) {","        if (code === 0) {","            d.resolve();","        } else {","            d.reject(new Error('Error with command \"'+command+'\"'));","        }","    });","","    return d.promise;","}","","/**","    Transform an option object to a command line string","","    @param {String|number} value","    @param {String}","*/","function escapeShellArg(value) {","    if (is.number(value)) {","        return value;","    }","","    value = String(value);","    value = value.replace(/\"/g, '\\\\\"');","","    return '\"' + value + '\"';","}","","/**","    Transform a map of options into a command line arguments string","","    @param {Object} options","    @return {String}","*/","function optionsToShellArgs(options) {","    var result = [];","","    for (var key in options) {","        var value = options[key];","","        if (value === null || value === undefined || value === false) {","            continue;","        }","","        if (is.bool(value)) {","            result.push(key);","        } else {","            result.push(key + '=' + escapeShellArg(value));","        }","    }","","    return result.join(' ');","}","","module.exports = {","    exec: exec,","    spawn: spawnCmd,","    optionsToShellArgs: optionsToShellArgs","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"13":1,"14":0,"16":0,"17":0,"18":0,"21":0,"22":0,"25":0,"26":0,"29":0,"30":0,"33":0,"44":1,"45":0,"46":0,"48":0,"49":0,"52":0,"53":0,"56":0,"57":0,"60":0,"61":0,"62":0,"64":0,"68":0,"77":1,"78":0,"79":0,"82":0,"83":0,"85":0,"94":1,"95":0,"97":0,"98":0,"100":0,"101":0,"104":0,"105":0,"107":0,"111":0,"114":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/inlinePng.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/inlinePng.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"inlinePng","line":17,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":47}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":37},"end":{"line":20,"column":52}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":39},"end":{"line":33,"column":50}}},"4":{"name":"(anonymous_4)","line":36,"loc":{"start":{"line":36,"column":14},"end":{"line":36,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":25}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":47}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":35}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":52}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":51}},"7":{"start":{"line":17,"column":0},"end":{"line":44,"column":1}},"8":{"start":{"line":18,"column":4},"end":{"line":18,"column":53}},"9":{"start":{"line":20,"column":4},"end":{"line":43,"column":7}},"10":{"start":{"line":21,"column":8},"end":{"line":21,"column":35}},"11":{"start":{"line":22,"column":8},"end":{"line":24,"column":9}},"12":{"start":{"line":23,"column":12},"end":{"line":23,"column":19}},"13":{"start":{"line":27,"column":8},"end":{"line":27,"column":47}},"14":{"start":{"line":28,"column":8},"end":{"line":28,"column":37}},"15":{"start":{"line":31,"column":8},"end":{"line":31,"column":55}},"16":{"start":{"line":33,"column":8},"end":{"line":42,"column":11}},"17":{"start":{"line":34,"column":12},"end":{"line":34,"column":62}},"18":{"start":{"line":38,"column":12},"end":{"line":38,"column":74}},"19":{"start":{"line":41,"column":12},"end":{"line":41,"column":39}},"20":{"start":{"line":47,"column":0},"end":{"line":47,"column":27}}},"branchMap":{"1":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":8},"end":{"line":22,"column":8}},{"start":{"line":22,"column":8},"end":{"line":22,"column":8}}]}},"code":["var crc = require('crc');","var path = require('path');","","var imagesUtil = require('../../utils/images');","var fs = require('../../utils/fs');","var LocationUtils = require('../../utils/location');","","var editHTMLElement = require('./editHTMLElement');","","/**","    Convert all inline PNG images to PNG file","","    @param {String} rootFolder","    @param {HTMLDom} $","    @return {Promise}","*/","function inlinePng(rootFolder, currentFile, $) {","    var currentDirectory = path.dirname(currentFile);","","    return editHTMLElement($, 'img', function($img) {","        var src = $img.attr('src');","        if (!LocationUtils.isDataURI(src)) {","            return;","        }","","        // We avoid generating twice the same PNG","        var hash = crc.crc32(src).toString(16);","        var fileName = hash + '.png';","","        // Result file path","        var filePath = path.join(rootFolder, fileName);","","        return fs.assertFile(filePath, function() {","            return imagesUtil.convertInlinePNG(src, filePath);","        })","        .then(function() {","            // Convert filename to a relative filename","            fileName = LocationUtils.relative(currentDirectory, fileName);","","            // Replace src","            $img.attr('src', fileName);","        });","    });","}","","","module.exports = inlinePng;",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"8":1,"17":1,"18":0,"20":0,"21":0,"22":0,"23":0,"27":0,"28":0,"31":0,"33":0,"34":0,"38":0,"41":0,"47":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/resolveImages.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/resolveImages.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"resolveImages","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":39}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":37},"end":{"line":16,"column":52}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":52}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":51}},"4":{"start":{"line":13,"column":0},"end":{"line":31,"column":1}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":53}},"6":{"start":{"line":16,"column":4},"end":{"line":30,"column":7}},"7":{"start":{"line":17,"column":8},"end":{"line":17,"column":35}},"8":{"start":{"line":19,"column":8},"end":{"line":21,"column":9}},"9":{"start":{"line":20,"column":12},"end":{"line":20,"column":19}},"10":{"start":{"line":24,"column":8},"end":{"line":24,"column":67}},"11":{"start":{"line":27,"column":8},"end":{"line":27,"column":60}},"12":{"start":{"line":29,"column":8},"end":{"line":29,"column":30}},"13":{"start":{"line":33,"column":0},"end":{"line":33,"column":31}}},"branchMap":{"1":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":8}},{"start":{"line":19,"column":8},"end":{"line":19,"column":8}}]},"2":{"line":19,"type":"binary-expr","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":41}},{"start":{"line":19,"column":45},"end":{"line":19,"column":73}}]}},"code":["var path = require('path');","","var LocationUtils = require('../../utils/location');","var editHTMLElement = require('./editHTMLElement');","","/**","    Resolve all HTML images:","        - /test.png in hello -> ../test.html","","    @param {String} currentFile","    @param {HTMLDom} $","*/","function resolveImages(currentFile, $) {","    var currentDirectory = path.dirname(currentFile);","","    return editHTMLElement($, 'img', function($img) {","        var src = $img.attr('src');","","        if (LocationUtils.isExternal(src) || LocationUtils.isDataURI(src)) {","            return;","        }","","        // Calcul absolute path for this","        src = LocationUtils.toAbsolute(src, currentDirectory, '.');","","        // Convert back to relative","        src = LocationUtils.relative(currentDirectory, src);","","        $img.attr('src', src);","    });","}","","module.exports = resolveImages;",""],"l":{"1":1,"3":1,"4":1,"13":1,"14":0,"16":0,"17":0,"19":0,"20":0,"24":0,"27":0,"29":0,"33":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/fetchRemoteImages.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/fetchRemoteImages.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"fetchRemoteImages","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":55}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":37},"end":{"line":19,"column":52}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":39},"end":{"line":32,"column":50}}},"4":{"name":"(anonymous_4)","line":35,"loc":{"start":{"line":35,"column":14},"end":{"line":35,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":25}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":51}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":35}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":52}},"6":{"start":{"line":16,"column":0},"end":{"line":42,"column":1}},"7":{"start":{"line":17,"column":4},"end":{"line":17,"column":53}},"8":{"start":{"line":19,"column":4},"end":{"line":41,"column":7}},"9":{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},"10":{"start":{"line":21,"column":8},"end":{"line":21,"column":42}},"11":{"start":{"line":23,"column":8},"end":{"line":25,"column":9}},"12":{"start":{"line":24,"column":12},"end":{"line":24,"column":19}},"13":{"start":{"line":28,"column":8},"end":{"line":28,"column":47}},"14":{"start":{"line":29,"column":8},"end":{"line":29,"column":40}},"15":{"start":{"line":30,"column":8},"end":{"line":30,"column":55}},"16":{"start":{"line":32,"column":8},"end":{"line":40,"column":11}},"17":{"start":{"line":33,"column":12},"end":{"line":33,"column":46}},"18":{"start":{"line":37,"column":12},"end":{"line":37,"column":69}},"19":{"start":{"line":39,"column":12},"end":{"line":39,"column":58}},"20":{"start":{"line":44,"column":0},"end":{"line":44,"column":35}}},"branchMap":{"1":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":23,"column":8}},{"start":{"line":23,"column":8},"end":{"line":23,"column":8}}]}},"code":["var path = require('path');","var crc = require('crc');","","var editHTMLElement = require('./editHTMLElement');","var fs = require('../../utils/fs');","var LocationUtils = require('../../utils/location');","","/**","    Fetch all remote images","","    @param {String} rootFolder","    @param {String} currentFile","    @param {HTMLDom} $","    @return {Promise}","*/","function fetchRemoteImages(rootFolder, currentFile, $) {","    var currentDirectory = path.dirname(currentFile);","","    return editHTMLElement($, 'img', function($img) {","        var src = $img.attr('src');","        var extension = path.extname(src);","","        if (!LocationUtils.isExternal(src)) {","            return;","        }","","        // We avoid generating twice the same PNG","        var hash = crc.crc32(src).toString(16);","        var fileName = hash + extension;","        var filePath = path.join(rootFolder, fileName);","","        return fs.assertFile(filePath, function() {","            return fs.download(src, filePath);","        })","        .then(function() {","            // Convert to relative","            src = LocationUtils.relative(currentDirectory, fileName);","","            $img.replaceWith('<img src=\"' + src + '\" />');","        });","    });","}","","module.exports = fetchRemoteImages;",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"16":1,"17":0,"19":0,"20":0,"21":0,"23":0,"24":0,"28":0,"29":0,"30":0,"32":0,"33":0,"37":0,"39":0,"44":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/addHeadingId.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/addHeadingId.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":1,"8":0,"9":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"addId","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":24}}},"2":{"name":"addHeadingId","line":19,"loc":{"start":{"line":19,"column":0},"end":{"line":19,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":36}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":51}},"3":{"start":{"line":9,"column":0},"end":{"line":12,"column":1}},"4":{"start":{"line":10,"column":4},"end":{"line":10,"column":35}},"5":{"start":{"line":10,"column":28},"end":{"line":10,"column":35}},"6":{"start":{"line":11,"column":4},"end":{"line":11,"column":45}},"7":{"start":{"line":19,"column":0},"end":{"line":21,"column":1}},"8":{"start":{"line":20,"column":4},"end":{"line":20,"column":58}},"9":{"start":{"line":23,"column":0},"end":{"line":23,"column":30}}},"branchMap":{"1":{"line":10,"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":4}},{"start":{"line":10,"column":4},"end":{"line":10,"column":4}}]}},"code":["var slug = require('github-slugid');","var editHTMLElement = require('./editHTMLElement');","","/**","    Add ID to an heading","","    @param {HTMLElement} heading","*/","function addId(heading) {","    if (heading.attr('id')) return;","    heading.attr('id', slug(heading.text()));","}","","/**","    Add ID to all headings","","    @param {HTMLDom} $","*/","function addHeadingId($) {","    return editHTMLElement($, 'h1,h2,h3,h4,h5,h6', addId);","}","","module.exports = addHeadingId;",""],"l":{"1":1,"2":1,"9":1,"10":0,"11":0,"19":1,"20":0,"23":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/resolveLinks.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/resolveLinks.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"resolveLinks","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":51}}},"2":{"name":"(anonymous_2)","line":18,"loc":{"start":{"line":18,"column":35},"end":{"line":18,"column":48}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":25}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":51}},"5":{"start":{"line":15,"column":0},"end":{"line":51,"column":1}},"6":{"start":{"line":16,"column":4},"end":{"line":16,"column":53}},"7":{"start":{"line":18,"column":4},"end":{"line":50,"column":7}},"8":{"start":{"line":19,"column":8},"end":{"line":19,"column":35}},"9":{"start":{"line":22,"column":8},"end":{"line":24,"column":9}},"10":{"start":{"line":23,"column":12},"end":{"line":23,"column":19}},"11":{"start":{"line":26,"column":8},"end":{"line":29,"column":9}},"12":{"start":{"line":27,"column":12},"end":{"line":27,"column":40}},"13":{"start":{"line":28,"column":12},"end":{"line":28,"column":19}},"14":{"start":{"line":32,"column":8},"end":{"line":32,"column":37}},"15":{"start":{"line":33,"column":8},"end":{"line":33,"column":37}},"16":{"start":{"line":35,"column":8},"end":{"line":44,"column":9}},"17":{"start":{"line":37,"column":12},"end":{"line":37,"column":73}},"18":{"start":{"line":40,"column":12},"end":{"line":40,"column":37}},"19":{"start":{"line":43,"column":12},"end":{"line":43,"column":66}},"20":{"start":{"line":47,"column":8},"end":{"line":47,"column":42}},"21":{"start":{"line":49,"column":8},"end":{"line":49,"column":30}},"22":{"start":{"line":53,"column":0},"end":{"line":53,"column":30}}},"branchMap":{"1":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":8},"end":{"line":22,"column":8}},{"start":{"line":22,"column":8},"end":{"line":22,"column":8}}]},"2":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":8},"end":{"line":26,"column":8}},{"start":{"line":26,"column":8},"end":{"line":26,"column":8}}]},"3":{"line":33,"type":"binary-expr","locations":[{"start":{"line":33,"column":15},"end":{"line":33,"column":30}},{"start":{"line":33,"column":34},"end":{"line":33,"column":36}}]},"4":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":8}},{"start":{"line":35,"column":8},"end":{"line":35,"column":8}}]},"5":{"line":47,"type":"binary-expr","locations":[{"start":{"line":47,"column":23},"end":{"line":47,"column":34}},{"start":{"line":47,"column":38},"end":{"line":47,"column":40}}]}},"code":["var path = require('path');","var url = require('url');","","var LocationUtils = require('../../utils/location');","var editHTMLElement = require('./editHTMLElement');","","/**","    Resolve all HTML links:","        - /test.md in hello -> ../test.html","","    @param {String} currentFile","    @param {Function(String) -> String} resolveFile","    @param {HTMLDom} $","*/","function resolveLinks(currentFile, resolveFile, $) {","    var currentDirectory = path.dirname(currentFile);","","    return editHTMLElement($, 'a', function($a) {","        var href = $a.attr('href');","","        // Don't change a tag without href","        if (!href) {","            return;","        }","","        if (LocationUtils.isExternal(href)) {","            $a.attr('target', '_blank');","            return;","        }","","        // Split anchor","        var parsed = url.parse(href);","        href = parsed.pathname || '';","","        if (href) {","            // Calcul absolute path for this","            href = LocationUtils.toAbsolute(href, currentDirectory, '.');","","            // Resolve file","            href = resolveFile(href);","","            // Convert back to relative","            href = LocationUtils.relative(currentDirectory, href);","        }","","        // Add back anchor","        href = href + (parsed.hash || '');","","        $a.attr('href', href);","    });","}","","module.exports = resolveLinks;",""],"l":{"1":1,"2":1,"4":1,"5":1,"15":1,"16":0,"18":0,"19":0,"22":0,"23":0,"26":0,"27":0,"28":0,"32":0,"33":0,"35":0,"37":0,"40":0,"43":0,"47":0,"49":0,"53":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/annotateText.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/annotateText.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"pregQuote","line":6,"loc":{"start":{"line":6,"column":0},"end":{"line":6,"column":26}}},"2":{"name":"replaceText","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":57}}},"3":{"name":"(anonymous_3)","line":11,"loc":{"start":{"line":11,"column":22},"end":{"line":11,"column":32}}},"4":{"name":"annotateText","line":68,"loc":{"start":{"line":68,"column":0},"end":{"line":68,"column":52}}},"5":{"name":"(anonymous_5)","line":69,"loc":{"start":{"line":69,"column":20},"end":{"line":69,"column":36}}},"6":{"name":"(anonymous_6)","line":75,"loc":{"start":{"line":75,"column":20},"end":{"line":75,"column":31}}},"7":{"name":"(anonymous_7)","line":83,"loc":{"start":{"line":83,"column":46},"end":{"line":83,"column":62}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":36}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":75}},"3":{"start":{"line":6,"column":0},"end":{"line":8,"column":1}},"4":{"start":{"line":7,"column":4},"end":{"line":7,"column":83}},"5":{"start":{"line":10,"column":0},"end":{"line":59,"column":1}},"6":{"start":{"line":11,"column":4},"end":{"line":58,"column":7}},"7":{"start":{"line":12,"column":8},"end":{"line":17,"column":24}},"8":{"start":{"line":20,"column":8},"end":{"line":54,"column":9}},"9":{"start":{"line":23,"column":12},"end":{"line":53,"column":13}},"10":{"start":{"line":26,"column":16},"end":{"line":50,"column":17}},"11":{"start":{"line":29,"column":20},"end":{"line":29,"column":41}},"12":{"start":{"line":32,"column":20},"end":{"line":32,"column":61}},"13":{"start":{"line":35,"column":20},"end":{"line":49,"column":21}},"14":{"start":{"line":37,"column":24},"end":{"line":48,"column":25}},"15":{"start":{"line":40,"column":28},"end":{"line":40,"column":54}},"16":{"start":{"line":43,"column":28},"end":{"line":43,"column":48}},"17":{"start":{"line":47,"column":28},"end":{"line":47,"column":53}},"18":{"start":{"line":52,"column":16},"end":{"line":52,"column":40}},"19":{"start":{"line":57,"column":8},"end":{"line":57,"column":46}},"20":{"start":{"line":57,"column":27},"end":{"line":57,"column":46}},"21":{"start":{"line":68,"column":0},"end":{"line":92,"column":1}},"22":{"start":{"line":69,"column":4},"end":{"line":91,"column":7}},"23":{"start":{"line":70,"column":8},"end":{"line":70,"column":40}},"24":{"start":{"line":71,"column":8},"end":{"line":71,"column":42}},"25":{"start":{"line":72,"column":8},"end":{"line":72,"column":49}},"26":{"start":{"line":73,"column":8},"end":{"line":73,"column":95}},"27":{"start":{"line":75,"column":8},"end":{"line":89,"column":11}},"28":{"start":{"line":76,"column":12},"end":{"line":76,"column":32}},"29":{"start":{"line":78,"column":12},"end":{"line":81,"column":21}},"30":{"start":{"line":81,"column":14},"end":{"line":81,"column":21}},"31":{"start":{"line":83,"column":12},"end":{"line":88,"column":15}},"32":{"start":{"line":84,"column":16},"end":{"line":87,"column":29}},"33":{"start":{"line":94,"column":0},"end":{"line":94,"column":30}}},"branchMap":{"1":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":8}},{"start":{"line":20,"column":8},"end":{"line":20,"column":8}}]},"2":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":16},"end":{"line":26,"column":16}},{"start":{"line":26,"column":16},"end":{"line":26,"column":16}}]},"3":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":20},"end":{"line":35,"column":20}},{"start":{"line":35,"column":20},"end":{"line":35,"column":20}}]},"4":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":24},"end":{"line":37,"column":24}},{"start":{"line":37,"column":24},"end":{"line":37,"column":24}}]},"5":{"line":37,"type":"binary-expr","locations":[{"start":{"line":37,"column":29},"end":{"line":37,"column":39}},{"start":{"line":37,"column":43},"end":{"line":37,"column":62}}]},"6":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":8},"end":{"line":57,"column":8}},{"start":{"line":57,"column":8},"end":{"line":57,"column":8}}]},"7":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":12},"end":{"line":78,"column":12}},{"start":{"line":78,"column":12},"end":{"line":78,"column":12}}]},"8":{"line":79,"type":"binary-expr","locations":[{"start":{"line":79,"column":16},"end":{"line":79,"column":43}},{"start":{"line":80,"column":16},"end":{"line":80,"column":59}}]}},"code":["var escape = require('escape-html');","","// Selector to ignore","var ANNOTATION_IGNORE = '.no-glossary,code,pre,a,script,h1,h2,h3,h4,h5,h6';","","function pregQuote( str ) {","    return (str+'').replace(/([\\\\\\.\\+\\*\\?\\[\\^\\]\\$\\(\\)\\{\\}\\=\\!\\<\\>\\|\\:])/g, '\\\\$1');","}","","function replaceText($, el, search, replace, text_only ) {","    return $(el).each(function(){","        var node = this.firstChild,","            val,","            new_val,","","            // Elements to be removed at the end.","            remove = [];","","        // Only continue if firstChild exists.","        if ( node ) {","","            // Loop over all childNodes.","            while (node) {","","                // Only process text nodes.","                if ( node.nodeType === 3 ) {","","                    // The original node value.","                    val = node.nodeValue;","","                    // The new value.","                    new_val = val.replace( search, replace );","","                    // Only replace text if the new value is actually different!","                    if ( new_val !== val ) {","","                        if ( !text_only && /</.test( new_val ) ) {","                            // The new value contains HTML, set it in a slower but far more","                            // robust way.","                            $(node).before( new_val );","","                            // Don't remove the node yet, or the loop will lose its place.","                            remove.push( node );","                        } else {","                            // The new value contains no HTML, so it can be set in this","                            // very fast, simple way.","                            node.nodeValue = new_val;","                        }","                    }","                }","","                node = node.nextSibling;","            }","        }","","        // Time to remove those elements!","        if (remove.length) $(remove).remove();","    });","}","","/**"," * Annotate text using a list of GlossaryEntry"," *"," * @param {List<GlossaryEntry>}"," * @param {String} glossaryFilePath"," * @param {HTMLDom} $"," */","function annotateText(entries, glossaryFilePath, $) {","    entries.forEach(function(entry) {","        var entryId     = entry.getID();","        var name        = entry.getName();","        var description = entry.getDescription();","        var searchRegex = new RegExp( '\\\\b(' + pregQuote(name.toLowerCase()) + ')\\\\b' , 'gi' );","","        $('*').each(function() {","            var $this = $(this);","","            if (","                $this.is(ANNOTATION_IGNORE) ||","                $this.parents(ANNOTATION_IGNORE).length > 0","            ) return;","","            replaceText($, this, searchRegex, function(match) {","                return '<a href=\"/' + glossaryFilePath + '#' + entryId + '\" '","                    + 'class=\"glossary-term\" title=\"' + escape(description) + '\">'","                    + match","                    + '</a>';","            });","        });","","    });","}","","module.exports = annotateText;",""],"l":{"1":1,"4":1,"6":1,"7":0,"10":1,"11":0,"12":0,"20":0,"23":0,"26":0,"29":0,"32":0,"35":0,"37":0,"40":0,"43":0,"47":0,"52":0,"57":0,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"75":0,"76":0,"78":0,"81":0,"83":0,"84":0,"94":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/highlightCode.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/modifiers/highlightCode.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"getLanguageForClass","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":41}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":13},"end":{"line":15,"column":26}}},"3":{"name":"(anonymous_3)","line":28,"loc":{"start":{"line":28,"column":14},"end":{"line":28,"column":27}}},"4":{"name":"highlightCode","line":41,"loc":{"start":{"line":41,"column":0},"end":{"line":41,"column":37}}},"5":{"name":"(anonymous_5)","line":42,"loc":{"start":{"line":42,"column":38},"end":{"line":42,"column":54}}},"6":{"name":"(anonymous_6)","line":48,"loc":{"start":{"line":48,"column":14},"end":{"line":48,"column":26}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":45}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":51}},"5":{"start":{"line":13,"column":0},"end":{"line":31,"column":1}},"6":{"start":{"line":14,"column":4},"end":{"line":30,"column":11}},"7":{"start":{"line":17,"column":12},"end":{"line":19,"column":13}},"8":{"start":{"line":18,"column":16},"end":{"line":18,"column":48}},"9":{"start":{"line":22,"column":12},"end":{"line":24,"column":13}},"10":{"start":{"line":23,"column":16},"end":{"line":23,"column":52}},"11":{"start":{"line":26,"column":12},"end":{"line":26,"column":24}},"12":{"start":{"line":29,"column":12},"end":{"line":29,"column":31}},"13":{"start":{"line":41,"column":0},"end":{"line":56,"column":1}},"14":{"start":{"line":42,"column":4},"end":{"line":55,"column":7}},"15":{"start":{"line":43,"column":8},"end":{"line":43,"column":64}},"16":{"start":{"line":44,"column":8},"end":{"line":44,"column":51}},"17":{"start":{"line":45,"column":8},"end":{"line":45,"column":34}},"18":{"start":{"line":47,"column":8},"end":{"line":54,"column":11}},"19":{"start":{"line":49,"column":12},"end":{"line":53,"column":13}},"20":{"start":{"line":50,"column":16},"end":{"line":50,"column":35}},"21":{"start":{"line":52,"column":16},"end":{"line":52,"column":35}},"22":{"start":{"line":58,"column":0},"end":{"line":58,"column":31}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":12},"end":{"line":17,"column":12}},{"start":{"line":17,"column":12},"end":{"line":17,"column":12}}]},"2":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":12},"end":{"line":22,"column":12}},{"start":{"line":22,"column":12},"end":{"line":22,"column":12}}]},"3":{"line":43,"type":"binary-expr","locations":[{"start":{"line":43,"column":26},"end":{"line":43,"column":45}},{"start":{"line":43,"column":49},"end":{"line":43,"column":51}}]},"4":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":12},"end":{"line":49,"column":12}},{"start":{"line":49,"column":12},"end":{"line":49,"column":12}}]}},"code":["var is = require('is');","var Immutable = require('immutable');","","var Promise = require('../../utils/promise');","var editHTMLElement = require('./editHTMLElement');","","/**","    Return language for a code blocks from a list of class names","","    @param {Array<String>}","    @return {String}","*/","function getLanguageForClass(classNames) {","    return Immutable.List(classNames)","        .map(function(cl) {","            // Markdown","            if (cl.search('lang-') === 0) {","                return cl.slice('lang-'.length);","            }","","            // Asciidoc","            if (cl.search('language-') === 0) {","                return cl.slice('language-'.length);","            }","","            return null;","        })","        .find(function(cl) {","            return Boolean(cl);","        });","}","","","/**","    Highlight all code elements","","    @param {Function(lang, body) -> String} highlight","    @param {HTMLDom} $","    @return {Promise}","*/","function highlightCode(highlight, $) {","    return editHTMLElement($, 'code', function($code) {","        var classNames = ($code.attr('class') || '').split(' ');","        var lang = getLanguageForClass(classNames);","        var source = $code.text();","","        return Promise(highlight(lang, source))","        .then(function(r) {","            if (is.string(r.html)) {","                $code.html(r.html);","            } else {","                $code.text(r.text);","            }","        });","    });","}","","module.exports = highlightCode;",""],"l":{"1":1,"2":1,"4":1,"5":1,"13":1,"14":0,"17":0,"18":0,"22":0,"23":0,"26":0,"29":0,"41":1,"42":0,"43":0,"44":0,"45":0,"47":0,"49":0,"50":0,"52":0,"58":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/helper/writeFile.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/helper/writeFile.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"writeFile","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":46}}},"2":{"name":"(anonymous_2)","line":17,"loc":{"start":{"line":17,"column":10},"end":{"line":17,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":12,"column":0},"end":{"line":21,"column":1}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":38}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":47}},"6":{"start":{"line":16,"column":4},"end":{"line":20,"column":25}},"7":{"start":{"line":18,"column":8},"end":{"line":18,"column":47}},"8":{"start":{"line":23,"column":0},"end":{"line":23,"column":27}}},"branchMap":{},"code":["var path = require('path');","var fs = require('../../utils/fs');","","/**","    Write a file to the output folder","","    @param {Output} output","    @param {String} filePath","    @param {Buffer|String} content","    @return {Promise}","*/","function writeFile(output, filePath, content) {","    var rootFolder = output.getRoot();","    filePath = path.join(rootFolder, filePath);","","    return fs.ensureFile(filePath)","    .then(function() {","        return fs.writeFile(filePath, content);","    })","    .thenResolve(output);","}","","module.exports = writeFile;",""],"l":{"1":1,"2":1,"12":1,"13":0,"14":0,"16":0,"18":0,"23":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/getModifiers.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/getModifiers.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"getModifiers","line":17,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":36}}},"2":{"name":"(anonymous_2)","line":55,"loc":{"start":{"line":55,"column":43},"end":{"line":55,"column":66}}},"3":{"name":"(anonymous_3)","line":62,"loc":{"start":{"line":62,"column":18},"end":{"line":62,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":39}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":60}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":28}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":36}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":42}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":58}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":52}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":23}},"9":{"start":{"line":17,"column":0},"end":{"line":71,"column":1}},"10":{"start":{"line":18,"column":4},"end":{"line":18,"column":32}},"11":{"start":{"line":19,"column":4},"end":{"line":19,"column":38}},"12":{"start":{"line":20,"column":4},"end":{"line":20,"column":38}},"13":{"start":{"line":21,"column":4},"end":{"line":21,"column":30}},"14":{"start":{"line":24,"column":4},"end":{"line":24,"column":40}},"15":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"16":{"start":{"line":26,"column":4},"end":{"line":26,"column":72}},"17":{"start":{"line":29,"column":4},"end":{"line":29,"column":41}},"18":{"start":{"line":32,"column":4},"end":{"line":32,"column":45}},"19":{"start":{"line":33,"column":4},"end":{"line":33,"column":69}},"20":{"start":{"line":36,"column":4},"end":{"line":36,"column":43}},"21":{"start":{"line":38,"column":4},"end":{"line":70,"column":6}},"22":{"start":{"line":56,"column":12},"end":{"line":68,"column":15}},"23":{"start":{"line":63,"column":16},"end":{"line":67,"column":17}},"24":{"start":{"line":64,"column":20},"end":{"line":64,"column":49}},"25":{"start":{"line":66,"column":20},"end":{"line":66,"column":49}},"26":{"start":{"line":73,"column":0},"end":{"line":73,"column":30}}},"branchMap":{"1":{"line":33,"type":"binary-expr","locations":[{"start":{"line":33,"column":15},"end":{"line":33,"column":36}},{"start":{"line":33,"column":40},"end":{"line":33,"column":68}}]},"2":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":16},"end":{"line":63,"column":16}},{"start":{"line":63,"column":16},"end":{"line":63,"column":16}}]}},"code":["var Modifiers = require('./modifiers');","var resolveFileToURL = require('./helper/resolveFileToURL');","var Api = require('../api');","var Plugins = require('../plugins');","var Promise = require('../utils/promise');","var defaultBlocks = require('../constants/defaultBlocks');","var fileToOutput = require('./helper/fileToOutput');","","var CODEBLOCK = 'code';","","/**"," * Return default modifier to prepare a page for"," * rendering."," *"," * @return {Array<Modifier>}"," */","function getModifiers(output, page) {","    var book = output.getBook();","    var plugins = output.getPlugins();","    var glossary = book.getGlossary();","    var file = page.getFile();","","    // Glossary entries","    var entries = glossary.getEntries();","    var glossaryFile = glossary.getFile();","    var glossaryFilename = fileToOutput(output, glossaryFile.getPath());","","    // Current file path","    var currentFilePath = file.getPath();","","    // Get TemplateBlock for highlighting","    var blocks = Plugins.listBlocks(plugins);","    var code = blocks.get(CODEBLOCK) || defaultBlocks.get(CODEBLOCK);","","    // Current context","    var context = Api.encodeGlobal(output);","","    return [","        // Normalize IDs on headings","        Modifiers.addHeadingId,","","        // Annotate text with glossary entries","        Modifiers.annotateText.bind(null, entries, glossaryFilename),","","        // Resolve images","        Modifiers.resolveImages.bind(null, currentFilePath),","","        // Resolve links (.md -> .html)","        Modifiers.resolveLinks.bind(null,","            currentFilePath,","            resolveFileToURL.bind(null, output)","        ),","","        // Highlight code blocks using \"code\" block","        Modifiers.highlightCode.bind(null, function(lang, source) {","            return Promise(code.applyBlock({","                body: source,","                kwargs: {","                    language: lang","                }","            }, context))","            .then(function(result) {","                if (result.html === false) {","                    return { text: result.body };","                } else {","                    return { html: result.body };","                }","            });","        })","    ];","}","","module.exports = getModifiers;",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"9":1,"17":1,"18":0,"19":0,"20":0,"21":0,"24":0,"25":0,"26":0,"29":0,"32":0,"33":0,"36":0,"38":0,"56":0,"63":0,"64":0,"66":0,"73":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/helper/resolveFileToURL.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/helper/resolveFileToURL.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"resolveFileToURL","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":44}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":52}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":39}},"3":{"start":{"line":12,"column":0},"end":{"line":24,"column":1}},"4":{"start":{"line":14,"column":4},"end":{"line":14,"column":58}},"5":{"start":{"line":16,"column":4},"end":{"line":16,"column":40}},"6":{"start":{"line":19,"column":4},"end":{"line":21,"column":5}},"7":{"start":{"line":20,"column":8},"end":{"line":20,"column":47}},"8":{"start":{"line":23,"column":4},"end":{"line":23,"column":45}},"9":{"start":{"line":26,"column":0},"end":{"line":26,"column":34}}},"branchMap":{"1":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":4}},{"start":{"line":19,"column":4},"end":{"line":19,"column":4}}]}},"code":["var LocationUtils = require('../../utils/location');","","var fileToURL = require('./fileToURL');","","/**"," * Resolve an absolute path (extracted from a link)"," *"," * @param {Output} output"," * @param {String} filePath"," * @return {String}"," */","function resolveFileToURL(output, filePath) {","    // Convert /test.png -> test.png","    filePath = LocationUtils.toAbsolute(filePath, '', '');","","    var page = output.getPage(filePath);","","    // if file is a page, return correct .html url","    if (page) {","        filePath = fileToURL(output, filePath);","    }","","    return LocationUtils.normalize(filePath);","}","","module.exports = resolveFileToURL;",""],"l":{"1":1,"3":1,"12":1,"14":0,"16":0,"19":0,"20":0,"23":0,"26":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/helper/fileToURL.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/helper/fileToURL.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"fileToURL","line":18,"loc":{"start":{"line":18,"column":0},"end":{"line":18,"column":37}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":52}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":45}},"4":{"start":{"line":18,"column":0},"end":{"line":29,"column":1}},"5":{"start":{"line":19,"column":4},"end":{"line":19,"column":38}},"6":{"start":{"line":20,"column":4},"end":{"line":20,"column":55}},"7":{"start":{"line":22,"column":4},"end":{"line":22,"column":46}},"8":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"9":{"start":{"line":25,"column":8},"end":{"line":25,"column":48}},"10":{"start":{"line":28,"column":4},"end":{"line":28,"column":45}},"11":{"start":{"line":31,"column":0},"end":{"line":31,"column":27}}},"branchMap":{"1":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":4}},{"start":{"line":24,"column":4},"end":{"line":24,"column":4}}]},"2":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":8},"end":{"line":24,"column":22}},{"start":{"line":24,"column":26},"end":{"line":24,"column":65}}]}},"code":["var path = require('path');","var LocationUtils = require('../../utils/location');","","var fileToOutput = require('./fileToOutput');","","/**","    Convert a filePath (absolute) to an url (without hostname).","    It returns an absolute path.","","    \"README.md\" -> \"/\"","    \"test/hello.md\" -> \"test/hello.html\"","    \"test/README.md\" -> \"test/\"","","    @param {Output} output","    @param {String} filePath","    @return {String}","*/","function fileToURL(output, filePath) {","    var options = output.getOptions();","    var directoryIndex = options.get('directoryIndex');","","    filePath = fileToOutput(output, filePath);","","    if (directoryIndex && path.basename(filePath) == 'index.html') {","        filePath = path.dirname(filePath) + '/';","    }","","    return LocationUtils.normalize(filePath);","}","","module.exports = fileToURL;",""],"l":{"1":1,"2":1,"4":1,"18":1,"19":0,"20":0,"22":0,"24":0,"25":0,"28":0,"31":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/helper/fileToOutput.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/helper/fileToOutput.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1},"b":{"1":[0,0],"2":[0,0,0]},"f":{"1":0},"fnMap":{"1":{"name":"fileToOutput","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":40}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":44}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":52}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":31}},"5":{"start":{"line":15,"column":0},"end":{"line":30,"column":1}},"6":{"start":{"line":16,"column":4},"end":{"line":16,"column":32}},"7":{"start":{"line":17,"column":4},"end":{"line":17,"column":34}},"8":{"start":{"line":18,"column":4},"end":{"line":18,"column":38}},"9":{"start":{"line":20,"column":4},"end":{"line":27,"column":5}},"10":{"start":{"line":24,"column":8},"end":{"line":24,"column":81}},"11":{"start":{"line":26,"column":8},"end":{"line":26,"column":70}},"12":{"start":{"line":29,"column":4},"end":{"line":29,"column":45}},"13":{"start":{"line":32,"column":0},"end":{"line":32,"column":30}}},"branchMap":{"1":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":20,"column":4}},{"start":{"line":20,"column":4},"end":{"line":20,"column":4}}]},"2":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":8},"end":{"line":21,"column":67}},{"start":{"line":22,"column":9},"end":{"line":22,"column":28}},{"start":{"line":22,"column":32},"end":{"line":22,"column":64}}]}},"code":["var path = require('path');","","var PathUtils = require('../../utils/path');","var LocationUtils = require('../../utils/location');","","var OUTPUT_EXTENSION = '.html';","","/**"," * Convert a filePath (absolute) to a filename for output"," *"," * @param {Output} output"," * @param {String} filePath"," * @return {String}"," */","function fileToOutput(output, filePath) {","    var book = output.getBook();","    var readme = book.getReadme();","    var fileReadme = readme.getFile();","","    if (","        path.basename(filePath, path.extname(filePath)) == 'README' ||","        (fileReadme.exists() && filePath == fileReadme.getPath())","    ) {","        filePath = path.join(path.dirname(filePath), 'index' + OUTPUT_EXTENSION);","    } else {","        filePath = PathUtils.setExtension(filePath, OUTPUT_EXTENSION);","    }","","    return LocationUtils.normalize(filePath);","}","","module.exports = fileToOutput;",""],"l":{"1":1,"3":1,"4":1,"6":1,"15":1,"16":0,"17":0,"18":0,"20":0,"24":0,"26":0,"29":0,"32":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":8,"column":2}}},"branchMap":{},"code":["","module.exports = {","    encodePage:         require('./encodePage'),","    decodePage:         require('./decodePage'),","","    encodeGlobal:       require('./encodeGlobal'),","    decodeGlobal:       require('./decodeGlobal')","};",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodePage.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodePage.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"encodePage","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":34}}},"2":{"name":"(anonymous_2)","line":25,"loc":{"start":{"line":25,"column":65},"end":{"line":25,"column":76}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":35}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":39}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":49}},"4":{"start":{"line":12,"column":0},"end":{"line":37,"column":1}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":32}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":36}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":33}},"8":{"start":{"line":16,"column":4},"end":{"line":16,"column":30}},"9":{"start":{"line":19,"column":4},"end":{"line":19,"column":53}},"10":{"start":{"line":21,"column":4},"end":{"line":21,"column":33}},"11":{"start":{"line":22,"column":4},"end":{"line":22,"column":33}},"12":{"start":{"line":23,"column":4},"end":{"line":23,"column":45}},"13":{"start":{"line":25,"column":4},"end":{"line":27,"column":49}},"14":{"start":{"line":26,"column":8},"end":{"line":26,"column":44}},"15":{"start":{"line":29,"column":4},"end":{"line":34,"column":70}},"16":{"start":{"line":36,"column":4},"end":{"line":36,"column":18}},"17":{"start":{"line":39,"column":0},"end":{"line":39,"column":28}}},"branchMap":{},"code":["var JSONUtils = require('../json');","var deprecate = require('./deprecate');","var encodeProgress = require('./encodeProgress');","","/**","    Encode a page in a context to a JS API","","    @param {Output} output","    @param {Page} page","    @return {Object}","*/","function encodePage(output, page) {","    var book = output.getBook();","    var summary = book.getSummary();","    var fs = book.getContentFS();","    var file = page.getFile();","","    // JS Page is based on the JSON output","    var result = JSONUtils.encodePage(page, summary);","","    result.type = file.getType();","    result.path = file.getPath();","    result.rawPath = fs.resolve(result.path);","","    deprecate.field(output, 'page.progress', result, 'progress', function() {","        return encodeProgress(output, page);","    }, '\"page.progress\" property is deprecated');","","    deprecate.field(output, 'page.sections', result, 'sections', [","        {","            content: result.content,","            type: 'normal'","        }","    ], '\"sections\" property is deprecated, use page.content instead');","","    return result;","}","","module.exports = encodePage;",""],"l":{"1":1,"2":1,"3":1,"12":1,"13":0,"14":0,"15":0,"16":0,"19":0,"21":0,"22":0,"23":0,"25":0,"26":0,"29":0,"36":0,"39":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/deprecate.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/deprecate.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":1,"34":0,"35":1,"36":0,"37":1,"38":0,"39":0,"40":0,"41":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"logNotice","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":39}}},"2":{"name":"deprecateMethod","line":32,"loc":{"start":{"line":32,"column":0},"end":{"line":32,"column":45}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":11},"end":{"line":33,"column":22}}},"4":{"name":"deprecateField","line":50,"loc":{"start":{"line":50,"column":0},"end":{"line":50,"column":67}}},"5":{"name":"(anonymous_5)","line":53,"loc":{"start":{"line":53,"column":18},"end":{"line":53,"column":29}}},"6":{"name":"(anonymous_6)","line":60,"loc":{"start":{"line":60,"column":17},"end":{"line":60,"column":27}}},"7":{"name":"(anonymous_7)","line":66,"loc":{"start":{"line":66,"column":17},"end":{"line":66,"column":29}}},"8":{"name":"enableDeprecation","line":87,"loc":{"start":{"line":87,"column":0},"end":{"line":87,"column":32}}},"9":{"name":"disableDeprecation","line":96,"loc":{"start":{"line":96,"column":0},"end":{"line":96,"column":33}}},"10":{"name":"deprecateRenamedMethod","line":109,"loc":{"start":{"line":109,"column":0},"end":{"line":109,"column":76}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":40}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":16}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":18}},"5":{"start":{"line":14,"column":0},"end":{"line":21,"column":1}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":45}},"7":{"start":{"line":15,"column":38},"end":{"line":15,"column":45}},"8":{"start":{"line":17,"column":4},"end":{"line":17,"column":23}},"9":{"start":{"line":19,"column":4},"end":{"line":19,"column":34}},"10":{"start":{"line":20,"column":4},"end":{"line":20,"column":28}},"11":{"start":{"line":32,"column":0},"end":{"line":38,"column":1}},"12":{"start":{"line":33,"column":4},"end":{"line":37,"column":6}},"13":{"start":{"line":34,"column":8},"end":{"line":34,"column":34}},"14":{"start":{"line":36,"column":8},"end":{"line":36,"column":41}},"15":{"start":{"line":50,"column":0},"end":{"line":80,"column":1}},"16":{"start":{"line":51,"column":4},"end":{"line":51,"column":26}},"17":{"start":{"line":53,"column":4},"end":{"line":58,"column":6}},"18":{"start":{"line":54,"column":8},"end":{"line":54,"column":41}},"19":{"start":{"line":54,"column":34},"end":{"line":54,"column":41}},"20":{"start":{"line":56,"column":8},"end":{"line":57,"column":27}},"21":{"start":{"line":56,"column":26},"end":{"line":56,"column":42}},"22":{"start":{"line":57,"column":13},"end":{"line":57,"column":27}},"23":{"start":{"line":60,"column":4},"end":{"line":65,"column":6}},"24":{"start":{"line":61,"column":8},"end":{"line":61,"column":18}},"25":{"start":{"line":63,"column":8},"end":{"line":63,"column":34}},"26":{"start":{"line":64,"column":8},"end":{"line":64,"column":21}},"27":{"start":{"line":66,"column":4},"end":{"line":72,"column":6}},"28":{"start":{"line":67,"column":8},"end":{"line":67,"column":18}},"29":{"start":{"line":69,"column":8},"end":{"line":69,"column":34}},"30":{"start":{"line":70,"column":8},"end":{"line":70,"column":18}},"31":{"start":{"line":71,"column":8},"end":{"line":71,"column":21}},"32":{"start":{"line":74,"column":4},"end":{"line":79,"column":7}},"33":{"start":{"line":87,"column":0},"end":{"line":89,"column":1}},"34":{"start":{"line":88,"column":4},"end":{"line":88,"column":26}},"35":{"start":{"line":96,"column":0},"end":{"line":98,"column":1}},"36":{"start":{"line":97,"column":4},"end":{"line":97,"column":25}},"37":{"start":{"line":109,"column":0},"end":{"line":114,"column":1}},"38":{"start":{"line":110,"column":4},"end":{"line":110,"column":86}},"39":{"start":{"line":111,"column":4},"end":{"line":111,"column":47}},"40":{"start":{"line":113,"column":4},"end":{"line":113,"column":60}},"41":{"start":{"line":116,"column":0},"end":{"line":122,"column":2}}},"branchMap":{"1":{"line":15,"type":"if","locations":[{"start":{"line":15,"column":4},"end":{"line":15,"column":4}},{"start":{"line":15,"column":4},"end":{"line":15,"column":4}}]},"2":{"line":15,"type":"binary-expr","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":19}},{"start":{"line":15,"column":23},"end":{"line":15,"column":36}}]},"3":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":8},"end":{"line":54,"column":8}},{"start":{"line":54,"column":8},"end":{"line":54,"column":8}}]},"4":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":8},"end":{"line":56,"column":8}},{"start":{"line":56,"column":8},"end":{"line":56,"column":8}}]},"5":{"line":110,"type":"binary-expr","locations":[{"start":{"line":110,"column":10},"end":{"line":110,"column":13}},{"start":{"line":110,"column":18},"end":{"line":110,"column":84}}]}},"code":["var is = require('is');","var objectPath = require('object-path');","","var logged = {};","var disabled = {};","","/**","    Log a deprecated notice","","    @param {Book|Output} book","    @param {String} key","    @param {String} message","*/","function logNotice(book, key, message) {","    if (logged[key] || disabled[key]) return;","","    logged[key] = true;","","    var logger = book.getLogger();","    logger.warn.ln(message);","}","","/**","    Deprecate a function","","    @param {Book|Output} book","    @param {String} key: unique identitifer for the deprecated","    @param {Function} fn","    @param {String} msg: message to print when called","    @return {Function}","*/","function deprecateMethod(book, key, fn, msg) {","    return function() {","        logNotice(book, key, msg);","","        return fn.apply(this, arguments);","    };","}","","/**","    Deprecate a property of an object","","    @param {Book|Output} book","    @param {String} key: unique identitifer for the deprecated","    @param {Object} instance","    @param {String|Function} property","    @param {String} msg: message to print when called","    @return {Function}","*/","function deprecateField(book, key, instance, property, value, msg) {","    var store = undefined;","","    var prepare = function() {","        if (!is.undefined(store)) return;","","        if (is.fn(value)) store = value();","        else store = value;","    };","","    var getter = function(){","        prepare();","","        logNotice(book, key, msg);","        return store;","    };","    var setter = function(v) {","        prepare();","","        logNotice(book, key, msg);","        store = v;","        return store;","    };","","    Object.defineProperty(instance, property, {","        get: getter,","        set: setter,","        enumerable: true,","        configurable: true","    });","}","","/**","    Enable a deprecation","","    @param {String} key: unique identitifer","*/","function enableDeprecation(key) {","    disabled[key] = false;","}","","/**","    Disable a deprecation","","    @param {String} key: unique identitifer","*/","function disableDeprecation(key) {","    disabled[key] = true;","}","","/**","    Deprecate a method in favor of another one","","    @param {Book} book","    @param {String} key","    @param {Object} instance","    @param {String} oldName","    @param {String} newName","*/","function deprecateRenamedMethod(book, key, instance, oldName, newName, msg) {","    msg = msg || ('\"' + oldName + '\" is deprecated, use \"' + newName + '()\" instead');","    var fn = objectPath.get(instance, newName);","","    instance[oldName] = deprecateMethod(book, key, fn, msg);","}","","module.exports = {","    method: deprecateMethod,","    renamedMethod: deprecateRenamedMethod,","    field: deprecateField,","    enable: enableDeprecation,","    disable: disableDeprecation","};",""],"l":{"1":1,"2":1,"4":1,"5":1,"14":1,"15":0,"17":0,"19":0,"20":0,"32":1,"33":0,"34":0,"36":0,"50":1,"51":0,"53":0,"54":0,"56":0,"57":0,"60":0,"61":0,"63":0,"64":0,"66":0,"67":0,"69":0,"70":0,"71":0,"74":0,"87":1,"88":0,"96":1,"97":0,"109":1,"110":0,"111":0,"113":0,"116":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodeProgress.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodeProgress.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"encodeProgress","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":38}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":13},"end":{"line":21,"column":40}}},"3":{"name":"(anonymous_3)","line":26,"loc":{"start":{"line":26,"column":16},"end":{"line":26,"column":30}}},"4":{"name":"(anonymous_4)","line":29,"loc":{"start":{"line":29,"column":13},"end":{"line":29,"column":30}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":53}},"3":{"start":{"line":11,"column":0},"end":{"line":60,"column":1}},"4":{"start":{"line":12,"column":4},"end":{"line":12,"column":33}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":46}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":43}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":28}},"8":{"start":{"line":17,"column":4},"end":{"line":17,"column":60}},"9":{"start":{"line":18,"column":4},"end":{"line":18,"column":20}},"10":{"start":{"line":20,"column":4},"end":{"line":45,"column":16}},"11":{"start":{"line":22,"column":12},"end":{"line":22,"column":35}},"12":{"start":{"line":23,"column":12},"end":{"line":23,"column":23}},"13":{"start":{"line":27,"column":12},"end":{"line":27,"column":29}},"14":{"start":{"line":31,"column":12},"end":{"line":31,"column":59}},"15":{"start":{"line":34,"column":12},"end":{"line":34,"column":28}},"16":{"start":{"line":35,"column":12},"end":{"line":41,"column":13}},"17":{"start":{"line":36,"column":16},"end":{"line":36,"column":37}},"18":{"start":{"line":37,"column":16},"end":{"line":37,"column":38}},"19":{"start":{"line":38,"column":16},"end":{"line":38,"column":29}},"20":{"start":{"line":39,"column":19},"end":{"line":41,"column":13}},"21":{"start":{"line":40,"column":16},"end":{"line":40,"column":42}},"22":{"start":{"line":43,"column":12},"end":{"line":43,"column":23}},"23":{"start":{"line":47,"column":4},"end":{"line":59,"column":6}},"24":{"start":{"line":62,"column":0},"end":{"line":62,"column":32}}},"branchMap":{"1":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":12},"end":{"line":35,"column":12}},{"start":{"line":35,"column":12},"end":{"line":35,"column":12}}]},"2":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":19},"end":{"line":39,"column":19}},{"start":{"line":39,"column":19},"end":{"line":39,"column":19}}]}},"code":["var Immutable = require('immutable');","var encodeNavigation = require('./encodeNavigation');","","/**","    page.progress is a deprecated property from GitBook v2","","    @param {Output}","    @param {Page}","    @return {Object}","*/","function encodeProgress(output, page) {","    var current = page.getPath();","    var navigation = encodeNavigation(output);","    navigation = Immutable.Map(navigation);","","    var n = navigation.size;","    var percent = 0, prevPercent = 0, currentChapter = null;","    var done = true;","","    var chapters = navigation","        .map(function(nav, chapterPath) {","            nav.path = chapterPath;","            return nav;","        })","        .valueSeq()","        .sortBy(function(nav) {","            return nav.index;","        })","        .map(function(nav, i) {","            // Calcul percent","            nav.percent = (i * 100) / Math.max((n - 1), 1);","","            // Is it done","            nav.done = done;","            if (nav.path == current) {","                currentChapter = nav;","                percent = nav.percent;","                done = false;","            } else if (done) {","                prevPercent = nav.percent;","            }","","            return nav;","        })","        .toJS();","","    return {","        // Previous percent","        prevPercent: prevPercent,","","        // Current percent","        percent: percent,","","        // List of chapter with progress","        chapters: chapters,","","        // Current chapter","        current: currentChapter","    };","}","","module.exports = encodeProgress;","",""],"l":{"1":1,"2":1,"11":1,"12":0,"13":0,"14":0,"16":0,"17":0,"18":0,"20":0,"22":0,"23":0,"27":0,"31":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"43":0,"47":0,"62":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodeNavigation.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodeNavigation.js","s":{"1":1,"2":1,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"encodeArticle","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":39}}},"2":{"name":"encodeNavigation","line":28,"loc":{"start":{"line":28,"column":0},"end":{"line":28,"column":34}}},"3":{"name":"(anonymous_3)","line":36,"loc":{"start":{"line":36,"column":13},"end":{"line":36,"column":34}}},"4":{"name":"(anonymous_4)","line":57,"loc":{"start":{"line":57,"column":16},"end":{"line":57,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":10,"column":0},"end":{"line":20,"column":1}},"3":{"start":{"line":11,"column":4},"end":{"line":11,"column":40}},"4":{"start":{"line":13,"column":4},"end":{"line":19,"column":6}},"5":{"start":{"line":28,"column":0},"end":{"line":62,"column":1}},"6":{"start":{"line":29,"column":4},"end":{"line":29,"column":32}},"7":{"start":{"line":30,"column":4},"end":{"line":30,"column":34}},"8":{"start":{"line":31,"column":4},"end":{"line":31,"column":36}},"9":{"start":{"line":32,"column":4},"end":{"line":32,"column":47}},"10":{"start":{"line":35,"column":4},"end":{"line":59,"column":11}},"11":{"start":{"line":37,"column":12},"end":{"line":37,"column":39}},"12":{"start":{"line":38,"column":12},"end":{"line":40,"column":13}},"13":{"start":{"line":39,"column":16},"end":{"line":39,"column":33}},"14":{"start":{"line":42,"column":12},"end":{"line":42,"column":43}},"15":{"start":{"line":43,"column":12},"end":{"line":43,"column":43}},"16":{"start":{"line":45,"column":12},"end":{"line":55,"column":14}},"17":{"start":{"line":58,"column":12},"end":{"line":58,"column":30}},"18":{"start":{"line":61,"column":4},"end":{"line":61,"column":44}},"19":{"start":{"line":64,"column":0},"end":{"line":64,"column":34}}},"branchMap":{"1":{"line":17,"type":"binary-expr","locations":[{"start":{"line":17,"column":17},"end":{"line":17,"column":28}},{"start":{"line":17,"column":32},"end":{"line":17,"column":54}}]},"2":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":12},"end":{"line":38,"column":12}},{"start":{"line":38,"column":12},"end":{"line":38,"column":12}}]},"3":{"line":51,"type":"cond-expr","locations":[{"start":{"line":51,"column":32},"end":{"line":51,"column":58}},{"start":{"line":51,"column":61},"end":{"line":51,"column":70}}]},"4":{"line":52,"type":"cond-expr","locations":[{"start":{"line":52,"column":32},"end":{"line":52,"column":58}},{"start":{"line":52,"column":61},"end":{"line":52,"column":70}}]}},"code":["var Immutable = require('immutable');","","/**","    Encode an article for next/prev","","    @param {Map<String:Page>}","    @param {Article}","    @return {Object}","*/","function encodeArticle(pages, article) {","    var articlePath = article.getPath();","","    return {","        path: articlePath,","        title: article.getTitle(),","        level: article.getLevel(),","        exists: (articlePath && pages.has(articlePath)),","        external: article.isExternal()","    };","}","","/**","    this.navigation is a deprecated property from GitBook v2","","    @param {Output}","    @return {Object}","*/","function encodeNavigation(output) {","    var book = output.getBook();","    var pages = output.getPages();","    var summary = book.getSummary();","    var articles = summary.getArticlesAsList();","","","    var navigation = articles","        .map(function(article, i) {","            var ref = article.getRef();","            if (!ref) {","                return undefined;","            }","","            var prev = articles.get(i - 1);","            var next = articles.get(i + 1);","","            return [","                ref,","                {","                    index: i,","                    title: article.getTitle(),","                    introduction: (i === 0),","                    prev: prev? encodeArticle(pages, prev) : undefined,","                    next: next? encodeArticle(pages, next) : undefined,","                    level: article.getLevel()","                }","            ];","        })","        .filter(function(e) {","            return Boolean(e);","        });","","    return Immutable.Map(navigation).toJS();","}","","module.exports = encodeNavigation;",""],"l":{"1":1,"10":1,"11":0,"13":0,"28":1,"29":0,"30":0,"31":0,"32":0,"35":0,"37":0,"38":0,"39":0,"42":0,"43":0,"45":0,"58":0,"61":0,"64":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/decodePage.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/decodePage.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"decodePage","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":42}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":32},"end":{"line":33,"column":50}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":39}},"2":{"start":{"line":12,"column":0},"end":{"line":42,"column":1}},"3":{"start":{"line":13,"column":4},"end":{"line":13,"column":44}},"4":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"5":{"start":{"line":18,"column":8},"end":{"line":18,"column":20}},"6":{"start":{"line":21,"column":4},"end":{"line":21,"column":39}},"7":{"start":{"line":25,"column":4},"end":{"line":37,"column":5}},"8":{"start":{"line":26,"column":8},"end":{"line":26,"column":51}},"9":{"start":{"line":31,"column":9},"end":{"line":37,"column":5}},"10":{"start":{"line":32,"column":8},"end":{"line":36,"column":10}},"11":{"start":{"line":34,"column":16},"end":{"line":34,"column":39}},"12":{"start":{"line":39,"column":4},"end":{"line":39,"column":38}},"13":{"start":{"line":41,"column":4},"end":{"line":41,"column":16}},"14":{"start":{"line":44,"column":0},"end":{"line":44,"column":28}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":17,"column":4}},{"start":{"line":17,"column":4},"end":{"line":17,"column":4}}]},"2":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":4}},{"start":{"line":25,"column":4},"end":{"line":25,"column":4}}]},"3":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":9},"end":{"line":31,"column":9}},{"start":{"line":31,"column":9},"end":{"line":31,"column":9}}]}},"code":["var deprecate = require('./deprecate');","","/**","    Decode changes from a JS API to a page object.","    Only the content can be edited by plugin's hooks.","","    @param {Output} output","    @param {Page} page: page instance to edit","    @param {Object} result: result from API","    @return {Page}","*/","function decodePage(output, page, result) {","    var originalContent = page.getContent();","","    // No returned value","    // Existing content will be used","    if (!result) {","        return page;","    }","","    deprecate.disable('page.sections');","","    // GitBook 3","    // Use returned page.content if different from original content","    if (result.content != originalContent) {","        page = page.set('content', result.content);","    }","","    // GitBook 2 compatibility","    // Finally, use page.sections","    else if (result.sections) {","        page = page.set('content',","            result.sections.map(function(section) {","                return section.content;","            }).join('\\n')","        );","    }","","    deprecate.enable('page.sections');","","    return page;","}","","module.exports = decodePage;",""],"l":{"1":1,"12":1,"13":0,"17":0,"18":0,"21":0,"25":0,"26":0,"31":0,"32":0,"34":0,"39":0,"41":0,"44":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodeGlobal.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodeGlobal.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"fnMap":{"1":{"name":"encodeGlobal","line":25,"loc":{"start":{"line":25,"column":0},"end":{"line":25,"column":30}}},"2":{"name":"(anonymous_2)","line":43,"loc":{"start":{"line":43,"column":24},"end":{"line":43,"column":35}}},"3":{"name":"(anonymous_3)","line":52,"loc":{"start":{"line":52,"column":24},"end":{"line":52,"column":35}}},"4":{"name":"(anonymous_4)","line":62,"loc":{"start":{"line":62,"column":18},"end":{"line":62,"column":37}}},"5":{"name":"(anonymous_5)","line":72,"loc":{"start":{"line":72,"column":26},"end":{"line":72,"column":45}}},"6":{"name":"(anonymous_6)","line":82,"loc":{"start":{"line":82,"column":17},"end":{"line":82,"column":36}}},"7":{"name":"(anonymous_7)","line":92,"loc":{"start":{"line":92,"column":23},"end":{"line":92,"column":42}}},"8":{"name":"(anonymous_8)","line":106,"loc":{"start":{"line":106,"column":21},"end":{"line":106,"column":42}}},"9":{"name":"(anonymous_9)","line":120,"loc":{"start":{"line":120,"column":22},"end":{"line":120,"column":43}}},"10":{"name":"(anonymous_10)","line":135,"loc":{"start":{"line":135,"column":24},"end":{"line":135,"column":50}}},"11":{"name":"(anonymous_11)","line":152,"loc":{"start":{"line":152,"column":18},"end":{"line":152,"column":29}}},"12":{"name":"(anonymous_12)","line":162,"loc":{"start":{"line":162,"column":21},"end":{"line":162,"column":40}}},"13":{"name":"(anonymous_13)","line":170,"loc":{"start":{"line":170,"column":19},"end":{"line":170,"column":38}}},"14":{"name":"(anonymous_14)","line":180,"loc":{"start":{"line":180,"column":21},"end":{"line":180,"column":49}}},"15":{"name":"(anonymous_15)","line":182,"loc":{"start":{"line":182,"column":22},"end":{"line":182,"column":33}}},"16":{"name":"(anonymous_16)","line":197,"loc":{"start":{"line":197,"column":23},"end":{"line":197,"column":51}}},"17":{"name":"(anonymous_17)","line":199,"loc":{"start":{"line":199,"column":22},"end":{"line":199,"column":33}}},"18":{"name":"(anonymous_18)","line":203,"loc":{"start":{"line":203,"column":26},"end":{"line":203,"column":37}}},"19":{"name":"(anonymous_19)","line":218,"loc":{"start":{"line":218,"column":22},"end":{"line":218,"column":63}}},"20":{"name":"(anonymous_20)","line":220,"loc":{"start":{"line":220,"column":22},"end":{"line":220,"column":33}}},"21":{"name":"(anonymous_21)","line":224,"loc":{"start":{"line":224,"column":26},"end":{"line":224,"column":37}}},"22":{"name":"(anonymous_22)","line":244,"loc":{"start":{"line":244,"column":69},"end":{"line":244,"column":80}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":42}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":41}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":32}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":36}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":39}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":54}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":58}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":36}},"10":{"start":{"line":11,"column":0},"end":{"line":11,"column":36}},"11":{"start":{"line":13,"column":0},"end":{"line":13,"column":45}},"12":{"start":{"line":14,"column":0},"end":{"line":14,"column":47}},"13":{"start":{"line":15,"column":0},"end":{"line":15,"column":53}},"14":{"start":{"line":16,"column":0},"end":{"line":16,"column":41}},"15":{"start":{"line":25,"column":0},"end":{"line":255,"column":1}},"16":{"start":{"line":26,"column":4},"end":{"line":26,"column":32}},"17":{"start":{"line":27,"column":4},"end":{"line":27,"column":37}},"18":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"19":{"start":{"line":29,"column":4},"end":{"line":29,"column":40}},"20":{"start":{"line":30,"column":4},"end":{"line":30,"column":38}},"21":{"start":{"line":31,"column":4},"end":{"line":31,"column":45}},"22":{"start":{"line":33,"column":4},"end":{"line":234,"column":6}},"23":{"start":{"line":44,"column":12},"end":{"line":44,"column":41}},"24":{"start":{"line":53,"column":12},"end":{"line":53,"column":41}},"25":{"start":{"line":63,"column":12},"end":{"line":63,"column":41}},"26":{"start":{"line":73,"column":12},"end":{"line":73,"column":49}},"27":{"start":{"line":83,"column":12},"end":{"line":83,"column":65}},"28":{"start":{"line":93,"column":12},"end":{"line":93,"column":48}},"29":{"start":{"line":94,"column":12},"end":{"line":94,"column":40}},"30":{"start":{"line":94,"column":23},"end":{"line":94,"column":40}},"31":{"start":{"line":96,"column":12},"end":{"line":96,"column":44}},"32":{"start":{"line":107,"column":12},"end":{"line":107,"column":43}},"33":{"start":{"line":109,"column":12},"end":{"line":110,"column":32}},"34":{"start":{"line":121,"column":12},"end":{"line":121,"column":43}},"35":{"start":{"line":123,"column":12},"end":{"line":124,"column":32}},"36":{"start":{"line":136,"column":16},"end":{"line":136,"column":72}},"37":{"start":{"line":137,"column":16},"end":{"line":137,"column":68}},"38":{"start":{"line":153,"column":16},"end":{"line":153,"column":36}},"39":{"start":{"line":163,"column":16},"end":{"line":163,"column":60}},"40":{"start":{"line":171,"column":16},"end":{"line":171,"column":51}},"41":{"start":{"line":181,"column":16},"end":{"line":186,"column":19}},"42":{"start":{"line":183,"column":20},"end":{"line":183,"column":83}},"43":{"start":{"line":185,"column":20},"end":{"line":185,"column":47}},"44":{"start":{"line":198,"column":16},"end":{"line":206,"column":19}},"45":{"start":{"line":200,"column":20},"end":{"line":200,"column":83}},"46":{"start":{"line":202,"column":20},"end":{"line":205,"column":23}},"47":{"start":{"line":204,"column":24},"end":{"line":204,"column":63}},"48":{"start":{"line":219,"column":16},"end":{"line":227,"column":19}},"49":{"start":{"line":221,"column":20},"end":{"line":221,"column":91}},"50":{"start":{"line":223,"column":20},"end":{"line":226,"column":23}},"51":{"start":{"line":225,"column":24},"end":{"line":225,"column":66}},"52":{"start":{"line":238,"column":4},"end":{"line":238,"column":93}},"53":{"start":{"line":239,"column":4},"end":{"line":239,"column":95}},"54":{"start":{"line":241,"column":4},"end":{"line":242,"column":106}},"55":{"start":{"line":244,"column":4},"end":{"line":246,"column":46}},"56":{"start":{"line":245,"column":8},"end":{"line":245,"column":40}},"57":{"start":{"line":248,"column":4},"end":{"line":249,"column":78}},"58":{"start":{"line":251,"column":4},"end":{"line":252,"column":95}},"59":{"start":{"line":254,"column":4},"end":{"line":254,"column":18}},"60":{"start":{"line":257,"column":0},"end":{"line":257,"column":30}}},"branchMap":{"1":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":12},"end":{"line":94,"column":12}},{"start":{"line":94,"column":12},"end":{"line":94,"column":12}}]},"2":{"line":136,"type":"binary-expr","locations":[{"start":{"line":136,"column":28},"end":{"line":136,"column":44}},{"start":{"line":136,"column":48},"end":{"line":136,"column":71}}]}},"code":["var path = require('path');","var Promise = require('../utils/promise');","var PathUtils = require('../utils/path');","var fs = require('../utils/fs');","","var Plugins = require('../plugins');","var deprecate = require('./deprecate');","var fileToURL = require('../output/helper/fileToURL');","var defaultBlocks = require('../constants/defaultBlocks');","var gitbook = require('../gitbook');","var parsers = require('../parsers');","","var encodeConfig = require('./encodeConfig');","var encodeSummary = require('./encodeSummary');","var encodeNavigation = require('./encodeNavigation');","var encodePage = require('./encodePage');","","/**","    Encode a global context into a JS object","    It's the context for page's hook, etc","","    @param {Output} output","    @return {Object}","*/","function encodeGlobal(output) {","    var book = output.getBook();","    var bookFS = book.getContentFS();","    var logger = output.getLogger();","    var outputFolder = output.getRoot();","    var plugins = output.getPlugins();","    var blocks = Plugins.listBlocks(plugins);","","    var result = {","        log: logger,","        config: encodeConfig(output, book.getConfig()),","        summary: encodeSummary(output, book.getSummary()),","","        /**","            Check if the book is a multilingual book","","            @return {Boolean}","        */","        isMultilingual: function() {","            return book.isMultilingual();","        },","","        /**","            Check if the book is a language book for a multilingual book","","            @return {Boolean}","        */","        isLanguageBook: function() {","            return book.isLanguageBook();","        },","","        /**","            Read a file from the book","","            @param {String} fileName","            @return {Promise<Buffer>}","        */","        readFile: function(fileName) {","            return bookFS.read(fileName);","        },","","        /**","            Read a file from the book as a string","","            @param {String} fileName","            @return {Promise<String>}","        */","        readFileAsString: function(fileName) {","            return bookFS.readAsString(fileName);","        },","","        /**","            Resolve a file from the book root","","            @param {String} fileName","            @return {String}","        */","        resolve: function(fileName) {","            return path.resolve(book.getContentRoot(), fileName);","        },","","        /**","            Resolve a page by it path","","            @param {String} filePath","            @return {String}","        */","        getPageByPath: function(filePath) {","            var page = output.getPage(filePath);","            if (!page) return undefined;","","            return encodePage(output, page);","        },","","        /**","            Render a block of text (markdown/asciidoc)","","            @param {String} type","            @param {String} text","            @return {Promise<String>}","        */","        renderBlock: function(type, text) {","            var parser = parsers.get(type);","","            return parser.parsePage(text)","                .get('content');","        },","","        /**","            Render an inline text (markdown/asciidoc)","","            @param {String} type","            @param {String} text","            @return {Promise<String>}","        */","        renderInline: function(type, text) {","            var parser = parsers.get(type);","","            return parser.parseInline(text)","                .get('content');","        },","","        template: {","            /**","                Apply a templating block and returns its result","","                @param {String} name","                @param {Object} blockData","                @return {Promise|Object}","            */","            applyBlock: function(name, blockData) {","                var block = blocks.get(name) || defaultBlocks.get(name);","                return Promise(block.applyBlock(blockData, result));","            }","        },","","        output: {","            /**","                Name of the generator being used","                {String}","            */","            name: output.getGenerator(),","","            /**","                Return absolute path to the root folder of output","                @return {String}","            */","            root: function() {","                return outputFolder;","            },","","            /**","                Resolve a file from the output root","","                @param {String} fileName","                @return {String}","            */","            resolve: function(fileName) {","                return path.resolve(outputFolder, fileName);","            },","","            /**","                Convert a filepath into an url","                @return {String}","            */","            toURL: function(filePath) {","                return fileToURL(output, filePath);","            },","","            /**","                Check that a file exists.","","                @param {String} fileName","                @return {Promise}","            */","            hasFile: function(fileName, content) {","                return Promise()","                .then(function() {","                    var filePath = PathUtils.resolveInRoot(outputFolder, fileName);","","                    return fs.exists(filePath);","                });","            },","","            /**","                Write a file to the output folder,","                It creates the required folder","","                @param {String} fileName","                @param {Buffer} content","                @return {Promise}","            */","            writeFile: function(fileName, content) {","                return Promise()","                .then(function() {","                    var filePath = PathUtils.resolveInRoot(outputFolder, fileName);","","                    return fs.ensureFile(filePath)","                    .then(function() {","                        return fs.writeFile(filePath, content);","                    });","                });","            },","","            /**","                Copy a file to the output folder","                It creates the required folder.","","                @param {String} inputFile","                @param {String} outputFile","                @param {Buffer} content","                @return {Promise}","            */","            copyFile: function(inputFile, outputFile, content) {","                return Promise()","                .then(function() {","                    var outputFilePath = PathUtils.resolveInRoot(outputFolder, outputFile);","","                    return fs.ensureFile(outputFilePath)","                    .then(function() {","                        return fs.copy(inputFile, outputFilePath);","                    });","                });","            }","        },","","        gitbook: {","            version: gitbook.version","        }","    };","","    // Deprecated properties","","    deprecate.renamedMethod(output, 'this.isSubBook', result, 'isSubBook', 'isLanguageBook');","    deprecate.renamedMethod(output, 'this.contentLink', result, 'contentLink', 'output.toURL');","","    deprecate.field(output, 'this.generator', result, 'generator',","        output.getGenerator(), '\"this.generator\" property is deprecated, use \"this.output.name\" instead');","","    deprecate.field(output, 'this.navigation', result, 'navigation', function() {","        return encodeNavigation(output);","    }, '\"navigation\" property is deprecated');","","    deprecate.field(output, 'this.book', result, 'book',","        result, '\"book\" property is deprecated, use \"this\" directly instead');","","    deprecate.field(output, 'this.options', result, 'options',","        result.config.values, '\"options\" property is deprecated, use config.get(key) instead');","","    return result;","}","","module.exports = encodeGlobal;",""],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"13":1,"14":1,"15":1,"16":1,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"33":0,"44":0,"53":0,"63":0,"73":0,"83":0,"93":0,"94":0,"96":0,"107":0,"109":0,"121":0,"123":0,"136":0,"137":0,"153":0,"163":0,"171":0,"181":0,"183":0,"185":0,"198":0,"200":0,"202":0,"204":0,"219":0,"221":0,"223":0,"225":0,"238":0,"239":0,"241":0,"244":0,"245":0,"248":0,"251":0,"254":0,"257":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":9,"column":2}}},"branchMap":{},"code":["","module.exports = {","    loadForBook:            require('./loadForBook'),","    validateConfig:         require('./validateConfig'),","    installPlugins:         require('./installPlugins'),","    listResources:          require('./listResources'),","    listBlocks:             require('./listBlocks'),","    listFilters:            require('./listFilters')","};","",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/loadForBook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/loadForBook.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"loadForBook","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":27}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":10},"end":{"line":23,"column":33}}},"3":{"name":"(anonymous_3)","line":25,"loc":{"start":{"line":25,"column":42},"end":{"line":25,"column":64}}},"4":{"name":"(anonymous_4)","line":31,"loc":{"start":{"line":31,"column":28},"end":{"line":31,"column":45}}},"5":{"name":"(anonymous_5)","line":47,"loc":{"start":{"line":47,"column":17},"end":{"line":47,"column":34}}},"6":{"name":"(anonymous_6)","line":66,"loc":{"start":{"line":66,"column":36},"end":{"line":66,"column":53}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":51}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":43}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":41}},"6":{"start":{"line":15,"column":0},"end":{"line":70,"column":1}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":34}},"8":{"start":{"line":19,"column":4},"end":{"line":19,"column":45}},"9":{"start":{"line":22,"column":4},"end":{"line":69,"column":7}},"10":{"start":{"line":24,"column":8},"end":{"line":24,"column":25}},"11":{"start":{"line":25,"column":8},"end":{"line":43,"column":15}},"12":{"start":{"line":26,"column":12},"end":{"line":26,"column":37}},"13":{"start":{"line":27,"column":12},"end":{"line":27,"column":51}},"14":{"start":{"line":29,"column":12},"end":{"line":40,"column":13}},"15":{"start":{"line":30,"column":16},"end":{"line":34,"column":31}},"16":{"start":{"line":32,"column":24},"end":{"line":32,"column":59}},"17":{"start":{"line":36,"column":16},"end":{"line":36,"column":45}},"18":{"start":{"line":37,"column":16},"end":{"line":37,"column":39}},"19":{"start":{"line":39,"column":16},"end":{"line":39,"column":35}},"20":{"start":{"line":42,"column":12},"end":{"line":42,"column":26}},"21":{"start":{"line":46,"column":8},"end":{"line":52,"column":15}},"22":{"start":{"line":48,"column":16},"end":{"line":51,"column":18}},"23":{"start":{"line":53,"column":8},"end":{"line":53,"column":48}},"24":{"start":{"line":56,"column":8},"end":{"line":56,"column":69}},"25":{"start":{"line":57,"column":8},"end":{"line":59,"column":9}},"26":{"start":{"line":58,"column":12},"end":{"line":58,"column":69}},"27":{"start":{"line":62,"column":8},"end":{"line":64,"column":9}},"28":{"start":{"line":63,"column":12},"end":{"line":63,"column":144}},"29":{"start":{"line":66,"column":8},"end":{"line":68,"column":11}},"30":{"start":{"line":67,"column":12},"end":{"line":67,"column":44}},"31":{"start":{"line":73,"column":0},"end":{"line":73,"column":29}}},"branchMap":{"1":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":12},"end":{"line":29,"column":12}},{"start":{"line":29,"column":12},"end":{"line":29,"column":12}}]},"2":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":8},"end":{"line":57,"column":8}},{"start":{"line":57,"column":8},"end":{"line":57,"column":8}}]},"3":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":8},"end":{"line":62,"column":8}},{"start":{"line":62,"column":8},"end":{"line":62,"column":8}}]}},"code":["var Immutable = require('immutable');","","var Promise = require('../utils/promise');","var listDepsForBook = require('./listDepsForBook');","var findForBook = require('./findForBook');","var loadPlugin = require('./loadPlugin');","","","/**"," * Load all plugins in a book"," *"," * @param {Book}"," * @return {Promise<Map<String:Plugin>}"," */","function loadForBook(book) {","    var logger = book.getLogger();","","    // List the dependencies","    var requirements = listDepsForBook(book);","","    // List all plugins installed in the book","    return findForBook(book)","    .then(function(installedMap) {","        var missing = [];","        var plugins = requirements.reduce(function(result, dep) {","            var name = dep.getName();","            var installed = installedMap.get(name);","","            if (installed) {","                var deps = installedMap","                    .filter(function(plugin) {","                        return plugin.getParent() === name;","                    })","                    .toArray();","","                result = result.concat(deps);","                result.push(installed);","            } else {","                missing.push(name);","            }","","            return result;","        }, []);","","        // Convert plugins list to a map","        plugins = Immutable.List(plugins)","            .map(function(plugin) {","                return [","                    plugin.getName(),","                    plugin","                ];","            });","        plugins = Immutable.OrderedMap(plugins);","","        // Log state","        logger.info.ln(installedMap.size + ' plugins are installed');","        if (requirements.size != installedMap.size) {","            logger.info.ln(requirements.size + ' explicitly listed');","        }","","        // Verify that all plugins are present","        if (missing.length > 0) {","            throw new Error('Couldn\\'t locate plugins \"' + missing.join(', ') + '\", Run \\'gitbook install\\' to install plugins from registry.');","        }","","        return Promise.map(plugins, function(plugin) {","            return loadPlugin(book, plugin);","        });","    });","}","","","module.exports = loadForBook;",""],"l":{"1":1,"3":1,"4":1,"5":1,"6":1,"15":1,"16":0,"19":0,"22":0,"24":0,"25":0,"26":0,"27":0,"29":0,"30":0,"32":0,"36":0,"37":0,"39":0,"42":0,"46":0,"48":0,"53":0,"56":0,"57":0,"58":0,"62":0,"63":0,"66":0,"67":0,"73":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/listDepsForBook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/listDepsForBook.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"listDepsForBook","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":53}},"2":{"start":{"line":11,"column":0},"end":{"line":16,"column":1}},"3":{"start":{"line":12,"column":4},"end":{"line":12,"column":34}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":49}},"5":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"6":{"start":{"line":18,"column":0},"end":{"line":18,"column":33}}},"branchMap":{},"code":["var listDependencies = require('./listDependencies');","","/**"," * List all plugin requirements for a book."," * It can be different from the final list of plugins,"," * since plugins can have their own dependencies"," *"," * @param {Book}"," * @return {List<PluginDependency>}"," */","function listDepsForBook(book) {","    var config = book.getConfig();","    var plugins = config.getPluginDependencies();","","    return listDependencies(plugins);","}","","module.exports = listDepsForBook;",""],"l":{"1":1,"11":1,"12":0,"13":0,"15":0,"18":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/listDependencies.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/listDependencies.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1},"b":{},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"listDependencies","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":32}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":16},"end":{"line":14,"column":33}}},"3":{"name":"(anonymous_3)","line":17,"loc":{"start":{"line":17,"column":13},"end":{"line":17,"column":30}}},"4":{"name":"(anonymous_4)","line":25,"loc":{"start":{"line":25,"column":26},"end":{"line":25,"column":43}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":61}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":53}},"3":{"start":{"line":11,"column":0},"end":{"line":31,"column":1}},"4":{"start":{"line":13,"column":4},"end":{"line":19,"column":11}},"5":{"start":{"line":15,"column":12},"end":{"line":15,"column":39}},"6":{"start":{"line":18,"column":12},"end":{"line":18,"column":36}},"7":{"start":{"line":22,"column":4},"end":{"line":22,"column":40}},"8":{"start":{"line":25,"column":4},"end":{"line":27,"column":7}},"9":{"start":{"line":26,"column":8},"end":{"line":26,"column":51}},"10":{"start":{"line":30,"column":4},"end":{"line":30,"column":34}},"11":{"start":{"line":33,"column":0},"end":{"line":33,"column":34}}},"branchMap":{},"code":["var DEFAULT_PLUGINS = require('../constants/defaultPlugins');","var sortDependencies = require('./sortDependencies');","","/**"," * List all dependencies for a book, including default plugins."," * It returns a concat with default plugins and remove disabled ones."," *"," * @param {List<PluginDependency>} deps"," * @return {List<PluginDependency>}"," */","function listDependencies(deps) {","    // Extract list of plugins to disable (starting with -)","    var toRemove = deps","        .filter(function(plugin) {","            return !plugin.isEnabled();","        })","        .map(function(plugin) {","            return plugin.getName();","        });","","    // Concat with default plugins","    deps = deps.concat(DEFAULT_PLUGINS);","","    // Remove plugins","    deps = deps.filterNot(function(plugin) {","        return toRemove.includes(plugin.getName());","    });","","    // Sort","    return sortDependencies(deps);","}","","module.exports = listDependencies;",""],"l":{"1":1,"2":1,"11":1,"13":0,"15":0,"18":0,"22":0,"25":0,"26":0,"30":0,"33":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/sortDependencies.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/sortDependencies.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":1,"9":0,"10":0,"11":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"pluginType","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":28}}},"2":{"name":"sortDependencies","line":27,"loc":{"start":{"line":27,"column":0},"end":{"line":27,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":55}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":27}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":26}},"5":{"start":{"line":14,"column":0},"end":{"line":17,"column":1}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":32}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":81}},"8":{"start":{"line":27,"column":0},"end":{"line":32,"column":1}},"9":{"start":{"line":28,"column":4},"end":{"line":28,"column":46}},"10":{"start":{"line":30,"column":4},"end":{"line":31,"column":59}},"11":{"start":{"line":34,"column":0},"end":{"line":34,"column":34}}},"branchMap":{"1":{"line":16,"type":"cond-expr","locations":[{"start":{"line":16,"column":56},"end":{"line":16,"column":66}},{"start":{"line":16,"column":69},"end":{"line":16,"column":80}}]},"2":{"line":16,"type":"binary-expr","locations":[{"start":{"line":16,"column":12},"end":{"line":16,"column":16}},{"start":{"line":16,"column":20},"end":{"line":16,"column":52}}]}},"code":["var Immutable = require('immutable');","","var THEME_PREFIX = require('../constants/themePrefix');","","var TYPE_PLUGIN = 'plugin';","var TYPE_THEME  = 'theme';","","","/**"," * Returns the type of a plugin given its name"," * @param {Plugin} plugin"," * @return {String}"," */","function pluginType(plugin) {","    var name = plugin.getName();","    return (name && name.indexOf(THEME_PREFIX) === 0) ? TYPE_THEME : TYPE_PLUGIN;","}","","","/**"," * Sort the list of dependencies to match list in book.json"," * The themes should always be loaded after the plugins"," *"," * @param {List<PluginDependency>} deps"," * @return {List<PluginDependency>}"," */","function sortDependencies(plugins) {","    var byTypes = plugins.groupBy(pluginType);","","    return byTypes.get(TYPE_PLUGIN, Immutable.List())","        .concat(byTypes.get(TYPE_THEME, Immutable.List()));","}","","module.exports = sortDependencies;"],"l":{"1":1,"3":1,"5":1,"6":1,"14":1,"15":0,"16":0,"27":1,"28":0,"30":0,"34":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/themePrefix.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/themePrefix.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":26}}},"branchMap":{},"code":["/*","    All GitBook themes plugins name start with this prefix once shorted.","*/","module.exports = 'theme-';"],"l":{"4":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/findForBook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/findForBook.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":1},"b":{},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"findForBook","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":27}}},"2":{"name":"(anonymous_2)","line":24,"loc":{"start":{"line":24,"column":14},"end":{"line":24,"column":32}}},"3":{"name":"(anonymous_3)","line":26,"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":46}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":40}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":47}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":53}},"6":{"start":{"line":14,"column":0},"end":{"line":31,"column":1}},"7":{"start":{"line":15,"column":4},"end":{"line":30,"column":6}},"8":{"start":{"line":25,"column":12},"end":{"line":28,"column":43}},"9":{"start":{"line":27,"column":20},"end":{"line":27,"column":45}},"10":{"start":{"line":34,"column":0},"end":{"line":34,"column":29}}},"branchMap":{},"code":["var Immutable = require('immutable');","","var Promise = require('../utils/promise');","var timing = require('../utils/timing');","var findInstalled = require('./findInstalled');","var locateRootFolder = require('./locateRootFolder');","","/**"," * List all plugins installed in a book"," *"," * @param {Book}"," * @return {Promise<OrderedMap<String:Plugin>>}"," */","function findForBook(book) {","    return timing.measure(","        'plugins.findForBook',","","        Promise.all([","            findInstalled(locateRootFolder()),","            findInstalled(book.getRoot())","        ])","","        // Merge all plugins","        .then(function(results) {","            return Immutable.List(results)","                .reduce(function(out, result) {","                    return out.merge(result);","                }, Immutable.OrderedMap());","        })","    );","}","","","module.exports = findForBook;",""],"l":{"1":1,"3":1,"4":1,"5":1,"6":1,"14":1,"15":0,"25":0,"27":0,"34":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/findInstalled.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/findInstalled.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"validateId","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":26}}},"2":{"name":"findInstalled","line":26,"loc":{"start":{"line":26,"column":0},"end":{"line":26,"column":31}}},"3":{"name":"(anonymous_3)","line":29,"loc":{"start":{"line":29,"column":13},"end":{"line":29,"column":24}}},"4":{"name":"onPackage","line":34,"loc":{"start":{"line":34,"column":4},"end":{"line":34,"column":36}}},"5":{"name":"(anonymous_5)","line":57,"loc":{"start":{"line":57,"column":44},"end":{"line":57,"column":58}}},"6":{"name":"(anonymous_6)","line":67,"loc":{"start":{"line":67,"column":10},"end":{"line":67,"column":21}}},"7":{"name":"(anonymous_7)","line":70,"loc":{"start":{"line":70,"column":10},"end":{"line":70,"column":28}}},"8":{"name":"(anonymous_8)","line":71,"loc":{"start":{"line":71,"column":38},"end":{"line":71,"column":55}}},"9":{"name":"(anonymous_9)","line":80,"loc":{"start":{"line":80,"column":18},"end":{"line":80,"column":33}}},"10":{"name":"(anonymous_10)","line":85,"loc":{"start":{"line":85,"column":10},"end":{"line":85,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":46}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":42}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":32}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":41}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":50}},"8":{"start":{"line":15,"column":0},"end":{"line":17,"column":1}},"9":{"start":{"line":16,"column":4},"end":{"line":16,"column":46}},"10":{"start":{"line":26,"column":0},"end":{"line":89,"column":1}},"11":{"start":{"line":27,"column":4},"end":{"line":31,"column":6}},"12":{"start":{"line":32,"column":4},"end":{"line":32,"column":41}},"13":{"start":{"line":34,"column":4},"end":{"line":60,"column":5}},"14":{"start":{"line":35,"column":8},"end":{"line":35,"column":30}},"15":{"start":{"line":35,"column":23},"end":{"line":35,"column":30}},"16":{"start":{"line":37,"column":8},"end":{"line":37,"column":28}},"17":{"start":{"line":38,"column":8},"end":{"line":38,"column":34}},"18":{"start":{"line":39,"column":8},"end":{"line":39,"column":35}},"19":{"start":{"line":40,"column":8},"end":{"line":40,"column":30}},"20":{"start":{"line":41,"column":8},"end":{"line":41,"column":44}},"21":{"start":{"line":43,"column":8},"end":{"line":43,"column":51}},"22":{"start":{"line":45,"column":8},"end":{"line":55,"column":9}},"23":{"start":{"line":46,"column":12},"end":{"line":46,"column":31}},"24":{"start":{"line":46,"column":24},"end":{"line":46,"column":31}},"25":{"start":{"line":48,"column":12},"end":{"line":54,"column":16}},"26":{"start":{"line":57,"column":8},"end":{"line":59,"column":11}},"27":{"start":{"line":58,"column":12},"end":{"line":58,"column":39}},"28":{"start":{"line":63,"column":4},"end":{"line":63,"column":57}},"29":{"start":{"line":66,"column":4},"end":{"line":88,"column":7}},"30":{"start":{"line":68,"column":8},"end":{"line":68,"column":27}},"31":{"start":{"line":71,"column":8},"end":{"line":83,"column":11}},"32":{"start":{"line":73,"column":12},"end":{"line":75,"column":13}},"33":{"start":{"line":74,"column":16},"end":{"line":74,"column":33}},"34":{"start":{"line":78,"column":12},"end":{"line":78,"column":64}},"35":{"start":{"line":79,"column":12},"end":{"line":82,"column":15}},"36":{"start":{"line":81,"column":16},"end":{"line":81,"column":32}},"37":{"start":{"line":87,"column":8},"end":{"line":87,"column":23}},"38":{"start":{"line":91,"column":0},"end":{"line":91,"column":31}}},"branchMap":{"1":{"line":16,"type":"binary-expr","locations":[{"start":{"line":16,"column":11},"end":{"line":16,"column":15}},{"start":{"line":16,"column":19},"end":{"line":16,"column":45}}]},"2":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":8}},{"start":{"line":35,"column":8},"end":{"line":35,"column":8}}]},"3":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":45,"column":8}},{"start":{"line":45,"column":8},"end":{"line":45,"column":8}}]},"4":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":12},"end":{"line":46,"column":12}},{"start":{"line":46,"column":12},"end":{"line":46,"column":12}}]},"5":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":12},"end":{"line":73,"column":12}},{"start":{"line":73,"column":12},"end":{"line":73,"column":12}}]}},"code":["var readInstalled = require('read-installed');","var Immutable = require('immutable');","var path = require('path');","","var Promise = require('../utils/promise');","var fs = require('../utils/fs');","var Plugin = require('../models/plugin');","var PREFIX = require('../constants/pluginPrefix');","","/**"," * Validate if a package name is a GitBook plugin"," *"," * @return {Boolean}"," */","function validateId(name) {","    return name && name.indexOf(PREFIX) === 0;","}","","","/**"," * List all packages installed inside a folder"," *"," * @param {String} folder"," * @return {OrderedMap<String:Plugin>}"," */","function findInstalled(folder) {","    var options = {","        dev: false,","        log: function() {},","        depth: 4","    };","    var results = Immutable.OrderedMap();","","    function onPackage(pkg, parent) {","        if (!pkg.name) return;","","        var name = pkg.name;","        var version = pkg.version;","        var pkgPath = pkg.realPath;","        var depth = pkg.depth;","        var dependencies = pkg.dependencies;","","        var pluginName = name.slice(PREFIX.length);","","        if (!validateId(name)){","            if (parent) return;","        } else {","            results = results.set(pluginName, Plugin({","                name: pluginName,","                version: version,","                path: pkgPath,","                depth: depth,","                parent: parent","            }));","        }","","        Immutable.Map(dependencies).forEach(function(dep) {","            onPackage(dep, pluginName);","        });","    }","","    // Search for gitbook-plugins in node_modules folder","    var node_modules = path.join(folder, 'node_modules');","","    // List all folders in node_modules","    return fs.readdir(node_modules)","    .fail(function() {","        return Promise([]);","    })","    .then(function(modules) {","        return Promise.serie(modules, function(module) {","            // Not a gitbook-plugin","            if (!validateId(module)) {","                return Promise();","            }","","            // Read gitbook-plugin package details","            var module_folder = path.join(node_modules, module);","            return Promise.nfcall(readInstalled, module_folder, options)","            .then(function(data) {","                onPackage(data);","            });","        });","    })","    .then(function() {","        // Return installed plugins","        return results;","    });","}","","module.exports = findInstalled;",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"7":1,"8":1,"15":1,"16":0,"26":1,"27":0,"32":0,"34":1,"35":0,"37":0,"38":0,"39":0,"40":0,"41":0,"43":0,"45":0,"46":0,"48":0,"57":0,"58":0,"63":0,"66":0,"68":0,"71":0,"73":0,"74":0,"78":0,"79":0,"81":0,"87":0,"91":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/plugin.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/plugin.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":1,"10":0,"11":1,"12":0,"13":1,"14":0,"15":1,"16":0,"17":1,"18":0,"19":1,"20":0,"21":1,"22":0,"23":1,"24":0,"25":1,"26":0,"27":0,"28":1,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":1,"43":0,"44":1,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":1,"52":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"fnMap":{"1":{"name":"(anonymous_1)","line":31,"loc":{"start":{"line":31,"column":27},"end":{"line":31,"column":38}}},"2":{"name":"(anonymous_2)","line":35,"loc":{"start":{"line":35,"column":27},"end":{"line":35,"column":38}}},"3":{"name":"(anonymous_3)","line":39,"loc":{"start":{"line":39,"column":30},"end":{"line":39,"column":41}}},"4":{"name":"(anonymous_4)","line":43,"loc":{"start":{"line":43,"column":30},"end":{"line":43,"column":41}}},"5":{"name":"(anonymous_5)","line":47,"loc":{"start":{"line":47,"column":30},"end":{"line":47,"column":41}}},"6":{"name":"(anonymous_6)","line":51,"loc":{"start":{"line":51,"column":28},"end":{"line":51,"column":39}}},"7":{"name":"(anonymous_7)","line":55,"loc":{"start":{"line":55,"column":29},"end":{"line":55,"column":40}}},"8":{"name":"(anonymous_8)","line":63,"loc":{"start":{"line":63,"column":28},"end":{"line":63,"column":39}}},"9":{"name":"(anonymous_9)","line":71,"loc":{"start":{"line":71,"column":28},"end":{"line":71,"column":39}}},"10":{"name":"(anonymous_10)","line":79,"loc":{"start":{"line":79,"column":27},"end":{"line":79,"column":38}}},"11":{"name":"(anonymous_11)","line":88,"loc":{"start":{"line":88,"column":28},"end":{"line":88,"column":39}}},"12":{"name":"(anonymous_12)","line":97,"loc":{"start":{"line":97,"column":32},"end":{"line":97,"column":47}}},"13":{"name":"(anonymous_13)","line":112,"loc":{"start":{"line":112,"column":30},"end":{"line":112,"column":41}}},"14":{"name":"(anonymous_14)","line":120,"loc":{"start":{"line":120,"column":29},"end":{"line":120,"column":40}}},"15":{"name":"(anonymous_15)","line":125,"loc":{"start":{"line":125,"column":13},"end":{"line":125,"column":40}}},"16":{"name":"(anonymous_16)","line":135,"loc":{"start":{"line":135,"column":27},"end":{"line":135,"column":42}}},"17":{"name":"(anonymous_17)","line":144,"loc":{"start":{"line":144,"column":26},"end":{"line":144,"column":38}}},"18":{"name":"(anonymous_18)","line":160,"loc":{"start":{"line":160,"column":23},"end":{"line":160,"column":37}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":47}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":53}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":55}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":26}},"6":{"start":{"line":9,"column":0},"end":{"line":29,"column":13}},"7":{"start":{"line":31,"column":0},"end":{"line":33,"column":2}},"8":{"start":{"line":32,"column":4},"end":{"line":32,"column":28}},"9":{"start":{"line":35,"column":0},"end":{"line":37,"column":2}},"10":{"start":{"line":36,"column":4},"end":{"line":36,"column":28}},"11":{"start":{"line":39,"column":0},"end":{"line":41,"column":2}},"12":{"start":{"line":40,"column":4},"end":{"line":40,"column":31}},"13":{"start":{"line":43,"column":0},"end":{"line":45,"column":2}},"14":{"start":{"line":44,"column":4},"end":{"line":44,"column":31}},"15":{"start":{"line":47,"column":0},"end":{"line":49,"column":2}},"16":{"start":{"line":48,"column":4},"end":{"line":48,"column":31}},"17":{"start":{"line":51,"column":0},"end":{"line":53,"column":2}},"18":{"start":{"line":52,"column":4},"end":{"line":52,"column":29}},"19":{"start":{"line":55,"column":0},"end":{"line":57,"column":2}},"20":{"start":{"line":56,"column":4},"end":{"line":56,"column":30}},"21":{"start":{"line":63,"column":0},"end":{"line":65,"column":2}},"22":{"start":{"line":64,"column":4},"end":{"line":64,"column":56}},"23":{"start":{"line":71,"column":0},"end":{"line":73,"column":2}},"24":{"start":{"line":72,"column":4},"end":{"line":72,"column":47}},"25":{"start":{"line":79,"column":0},"end":{"line":82,"column":2}},"26":{"start":{"line":80,"column":4},"end":{"line":80,"column":30}},"27":{"start":{"line":81,"column":4},"end":{"line":81,"column":54}},"28":{"start":{"line":88,"column":0},"end":{"line":90,"column":2}},"29":{"start":{"line":89,"column":4},"end":{"line":89,"column":61}},"30":{"start":{"line":97,"column":0},"end":{"line":106,"column":2}},"31":{"start":{"line":98,"column":4},"end":{"line":100,"column":5}},"32":{"start":{"line":99,"column":8},"end":{"line":99,"column":55}},"33":{"start":{"line":102,"column":4},"end":{"line":102,"column":36}},"34":{"start":{"line":103,"column":4},"end":{"line":105,"column":28}},"35":{"start":{"line":112,"column":0},"end":{"line":114,"column":2}},"36":{"start":{"line":113,"column":4},"end":{"line":113,"column":44}},"37":{"start":{"line":120,"column":0},"end":{"line":128,"column":2}},"38":{"start":{"line":121,"column":4},"end":{"line":121,"column":49}},"39":{"start":{"line":122,"column":4},"end":{"line":122,"column":39}},"40":{"start":{"line":124,"column":4},"end":{"line":127,"column":11}},"41":{"start":{"line":126,"column":12},"end":{"line":126,"column":58}},"42":{"start":{"line":135,"column":0},"end":{"line":137,"column":2}},"43":{"start":{"line":136,"column":4},"end":{"line":136,"column":37}},"44":{"start":{"line":144,"column":0},"end":{"line":153,"column":2}},"45":{"start":{"line":145,"column":4},"end":{"line":145,"column":29}},"46":{"start":{"line":146,"column":4},"end":{"line":146,"column":24}},"47":{"start":{"line":147,"column":4},"end":{"line":147,"column":43}},"48":{"start":{"line":149,"column":4},"end":{"line":152,"column":7}},"49":{"start":{"line":160,"column":0},"end":{"line":165,"column":2}},"50":{"start":{"line":161,"column":4},"end":{"line":164,"column":7}},"51":{"start":{"line":167,"column":0},"end":{"line":167,"column":50}},"52":{"start":{"line":169,"column":0},"end":{"line":169,"column":24}}},"branchMap":{"1":{"line":81,"type":"binary-expr","locations":[{"start":{"line":81,"column":12},"end":{"line":81,"column":16}},{"start":{"line":81,"column":20},"end":{"line":81,"column":52}}]},"2":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":11},"end":{"line":89,"column":41}},{"start":{"line":89,"column":45},"end":{"line":89,"column":60}}]},"3":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":4},"end":{"line":98,"column":4}},{"start":{"line":98,"column":4},"end":{"line":98,"column":4}}]},"4":{"line":98,"type":"binary-expr","locations":[{"start":{"line":98,"column":8},"end":{"line":98,"column":25}},{"start":{"line":98,"column":29},"end":{"line":98,"column":44}}]},"5":{"line":103,"type":"binary-expr","locations":[{"start":{"line":103,"column":12},"end":{"line":103,"column":29}},{"start":{"line":104,"column":12},"end":{"line":104,"column":57}},{"start":{"line":105,"column":11},"end":{"line":105,"column":26}}]},"6":{"line":104,"type":"cond-expr","locations":[{"start":{"line":104,"column":31},"end":{"line":104,"column":50}},{"start":{"line":104,"column":53},"end":{"line":104,"column":57}}]},"7":{"line":122,"type":"binary-expr","locations":[{"start":{"line":122,"column":13},"end":{"line":122,"column":19}},{"start":{"line":122,"column":23},"end":{"line":122,"column":38}}]},"8":{"line":151,"type":"binary-expr","locations":[{"start":{"line":151,"column":17},"end":{"line":151,"column":24}},{"start":{"line":151,"column":28},"end":{"line":151,"column":43}}]}},"code":["var Immutable = require('immutable');","","var TemplateBlock = require('./templateBlock');","var PluginDependency = require('./pluginDependency');","var THEME_PREFIX = require('../constants/themePrefix');","","var DEFAULT_VERSION = '*';","","var Plugin = Immutable.Record({","    name:       String(),","","    // Requirement version (ex: \">1.0.0\")","    version:    String(DEFAULT_VERSION),","","    // Path to load this plugin","    path:       String(),","","    // Depth of this plugin in the dependency tree","    depth:      Number(0),","","    // Parent depending on this plugin","    parent:     String(),","","    // Content of the \"package.json\"","    package:    Immutable.Map(),","","    // Content of the package itself","    content:    Immutable.Map()","}, 'Plugin');","","Plugin.prototype.getName = function() {","    return this.get('name');","};","","Plugin.prototype.getPath = function() {","    return this.get('path');","};","","Plugin.prototype.getVersion = function() {","    return this.get('version');","};","","Plugin.prototype.getPackage = function() {","    return this.get('package');","};","","Plugin.prototype.getContent = function() {","    return this.get('content');","};","","Plugin.prototype.getDepth = function() {","    return this.get('depth');","};","","Plugin.prototype.getParent = function() {","    return this.get('parent');","};","","/**"," * Return the ID on NPM for this plugin"," * @return {String}"," */","Plugin.prototype.getNpmID = function() {","    return PluginDependency.nameToNpmID(this.getName());","};","","/**"," * Check if a plugin is loaded"," * @return {Boolean}"," */","Plugin.prototype.isLoaded = function() {","    return Boolean(this.getPackage().size > 0);","};","","/**"," * Check if a plugin is a theme given its name"," * @return {Boolean}"," */","Plugin.prototype.isTheme = function() {","    var name = this.getName();","    return (name && name.indexOf(THEME_PREFIX) === 0);","};","","/**"," * Return map of hooks"," * @return {Map<String:Function>}"," */","Plugin.prototype.getHooks = function() {","    return this.getContent().get('hooks') || Immutable.Map();","};","","/**"," * Return infos about resources for a specific type"," * @param {String} type"," * @return {Map<String:Mixed>}"," */","Plugin.prototype.getResources = function(type) {","    if (type != 'website' && type != 'ebook') {","        throw new Error('Invalid assets type ' + type);","    }","","    var content = this.getContent();","    return (content.get(type)","        || (type == 'website'? content.get('book') : null)","        || Immutable.Map());","};","","/**"," * Return map of filters"," * @return {Map<String:Function>}"," */","Plugin.prototype.getFilters = function() {","    return this.getContent().get('filters');","};","","/**"," * Return map of blocks"," * @return {Map<String:TemplateBlock>}"," */","Plugin.prototype.getBlocks = function() {","    var blocks = this.getContent().get('blocks');","    blocks = blocks || Immutable.Map();","","    return blocks","        .map(function(block, blockName) {","            return TemplateBlock.create(blockName, block);","        });","};","","/**"," * Return a specific hook"," * @param {String} name"," * @return {Function|undefined}"," */","Plugin.prototype.getHook = function(name) {","    return this.getHooks().get(name);","};","","/**"," * Create a plugin from a string"," * @param {String}"," * @return {Plugin}"," */","Plugin.createFromString = function(s) {","    var parts = s.split('@');","    var name = parts[0];","    var version = parts.slice(1).join('@');","","    return new Plugin({","        name: name,","        version: version || DEFAULT_VERSION","    });","};","","/**"," * Create a plugin from a dependency"," * @param {PluginDependency}"," * @return {Plugin}"," */","Plugin.createFromDep = function(dep) {","    return new Plugin({","        name: dep.getName(),","        version: dep.getVersion()","    });","};","","Plugin.nameToNpmID = PluginDependency.nameToNpmID;","","module.exports = Plugin;",""],"l":{"1":1,"3":1,"4":1,"5":1,"7":1,"9":1,"31":1,"32":0,"35":1,"36":0,"39":1,"40":0,"43":1,"44":0,"47":1,"48":0,"51":1,"52":0,"55":1,"56":0,"63":1,"64":0,"71":1,"72":0,"79":1,"80":0,"81":0,"88":1,"89":0,"97":1,"98":0,"99":0,"102":0,"103":0,"112":1,"113":0,"120":1,"121":0,"122":0,"124":0,"126":0,"135":1,"136":0,"144":1,"145":0,"146":0,"147":0,"149":0,"160":1,"161":0,"167":1,"169":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/templateBlock.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/templateBlock.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":1,"12":0,"13":1,"14":0,"15":1,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":1,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":1,"97":0,"98":0,"99":0,"100":0,"101":1,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":1,"111":0,"112":0,"113":0,"114":0,"115":0,"116":1,"117":0,"118":0,"119":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":34},"end":{"line":28,"column":45}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":36},"end":{"line":32,"column":47}}},"3":{"name":"(anonymous_3)","line":36,"loc":{"start":{"line":36,"column":37},"end":{"line":36,"column":48}}},"4":{"name":"(anonymous_4)","line":40,"loc":{"start":{"line":40,"column":36},"end":{"line":40,"column":47}}},"5":{"name":"(anonymous_5)","line":49,"loc":{"start":{"line":49,"column":39},"end":{"line":49,"column":50}}},"6":{"name":"(anonymous_6)","line":62,"loc":{"start":{"line":62,"column":43},"end":{"line":62,"column":54}}},"7":{"name":"(anonymous_7)","line":70,"loc":{"start":{"line":70,"column":40},"end":{"line":70,"column":76}}},"8":{"name":"Ext","line":78,"loc":{"start":{"line":78,"column":4},"end":{"line":78,"column":19}}},"9":{"name":"(anonymous_9)","line":81,"loc":{"start":{"line":81,"column":21},"end":{"line":81,"column":45}}},"10":{"name":"(anonymous_10)","line":107,"loc":{"start":{"line":107,"column":47},"end":{"line":107,"column":63}}},"11":{"name":"(anonymous_11)","line":129,"loc":{"start":{"line":129,"column":19},"end":{"line":129,"column":37}}},"12":{"name":"(anonymous_12)","line":154,"loc":{"start":{"line":154,"column":31},"end":{"line":154,"column":49}}},"13":{"name":"(anonymous_13)","line":174,"loc":{"start":{"line":174,"column":18},"end":{"line":174,"column":29}}},"14":{"name":"(anonymous_14)","line":181,"loc":{"start":{"line":181,"column":18},"end":{"line":181,"column":35}}},"15":{"name":"(anonymous_15)","line":197,"loc":{"start":{"line":197,"column":37},"end":{"line":197,"column":62}}},"16":{"name":"(anonymous_16)","line":219,"loc":{"start":{"line":219,"column":47},"end":{"line":219,"column":64}}},"17":{"name":"(anonymous_17)","line":234,"loc":{"start":{"line":234,"column":44},"end":{"line":234,"column":75}}},"18":{"name":"(anonymous_18)","line":259,"loc":{"start":{"line":259,"column":23},"end":{"line":259,"column":50}}},"19":{"name":"extractKwargs","line":276,"loc":{"start":{"line":276,"column":0},"end":{"line":276,"column":29}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":31}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":42}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":40}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":53}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":33}},"8":{"start":{"line":11,"column":0},"end":{"line":26,"column":20}},"9":{"start":{"line":28,"column":0},"end":{"line":30,"column":2}},"10":{"start":{"line":29,"column":4},"end":{"line":29,"column":28}},"11":{"start":{"line":32,"column":0},"end":{"line":34,"column":2}},"12":{"start":{"line":33,"column":4},"end":{"line":33,"column":55}},"13":{"start":{"line":36,"column":0},"end":{"line":38,"column":2}},"14":{"start":{"line":37,"column":4},"end":{"line":37,"column":31}},"15":{"start":{"line":40,"column":0},"end":{"line":42,"column":2}},"16":{"start":{"line":41,"column":4},"end":{"line":41,"column":30}},"17":{"start":{"line":49,"column":0},"end":{"line":56,"column":2}},"18":{"start":{"line":50,"column":4},"end":{"line":50,"column":42}},"19":{"start":{"line":51,"column":4},"end":{"line":53,"column":5}},"20":{"start":{"line":52,"column":8},"end":{"line":52,"column":25}},"21":{"start":{"line":55,"column":4},"end":{"line":55,"column":60}},"22":{"start":{"line":62,"column":0},"end":{"line":64,"column":2}},"23":{"start":{"line":63,"column":4},"end":{"line":63,"column":50}},"24":{"start":{"line":70,"column":0},"end":{"line":189,"column":2}},"25":{"start":{"line":71,"column":4},"end":{"line":71,"column":38}},"26":{"start":{"line":73,"column":4},"end":{"line":73,"column":20}},"27":{"start":{"line":74,"column":4},"end":{"line":74,"column":30}},"28":{"start":{"line":75,"column":4},"end":{"line":75,"column":34}},"29":{"start":{"line":76,"column":4},"end":{"line":76,"column":41}},"30":{"start":{"line":78,"column":4},"end":{"line":186,"column":5}},"31":{"start":{"line":79,"column":8},"end":{"line":79,"column":27}},"32":{"start":{"line":81,"column":8},"end":{"line":127,"column":10}},"33":{"start":{"line":82,"column":12},"end":{"line":82,"column":37}},"34":{"start":{"line":83,"column":12},"end":{"line":83,"column":37}},"35":{"start":{"line":84,"column":12},"end":{"line":84,"column":52}},"36":{"start":{"line":87,"column":12},"end":{"line":87,"column":41}},"37":{"start":{"line":88,"column":12},"end":{"line":88,"column":62}},"38":{"start":{"line":89,"column":12},"end":{"line":89,"column":51}},"39":{"start":{"line":91,"column":12},"end":{"line":91,"column":44}},"40":{"start":{"line":92,"column":12},"end":{"line":92,"column":28}},"41":{"start":{"line":93,"column":12},"end":{"line":93,"column":72}},"42":{"start":{"line":94,"column":12},"end":{"line":94,"column":72}},"43":{"start":{"line":97,"column":12},"end":{"line":120,"column":46}},"44":{"start":{"line":99,"column":16},"end":{"line":99,"column":83}},"45":{"start":{"line":102,"column":16},"end":{"line":102,"column":99}},"46":{"start":{"line":103,"column":16},"end":{"line":103,"column":115}},"47":{"start":{"line":104,"column":16},"end":{"line":104,"column":41}},"48":{"start":{"line":107,"column":16},"end":{"line":109,"column":19}},"49":{"start":{"line":108,"column":20},"end":{"line":108,"column":41}},"50":{"start":{"line":112,"column":16},"end":{"line":112,"column":57}},"51":{"start":{"line":115,"column":16},"end":{"line":117,"column":17}},"52":{"start":{"line":116,"column":20},"end":{"line":116,"column":70}},"53":{"start":{"line":119,"column":16},"end":{"line":119,"column":59}},"54":{"start":{"line":122,"column":12},"end":{"line":122,"column":42}},"55":{"start":{"line":123,"column":12},"end":{"line":123,"column":42}},"56":{"start":{"line":124,"column":12},"end":{"line":124,"column":84}},"57":{"start":{"line":126,"column":12},"end":{"line":126,"column":75}},"58":{"start":{"line":129,"column":8},"end":{"line":185,"column":10}},"59":{"start":{"line":130,"column":12},"end":{"line":130,"column":66}},"60":{"start":{"line":132,"column":12},"end":{"line":132,"column":21}},"61":{"start":{"line":133,"column":12},"end":{"line":133,"column":28}},"62":{"start":{"line":134,"column":12},"end":{"line":134,"column":28}},"63":{"start":{"line":135,"column":12},"end":{"line":135,"column":27}},"64":{"start":{"line":136,"column":12},"end":{"line":136,"column":31}},"65":{"start":{"line":137,"column":12},"end":{"line":137,"column":25}},"66":{"start":{"line":140,"column":12},"end":{"line":140,"column":36}},"67":{"start":{"line":143,"column":12},"end":{"line":143,"column":59}},"68":{"start":{"line":146,"column":12},"end":{"line":146,"column":48}},"69":{"start":{"line":147,"column":12},"end":{"line":147,"column":51}},"70":{"start":{"line":150,"column":12},"end":{"line":150,"column":40}},"71":{"start":{"line":151,"column":12},"end":{"line":151,"column":36}},"72":{"start":{"line":154,"column":12},"end":{"line":168,"column":15}},"73":{"start":{"line":155,"column":16},"end":{"line":155,"column":50}},"74":{"start":{"line":156,"column":16},"end":{"line":156,"column":47}},"75":{"start":{"line":158,"column":16},"end":{"line":158,"column":77}},"76":{"start":{"line":159,"column":16},"end":{"line":159,"column":45}},"77":{"start":{"line":160,"column":16},"end":{"line":160,"column":59}},"78":{"start":{"line":162,"column":16},"end":{"line":167,"column":19}},"79":{"start":{"line":170,"column":12},"end":{"line":170,"column":43}},"80":{"start":{"line":171,"column":12},"end":{"line":171,"column":38}},"81":{"start":{"line":173,"column":12},"end":{"line":184,"column":31}},"82":{"start":{"line":175,"column":16},"end":{"line":177,"column":38}},"83":{"start":{"line":179,"column":16},"end":{"line":179,"column":55}},"84":{"start":{"line":182,"column":16},"end":{"line":182,"column":68}},"85":{"start":{"line":188,"column":4},"end":{"line":188,"column":15}},"86":{"start":{"line":197,"column":0},"end":{"line":212,"column":2}},"87":{"start":{"line":198,"column":4},"end":{"line":198,"column":38}},"88":{"start":{"line":200,"column":4},"end":{"line":200,"column":24}},"89":{"start":{"line":201,"column":4},"end":{"line":201,"column":34}},"90":{"start":{"line":202,"column":4},"end":{"line":202,"column":38}},"91":{"start":{"line":203,"column":4},"end":{"line":203,"column":38}},"92":{"start":{"line":205,"column":4},"end":{"line":205,"column":43}},"93":{"start":{"line":207,"column":4},"end":{"line":211,"column":5}},"94":{"start":{"line":208,"column":8},"end":{"line":208,"column":60}},"95":{"start":{"line":210,"column":8},"end":{"line":210,"column":44}},"96":{"start":{"line":219,"column":0},"end":{"line":226,"column":2}},"97":{"start":{"line":220,"column":4},"end":{"line":222,"column":5}},"98":{"start":{"line":221,"column":8},"end":{"line":221,"column":34}},"99":{"start":{"line":223,"column":4},"end":{"line":223,"column":33}},"100":{"start":{"line":225,"column":4},"end":{"line":225,"column":18}},"101":{"start":{"line":234,"column":0},"end":{"line":251,"column":2}},"102":{"start":{"line":235,"column":4},"end":{"line":235,"column":19}},"103":{"start":{"line":236,"column":4},"end":{"line":236,"column":65}},"104":{"start":{"line":238,"column":4},"end":{"line":241,"column":5}},"105":{"start":{"line":239,"column":8},"end":{"line":239,"column":30}},"106":{"start":{"line":240,"column":8},"end":{"line":240,"column":42}},"107":{"start":{"line":244,"column":4},"end":{"line":246,"column":5}},"108":{"start":{"line":245,"column":8},"end":{"line":245,"column":27}},"109":{"start":{"line":249,"column":4},"end":{"line":249,"column":40}},"110":{"start":{"line":259,"column":0},"end":{"line":269,"column":2}},"111":{"start":{"line":260,"column":4},"end":{"line":264,"column":5}},"112":{"start":{"line":261,"column":8},"end":{"line":263,"column":11}},"113":{"start":{"line":266,"column":4},"end":{"line":266,"column":37}},"114":{"start":{"line":267,"column":4},"end":{"line":267,"column":41}},"115":{"start":{"line":268,"column":4},"end":{"line":268,"column":17}},"116":{"start":{"line":276,"column":0},"end":{"line":279,"column":1}},"117":{"start":{"line":277,"column":4},"end":{"line":277,"column":37}},"118":{"start":{"line":278,"column":4},"end":{"line":278,"column":65}},"119":{"start":{"line":281,"column":0},"end":{"line":281,"column":31}}},"branchMap":{"1":{"line":33,"type":"binary-expr","locations":[{"start":{"line":33,"column":11},"end":{"line":33,"column":26}},{"start":{"line":33,"column":31},"end":{"line":33,"column":53}}]},"2":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":4},"end":{"line":51,"column":4}},{"start":{"line":51,"column":4},"end":{"line":51,"column":4}}]},"3":{"line":71,"type":"binary-expr","locations":[{"start":{"line":71,"column":19},"end":{"line":71,"column":31}},{"start":{"line":71,"column":35},"end":{"line":71,"column":37}}]},"4":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":16},"end":{"line":115,"column":16}},{"start":{"line":115,"column":16},"end":{"line":115,"column":16}}]},"5":{"line":158,"type":"cond-expr","locations":[{"start":{"line":158,"column":47},"end":{"line":158,"column":71}},{"start":{"line":158,"column":74},"end":{"line":158,"column":76}}]},"6":{"line":177,"type":"binary-expr","locations":[{"start":{"line":177,"column":19},"end":{"line":177,"column":30}},{"start":{"line":177,"column":34},"end":{"line":177,"column":36}}]},"7":{"line":200,"type":"binary-expr","locations":[{"start":{"line":200,"column":12},"end":{"line":200,"column":17}},{"start":{"line":200,"column":21},"end":{"line":200,"column":23}}]},"8":{"line":201,"type":"binary-expr","locations":[{"start":{"line":201,"column":17},"end":{"line":201,"column":27}},{"start":{"line":201,"column":31},"end":{"line":201,"column":33}}]},"9":{"line":202,"type":"binary-expr","locations":[{"start":{"line":202,"column":19},"end":{"line":202,"column":31}},{"start":{"line":202,"column":35},"end":{"line":202,"column":37}}]},"10":{"line":203,"type":"binary-expr","locations":[{"start":{"line":203,"column":19},"end":{"line":203,"column":31}},{"start":{"line":203,"column":35},"end":{"line":203,"column":37}}]},"11":{"line":207,"type":"if","locations":[{"start":{"line":207,"column":4},"end":{"line":207,"column":4}},{"start":{"line":207,"column":4},"end":{"line":207,"column":4}}]},"12":{"line":220,"type":"if","locations":[{"start":{"line":220,"column":4},"end":{"line":220,"column":4}},{"start":{"line":220,"column":4},"end":{"line":220,"column":4}}]},"13":{"line":236,"type":"binary-expr","locations":[{"start":{"line":236,"column":19},"end":{"line":236,"column":32}},{"start":{"line":236,"column":38},"end":{"line":236,"column":63}}]},"14":{"line":238,"type":"if","locations":[{"start":{"line":238,"column":4},"end":{"line":238,"column":4}},{"start":{"line":238,"column":4},"end":{"line":238,"column":4}}]},"15":{"line":244,"type":"if","locations":[{"start":{"line":244,"column":4},"end":{"line":244,"column":4}},{"start":{"line":244,"column":4},"end":{"line":244,"column":4}}]},"16":{"line":260,"type":"if","locations":[{"start":{"line":260,"column":4},"end":{"line":260,"column":4}},{"start":{"line":260,"column":4},"end":{"line":260,"column":4}}]},"17":{"line":278,"type":"cond-expr","locations":[{"start":{"line":278,"column":49},"end":{"line":278,"column":59}},{"start":{"line":278,"column":62},"end":{"line":278,"column":64}}]},"18":{"line":278,"type":"binary-expr","locations":[{"start":{"line":278,"column":12},"end":{"line":278,"column":27}},{"start":{"line":278,"column":31},"end":{"line":278,"column":46}}]}},"code":["var is = require('is');","var extend = require('extend');","var Immutable = require('immutable');","","var Promise = require('../utils/promise');","var genKey = require('../utils/genKey');","var TemplateShortcut = require('./templateShortcut');","","var NODE_ENDARGS = '%%endargs%%';","","var TemplateBlock = Immutable.Record({","    // Name of block, also the start tag","    name:           String(),","","    // End tag, default to \"end<name>\"","    end:            String(),","","    // Function to process the block content","    process:        Function(),","","    // List of String, for inner block tags","    blocks:         Immutable.List(),","","    // List of shortcuts to replace with this block","    shortcuts:      Immutable.Map()","}, 'TemplateBlock');","","TemplateBlock.prototype.getName = function() {","    return this.get('name');","};","","TemplateBlock.prototype.getEndTag = function() {","    return this.get('end') || ('end' + this.getName());","};","","TemplateBlock.prototype.getProcess = function() {","    return this.get('process');","};","","TemplateBlock.prototype.getBlocks = function() {","    return this.get('blocks');","};","","","/**"," * Return shortcuts associated with this block or undefined"," * @return {TemplateShortcut|undefined}"," */","TemplateBlock.prototype.getShortcuts = function() {","    var shortcuts = this.get('shortcuts');","    if (shortcuts.size === 0) {","        return undefined;","    }","","    return TemplateShortcut.createForBlock(this, shortcuts);","};","","/**"," * Return name for the nunjucks extension"," * @return {String}"," */","TemplateBlock.prototype.getExtensionName = function() {","    return 'Block' + this.getName() + 'Extension';","};","","/**"," * Return a nunjucks extension to represents this block"," * @return {Nunjucks.Extension}"," */","TemplateBlock.prototype.toNunjucksExt = function(mainContext, blocksOutput) {","    blocksOutput = blocksOutput || {};","","    var that = this;","    var name = this.getName();","    var endTag = this.getEndTag();","    var blocks = this.getBlocks().toJS();","","    function Ext() {","        this.tags = [name];","","        this.parse = function(parser, nodes) {","            var lastBlockName = null;","            var lastBlockArgs = null;","            var allBlocks = blocks.concat([endTag]);","","            // Parse first block","            var tok = parser.nextToken();","            lastBlockArgs = parser.parseSignature(null, true);","            parser.advanceAfterBlockEnd(tok.value);","","            var args = new nodes.NodeList();","            var bodies = [];","            var blockNamesNode = new nodes.Array(tok.lineno, tok.colno);","            var blockArgCounts = new nodes.Array(tok.lineno, tok.colno);","","            // Parse while we found \"end<block>\"","            do {","                // Read body","                var currentBody = parser.parseUntilBlocks.apply(parser, allBlocks);","","                // Handle body with previous block name and args","                blockNamesNode.addChild(new nodes.Literal(args.lineno, args.colno, lastBlockName));","                blockArgCounts.addChild(new nodes.Literal(args.lineno, args.colno, lastBlockArgs.children.length));","                bodies.push(currentBody);","","                // Append arguments of this block as arguments of the run function","                lastBlockArgs.children.forEach(function(child) {","                    args.addChild(child);","                });","","                // Read new block","                lastBlockName = parser.nextToken().value;","","                // Parse signature and move to the end of the block","                if (lastBlockName != endTag) {","                    lastBlockArgs = parser.parseSignature(null, true);","                }","","                parser.advanceAfterBlockEnd(lastBlockName);","            } while (lastBlockName != endTag);","","            args.addChild(blockNamesNode);","            args.addChild(blockArgCounts);","            args.addChild(new nodes.Literal(args.lineno, args.colno, NODE_ENDARGS));","","            return new nodes.CallExtensionAsync(this, 'run', args, bodies);","        };","","        this.run = function(context) {","            var fnArgs = Array.prototype.slice.call(arguments, 1);","","            var args;","            var blocks = [];","            var bodies = [];","            var blockNames;","            var blockArgCounts;","            var callback;","","            // Extract callback","            callback = fnArgs.pop();","","            // Detect end of arguments","            var endArgIndex = fnArgs.indexOf(NODE_ENDARGS);","","            // Extract arguments and bodies","            args = fnArgs.slice(0, endArgIndex);","            bodies = fnArgs.slice(endArgIndex + 1);","","            // Extract block counts","            blockArgCounts = args.pop();","            blockNames = args.pop();","","            // Recreate list of blocks","            blockNames.forEach(function(name, i) {","                var countArgs = blockArgCounts[i];","                var blockBody = bodies.shift();","","                var blockArgs = countArgs > 0? args.slice(0, countArgs) : [];","                args = args.slice(countArgs);","                var blockKwargs = extractKwargs(blockArgs);","","                blocks.push({","                    name: name,","                    body: blockBody(),","                    args: blockArgs,","                    kwargs: blockKwargs","                });","            });","","            var mainBlock = blocks.shift();","            mainBlock.blocks = blocks;","","            Promise()","            .then(function() {","                var ctx = extend({","                    ctx: context","                }, mainContext || {});","","                return that.applyBlock(mainBlock, ctx);","            })","            .then(function(result) {","                return that.blockResultToHtml(result, blocksOutput);","            })","            .nodeify(callback);","        };","    }","","    return Ext;","};","","/**"," * Apply a block to a content"," * @param {Object} inner"," * @param {Object} context"," * @return {Promise<String>|String}"," */","TemplateBlock.prototype.applyBlock = function(inner, context) {","    var processFn = this.getProcess();","","    inner = inner || {};","    inner.args = inner.args || [];","    inner.kwargs = inner.kwargs || {};","    inner.blocks = inner.blocks || [];","","    var r = processFn.call(context, inner);","","    if (Promise.isPromiseAlike(r)) {","        return r.then(this.normalizeBlockResult.bind(this));","    } else {","        return this.normalizeBlockResult(r);","    }","};","","/**"," * Normalize result from a block process function"," * @param {Object|String} result"," * @return {Object}"," */","TemplateBlock.prototype.normalizeBlockResult = function(result) {","    if (is.string(result)) {","        result = { body: result };","    }","    result.name = this.getName();","","    return result;","};","","/**"," * Convert a block result to HTML"," * @param {Object} result"," * @param {Object} blocksOutput: stored post processing blocks in this object"," * @return {String}"," */","TemplateBlock.prototype.blockResultToHtml = function(result, blocksOutput) {","    var indexedKey;","    var toIndex = (!result.parse) || (result.post !== undefined);","","    if (toIndex) {","        indexedKey = genKey();","        blocksOutput[indexedKey] = result;","    }","","    // Parsable block, just return it","    if (result.parse) {","        return result.body;","    }","","    // Return it as a position marker","    return '{{-%' + indexedKey + '%-}}';","","};","","/**"," * Create a template block from a function or an object"," * @param {String} blockName"," * @param {Object} block"," * @return {TemplateBlock}"," */","TemplateBlock.create = function(blockName, block) {","    if (is.fn(block)) {","        block = new Immutable.Map({","            process: block","        });","    }","","    block = new TemplateBlock(block);","    block = block.set('name', blockName);","    return block;","};","","/**"," * Extract kwargs from an arguments array"," * @param {Array} args"," * @return {Object}"," */","function extractKwargs(args) {","    var last = args[args.length - 1];","    return (is.object(last) && last.__keywords)? args.pop() : {};","}","","module.exports = TemplateBlock;",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"7":1,"9":1,"11":1,"28":1,"29":0,"32":1,"33":0,"36":1,"37":0,"40":1,"41":0,"49":1,"50":0,"51":0,"52":0,"55":0,"62":1,"63":0,"70":1,"71":0,"73":0,"74":0,"75":0,"76":0,"78":1,"79":0,"81":0,"82":0,"83":0,"84":0,"87":0,"88":0,"89":0,"91":0,"92":0,"93":0,"94":0,"97":0,"99":0,"102":0,"103":0,"104":0,"107":0,"108":0,"112":0,"115":0,"116":0,"119":0,"122":0,"123":0,"124":0,"126":0,"129":0,"130":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"140":0,"143":0,"146":0,"147":0,"150":0,"151":0,"154":0,"155":0,"156":0,"158":0,"159":0,"160":0,"162":0,"170":0,"171":0,"173":0,"175":0,"179":0,"182":0,"188":0,"197":1,"198":0,"200":0,"201":0,"202":0,"203":0,"205":0,"207":0,"208":0,"210":0,"219":1,"220":0,"221":0,"223":0,"225":0,"234":1,"235":0,"236":0,"238":0,"239":0,"240":0,"244":0,"245":0,"249":0,"259":1,"260":0,"261":0,"266":0,"267":0,"268":0,"276":1,"277":0,"278":0,"281":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/genKey.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/genKey.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"generateKey","line":7,"loc":{"start":{"line":7,"column":0},"end":{"line":7,"column":23}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":16}},"2":{"start":{"line":7,"column":0},"end":{"line":11,"column":1}},"3":{"start":{"line":8,"column":4},"end":{"line":8,"column":17}},"4":{"start":{"line":9,"column":4},"end":{"line":9,"column":35}},"5":{"start":{"line":10,"column":4},"end":{"line":10,"column":43}},"6":{"start":{"line":13,"column":0},"end":{"line":13,"column":29}}},"branchMap":{},"code":["var lastKey = 0;","","/*","    Generate a random key","    @return {String}","*/","function generateKey() {","    lastKey += 1;","    var str = lastKey.toString(16);","    return '00000'.slice(str.length) + str;","}","","module.exports = generateKey;",""],"l":{"1":1,"7":1,"8":0,"9":0,"10":0,"13":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/templateShortcut.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/templateShortcut.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":1,"11":0,"12":1,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":19,"loc":{"start":{"line":19,"column":38},"end":{"line":19,"column":49}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":36},"end":{"line":23,"column":47}}},"3":{"name":"(anonymous_3)","line":27,"loc":{"start":{"line":27,"column":41},"end":{"line":27,"column":52}}},"4":{"name":"(anonymous_4)","line":31,"loc":{"start":{"line":31,"column":39},"end":{"line":31,"column":50}}},"5":{"name":"(anonymous_5)","line":35,"loc":{"start":{"line":35,"column":40},"end":{"line":35,"column":51}}},"6":{"name":"(anonymous_6)","line":45,"loc":{"start":{"line":45,"column":42},"end":{"line":45,"column":59}}},"7":{"name":"(anonymous_7)","line":61,"loc":{"start":{"line":61,"column":34},"end":{"line":61,"column":59}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":23}},"3":{"start":{"line":8,"column":0},"end":{"line":17,"column":23}},"4":{"start":{"line":19,"column":0},"end":{"line":21,"column":2}},"5":{"start":{"line":20,"column":4},"end":{"line":20,"column":29}},"6":{"start":{"line":23,"column":0},"end":{"line":25,"column":2}},"7":{"start":{"line":24,"column":4},"end":{"line":24,"column":27}},"8":{"start":{"line":27,"column":0},"end":{"line":29,"column":2}},"9":{"start":{"line":28,"column":4},"end":{"line":28,"column":32}},"10":{"start":{"line":31,"column":0},"end":{"line":33,"column":2}},"11":{"start":{"line":32,"column":4},"end":{"line":32,"column":30}},"12":{"start":{"line":35,"column":0},"end":{"line":37,"column":2}},"13":{"start":{"line":36,"column":4},"end":{"line":36,"column":31}},"14":{"start":{"line":45,"column":0},"end":{"line":52,"column":2}},"15":{"start":{"line":46,"column":4},"end":{"line":48,"column":5}},"16":{"start":{"line":47,"column":8},"end":{"line":47,"column":34}},"17":{"start":{"line":50,"column":4},"end":{"line":50,"column":42}},"18":{"start":{"line":51,"column":4},"end":{"line":51,"column":40}},"19":{"start":{"line":61,"column":0},"end":{"line":71,"column":2}},"20":{"start":{"line":62,"column":4},"end":{"line":62,"column":40}},"21":{"start":{"line":64,"column":4},"end":{"line":70,"column":7}},"22":{"start":{"line":73,"column":0},"end":{"line":73,"column":34}}},"branchMap":{"1":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":4},"end":{"line":46,"column":4}},{"start":{"line":46,"column":4},"end":{"line":46,"column":4}}]}},"code":["var Immutable = require('immutable');","var is = require('is');","","/*","    A TemplateShortcut is defined in plugin's template blocks","    to replace content with a templating block using delimiters.","*/","var TemplateShortcut = Immutable.Record({","    // List of parser names accepting this shortcut","    parsers:     Immutable.Map(),","","    start:       String(),","    end:         String(),","","    startTag:    String(),","    endTag:      String()","}, 'TemplateShortcut');","","TemplateShortcut.prototype.getStart = function() {","    return this.get('start');","};","","TemplateShortcut.prototype.getEnd = function() {","    return this.get('end');","};","","TemplateShortcut.prototype.getStartTag = function() {","    return this.get('startTag');","};","","TemplateShortcut.prototype.getEndTag = function() {","    return this.get('endTag');","};","","TemplateShortcut.prototype.getParsers = function() {","    return this.get('parsers');","};","","/**","    Test if this shortcut accept a parser","","    @param {Parser|String} parser","    @return {Boolean}","*/","TemplateShortcut.prototype.acceptParser = function(parser) {","    if (!is.string(parser)) {","        parser = parser.getName();","    }","","    var parserNames = this.get('parsers');","    return parserNames.includes(parser);","};","","/**","    Create a shortcut for a block","","    @param {TemplateBlock} block","    @param {Map} details","    @return {TemplateShortcut}","*/","TemplateShortcut.createForBlock = function(block, details) {","    details = Immutable.fromJS(details);","","    return new TemplateShortcut({","        parsers:        details.get('parsers'),","        start:          details.get('start'),","        end:            details.get('end'),","        startTag:       block.getName(),","        endTag:         block.getEndTag()","    });","};","","module.exports = TemplateShortcut;",""],"l":{"1":1,"2":1,"8":1,"19":1,"20":0,"23":1,"24":0,"27":1,"28":0,"31":1,"32":0,"35":1,"36":0,"45":1,"46":0,"47":0,"50":0,"51":0,"61":1,"62":0,"64":0,"73":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/locateRootFolder.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/locateRootFolder.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"locateRootFolder","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":61}},"4":{"start":{"line":12,"column":0},"end":{"line":20,"column":1}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":53}},"6":{"start":{"line":14,"column":4},"end":{"line":16,"column":7}},"7":{"start":{"line":17,"column":4},"end":{"line":17,"column":59}},"8":{"start":{"line":19,"column":4},"end":{"line":19,"column":23}},"9":{"start":{"line":22,"column":0},"end":{"line":22,"column":34}}},"branchMap":{},"code":["var path = require('path');","var resolve = require('resolve');","","var DEFAULT_PLUGINS = require('../constants/defaultPlugins');","","/**"," * Resolve the root folder containing for node_modules"," * since gitbook can be used as a library and dependency can be flattened."," *"," * @return {String} folderPath"," */","function locateRootFolder() {","    var firstDefaultPlugin = DEFAULT_PLUGINS.first();","    var pluginPath = resolve.sync(firstDefaultPlugin.getNpmID() + '/package.json', {","        basedir: __dirname","    });","    var nodeModules = path.resolve(pluginPath, '../../..');","","    return nodeModules;","}","","module.exports = locateRootFolder;",""],"l":{"1":1,"2":1,"4":1,"12":1,"13":0,"14":0,"17":0,"19":0,"22":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/loadPlugin.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/loadPlugin.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"isModuleNotFound","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":31}}},"2":{"name":"loadPlugin","line":25,"loc":{"start":{"line":25,"column":0},"end":{"line":25,"column":34}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":10},"end":{"line":33,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":42}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":38}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":40}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":49}},"8":{"start":{"line":13,"column":0},"end":{"line":15,"column":1}},"9":{"start":{"line":14,"column":4},"end":{"line":14,"column":92}},"10":{"start":{"line":25,"column":0},"end":{"line":86,"column":1}},"11":{"start":{"line":26,"column":4},"end":{"line":26,"column":34}},"12":{"start":{"line":28,"column":4},"end":{"line":28,"column":32}},"13":{"start":{"line":29,"column":4},"end":{"line":29,"column":35}},"14":{"start":{"line":32,"column":4},"end":{"line":80,"column":26}},"15":{"start":{"line":34,"column":8},"end":{"line":34,"column":27}},"16":{"start":{"line":35,"column":8},"end":{"line":35,"column":24}},"17":{"start":{"line":36,"column":8},"end":{"line":36,"column":20}},"18":{"start":{"line":39,"column":8},"end":{"line":51,"column":9}},"19":{"start":{"line":40,"column":12},"end":{"line":40,"column":75}},"20":{"start":{"line":42,"column":12},"end":{"line":42,"column":40}},"21":{"start":{"line":43,"column":12},"end":{"line":43,"column":42}},"22":{"start":{"line":45,"column":12},"end":{"line":45,"column":50}},"23":{"start":{"line":45,"column":40},"end":{"line":45,"column":50}},"24":{"start":{"line":47,"column":12},"end":{"line":47,"column":39}},"25":{"start":{"line":48,"column":12},"end":{"line":48,"column":32}},"26":{"start":{"line":50,"column":12},"end":{"line":50,"column":19}},"27":{"start":{"line":54,"column":8},"end":{"line":60,"column":9}},"28":{"start":{"line":55,"column":12},"end":{"line":55,"column":76}},"29":{"start":{"line":56,"column":12},"end":{"line":56,"column":77}},"30":{"start":{"line":58,"column":12},"end":{"line":58,"column":50}},"31":{"start":{"line":58,"column":40},"end":{"line":58,"column":50}},"32":{"start":{"line":59,"column":12},"end":{"line":59,"column":36}},"33":{"start":{"line":63,"column":8},"end":{"line":71,"column":9}},"34":{"start":{"line":64,"column":12},"end":{"line":70,"column":13}},"35":{"start":{"line":65,"column":16},"end":{"line":65,"column":47}},"36":{"start":{"line":67,"column":16},"end":{"line":69,"column":19}},"37":{"start":{"line":74,"column":8},"end":{"line":77,"column":11}},"38":{"start":{"line":82,"column":4},"end":{"line":82,"column":41}},"39":{"start":{"line":84,"column":4},"end":{"line":84,"column":53}},"40":{"start":{"line":85,"column":4},"end":{"line":85,"column":34}},"41":{"start":{"line":89,"column":0},"end":{"line":89,"column":28}}},"branchMap":{"1":{"line":14,"type":"binary-expr","locations":[{"start":{"line":14,"column":11},"end":{"line":14,"column":41}},{"start":{"line":14,"column":45},"end":{"line":14,"column":91}}]},"2":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":12},"end":{"line":45,"column":12}},{"start":{"line":45,"column":12},"end":{"line":45,"column":12}}]},"3":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":41},"end":{"line":55,"column":60}},{"start":{"line":55,"column":64},"end":{"line":55,"column":74}}]},"4":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":12},"end":{"line":58,"column":12}},{"start":{"line":58,"column":12},"end":{"line":58,"column":12}}]},"5":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":8},"end":{"line":63,"column":8}},{"start":{"line":63,"column":8},"end":{"line":63,"column":8}}]},"6":{"line":76,"type":"binary-expr","locations":[{"start":{"line":76,"column":40},"end":{"line":76,"column":47}},{"start":{"line":76,"column":51},"end":{"line":76,"column":53}}]}},"code":["var path = require('path');","var resolve = require('resolve');","var Immutable = require('immutable');","","var Promise = require('../utils/promise');","var error = require('../utils/error');","var timing = require('../utils/timing');","","var validatePlugin = require('./validatePlugin');","","// Return true if an error is a \"module not found\"","// Wait on https://github.com/substack/node-resolve/pull/81 to be merged","function isModuleNotFound(err) {","    return err.code == 'MODULE_NOT_FOUND' || err.message.indexOf('Cannot find module') >= 0;","}","","/**","    Load a plugin in a book","","    @param {Book} book","    @param {Plugin} plugin","    @param {String} pkgPath (optional)","    @return {Promise<Plugin>}","*/","function loadPlugin(book, plugin) {","    var logger = book.getLogger();","","    var name = plugin.getName();","    var pkgPath = plugin.getPath();","","    // Try loading plugins from different location","    var p = Promise()","    .then(function() {","        var packageContent;","        var packageMain;","        var content;","","        // Locate plugin and load package.json","        try {","            var res = resolve.sync('./package.json', { basedir: pkgPath });","","            pkgPath = path.dirname(res);","            packageContent = require(res);","        } catch (err) {","            if (!isModuleNotFound(err)) throw err;","","            packageContent = undefined;","            content = undefined;","","            return;","        }","","        // Locate the main package","        try {","            var indexJs = path.normalize(packageContent.main || 'index.js');","            packageMain = resolve.sync('./' + indexJs, { basedir: pkgPath });","        } catch (err) {","            if (!isModuleNotFound(err)) throw err;","            packageMain = undefined;","        }","","        // Load plugin JS content","        if (packageMain) {","            try {","                content = require(packageMain);","            } catch(err) {","                throw new error.PluginError(err, {","                    plugin: name","                });","            }","        }","","        // Update plugin","        return plugin.merge({","            'package': Immutable.fromJS(packageContent),","            'content': Immutable.fromJS(content || {})","        });","    })","","    .then(validatePlugin);","","    p = timing.measure('plugin.load', p);","","    logger.info('loading plugin \"' + name + '\"... ');","    return logger.info.promise(p);","}","","","module.exports = loadPlugin;",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"7":1,"9":1,"13":1,"14":0,"25":1,"26":0,"28":0,"29":0,"32":0,"34":0,"35":0,"36":0,"39":0,"40":0,"42":0,"43":0,"45":0,"47":0,"48":0,"50":0,"54":0,"55":0,"56":0,"58":0,"59":0,"63":0,"64":0,"65":0,"67":0,"74":0,"82":0,"84":0,"85":0,"89":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/validatePlugin.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/validatePlugin.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1},"b":{"1":[0,0,0,0,0],"2":[0,0],"3":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"validatePlugin","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":36}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"3":{"start":{"line":11,"column":0},"end":{"line":32,"column":1}},"4":{"start":{"line":12,"column":4},"end":{"line":12,"column":43}},"5":{"start":{"line":14,"column":4},"end":{"line":20,"column":6}},"6":{"start":{"line":22,"column":4},"end":{"line":24,"column":5}},"7":{"start":{"line":23,"column":8},"end":{"line":23,"column":122}},"8":{"start":{"line":26,"column":4},"end":{"line":26,"column":60}},"9":{"start":{"line":27,"column":4},"end":{"line":29,"column":5}},"10":{"start":{"line":28,"column":8},"end":{"line":28,"column":112}},"11":{"start":{"line":31,"column":4},"end":{"line":31,"column":27}},"12":{"start":{"line":34,"column":0},"end":{"line":34,"column":32}}},"branchMap":{"1":{"line":15,"type":"binary-expr","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":25}},{"start":{"line":16,"column":8},"end":{"line":16,"column":20}},{"start":{"line":17,"column":8},"end":{"line":17,"column":32}},{"start":{"line":18,"column":8},"end":{"line":18,"column":35}},{"start":{"line":19,"column":8},"end":{"line":19,"column":50}}]},"2":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":22,"column":4}},{"start":{"line":22,"column":4},"end":{"line":22,"column":4}}]},"3":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":4}},{"start":{"line":27,"column":4},"end":{"line":27,"column":4}}]}},"code":["var gitbook = require('../gitbook');","","var Promise = require('../utils/promise');","","/**","    Validate a plugin","","    @param {Plugin}","    @return {Promise<Plugin>}","*/","function validatePlugin(plugin) {","    var packageInfos = plugin.getPackage();","","    var isValid = (","        plugin.isLoaded() &&","        packageInfos &&","        packageInfos.get('name') &&","        packageInfos.get('engines') &&","        packageInfos.get('engines').get('gitbook')","    );","","    if (!isValid) {","        return Promise.reject(new Error('Error loading plugin \"' + plugin.getName() + '\" at \"' + plugin.getPath() + '\"'));","    }","","    var engine = packageInfos.get('engines').get('gitbook');","    if (!gitbook.satisfies(engine)) {","        return Promise.reject(new Error('GitBook doesn\\'t satisfy the requirements of this plugin: ' + engine));","    }","","    return Promise(plugin);","}","","module.exports = validatePlugin;",""],"l":{"1":1,"3":1,"11":1,"12":0,"14":0,"22":0,"23":0,"26":0,"27":0,"28":0,"31":0,"34":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/validateConfig.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/validateConfig.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"validatePluginConfig","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":44}}},"2":{"name":"validateConfig","line":65,"loc":{"start":{"line":65,"column":0},"end":{"line":65,"column":39}}},"3":{"name":"(anonymous_3)","line":66,"loc":{"start":{"line":66,"column":35},"end":{"line":66,"column":61}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":39}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":57}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":42}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":38}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":54}},"7":{"start":{"line":16,"column":0},"end":{"line":55,"column":1}},"8":{"start":{"line":17,"column":4},"end":{"line":17,"column":34}},"9":{"start":{"line":18,"column":4},"end":{"line":18,"column":43}},"10":{"start":{"line":20,"column":4},"end":{"line":23,"column":16}},"11":{"start":{"line":25,"column":4},"end":{"line":25,"column":61}},"12":{"start":{"line":27,"column":4},"end":{"line":27,"column":73}},"13":{"start":{"line":28,"column":4},"end":{"line":28,"column":29}},"14":{"start":{"line":28,"column":17},"end":{"line":28,"column":29}},"15":{"start":{"line":31,"column":4},"end":{"line":31,"column":32}},"16":{"start":{"line":32,"column":4},"end":{"line":32,"column":27}},"17":{"start":{"line":35,"column":4},"end":{"line":35,"column":39}},"18":{"start":{"line":36,"column":4},"end":{"line":38,"column":7}},"19":{"start":{"line":41,"column":4},"end":{"line":43,"column":5}},"20":{"start":{"line":42,"column":8},"end":{"line":42,"column":78}},"21":{"start":{"line":46,"column":4},"end":{"line":46,"column":46}},"22":{"start":{"line":47,"column":4},"end":{"line":47,"column":57}},"23":{"start":{"line":51,"column":4},"end":{"line":51,"column":54}},"24":{"start":{"line":54,"column":4},"end":{"line":54,"column":38}},"25":{"start":{"line":65,"column":0},"end":{"line":69,"column":1}},"26":{"start":{"line":66,"column":4},"end":{"line":68,"column":13}},"27":{"start":{"line":67,"column":8},"end":{"line":67,"column":53}},"28":{"start":{"line":71,"column":0},"end":{"line":71,"column":32}}},"branchMap":{"1":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":18},"end":{"line":27,"column":45}},{"start":{"line":27,"column":49},"end":{"line":27,"column":64}}]},"2":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":28,"column":4}},{"start":{"line":28,"column":4},"end":{"line":28,"column":4}}]},"3":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":41,"column":4}},{"start":{"line":41,"column":4},"end":{"line":41,"column":4}}]}},"code":["var Immutable = require('immutable');","var jsonschema = require('jsonschema');","var jsonSchemaDefaults = require('json-schema-defaults');","","var Promise = require('../utils/promise');","var error = require('../utils/error');","var mergeDefaults = require('../utils/mergeDefaults');","","/**","    Validate one plugin for a book and update book's confiration","","    @param {Book}","    @param {Plugin}","    @return {Book}","*/","function validatePluginConfig(book, plugin) {","    var config = book.getConfig();","    var packageInfos = plugin.getPackage();","","    var configKey = [","        'pluginsConfig',","        plugin.getName()","    ].join('.');","","    var pluginConfig = config.getValue(configKey, {}).toJS();","","    var schema = (packageInfos.get('gitbook') || Immutable.Map()).toJS();","    if (!schema) return book;","","    // Normalize schema","    schema.id = '/' + configKey;","    schema.type = 'object';","","    // Validate and throw if invalid","    var v = new jsonschema.Validator();","    var result = v.validate(pluginConfig, schema, {","        propertyName: configKey","    });","","    // Throw error","    if (result.errors.length > 0) {","        throw new error.ConfigurationError(new Error(result.errors[0].stack));","    }","","    // Insert default values","    var defaults = jsonSchemaDefaults(schema);","    pluginConfig = mergeDefaults(pluginConfig, defaults);","","","    // Update configuration","    config = config.setValue(configKey, pluginConfig);","","    // Return new book","    return book.set('config', config);","}","","/**","    Validate a book configuration for plugins and","    returns an update configuration with default values.","","    @param {Book}","    @param {OrderedMap<String:Plugin>}","    @return {Promise<Book>}","*/","function validateConfig(book, plugins) {","    return Promise.reduce(plugins, function(newBook, plugin) {","        return validatePluginConfig(newBook, plugin);","    }, book);","}","","module.exports = validateConfig;",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"7":1,"16":1,"17":0,"18":0,"20":0,"25":0,"27":0,"28":0,"31":0,"32":0,"35":0,"36":0,"41":0,"42":0,"46":0,"47":0,"51":0,"54":0,"65":1,"66":0,"67":0,"71":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/installPlugins.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/installPlugins.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1},"b":{"1":[0,0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"installPlugins","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":30}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":32},"end":{"line":20,"column":49}}},"3":{"name":"(anonymous_3)","line":21,"loc":{"start":{"line":21,"column":46},"end":{"line":21,"column":60}}},"4":{"name":"(anonymous_4)","line":42,"loc":{"start":{"line":42,"column":36},"end":{"line":42,"column":53}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":61}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":42}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":47}},"5":{"start":{"line":13,"column":0},"end":{"line":46,"column":1}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":34}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":34}},"8":{"start":{"line":16,"column":4},"end":{"line":16,"column":49}},"9":{"start":{"line":20,"column":4},"end":{"line":33,"column":7}},"10":{"start":{"line":21,"column":8},"end":{"line":23,"column":11}},"11":{"start":{"line":22,"column":12},"end":{"line":22,"column":54}},"12":{"start":{"line":25,"column":8},"end":{"line":32,"column":10}},"13":{"start":{"line":35,"column":4},"end":{"line":38,"column":5}},"14":{"start":{"line":36,"column":8},"end":{"line":36,"column":46}},"15":{"start":{"line":37,"column":8},"end":{"line":37,"column":25}},"16":{"start":{"line":40,"column":4},"end":{"line":40,"column":88}},"17":{"start":{"line":42,"column":4},"end":{"line":45,"column":31}},"18":{"start":{"line":43,"column":8},"end":{"line":43,"column":43}},"19":{"start":{"line":48,"column":0},"end":{"line":48,"column":32}}},"branchMap":{"1":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":12},"end":{"line":27,"column":31}},{"start":{"line":30,"column":13},"end":{"line":30,"column":23}},{"start":{"line":31,"column":12},"end":{"line":31,"column":59}}]},"2":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":35,"column":4}},{"start":{"line":35,"column":4},"end":{"line":35,"column":4}}]}},"code":["var npmi = require('npmi');","","var DEFAULT_PLUGINS = require('../constants/defaultPlugins');","var Promise = require('../utils/promise');","var installPlugin = require('./installPlugin');","","/**","    Install plugin requirements for a book","","    @param {Book}","    @return {Promise<Number>}","*/","function installPlugins(book) {","    var logger = book.getLogger();","    var config = book.getConfig();","    var plugins = config.getPluginDependencies();","","    // Remove default plugins","    // (only if version is same as installed)","    plugins = plugins.filterNot(function(plugin) {","        var dependency = DEFAULT_PLUGINS.find(function(dep) {","            return dep.getName() === plugin.getName();","        });","","        return (","            // Disabled plugin","            !plugin.isEnabled() ||","","            // Or default one installed in GitBook itself","            (dependency &&","            plugin.getVersion() === dependency.getVersion())","        );","    });","","    if (plugins.size == 0) {","        logger.info.ln('nothing to install!');","        return Promise();","    }","","    logger.info.ln('installing', plugins.size, 'plugins using npm@' + npmi.NPM_VERSION);","","    return Promise.forEach(plugins, function(plugin) {","        return installPlugin(book, plugin);","    })","    .thenResolve(plugins.size);","}","","module.exports = installPlugins;",""],"l":{"1":1,"3":1,"4":1,"5":1,"13":1,"14":0,"15":0,"16":0,"20":0,"21":0,"22":0,"25":0,"35":0,"36":0,"37":0,"40":0,"42":0,"43":0,"48":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/installPlugin.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/installPlugin.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"installPlugin","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":37}}},"2":{"name":"(anonymous_2)","line":25,"loc":{"start":{"line":25,"column":10},"end":{"line":25,"column":28}}},"3":{"name":"(anonymous_3)","line":42,"loc":{"start":{"line":42,"column":10},"end":{"line":42,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":49}},"4":{"start":{"line":13,"column":0},"end":{"line":45,"column":1}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":34}},"6":{"start":{"line":16,"column":4},"end":{"line":16,"column":39}},"7":{"start":{"line":17,"column":4},"end":{"line":17,"column":32}},"8":{"start":{"line":18,"column":4},"end":{"line":18,"column":42}},"9":{"start":{"line":20,"column":4},"end":{"line":20,"column":23}},"10":{"start":{"line":21,"column":4},"end":{"line":21,"column":55}},"11":{"start":{"line":24,"column":4},"end":{"line":44,"column":7}},"12":{"start":{"line":26,"column":8},"end":{"line":28,"column":9}},"13":{"start":{"line":27,"column":12},"end":{"line":27,"column":126}},"14":{"start":{"line":30,"column":8},"end":{"line":30,"column":108}},"15":{"start":{"line":31,"column":8},"end":{"line":40,"column":11}},"16":{"start":{"line":43,"column":8},"end":{"line":43,"column":71}},"17":{"start":{"line":47,"column":0},"end":{"line":47,"column":31}}},"branchMap":{"1":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":8},"end":{"line":26,"column":8}},{"start":{"line":26,"column":8},"end":{"line":26,"column":8}}]}},"code":["var npmi = require('npmi');","","var Promise = require('../utils/promise');","var resolveVersion = require('./resolveVersion');","","/**","    Install a plugin for a book","","    @param {Book}","    @param {PluginDependency}","    @return {Promise}","*/","function installPlugin(book, plugin) {","    var logger = book.getLogger();","","    var installFolder = book.getRoot();","    var name = plugin.getName();","    var requirement = plugin.getVersion();","","    logger.info.ln('');","    logger.info.ln('installing plugin \"' + name + '\"');","","    // Find a version to install","    return resolveVersion(plugin)","    .then(function(version) {","        if (!version) {","            throw new Error('Found no satisfactory version for plugin \"' + name + '\" with requirement \"' + requirement + '\"');","        }","","        logger.info.ln('install plugin \"' + name +'\" (' + requirement + ') from NPM with version', version);","        return Promise.nfcall(npmi, {","            'name': plugin.getNpmID(),","            'version': version,","            'path': installFolder,","            'npmLoad': {","                'loglevel': 'silent',","                'loaded': true,","                'prefix': installFolder","            }","        });","    })","    .then(function() {","        logger.info.ok('plugin \"' + name + '\" installed with success');","    });","}","","module.exports = installPlugin;",""],"l":{"1":1,"3":1,"4":1,"13":1,"14":0,"16":0,"17":0,"18":0,"20":0,"21":0,"24":0,"26":0,"27":0,"30":0,"31":0,"43":0,"47":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/resolveVersion.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/resolveVersion.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"initNPM","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":19}}},"2":{"name":"resolveVersion","line":33,"loc":{"start":{"line":33,"column":0},"end":{"line":33,"column":32}}},"3":{"name":"(anonymous_3)","line":42,"loc":{"start":{"line":42,"column":10},"end":{"line":42,"column":21}}},"4":{"name":"(anonymous_4)","line":45,"loc":{"start":{"line":45,"column":10},"end":{"line":45,"column":29}}},"5":{"name":"(anonymous_5)","line":49,"loc":{"start":{"line":49,"column":17},"end":{"line":49,"column":33}}},"6":{"name":"(anonymous_6)","line":55,"loc":{"start":{"line":55,"column":20},"end":{"line":55,"column":32}}},"7":{"name":"(anonymous_7)","line":58,"loc":{"start":{"line":58,"column":18},"end":{"line":58,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":25}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":31}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":42}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":41}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":36}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":15}},"8":{"start":{"line":16,"column":0},"end":{"line":25,"column":1}},"9":{"start":{"line":17,"column":4},"end":{"line":17,"column":38}},"10":{"start":{"line":17,"column":20},"end":{"line":17,"column":38}},"11":{"start":{"line":19,"column":4},"end":{"line":22,"column":7}},"12":{"start":{"line":24,"column":4},"end":{"line":24,"column":22}},"13":{"start":{"line":33,"column":0},"end":{"line":69,"column":1}},"14":{"start":{"line":34,"column":4},"end":{"line":34,"column":53}},"15":{"start":{"line":35,"column":4},"end":{"line":35,"column":46}},"16":{"start":{"line":37,"column":4},"end":{"line":39,"column":5}},"17":{"start":{"line":38,"column":8},"end":{"line":38,"column":48}},"18":{"start":{"line":41,"column":4},"end":{"line":68,"column":7}},"19":{"start":{"line":43,"column":8},"end":{"line":43,"column":99}},"20":{"start":{"line":46,"column":8},"end":{"line":46,"column":54}},"21":{"start":{"line":48,"column":8},"end":{"line":61,"column":20}},"22":{"start":{"line":50,"column":16},"end":{"line":53,"column":18}},"23":{"start":{"line":56,"column":16},"end":{"line":56,"column":65}},"24":{"start":{"line":59,"column":16},"end":{"line":59,"column":65}},"25":{"start":{"line":63,"column":8},"end":{"line":67,"column":9}},"26":{"start":{"line":64,"column":12},"end":{"line":64,"column":29}},"27":{"start":{"line":66,"column":12},"end":{"line":66,"column":34}},"28":{"start":{"line":71,"column":0},"end":{"line":71,"column":32}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":17,"column":4}},{"start":{"line":17,"column":4},"end":{"line":17,"column":4}}]},"2":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":37,"column":4}},{"start":{"line":37,"column":4},"end":{"line":37,"column":4}}]},"3":{"line":52,"type":"binary-expr","locations":[{"start":{"line":52,"column":30},"end":{"line":52,"column":46}},{"start":{"line":52,"column":50},"end":{"line":52,"column":52}}]},"4":{"line":56,"type":"binary-expr","locations":[{"start":{"line":56,"column":23},"end":{"line":56,"column":32}},{"start":{"line":56,"column":36},"end":{"line":56,"column":64}}]},"5":{"line":59,"type":"cond-expr","locations":[{"start":{"line":59,"column":58},"end":{"line":59,"column":59}},{"start":{"line":59,"column":62},"end":{"line":59,"column":64}}]},"6":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":8},"end":{"line":63,"column":8}},{"start":{"line":63,"column":8},"end":{"line":63,"column":8}}]}},"code":["var npm = require('npm');","var semver = require('semver');","var Immutable = require('immutable');","","var Promise = require('../utils/promise');","var Plugin = require('../models/plugin');","var gitbook = require('../gitbook');","","var npmIsReady;","","/**","    Initialize and prepare NPM","","    @return {Promise}","*/","function initNPM() {","    if (npmIsReady) return npmIsReady;","","    npmIsReady = Promise.nfcall(npm.load, {","        silent: true,","        loglevel: 'silent'","    });","","    return npmIsReady;","}","","/**","    Resolve a plugin dependency to a version","","    @param {PluginDependency} plugin","    @return {Promise<String>}","*/","function resolveVersion(plugin) {","    var npmId = Plugin.nameToNpmID(plugin.getName());","    var requiredVersion = plugin.getVersion();","","    if (plugin.isGitDependency()) {","        return Promise.resolve(requiredVersion);","    }","","    return initNPM()","    .then(function() {","        return Promise.nfcall(npm.commands.view, [npmId + '@' + requiredVersion, 'engines'], true);","    })","    .then(function(versions) {","        versions = Immutable.Map(versions).entrySeq();","","        var result = versions","            .map(function(entry) {","                return {","                    version: entry[0],","                    gitbook: (entry[1].engines || {}).gitbook","                };","            })","            .filter(function(v) {","                return v.gitbook && gitbook.satisfies(v.gitbook);","            })","            .sort(function(v1, v2) {","                return semver.lt(v1.version, v2.version)? 1 : -1;","            })","            .get(0);","","        if (!result) {","            return undefined;","        } else {","            return result.version;","        }","    });","}","","module.exports = resolveVersion;",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"7":1,"9":1,"16":1,"17":0,"19":0,"24":0,"33":1,"34":0,"35":0,"37":0,"38":0,"41":0,"43":0,"46":0,"48":0,"50":0,"56":0,"59":0,"63":0,"64":0,"66":0,"71":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/listResources.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/listResources.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"listResources","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":43}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":26},"end":{"line":15,"column":51}}},"3":{"name":"(anonymous_3)","line":19,"loc":{"start":{"line":19,"column":33},"end":{"line":19,"column":56}}},"4":{"name":"(anonymous_4)","line":25,"loc":{"start":{"line":25,"column":32},"end":{"line":25,"column":52}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":49}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":63}},"5":{"start":{"line":14,"column":0},"end":{"line":43,"column":1}},"6":{"start":{"line":15,"column":4},"end":{"line":42,"column":24}},"7":{"start":{"line":16,"column":8},"end":{"line":16,"column":48}},"8":{"start":{"line":17,"column":8},"end":{"line":17,"column":62}},"9":{"start":{"line":19,"column":8},"end":{"line":39,"column":11}},"10":{"start":{"line":20,"column":12},"end":{"line":20,"column":59}},"11":{"start":{"line":21,"column":12},"end":{"line":21,"column":32}},"12":{"start":{"line":21,"column":25},"end":{"line":21,"column":32}},"13":{"start":{"line":23,"column":12},"end":{"line":23,"column":68}},"14":{"start":{"line":25,"column":12},"end":{"line":35,"column":15}},"15":{"start":{"line":26,"column":16},"end":{"line":34,"column":17}},"16":{"start":{"line":27,"column":20},"end":{"line":29,"column":22}},"17":{"start":{"line":31,"column":20},"end":{"line":33,"column":22}},"18":{"start":{"line":37,"column":12},"end":{"line":37,"column":39}},"19":{"start":{"line":38,"column":12},"end":{"line":38,"column":52}},"20":{"start":{"line":41,"column":8},"end":{"line":41,"column":22}},"21":{"start":{"line":45,"column":0},"end":{"line":45,"column":31}}},"branchMap":{"1":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":12},"end":{"line":21,"column":12}},{"start":{"line":21,"column":12},"end":{"line":21,"column":12}}]},"2":{"line":23,"type":"binary-expr","locations":[{"start":{"line":23,"column":23},"end":{"line":23,"column":47}},{"start":{"line":23,"column":51},"end":{"line":23,"column":67}}]},"3":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":16},"end":{"line":26,"column":16}},{"start":{"line":26,"column":16},"end":{"line":26,"column":16}}]}},"code":["var Immutable = require('immutable');","var path = require('path');","","var LocationUtils = require('../utils/location');","var PLUGIN_RESOURCES = require('../constants/pluginResources');","","/**","    List all resources from a list of plugins","","    @param {OrderedMap<String:Plugin>}","    @param {String} type","    @return {Map<String:List<{url, path}>}","*/","function listResources(plugins, resources) {","    return plugins.reduce(function(result, plugin) {","        var npmId           = plugin.getNpmID();","        var pluginResources = resources.get(plugin.getName());","","        PLUGIN_RESOURCES.forEach(function(resourceType) {","            var assets = pluginResources.get(resourceType);","            if (!assets) return;","","            var list = result.get(resourceType) || Immutable.List();","","            assets = assets.map(function(assetFile) {","                if (LocationUtils.isExternal(assetFile)) {","                    return {","                        url: assetFile","                    };","                } else {","                    return {","                        path: LocationUtils.normalize(path.join(npmId, assetFile))","                    };","                }","            });","","            list = list.concat(assets);","            result = result.set(resourceType, list);","        });","","        return result;","    }, Immutable.Map());","}","","module.exports = listResources;",""],"l":{"1":1,"2":1,"4":1,"5":1,"14":1,"15":0,"16":0,"17":0,"19":0,"20":0,"21":0,"23":0,"25":0,"26":0,"27":0,"31":0,"37":0,"38":0,"41":0,"45":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/pluginResources.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/pluginResources.js","s":{"1":1,"2":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":6,"column":3}}},"branchMap":{},"code":["var Immutable = require('immutable');","","module.exports = Immutable.List([","    'js',","    'css'","]);",""],"l":{"1":1,"3":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/listBlocks.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/listBlocks.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"listBlocks","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":29}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":16},"end":{"line":12,"column":41}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":9,"column":0},"end":{"line":16,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":15,"column":28}},"4":{"start":{"line":13,"column":12},"end":{"line":13,"column":44}},"5":{"start":{"line":14,"column":12},"end":{"line":14,"column":40}},"6":{"start":{"line":18,"column":0},"end":{"line":18,"column":28}}},"branchMap":{},"code":["var Immutable = require('immutable');","","/**","    List blocks from a list of plugins","","    @param {OrderedMap<String:Plugin>}","    @return {Map<String:TemplateBlock>}","*/","function listBlocks(plugins) {","    return plugins","        .reverse()","        .reduce(function(result, plugin) {","            var blocks = plugin.getBlocks();","            return result.merge(blocks);","        }, Immutable.Map());","}","","module.exports = listBlocks;",""],"l":{"1":1,"9":1,"10":0,"13":0,"14":0,"18":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/listFilters.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/listFilters.js","s":{"1":1,"2":1,"3":0,"4":0,"5":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"listFilters","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":30}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":16},"end":{"line":12,"column":41}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":9,"column":0},"end":{"line":15,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":14,"column":28}},"4":{"start":{"line":13,"column":12},"end":{"line":13,"column":53}},"5":{"start":{"line":17,"column":0},"end":{"line":17,"column":29}}},"branchMap":{},"code":["var Immutable = require('immutable');","","/**","    List filters from a list of plugins","","    @param {OrderedMap<String:Plugin>}","    @return {Map<String:Function>}","*/","function listFilters(plugins) {","    return plugins","        .reverse()","        .reduce(function(result, plugin) {","            return result.merge(plugin.getFilters());","        }, Immutable.Map());","}","","module.exports = listFilters;",""],"l":{"1":1,"9":1,"10":0,"13":0,"17":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/defaultBlocks.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/defaultBlocks.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":31}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":17},"end":{"line":14,"column":31}}},"3":{"name":"(anonymous_3)","line":24,"loc":{"start":{"line":24,"column":17},"end":{"line":24,"column":31}}},"4":{"name":"(anonymous_4)","line":26,"loc":{"start":{"line":26,"column":18},"end":{"line":26,"column":32}}},"5":{"name":"(anonymous_5)","line":34,"loc":{"start":{"line":34,"column":17},"end":{"line":34,"column":31}}},"6":{"name":"(anonymous_6)","line":36,"loc":{"start":{"line":36,"column":18},"end":{"line":36,"column":32}}},"7":{"name":"(anonymous_7)","line":44,"loc":{"start":{"line":44,"column":17},"end":{"line":44,"column":31}}},"8":{"name":"(anonymous_8)","line":46,"loc":{"start":{"line":46,"column":18},"end":{"line":46,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":55}},"3":{"start":{"line":4,"column":0},"end":{"line":51,"column":3}},"4":{"start":{"line":8,"column":12},"end":{"line":8,"column":23}},"5":{"start":{"line":15,"column":12},"end":{"line":18,"column":14}},"6":{"start":{"line":25,"column":12},"end":{"line":28,"column":15}},"7":{"start":{"line":27,"column":16},"end":{"line":27,"column":37}},"8":{"start":{"line":35,"column":12},"end":{"line":38,"column":15}},"9":{"start":{"line":37,"column":16},"end":{"line":37,"column":37}},"10":{"start":{"line":45,"column":12},"end":{"line":48,"column":15}},"11":{"start":{"line":47,"column":16},"end":{"line":47,"column":37}}},"branchMap":{},"code":["var Immutable = require('immutable');","var TemplateBlock = require('../models/templateBlock');","","module.exports = Immutable.Map({","    html: TemplateBlock({","        name: 'html',","        process: function(blk) {","            return blk;","        }","    }),","","    code: TemplateBlock({","        name: 'code',","        process: function(blk) {","            return {","                html: false,","                body: blk.body","            };","        }","    }),","","    markdown: TemplateBlock({","        name: 'markdown',","        process: function(blk) {","            return this.book.renderInline('markdown', blk.body)","            .then(function(out) {","                return { body: out };","            });","        }","    }),","","    asciidoc: TemplateBlock({","        name: 'asciidoc',","        process: function(blk) {","            return this.book.renderInline('asciidoc', blk.body)","            .then(function(out) {","                return { body: out };","            });","        }","    }),","","    markup: TemplateBlock({","        name: 'markup',","        process: function(blk) {","            return this.book.renderInline(this.ctx.file.type, blk.body)","            .then(function(out) {","                return { body: out };","            });","        }","    })","});",""],"l":{"1":1,"2":1,"4":1,"8":0,"15":0,"25":0,"27":0,"35":0,"37":0,"45":0,"47":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodeConfig.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodeConfig.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1},"b":{},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"encodeConfig","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":38}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":13},"end":{"line":15,"column":41}}},"3":{"name":"(anonymous_3)","line":19,"loc":{"start":{"line":19,"column":13},"end":{"line":19,"column":34}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":40}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":39}},"3":{"start":{"line":11,"column":0},"end":{"line":34,"column":1}},"4":{"start":{"line":12,"column":4},"end":{"line":22,"column":6}},"5":{"start":{"line":16,"column":12},"end":{"line":16,"column":68}},"6":{"start":{"line":20,"column":12},"end":{"line":20,"column":61}},"7":{"start":{"line":24,"column":4},"end":{"line":25,"column":97}},"8":{"start":{"line":27,"column":4},"end":{"line":28,"column":104}},"9":{"start":{"line":30,"column":4},"end":{"line":31,"column":98}},"10":{"start":{"line":33,"column":4},"end":{"line":33,"column":18}},"11":{"start":{"line":36,"column":0},"end":{"line":36,"column":30}}},"branchMap":{},"code":["var objectPath = require('object-path');","var deprecate = require('./deprecate');","","/**","    Encode a config object into a JS config api","","    @param {Output} output","    @param {Config} config","    @return {Object}","*/","function encodeConfig(output, config) {","    var result = {","        values: config.getValues().toJS(),","","        get: function(key, defaultValue) {","            return objectPath.get(result.values, key, defaultValue);","        },","","        set: function(key, value) {","            return objectPath.set(result.values, key, value);","        }","    };","","    deprecate.field(output, 'config.options', result, 'options',","        result.values, '\"config.options\" property is deprecated, use \"config.get(key)\" instead');","","    deprecate.field(output, 'config.options.generator', result.values, 'generator',","        output.getGenerator(), '\"options.generator\" property is deprecated, use \"output.name\" instead');","","    deprecate.field(output, 'config.options.generator', result.values, 'output',","        output.getRoot(), '\"options.output\" property is deprecated, use \"output.root()\" instead');","","    return result;","}","","module.exports = encodeConfig;",""],"l":{"1":1,"2":1,"11":1,"12":0,"16":0,"20":0,"24":0,"27":0,"30":0,"33":0,"36":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodeSummary.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/encodeSummary.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"encodeSummary","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":40}}},"2":{"name":"(anonymous_2)","line":17,"loc":{"start":{"line":17,"column":14},"end":{"line":17,"column":30}}},"3":{"name":"(anonymous_3)","line":18,"loc":{"start":{"line":18,"column":31},"end":{"line":18,"column":49}}},"4":{"name":"(anonymous_4)","line":31,"loc":{"start":{"line":31,"column":27},"end":{"line":31,"column":43}}},"5":{"name":"(anonymous_5)","line":42,"loc":{"start":{"line":42,"column":26},"end":{"line":42,"column":42}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":67}},"2":{"start":{"line":10,"column":0},"end":{"line":49,"column":1}},"3":{"start":{"line":11,"column":4},"end":{"line":46,"column":6}},"4":{"start":{"line":18,"column":12},"end":{"line":22,"column":15}},"5":{"start":{"line":19,"column":16},"end":{"line":19,"column":71}},"6":{"start":{"line":21,"column":16},"end":{"line":21,"column":41}},"7":{"start":{"line":32,"column":12},"end":{"line":32,"column":52}},"8":{"start":{"line":33,"column":12},"end":{"line":33,"column":72}},"9":{"start":{"line":43,"column":12},"end":{"line":43,"column":51}},"10":{"start":{"line":44,"column":12},"end":{"line":44,"column":72}},"11":{"start":{"line":48,"column":4},"end":{"line":48,"column":18}},"12":{"start":{"line":51,"column":0},"end":{"line":51,"column":31}}},"branchMap":{"1":{"line":33,"type":"cond-expr","locations":[{"start":{"line":33,"column":29},"end":{"line":33,"column":58}},{"start":{"line":33,"column":61},"end":{"line":33,"column":70}}]},"2":{"line":44,"type":"cond-expr","locations":[{"start":{"line":44,"column":29},"end":{"line":44,"column":58}},{"start":{"line":44,"column":61},"end":{"line":44,"column":70}}]}},"code":["var encodeSummaryArticle = require('../json/encodeSummaryArticle');","","/**","    Encode summary to provide an API to plugin","","    @param {Output} output","    @param {Config} config","    @return {Object}","*/","function encodeSummary(output, summary) {","    var result = {","        /**","            Iterate over the summary, it stops when the \"iter\" returns false","","            @param {Function} iter","        */","        walk: function (iter) {","            summary.getArticle(function(article) {","                var jsonArticle = encodeSummaryArticle(article, false);","","                return iter(jsonArticle);","            });","        },","","        /**","            Get an article by its level","","            @param {String} level","            @return {Object}","        */","        getArticleByLevel: function(level) {","            var article = summary.getByLevel(level);","            return (article? encodeSummaryArticle(article) : undefined);","        },","","        /**","            Get an article by its path","","            @param {String} level","            @return {Object}","        */","        getArticleByPath: function(level) {","            var article = summary.getByPath(level);","            return (article? encodeSummaryArticle(article) : undefined);","        }","    };","","    return result;","}","","module.exports = encodeSummary;",""],"l":{"1":1,"10":1,"11":0,"18":0,"19":0,"21":0,"32":0,"33":0,"43":0,"44":0,"48":0,"51":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/decodeGlobal.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/decodeGlobal.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"decodeGlobal","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":38}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":45}},"2":{"start":{"line":11,"column":0},"end":{"line":20,"column":1}},"3":{"start":{"line":12,"column":4},"end":{"line":12,"column":32}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":34}},"5":{"start":{"line":16,"column":4},"end":{"line":16,"column":49}},"6":{"start":{"line":17,"column":4},"end":{"line":17,"column":38}},"7":{"start":{"line":19,"column":4},"end":{"line":19,"column":36}},"8":{"start":{"line":22,"column":0},"end":{"line":22,"column":30}}},"branchMap":{},"code":["var decodeConfig = require('./decodeConfig');","","/**","    Decode changes from a JS API to a output object.","    Only the configuration can be edited by plugin's hooks","","    @param {Output} output","    @param {Object} result: result from API","    @return {Output}","*/","function decodeGlobal(output, result) {","    var book = output.getBook();","    var config = book.getConfig();","","    // Update config","    config = decodeConfig(config, result.config);","    book = book.set('config', config);","","    return output.set('book', book);","}","","module.exports = decodeGlobal;",""],"l":{"1":1,"11":1,"12":0,"13":0,"16":0,"17":0,"19":0,"22":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/decodeConfig.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/api/decodeConfig.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"decodeGlobal","line":8,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":38}}}},"statementMap":{"1":{"start":{"line":8,"column":0},"end":{"line":15,"column":1}},"2":{"start":{"line":9,"column":4},"end":{"line":9,"column":31}},"3":{"start":{"line":11,"column":4},"end":{"line":11,"column":28}},"4":{"start":{"line":12,"column":4},"end":{"line":12,"column":25}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":39}},"6":{"start":{"line":17,"column":0},"end":{"line":17,"column":30}}},"branchMap":{},"code":["/**","    Decode changes from a JS API to a config object","","    @param {Config} config","    @param {Object} result: result from API","    @return {Config}","*/","function decodeGlobal(config, result) {","    var values = result.values;","","    delete values.generator;","    delete values.output;","","    return config.updateValues(values);","}","","module.exports = decodeGlobal;",""],"l":{"8":1,"9":0,"11":0,"12":0,"14":0,"17":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/json/onFinish.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/json/onFinish.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"onFinish","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":26}}},"2":{"name":"(anonymous_2)","line":29,"loc":{"start":{"line":29,"column":10},"end":{"line":29,"column":28}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":10},"end":{"line":37,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":35}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":38}},"5":{"start":{"line":13,"column":0},"end":{"line":45,"column":1}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":32}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":38}},"8":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"9":{"start":{"line":18,"column":8},"end":{"line":18,"column":31}},"10":{"start":{"line":22,"column":4},"end":{"line":22,"column":40}},"11":{"start":{"line":23,"column":4},"end":{"line":23,"column":54}},"12":{"start":{"line":26,"column":4},"end":{"line":44,"column":25}},"13":{"start":{"line":30,"column":8},"end":{"line":30,"column":39}},"14":{"start":{"line":32,"column":8},"end":{"line":32,"column":62}},"15":{"start":{"line":34,"column":8},"end":{"line":34,"column":20}},"16":{"start":{"line":38,"column":8},"end":{"line":41,"column":10}},"17":{"start":{"line":47,"column":0},"end":{"line":47,"column":26}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":17,"column":4}},{"start":{"line":17,"column":4},"end":{"line":17,"column":4}}]}},"code":["var path = require('path');","","var Promise = require('../../utils/promise');","var fs = require('../../utils/fs');","var JSONUtils = require('../../json');","","/**","    Finish the generation","","    @param {Output}","    @return {Output}","*/","function onFinish(output) {","    var book = output.getBook();","    var outputRoot = output.getRoot();","","    if (!book.isMultilingual()) {","        return Promise(output);","    }","","    // Get main language","    var languages = book.getLanguages();","    var mainLanguage = languages.getDefaultLanguage();","","    // Read the main JSON","    return fs.readFile(path.resolve(outputRoot, mainLanguage.getID(), 'README.json'), 'utf8')","","    // Extend the JSON","    .then(function(content) {","        var json = JSON.parse(content);","","        json.languages = JSONUtils.encodeLanguages(languages);","","        return json;","    })","","    .then(function(json) {","        return fs.writeFile(","            path.resolve(outputRoot, 'README.json'),","            JSON.stringify(json, null, 4)","        );","    })","","    .thenResolve(output);","}","","module.exports = onFinish;",""],"l":{"1":1,"3":1,"4":1,"5":1,"13":1,"14":0,"15":0,"17":0,"18":0,"22":0,"23":0,"26":0,"30":0,"32":0,"34":0,"38":0,"47":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":11,"column":2}}},"branchMap":{},"code":["","module.exports = {","    name:                       'website',","    State:                      require('./state'),","    Options:                    require('./options'),","    onInit:                     require('./onInit'),","    onFinish:                   require('./onFinish'),","    onPage:                     require('./onPage'),","    onAsset:                    require('./onAsset'),","    createTemplateEngine:       require('./createTemplateEngine')","};",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/state.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/state.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":35},"end":{"line":11,"column":46}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":40},"end":{"line":15,"column":51}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":29}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":9,"column":3}},"4":{"start":{"line":11,"column":0},"end":{"line":13,"column":2}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":28}},"6":{"start":{"line":15,"column":0},"end":{"line":17,"column":2}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":33}},"8":{"start":{"line":19,"column":0},"end":{"line":19,"column":32}}},"branchMap":{},"code":["var I18n = require('i18n-t');","var Immutable = require('immutable');","","var GeneratorState = Immutable.Record({","    i18n:       I18n(),","","    // List of plugins' resources","    resources:  Immutable.Map()","});","","GeneratorState.prototype.getI18n = function() {","    return this.get('i18n');","};","","GeneratorState.prototype.getResources = function() {","    return this.get('resources');","};","","module.exports = GeneratorState;",""],"l":{"1":1,"2":1,"4":1,"11":1,"12":0,"15":1,"16":0,"19":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/options.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/options.js","s":{"1":1,"2":1,"3":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":12,"column":3}},"3":{"start":{"line":14,"column":0},"end":{"line":14,"column":25}}},"branchMap":{},"code":["var Immutable = require('immutable');","","var Options = Immutable.Record({","    // Root folder for the output","    root:               String(),","","    // Prefix for generation","    prefix:             String('website'),","","    // Use directory index url instead of \"index.html\"","    directoryIndex:     Boolean(true)","});","","module.exports = Options;",""],"l":{"1":1,"3":1,"14":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/onInit.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/onInit.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"onInit","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":24}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":45}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":53}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":43}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":53}},"5":{"start":{"line":13,"column":0},"end":{"line":18,"column":1}},"6":{"start":{"line":14,"column":4},"end":{"line":17,"column":28}},"7":{"start":{"line":20,"column":0},"end":{"line":20,"column":24}}},"branchMap":{},"code":["var Promise = require('../../utils/promise');","","var copyPluginAssets = require('./copyPluginAssets');","var prepareI18n = require('./prepareI18n');","var prepareResources = require('./prepareResources');","","/**","    Initialize the generator","","    @param {Output}","    @return {Output}","*/","function onInit(output) {","    return Promise(output)","    .then(prepareI18n)","    .then(prepareResources)","    .then(copyPluginAssets);","}","","module.exports = onInit;",""],"l":{"1":1,"3":1,"4":1,"5":1,"13":1,"14":0,"20":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/copyPluginAssets.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/copyPluginAssets.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"copyPluginAssets","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":34}}},"2":{"name":"(anonymous_2)","line":30,"loc":{"start":{"line":30,"column":36},"end":{"line":30,"column":53}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":14},"end":{"line":32,"column":25}}},"4":{"name":"copyAssets","line":45,"loc":{"start":{"line":45,"column":0},"end":{"line":45,"column":36}}},"5":{"name":"copyResources","line":78,"loc":{"start":{"line":78,"column":0},"end":{"line":78,"column":39}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":65}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":45}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":35}},"5":{"start":{"line":15,"column":0},"end":{"line":37,"column":1}},"6":{"start":{"line":16,"column":4},"end":{"line":16,"column":32}},"7":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"8":{"start":{"line":21,"column":8},"end":{"line":21,"column":31}},"9":{"start":{"line":24,"column":4},"end":{"line":28,"column":19}},"10":{"start":{"line":30,"column":4},"end":{"line":36,"column":25}},"11":{"start":{"line":31,"column":8},"end":{"line":34,"column":11}},"12":{"start":{"line":33,"column":12},"end":{"line":33,"column":49}},"13":{"start":{"line":45,"column":0},"end":{"line":70,"column":1}},"14":{"start":{"line":46,"column":4},"end":{"line":46,"column":36}},"15":{"start":{"line":47,"column":4},"end":{"line":47,"column":38}},"16":{"start":{"line":48,"column":4},"end":{"line":48,"column":38}},"17":{"start":{"line":50,"column":4},"end":{"line":50,"column":41}},"18":{"start":{"line":51,"column":4},"end":{"line":51,"column":61}},"19":{"start":{"line":52,"column":4},"end":{"line":52,"column":39}},"20":{"start":{"line":54,"column":4},"end":{"line":54,"column":66}},"21":{"start":{"line":56,"column":4},"end":{"line":58,"column":5}},"22":{"start":{"line":57,"column":8},"end":{"line":57,"column":25}},"23":{"start":{"line":60,"column":4},"end":{"line":60,"column":59}},"24":{"start":{"line":61,"column":4},"end":{"line":69,"column":6}},"25":{"start":{"line":78,"column":0},"end":{"line":115,"column":1}},"26":{"start":{"line":79,"column":4},"end":{"line":79,"column":36}},"27":{"start":{"line":81,"column":4},"end":{"line":81,"column":41}},"28":{"start":{"line":82,"column":4},"end":{"line":82,"column":41}},"29":{"start":{"line":84,"column":4},"end":{"line":84,"column":34}},"30":{"start":{"line":85,"column":4},"end":{"line":85,"column":41}},"31":{"start":{"line":87,"column":4},"end":{"line":87,"column":43}},"32":{"start":{"line":88,"column":4},"end":{"line":88,"column":58}},"33":{"start":{"line":90,"column":4},"end":{"line":90,"column":53}},"34":{"start":{"line":91,"column":4},"end":{"line":91,"column":80}},"35":{"start":{"line":93,"column":4},"end":{"line":95,"column":5}},"36":{"start":{"line":94,"column":8},"end":{"line":94,"column":25}},"37":{"start":{"line":98,"column":4},"end":{"line":98,"column":58}},"38":{"start":{"line":99,"column":4},"end":{"line":102,"column":5}},"39":{"start":{"line":100,"column":8},"end":{"line":100,"column":93}},"40":{"start":{"line":101,"column":8},"end":{"line":101,"column":25}},"41":{"start":{"line":104,"column":4},"end":{"line":104,"column":64}},"42":{"start":{"line":106,"column":4},"end":{"line":114,"column":6}},"43":{"start":{"line":117,"column":0},"end":{"line":117,"column":34}}},"branchMap":{"1":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":20,"column":4}},{"start":{"line":20,"column":4},"end":{"line":20,"column":4}}]},"2":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":56,"column":4}},{"start":{"line":56,"column":4},"end":{"line":56,"column":4}}]},"3":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":4},"end":{"line":93,"column":4}},{"start":{"line":93,"column":4},"end":{"line":93,"column":4}}]},"4":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":4},"end":{"line":99,"column":4}},{"start":{"line":99,"column":4},"end":{"line":99,"column":4}}]}},"code":["var path = require('path');","","var ASSET_FOLDER = require('../../constants/pluginAssetsFolder');","var Promise = require('../../utils/promise');","var fs = require('../../utils/fs');","","/**","    Copy all assets from plugins.","    Assets are files stored in \"_assets\"","    nd resources declared in the plugin itself.","","    @param {Output}","    @return {Promise}","*/","function copyPluginAssets(output) {","    var book = output.getBook();","","    // Don't copy plugins assets for language book","    // It'll be resolved to the parent folder","    if (book.isLanguageBook()) {","        return Promise(output);","    }","","    var plugins = output.getPlugins()","","        // We reverse the order of plugins to copy","        // so that first plugins can replace assets from other plugins.","        .reverse();","","    return Promise.forEach(plugins, function(plugin) {","        return copyAssets(output, plugin)","        .then(function() {","            return copyResources(output, plugin);","        });","    })","    .thenResolve(output);","}","","/**","    Copy assets from a plugin","","    @param {Plugin}","    @return {Promise}","*/","function copyAssets(output, plugin) {","    var logger = output.getLogger();","    var pluginRoot = plugin.getPath();","    var options = output.getOptions();","","    var outputRoot = options.get('root');","    var assetOutputFolder = path.join(outputRoot, 'gitbook');","    var prefix = options.get('prefix');","","    var assetFolder = path.join(pluginRoot, ASSET_FOLDER, prefix);","","    if (!fs.existsSync(assetFolder)) {","        return Promise();","    }","","    logger.debug.ln('copy assets from theme', assetFolder);","    return fs.copyDir(","        assetFolder,","        assetOutputFolder,","        {","            deleteFirst: false,","            overwrite: true,","            confirm: true","        }","    );","}","","/**","    Copy resources from a plugin","","    @param {Plugin}","    @return {Promise}","*/","function copyResources(output, plugin) {","    var logger = output.getLogger();","","    var options    = output.getOptions();","    var outputRoot = options.get('root');","","    var state = output.getState();","    var resources = state.getResources();","","    var pluginRoot      = plugin.getPath();","    var pluginResources = resources.get(plugin.getName());","","    var assetsFolder = pluginResources.get('assets');","    var assetOutputFolder = path.join(outputRoot, 'gitbook', plugin.getNpmID());","","    if (!assetsFolder) {","        return Promise();","    }","","    // Resolve assets folder","    assetsFolder = path.resolve(pluginRoot, assetsFolder);","    if (!fs.existsSync(assetsFolder)) {","        logger.warn.ln('assets folder for plugin \"' + plugin.getName() + '\" doesn\\'t exist');","        return Promise();","    }","","    logger.debug.ln('copy resources from plugin', assetsFolder);","","    return fs.copyDir(","        assetsFolder,","        assetOutputFolder,","        {","            deleteFirst: false,","            overwrite: true,","            confirm: true","        }","    );","}","","module.exports = copyPluginAssets;",""],"l":{"1":1,"3":1,"4":1,"5":1,"15":1,"16":0,"20":0,"21":0,"24":0,"30":0,"31":0,"33":0,"45":1,"46":0,"47":0,"48":0,"50":0,"51":0,"52":0,"54":0,"56":0,"57":0,"60":0,"61":0,"78":1,"79":0,"81":0,"82":0,"84":0,"85":0,"87":0,"88":0,"90":0,"91":0,"93":0,"94":0,"98":0,"99":0,"100":0,"101":0,"104":0,"106":0,"117":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/pluginAssetsFolder.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/pluginAssetsFolder.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}}},"branchMap":{},"code":["","module.exports = '_assets';",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/prepareI18n.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/prepareI18n.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"prepareI18n","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":29}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":17},"end":{"line":20,"column":38}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":35}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":45}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":51}},"5":{"start":{"line":13,"column":0},"end":{"line":28,"column":1}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":34}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":31}},"8":{"start":{"line":16,"column":4},"end":{"line":16,"column":46}},"9":{"start":{"line":18,"column":4},"end":{"line":25,"column":11}},"10":{"start":{"line":21,"column":12},"end":{"line":21,"column":61}},"11":{"start":{"line":23,"column":12},"end":{"line":23,"column":49}},"12":{"start":{"line":23,"column":42},"end":{"line":23,"column":49}},"13":{"start":{"line":24,"column":12},"end":{"line":24,"column":32}},"14":{"start":{"line":27,"column":4},"end":{"line":27,"column":27}},"15":{"start":{"line":30,"column":0},"end":{"line":30,"column":29}}},"branchMap":{"1":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":12},"end":{"line":23,"column":12}},{"start":{"line":23,"column":12},"end":{"line":23,"column":12}}]}},"code":["var path = require('path');","","var fs = require('../../utils/fs');","var Promise = require('../../utils/promise');","var listSearchPaths = require('./listSearchPaths');","","/**"," * Prepare i18n, load translations from plugins and book"," *"," * @param {Output}"," * @return {Promise<Output>}"," */","function prepareI18n(output) {","    var state = output.getState();","    var i18n = state.getI18n();","    var searchPaths = listSearchPaths(output);","","    searchPaths","        .reverse()","        .forEach(function(searchPath) {","            var i18nRoot = path.resolve(searchPath, '_i18n');","","            if (!fs.existsSync(i18nRoot)) return;","            i18n.load(i18nRoot);","        });","","    return Promise(output);","}","","module.exports = prepareI18n;",""],"l":{"1":1,"3":1,"4":1,"5":1,"13":1,"14":0,"15":0,"16":0,"18":0,"21":0,"23":0,"24":0,"27":0,"30":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/listSearchPaths.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/listSearchPaths.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"listSearchPaths","line":8,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":33}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":13},"end":{"line":14,"column":30}}}},"statementMap":{"1":{"start":{"line":8,"column":0},"end":{"line":20,"column":1}},"2":{"start":{"line":9,"column":4},"end":{"line":9,"column":32}},"3":{"start":{"line":10,"column":4},"end":{"line":10,"column":38}},"4":{"start":{"line":12,"column":4},"end":{"line":17,"column":18}},"5":{"start":{"line":15,"column":12},"end":{"line":15,"column":36}},"6":{"start":{"line":19,"column":4},"end":{"line":19,"column":54}},"7":{"start":{"line":23,"column":0},"end":{"line":23,"column":33}}},"branchMap":{},"code":["","/**","    List search paths for templates / i18n, etc","","    @param {Output} output","    @return {List<String>}","*/","function listSearchPaths(output) {","    var book = output.getBook();","    var plugins = output.getPlugins();","","    var searchPaths = plugins","        .valueSeq()","        .map(function(plugin) {","            return plugin.getPath();","        })","        .toList();","","    return searchPaths.unshift(book.getContentRoot());","}","","","module.exports = listSearchPaths;",""],"l":{"8":1,"9":0,"10":0,"12":0,"15":0,"19":0,"23":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/prepareResources.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/prepareResources.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"prepareResources","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":34}}},"2":{"name":"(anonymous_2)","line":22,"loc":{"start":{"line":22,"column":36},"end":{"line":22,"column":53}}},"3":{"name":"(anonymous_3)","line":26,"loc":{"start":{"line":26,"column":14},"end":{"line":26,"column":25}}},"4":{"name":"(anonymous_4)","line":36,"loc":{"start":{"line":36,"column":14},"end":{"line":36,"column":34}}},"5":{"name":"(anonymous_5)","line":40,"loc":{"start":{"line":40,"column":10},"end":{"line":40,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":30}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":47}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":44}},"5":{"start":{"line":13,"column":0},"end":{"line":52,"column":1}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":38}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":38}},"8":{"start":{"line":16,"column":4},"end":{"line":16,"column":40}},"9":{"start":{"line":17,"column":4},"end":{"line":17,"column":36}},"10":{"start":{"line":18,"column":4},"end":{"line":18,"column":43}},"11":{"start":{"line":20,"column":4},"end":{"line":20,"column":33}},"12":{"start":{"line":22,"column":4},"end":{"line":51,"column":7}},"13":{"start":{"line":23,"column":8},"end":{"line":23,"column":56}},"14":{"start":{"line":25,"column":8},"end":{"line":38,"column":11}},"15":{"start":{"line":28,"column":12},"end":{"line":34,"column":13}},"16":{"start":{"line":29,"column":16},"end":{"line":30,"column":53}},"17":{"start":{"line":33,"column":16},"end":{"line":33,"column":39}},"18":{"start":{"line":37,"column":12},"end":{"line":37,"column":76}},"19":{"start":{"line":42,"column":8},"end":{"line":44,"column":11}},"20":{"start":{"line":46,"column":8},"end":{"line":48,"column":11}},"21":{"start":{"line":50,"column":8},"end":{"line":50,"column":22}},"22":{"start":{"line":54,"column":0},"end":{"line":54,"column":34}}},"branchMap":{"1":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":12},"end":{"line":28,"column":12}},{"start":{"line":28,"column":12},"end":{"line":28,"column":12}}]}},"code":["var is        = require('is');","var Immutable = require('immutable');","var Promise   = require('../../utils/promise');","","var Api              = require('../../api');","","/**","    Prepare plugins resources, add all output corresponding type resources","","    @param {Output}","    @return {Promise<Output>}","*/","function prepareResources(output) {","    var plugins = output.getPlugins();","    var options = output.getOptions();","    var type    = options.get('prefix');","    var state   = output.getState();","    var context = Api.encodeGlobal(output);","","    var result = Immutable.Map();","","    return Promise.forEach(plugins, function(plugin) {","        var pluginResources = plugin.getResources(type);","","        return Promise()","        .then(function() {","            // Apply resources if is a function","            if (is.fn(pluginResources)) {","                return Promise()","                .then(pluginResources.bind(context));","            }","            else {","                return pluginResources;","            }","        })","        .then(function(resources) {","            result = result.set(plugin.getName(), Immutable.Map(resources));","        });","    })","    .then(function() {","        // Set output resources","        state = state.merge({","            resources: result","        });","","        output = output.merge({","            state: state","        });","","        return output;","    });","}","","module.exports = prepareResources;"],"l":{"1":1,"2":1,"3":1,"5":1,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"20":0,"22":0,"23":0,"25":0,"28":0,"29":0,"33":0,"37":0,"42":0,"46":0,"50":0,"54":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/onFinish.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/onFinish.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"onFinish","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":26}}},"2":{"name":"(anonymous_2)","line":30,"loc":{"start":{"line":30,"column":10},"end":{"line":30,"column":27}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":45}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":38}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":47}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":61}},"6":{"start":{"line":13,"column":0},"end":{"line":33,"column":1}},"7":{"start":{"line":14,"column":4},"end":{"line":14,"column":32}},"8":{"start":{"line":15,"column":4},"end":{"line":15,"column":38}},"9":{"start":{"line":16,"column":4},"end":{"line":16,"column":39}},"10":{"start":{"line":18,"column":4},"end":{"line":20,"column":5}},"11":{"start":{"line":19,"column":8},"end":{"line":19,"column":31}},"12":{"start":{"line":22,"column":4},"end":{"line":22,"column":32}},"13":{"start":{"line":23,"column":4},"end":{"line":23,"column":56}},"14":{"start":{"line":24,"column":4},"end":{"line":24,"column":49}},"15":{"start":{"line":27,"column":4},"end":{"line":32,"column":7}},"16":{"start":{"line":31,"column":8},"end":{"line":31,"column":64}},"17":{"start":{"line":35,"column":0},"end":{"line":35,"column":26}}},"branchMap":{"1":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":18,"column":4}},{"start":{"line":18,"column":4},"end":{"line":18,"column":4}}]}},"code":["var Promise = require('../../utils/promise');","var JSONUtils = require('../../json');","var Templating = require('../../templating');","var writeFile = require('../helper/writeFile');","var createTemplateEngine = require('./createTemplateEngine');","","/**","    Finish the generation, write the languages index","","    @param {Output}","    @return {Output}","*/","function onFinish(output) {","    var book = output.getBook();","    var options = output.getOptions();","    var prefix = options.get('prefix');","","    if (!book.isMultilingual()) {","        return Promise(output);","    }","","    var filePath = 'index.html';","    var engine = createTemplateEngine(output, filePath);","    var context = JSONUtils.encodeOutput(output);","","    // Render the theme","    return Templating.renderFile(engine, prefix + '/languages.html', context)","","    // Write it to the disk","    .then(function(tplOut) {","        return writeFile(output, filePath, tplOut.getContent());","    });","}","","module.exports = onFinish;",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"13":1,"14":0,"15":0,"16":0,"18":0,"19":0,"22":0,"23":0,"24":0,"27":0,"31":0,"35":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":10,"column":2}}},"branchMap":{},"code":["","module.exports = {","    render:             require('./render'),","    renderFile:         require('./renderFile'),","    postRender:         require('./postRender'),","    replaceShortcuts:   require('./replaceShortcuts'),","","    ConrefsLoader:      require('./conrefsLoader'),","    ThemesLoader:       require('./themesLoader')","};",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/render.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/render.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"renderTemplate","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":60}}},"2":{"name":"(anonymous_2)","line":38,"loc":{"start":{"line":38,"column":14},"end":{"line":38,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":40}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":57}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":53}},"5":{"start":{"line":15,"column":0},"end":{"line":42,"column":1}},"6":{"start":{"line":16,"column":4},"end":{"line":16,"column":28}},"7":{"start":{"line":19,"column":4},"end":{"line":19,"column":20}},"8":{"start":{"line":22,"column":4},"end":{"line":22,"column":40}},"9":{"start":{"line":25,"column":4},"end":{"line":25,"column":70}},"10":{"start":{"line":27,"column":4},"end":{"line":41,"column":6}},"11":{"start":{"line":39,"column":12},"end":{"line":39,"column":58}},"12":{"start":{"line":44,"column":0},"end":{"line":44,"column":32}}},"branchMap":{"1":{"line":16,"type":"binary-expr","locations":[{"start":{"line":16,"column":14},"end":{"line":16,"column":21}},{"start":{"line":16,"column":25},"end":{"line":16,"column":27}}]}},"code":["var Promise = require('../utils/promise');","var timing = require('../utils/timing');","var TemplateOutput = require('../models/templateOutput');","var replaceShortcuts = require('./replaceShortcuts');","","/**"," * Render a template"," *"," * @param {TemplateEngine} engine"," * @param {String} filePath: absolute path for the loader"," * @param {String} content"," * @param {Object} context (optional)"," * @return {Promise<TemplateOutput>}"," */","function renderTemplate(engine, filePath, content, context) {","    context = context || {};","","    // Mutable objects to contains all blocks requiring post-processing","    var blocks = {};","","    // Create nunjucks environment","    var env = engine.toNunjucks(blocks);","","    // Replace shortcuts from plugin's blocks","    content = replaceShortcuts(engine.getBlocks(), filePath, content);","","    return timing.measure(","        'template.render',","","        Promise.nfcall(","            env.renderString.bind(env),","            content,","            context,","            {","                path: filePath","            }","        )","        .then(function(content) {","            return TemplateOutput.create(content, blocks);","        })","    );","}","","module.exports = renderTemplate;",""],"l":{"1":1,"2":1,"3":1,"4":1,"15":1,"16":0,"19":0,"22":0,"25":0,"27":0,"39":0,"44":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/templateOutput.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/templateOutput.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":0,"7":1,"8":0,"9":1,"10":0,"11":1},"b":{},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":38},"end":{"line":11,"column":49}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":37},"end":{"line":15,"column":48}}},"3":{"name":"(anonymous_3)","line":24,"loc":{"start":{"line":24,"column":38},"end":{"line":24,"column":56}}},"4":{"name":"(anonymous_4)","line":35,"loc":{"start":{"line":35,"column":24},"end":{"line":35,"column":50}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":9,"column":21}},"3":{"start":{"line":11,"column":0},"end":{"line":13,"column":2}},"4":{"start":{"line":12,"column":4},"end":{"line":12,"column":31}},"5":{"start":{"line":15,"column":0},"end":{"line":17,"column":2}},"6":{"start":{"line":16,"column":4},"end":{"line":16,"column":30}},"7":{"start":{"line":24,"column":0},"end":{"line":26,"column":2}},"8":{"start":{"line":25,"column":4},"end":{"line":25,"column":40}},"9":{"start":{"line":35,"column":0},"end":{"line":40,"column":2}},"10":{"start":{"line":36,"column":4},"end":{"line":39,"column":7}},"11":{"start":{"line":42,"column":0},"end":{"line":42,"column":32}}},"branchMap":{},"code":["var Immutable = require('immutable');","","var TemplateOutput = Immutable.Record({","    // Text content of the template","    content:        String(),","","    // Map of blocks to replace / post process","    blocks:         Immutable.Map()","}, 'TemplateOutput');","","TemplateOutput.prototype.getContent = function() {","    return this.get('content');","};","","TemplateOutput.prototype.getBlocks = function() {","    return this.get('blocks');","};","","/**"," * Update content of this output"," * @param {String} content"," * @return {TemplateContent}"," */","TemplateOutput.prototype.setContent = function(content) {","    return this.set('content', content);","};","","/**"," * Create a TemplateOutput from a text content"," * and an object containing block definition"," * @param {String} content"," * @param {Object} blocks"," * @return {TemplateOutput}"," */","TemplateOutput.create = function(content, blocks) {","    return new TemplateOutput({","        content:    content,","        blocks:     Immutable.fromJS(blocks)","    });","};","","module.exports = TemplateOutput;",""],"l":{"1":1,"3":1,"11":1,"12":0,"15":1,"16":0,"24":1,"25":0,"35":1,"36":0,"42":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/replaceShortcuts.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/replaceShortcuts.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1},"b":{},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"applyShortcut","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":42}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":34},"end":{"line":21,"column":55}}},"3":{"name":"replaceShortcuts","line":34,"loc":{"start":{"line":34,"column":0},"end":{"line":34,"column":53}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":57}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":47}},"3":{"start":{"line":10,"column":0},"end":{"line":24,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":36}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":32}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":42}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":38}},"8":{"start":{"line":17,"column":4},"end":{"line":20,"column":6}},"9":{"start":{"line":21,"column":4},"end":{"line":23,"column":7}},"10":{"start":{"line":22,"column":8},"end":{"line":22,"column":73}},"11":{"start":{"line":34,"column":0},"end":{"line":37,"column":1}},"12":{"start":{"line":35,"column":4},"end":{"line":35,"column":52}},"13":{"start":{"line":36,"column":4},"end":{"line":36,"column":52}},"14":{"start":{"line":39,"column":0},"end":{"line":39,"column":34}}},"branchMap":{},"code":["var escapeStringRegexp = require('escape-string-regexp');","var listShortcuts = require('./listShortcuts');","","/**"," * Apply a shortcut of block to a template"," * @param {String} content"," * @param {Shortcut} shortcut"," * @return {String}"," */","function applyShortcut(content, shortcut) {","    var start = shortcut.getStart();","    var end = shortcut.getEnd();","","    var tagStart = shortcut.getStartTag();","    var tagEnd = shortcut.getEndTag();","","    var regex = new RegExp(","        escapeStringRegexp(start) + '([\\\\s\\\\S]*?[^\\\\$])' + escapeStringRegexp(end),","       'g'","    );","    return content.replace(regex, function(all, match) {","        return '{% ' + tagStart + ' %}' + match + '{% ' + tagEnd + ' %}';","    });","}","","/**"," * Replace shortcuts from blocks in a string"," *"," * @param {List<TemplateBlock>} engine"," * @param {String} filePath"," * @param {String} content"," * @return {String}"," */","function replaceShortcuts(blocks, filePath, content) {","    var shortcuts = listShortcuts(blocks, filePath);","    return shortcuts.reduce(applyShortcut, content);","}","","module.exports = replaceShortcuts;",""],"l":{"1":1,"2":1,"10":1,"11":0,"12":0,"14":0,"15":0,"17":0,"21":0,"22":0,"34":1,"35":0,"36":0,"39":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/listShortcuts.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/listShortcuts.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"listShortcuts","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":41}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":13},"end":{"line":20,"column":29}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":16},"end":{"line":23,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":36}},"3":{"start":{"line":12,"column":0},"end":{"line":29,"column":1}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":46}},"5":{"start":{"line":15,"column":4},"end":{"line":17,"column":5}},"6":{"start":{"line":16,"column":8},"end":{"line":16,"column":32}},"7":{"start":{"line":19,"column":4},"end":{"line":28,"column":11}},"8":{"start":{"line":21,"column":12},"end":{"line":21,"column":40}},"9":{"start":{"line":24,"column":12},"end":{"line":27,"column":14}},"10":{"start":{"line":31,"column":0},"end":{"line":31,"column":31}}},"branchMap":{"1":{"line":15,"type":"if","locations":[{"start":{"line":15,"column":4},"end":{"line":15,"column":4}},{"start":{"line":15,"column":4},"end":{"line":15,"column":4}}]},"2":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":16},"end":{"line":25,"column":25}},{"start":{"line":26,"column":16},"end":{"line":26,"column":56}}]}},"code":["var Immutable = require('immutable');","var parsers = require('../parsers');","","/**"," * Return a list of all shortcuts that can apply"," * to a file for a TemplatEngine"," *"," * @param {List<TemplateBlock>} engine"," * @param {String} filePath"," * @return {List<TemplateShortcut>}"," */","function listShortcuts(blocks, filePath) {","    var parser = parsers.getForFile(filePath);","","    if (!parser) {","        return Immutable.List();","    }","","    return blocks","        .map(function(block) {","            return block.getShortcuts();","        })","        .filter(function(shortcuts) {","            return (","                shortcuts &&","                shortcuts.acceptParser(parser.getName())","            );","        });","}","","module.exports = listShortcuts;",""],"l":{"1":1,"2":1,"12":1,"13":0,"15":0,"16":0,"19":0,"21":0,"24":0,"31":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/renderFile.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/renderFile.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"renderTemplateFile","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":55}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":10},"end":{"line":20,"column":21}}},"3":{"name":"(anonymous_3)","line":29,"loc":{"start":{"line":29,"column":10},"end":{"line":29,"column":27}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":38}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":33}},"4":{"start":{"line":13,"column":0},"end":{"line":39,"column":1}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":36}},"6":{"start":{"line":17,"column":4},"end":{"line":17,"column":58}},"7":{"start":{"line":19,"column":4},"end":{"line":37,"column":7}},"8":{"start":{"line":21,"column":8},"end":{"line":23,"column":9}},"9":{"start":{"line":22,"column":12},"end":{"line":22,"column":54}},"10":{"start":{"line":25,"column":8},"end":{"line":25,"column":39}},"11":{"start":{"line":26,"column":8},"end":{"line":26,"column":72}},"12":{"start":{"line":27,"column":8},"end":{"line":27,"column":32}},"13":{"start":{"line":30,"column":8},"end":{"line":34,"column":9}},"14":{"start":{"line":31,"column":12},"end":{"line":33,"column":15}},"15":{"start":{"line":36,"column":8},"end":{"line":36,"column":64}},"16":{"start":{"line":41,"column":0},"end":{"line":41,"column":36}}},"branchMap":{"1":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":21,"column":8}},{"start":{"line":21,"column":8},"end":{"line":21,"column":8}}]},"2":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":8},"end":{"line":30,"column":8}},{"start":{"line":30,"column":8},"end":{"line":30,"column":8}}]}},"code":["var Promise = require('../utils/promise');","var error = require('../utils/error');","var render = require('./render');","","/**"," * Render a template"," *"," * @param {TemplateEngine} engine"," * @param {String} filePath"," * @param {Object} context"," * @return {Promise<TemplateOutput>}"," */","function renderTemplateFile(engine, filePath, context) {","    var loader = engine.getLoader();","","    // Resolve the filePath","    var resolvedFilePath = loader.resolve(null, filePath);","","    return Promise()","    .then(function() {","        if (!loader.async) {","            return loader.getSource(resolvedFilePath);","        }","","        var deferred = Promise.defer();","        loader.getSource(resolvedFilePath, deferred.makeNodeResolver());","        return deferred.promise;","    })","    .then(function(result) {","        if (!result) {","            throw error.TemplateError(new Error('Not found'), {","                filename: filePath","            });","        }","","        return render(engine, result.path, result.src, context);","    });","","}","","module.exports = renderTemplateFile;",""],"l":{"1":1,"2":1,"3":1,"13":1,"14":0,"17":0,"19":0,"21":0,"22":0,"25":0,"26":0,"27":0,"30":0,"31":0,"36":0,"41":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/postRender.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/postRender.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"replaceBlocks","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":40}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":68},"end":{"line":12,"column":89}}},"3":{"name":"postRender","line":35,"loc":{"start":{"line":35,"column":0},"end":{"line":35,"column":36}}},"4":{"name":"(anonymous_4)","line":41,"loc":{"start":{"line":41,"column":35},"end":{"line":41,"column":51}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":11,"column":0},"end":{"line":24,"column":1}},"3":{"start":{"line":12,"column":4},"end":{"line":21,"column":7}},"4":{"start":{"line":13,"column":8},"end":{"line":13,"column":33}},"5":{"start":{"line":15,"column":8},"end":{"line":15,"column":36}},"6":{"start":{"line":16,"column":8},"end":{"line":18,"column":9}},"7":{"start":{"line":17,"column":12},"end":{"line":17,"column":68}},"8":{"start":{"line":20,"column":8},"end":{"line":20,"column":28}},"9":{"start":{"line":23,"column":4},"end":{"line":23,"column":22}},"10":{"start":{"line":35,"column":0},"end":{"line":51,"column":1}},"11":{"start":{"line":36,"column":4},"end":{"line":36,"column":38}},"12":{"start":{"line":37,"column":4},"end":{"line":37,"column":36}},"13":{"start":{"line":39,"column":4},"end":{"line":39,"column":48}},"14":{"start":{"line":41,"column":4},"end":{"line":50,"column":25}},"15":{"start":{"line":42,"column":8},"end":{"line":42,"column":37}},"16":{"start":{"line":44,"column":8},"end":{"line":46,"column":9}},"17":{"start":{"line":45,"column":12},"end":{"line":45,"column":19}},"18":{"start":{"line":48,"column":8},"end":{"line":48,"column":22}},"19":{"start":{"line":53,"column":0},"end":{"line":53,"column":28}}},"branchMap":{"1":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":8}},{"start":{"line":16,"column":8},"end":{"line":16,"column":8}}]},"2":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":8},"end":{"line":44,"column":8}},{"start":{"line":44,"column":8},"end":{"line":44,"column":8}}]}},"code":["var Promise = require('../utils/promise');","","","/**"," * Replace position markers of blocks by body after processing"," * This is done to avoid that markdown/asciidoc processer parse the block content"," *"," * @param {String} content"," * @return {Object} {blocks: Set, content: String}"," */","function replaceBlocks(content, blocks) {","    var newContent = content.replace(/\\{\\{\\-\\%([\\s\\S]+?)\\%\\-\\}\\}/g, function(match, key) {","        var replacedWith = match;","","        var block = blocks.get(key);","        if (block) {","            replacedWith = replaceBlocks(block.get('body'), blocks);","        }","","        return replacedWith;","    });","","    return newContent;","}","","/**"," * Post render a template:"," *     - Execute \"post\" for blocks"," *     - Replace block content"," *"," * @param {TemplateEngine} engine"," * @param {TemplateOutput} content"," * @return {Promise<String>}"," */","function postRender(engine, output) {","    var content = output.getContent();","    var blocks = output.getBlocks();","","    var result = replaceBlocks(content, blocks);","","    return Promise.forEach(blocks, function(block) {","        var post = block.get('post');","","        if (!post) {","            return;","        }","","        return post();","    })","    .thenResolve(result);","}","","module.exports = postRender;",""],"l":{"1":1,"11":1,"12":0,"13":0,"15":0,"16":0,"17":0,"20":0,"23":0,"35":1,"36":0,"37":0,"39":0,"41":0,"42":0,"44":0,"45":0,"48":0,"53":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/conrefsLoader.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/conrefsLoader.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":23,"loc":{"start":{"line":23,"column":10},"end":{"line":23,"column":52}}},"2":{"name":"(anonymous_2)","line":30,"loc":{"start":{"line":30,"column":15},"end":{"line":30,"column":45}}},"3":{"name":"(anonymous_3)","line":34,"loc":{"start":{"line":34,"column":14},"end":{"line":34,"column":33}}},"4":{"name":"(anonymous_4)","line":44,"loc":{"start":{"line":44,"column":18},"end":{"line":44,"column":35}}},"5":{"name":"(anonymous_5)","line":53,"loc":{"start":{"line":53,"column":18},"end":{"line":53,"column":35}}},"6":{"name":"(anonymous_6)","line":63,"loc":{"start":{"line":63,"column":13},"end":{"line":63,"column":32}}},"7":{"name":"(anonymous_7)","line":88,"loc":{"start":{"line":88,"column":16},"end":{"line":88,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":32}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":34}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":49}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":41}},"7":{"start":{"line":20,"column":0},"end":{"line":91,"column":3}},"8":{"start":{"line":24,"column":8},"end":{"line":24,"column":37}},"9":{"start":{"line":25,"column":8},"end":{"line":25,"column":39}},"10":{"start":{"line":26,"column":8},"end":{"line":26,"column":29}},"11":{"start":{"line":27,"column":8},"end":{"line":27,"column":29}},"12":{"start":{"line":31,"column":8},"end":{"line":31,"column":24}},"13":{"start":{"line":33,"column":8},"end":{"line":60,"column":27}},"14":{"start":{"line":36,"column":12},"end":{"line":40,"column":13}},"15":{"start":{"line":37,"column":16},"end":{"line":37,"column":51}},"16":{"start":{"line":39,"column":16},"end":{"line":39,"column":101}},"17":{"start":{"line":39,"column":33},"end":{"line":39,"column":101}},"18":{"start":{"line":43,"column":12},"end":{"line":58,"column":15}},"19":{"start":{"line":45,"column":16},"end":{"line":45,"column":49}},"20":{"start":{"line":47,"column":16},"end":{"line":49,"column":17}},"21":{"start":{"line":48,"column":20},"end":{"line":48,"column":62}},"22":{"start":{"line":51,"column":16},"end":{"line":51,"column":30}},"23":{"start":{"line":54,"column":16},"end":{"line":57,"column":18}},"24":{"start":{"line":65,"column":8},"end":{"line":75,"column":9}},"25":{"start":{"line":68,"column":12},"end":{"line":68,"column":68}},"26":{"start":{"line":71,"column":12},"end":{"line":71,"column":84}},"27":{"start":{"line":74,"column":12},"end":{"line":74,"column":66}},"28":{"start":{"line":78,"column":8},"end":{"line":78,"column":49}},"29":{"start":{"line":79,"column":8},"end":{"line":81,"column":9}},"30":{"start":{"line":80,"column":12},"end":{"line":80,"column":56}},"31":{"start":{"line":84,"column":8},"end":{"line":84,"column":52}},"32":{"start":{"line":89,"column":8},"end":{"line":89,"column":50}},"33":{"start":{"line":93,"column":0},"end":{"line":93,"column":31}}},"branchMap":{"1":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":12},"end":{"line":36,"column":12}},{"start":{"line":36,"column":12},"end":{"line":36,"column":12}}]},"2":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":16},"end":{"line":39,"column":16}},{"start":{"line":39,"column":16},"end":{"line":39,"column":16}}]},"3":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":16},"end":{"line":47,"column":16}},{"start":{"line":47,"column":16},"end":{"line":47,"column":16}}]},"4":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":65,"column":8}},{"start":{"line":65,"column":8},"end":{"line":65,"column":8}}]},"5":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":8},"end":{"line":79,"column":8}},{"start":{"line":79,"column":8},"end":{"line":79,"column":8}}]}},"code":["var path = require('path');","var nunjucks = require('nunjucks');","","var fs = require('../utils/fs');","var Git = require('../utils/git');","var LocationUtils = require('../utils/location');","var PathUtils = require('../utils/path');","","","/**"," * Template loader resolving both:"," *      - relative url (\"./test.md\")"," *      - absolute url (\"/test.md\")"," *      - git url (\"\")"," *"," * @param {String} rootFolder"," * @param {Function(filePath, source)} transformFn (optional)"," * @param {Logger} logger (optional)"," */","var ConrefsLoader = nunjucks.Loader.extend({","    async: true,","","    init: function(rootFolder, transformFn, logger) {","        this.rootFolder = rootFolder;","        this.transformFn = transformFn;","        this.logger = logger;","        this.git = new Git();","    },","","    getSource: function(sourceURL, callback) {","        var that = this;","","        this.git.resolve(sourceURL)","        .then(function(filepath) {","            // Is local file","            if (!filepath) {","                filepath = path.resolve(sourceURL);","            } else {","                if (that.logger) that.logger.debug.ln('resolve from git', sourceURL, 'to', filepath);","            }","","            // Read file from absolute path","            return fs.readFile(filepath)","            .then(function(source) {","                source = source.toString('utf8');","","                if (that.transformFn) {","                    return that.transformFn(filepath, source);","                }","","                return source;","            })","            .then(function(source) {","                return {","                    src: source,","                    path: filepath","                };","            });","        })","        .nodeify(callback);","    },","","    resolve: function(from, to) {","        // If origin is in the book, we enforce result file to be in the book","        if (PathUtils.isInRoot(this.rootFolder, from)) {","","            // Path of current template in the rootFolder (not absolute to fs)","            var fromRelative = path.relative(this.rootFolder, from);","","            // Resolve \"to\" to a filepath relative to rootFolder","            var href = LocationUtils.toAbsolute(to, path.dirname(fromRelative), '');","","            // Return absolute path","            return PathUtils.resolveInRoot(this.rootFolder, href);","        }","","        // If origin is in a git repository, we resolve file in the git repository","        var gitRoot = this.git.resolveRoot(from);","        if (gitRoot) {","            return PathUtils.resolveInRoot(gitRoot, to);","        }","","        // If origin is not in the book (include from a git content ref)","        return path.resolve(path.dirname(from), to);","    },","","    // Handle all files as relative, so that nunjucks pass responsability to 'resolve'","    isRelative: function(filename) {","        return LocationUtils.isRelative(filename);","    }","});","","module.exports = ConrefsLoader;",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"7":1,"20":1,"24":0,"25":0,"26":0,"27":0,"31":0,"33":0,"36":0,"37":0,"39":0,"43":0,"45":0,"47":0,"48":0,"51":0,"54":0,"65":0,"68":0,"71":0,"74":0,"78":0,"79":0,"80":0,"84":0,"89":0,"93":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/git.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/utils/git.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":1,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":1,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":1,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":1,"54":0,"55":1,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"Git","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":15}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":23},"end":{"line":19,"column":43}}},"3":{"name":"(anonymous_3)","line":24,"loc":{"start":{"line":24,"column":28},"end":{"line":24,"column":39}}},"4":{"name":"(anonymous_4)","line":30,"loc":{"start":{"line":30,"column":10},"end":{"line":30,"column":24}}},"5":{"name":"(anonymous_5)","line":36,"loc":{"start":{"line":36,"column":22},"end":{"line":36,"column":42}}},"6":{"name":"(anonymous_6)","line":42,"loc":{"start":{"line":42,"column":10},"end":{"line":42,"column":21}}},"7":{"name":"(anonymous_7)","line":55,"loc":{"start":{"line":55,"column":14},"end":{"line":55,"column":25}}},"8":{"name":"(anonymous_8)","line":66,"loc":{"start":{"line":66,"column":24},"end":{"line":66,"column":41}}},"9":{"name":"(anonymous_9)","line":77,"loc":{"start":{"line":77,"column":10},"end":{"line":77,"column":25}}},"10":{"name":"(anonymous_10)","line":83,"loc":{"start":{"line":83,"column":28},"end":{"line":83,"column":47}}},"11":{"name":"(anonymous_11)","line":101,"loc":{"start":{"line":101,"column":12},"end":{"line":101,"column":29}}},"12":{"name":"(anonymous_12)","line":106,"loc":{"start":{"line":106,"column":15},"end":{"line":106,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":25}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":27}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":33}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":35}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":35}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":25}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":24}},"10":{"start":{"line":13,"column":0},"end":{"line":16,"column":1}},"11":{"start":{"line":14,"column":4},"end":{"line":14,"column":16}},"12":{"start":{"line":15,"column":4},"end":{"line":15,"column":21}},"13":{"start":{"line":19,"column":0},"end":{"line":21,"column":2}},"14":{"start":{"line":20,"column":4},"end":{"line":20,"column":56}},"15":{"start":{"line":24,"column":0},"end":{"line":33,"column":2}},"16":{"start":{"line":25,"column":4},"end":{"line":25,"column":20}},"17":{"start":{"line":27,"column":4},"end":{"line":27,"column":38}},"18":{"start":{"line":27,"column":21},"end":{"line":27,"column":38}},"19":{"start":{"line":29,"column":4},"end":{"line":32,"column":7}},"20":{"start":{"line":31,"column":8},"end":{"line":31,"column":26}},"21":{"start":{"line":36,"column":0},"end":{"line":63,"column":2}},"22":{"start":{"line":37,"column":4},"end":{"line":37,"column":20}},"23":{"start":{"line":39,"column":4},"end":{"line":62,"column":7}},"24":{"start":{"line":44,"column":8},"end":{"line":44,"column":44}},"25":{"start":{"line":47,"column":8},"end":{"line":47,"column":54}},"26":{"start":{"line":49,"column":8},"end":{"line":49,"column":49}},"27":{"start":{"line":49,"column":33},"end":{"line":49,"column":49}},"28":{"start":{"line":52,"column":8},"end":{"line":61,"column":31}},"29":{"start":{"line":56,"column":12},"end":{"line":56,"column":39}},"30":{"start":{"line":58,"column":12},"end":{"line":58,"column":29}},"31":{"start":{"line":58,"column":22},"end":{"line":58,"column":29}},"32":{"start":{"line":59,"column":12},"end":{"line":59,"column":72}},"33":{"start":{"line":66,"column":0},"end":{"line":80,"column":2}},"34":{"start":{"line":68,"column":4},"end":{"line":71,"column":5}},"35":{"start":{"line":69,"column":8},"end":{"line":69,"column":61}},"36":{"start":{"line":69,"column":38},"end":{"line":69,"column":61}},"37":{"start":{"line":70,"column":8},"end":{"line":70,"column":29}},"38":{"start":{"line":72,"column":4},"end":{"line":72,"column":57}},"39":{"start":{"line":72,"column":27},"end":{"line":72,"column":57}},"40":{"start":{"line":73,"column":4},"end":{"line":73,"column":38}},"41":{"start":{"line":73,"column":17},"end":{"line":73,"column":38}},"42":{"start":{"line":76,"column":4},"end":{"line":79,"column":7}},"43":{"start":{"line":78,"column":8},"end":{"line":78,"column":51}},"44":{"start":{"line":83,"column":0},"end":{"line":98,"column":2}},"45":{"start":{"line":84,"column":4},"end":{"line":84,"column":30}},"46":{"start":{"line":87,"column":4},"end":{"line":87,"column":79}},"47":{"start":{"line":87,"column":67},"end":{"line":87,"column":79}},"48":{"start":{"line":90,"column":4},"end":{"line":90,"column":57}},"49":{"start":{"line":91,"column":4},"end":{"line":91,"column":46}},"50":{"start":{"line":92,"column":4},"end":{"line":94,"column":5}},"51":{"start":{"line":93,"column":8},"end":{"line":93,"column":15}},"52":{"start":{"line":97,"column":4},"end":{"line":97,"column":45}},"53":{"start":{"line":101,"column":0},"end":{"line":103,"column":2}},"54":{"start":{"line":102,"column":4},"end":{"line":102,"column":46}},"55":{"start":{"line":106,"column":0},"end":{"line":131,"column":2}},"56":{"start":{"line":107,"column":4},"end":{"line":107,"column":38}},"57":{"start":{"line":109,"column":4},"end":{"line":109,"column":40}},"58":{"start":{"line":109,"column":28},"end":{"line":109,"column":40}},"59":{"start":{"line":110,"column":4},"end":{"line":110,"column":45}},"60":{"start":{"line":112,"column":4},"end":{"line":112,"column":26}},"61":{"start":{"line":113,"column":4},"end":{"line":113,"column":33}},"62":{"start":{"line":114,"column":4},"end":{"line":114,"column":23}},"63":{"start":{"line":117,"column":4},"end":{"line":117,"column":41}},"64":{"start":{"line":118,"column":4},"end":{"line":118,"column":74}},"65":{"start":{"line":119,"column":4},"end":{"line":121,"column":5}},"66":{"start":{"line":120,"column":8},"end":{"line":120,"column":37}},"67":{"start":{"line":124,"column":4},"end":{"line":124,"column":36}},"68":{"start":{"line":126,"column":4},"end":{"line":130,"column":6}},"69":{"start":{"line":133,"column":0},"end":{"line":133,"column":21}}},"branchMap":{"1":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":31},"end":{"line":20,"column":34}},{"start":{"line":20,"column":38},"end":{"line":20,"column":40}}]},"2":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":4}},{"start":{"line":27,"column":4},"end":{"line":27,"column":4}}]},"3":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":8},"end":{"line":49,"column":8}},{"start":{"line":49,"column":8},"end":{"line":49,"column":8}}]},"4":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":12},"end":{"line":58,"column":12}},{"start":{"line":58,"column":12},"end":{"line":58,"column":12}}]},"5":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":4},"end":{"line":68,"column":4}},{"start":{"line":68,"column":4},"end":{"line":68,"column":4}}]},"6":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":8},"end":{"line":69,"column":8}},{"start":{"line":69,"column":8},"end":{"line":69,"column":8}}]},"7":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":4},"end":{"line":72,"column":4}},{"start":{"line":72,"column":4},"end":{"line":72,"column":4}}]},"8":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":73,"column":4}},{"start":{"line":73,"column":4},"end":{"line":73,"column":4}}]},"9":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":4},"end":{"line":87,"column":4}},{"start":{"line":87,"column":4},"end":{"line":87,"column":4}}]},"10":{"line":87,"type":"binary-expr","locations":[{"start":{"line":87,"column":8},"end":{"line":87,"column":20}},{"start":{"line":87,"column":24},"end":{"line":87,"column":65}}]},"11":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":4},"end":{"line":92,"column":4}},{"start":{"line":92,"column":4},"end":{"line":92,"column":4}}]},"12":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":4},"end":{"line":109,"column":4}},{"start":{"line":109,"column":4},"end":{"line":109,"column":4}}]},"13":{"line":113,"type":"binary-expr","locations":[{"start":{"line":113,"column":10},"end":{"line":113,"column":24}},{"start":{"line":113,"column":28},"end":{"line":113,"column":32}}]},"14":{"line":118,"type":"cond-expr","locations":[{"start":{"line":118,"column":37},"end":{"line":118,"column":68}},{"start":{"line":118,"column":71},"end":{"line":118,"column":73}}]},"15":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":4},"end":{"line":119,"column":4}},{"start":{"line":119,"column":4},"end":{"line":119,"column":4}}]}},"code":["var is = require('is');","var path = require('path');","var crc = require('crc');","var URI = require('urijs');","","var pathUtil = require('./path');","var Promise = require('./promise');","var command = require('./command');","var fs = require('./fs');","","var GIT_PREFIX = 'git+';","","function Git() {","    this.tmpDir;","    this.cloned = {};","}","","// Return an unique ID for a combinaison host/ref","Git.prototype.repoID = function(host, ref) {","    return crc.crc32(host+'#'+(ref || '')).toString(16);","};","","// Allocate a temporary folder for cloning repos in it","Git.prototype.allocateDir = function() {","    var that = this;","","    if (this.tmpDir) return Promise();","","    return fs.tmpDir()","    .then(function(dir) {","        that.tmpDir = dir;","    });","};","","// Clone a git repository if non existant","Git.prototype.clone = function(host, ref) {","    var that = this;","","    return this.allocateDir()","","    // Return or clone the git repo","    .then(function() {","        // Unique ID for repo/ref combinaison","        var repoId = that.repoID(host, ref);","","        // Absolute path to the folder","        var repoPath = path.join(that.tmpDir, repoId);","","        if (that.cloned[repoId]) return repoPath;","","        // Clone repo","        return command.exec('git clone '+host+' '+repoPath)","","        // Checkout reference if specified","        .then(function() {","            that.cloned[repoId] = true;","","            if (!ref) return;","            return command.exec('git checkout '+ref, { cwd: repoPath });","        })","        .thenResolve(repoPath);","    });","};","","// Get file from a git repo","Git.prototype.resolve = function(giturl) {","    // Path to a file in a git repo?","    if (!Git.isUrl(giturl)) {","        if (this.resolveRoot(giturl)) return Promise(giturl);","        return Promise(null);","    }","    if (is.string(giturl)) giturl = Git.parseUrl(giturl);","    if (!giturl) return Promise(null);","","    // Clone or get from cache","    return this.clone(giturl.host, giturl.ref)","    .then(function(repo) {","        return path.resolve(repo, giturl.filepath);","    });","};","","// Return root of git repo from a filepath","Git.prototype.resolveRoot = function(filepath) {","    var relativeToGit, repoId;","","    // No git repo cloned, or file is not in a git repository","    if (!this.tmpDir || !pathUtil.isInRoot(this.tmpDir, filepath)) return null;","","    // Extract first directory (is the repo id)","    relativeToGit = path.relative(this.tmpDir, filepath);","    repoId = relativeToGit.split(path.sep)[0];","    if (!repoId) {","        return;","    }","","    // Return an absolute file","    return path.resolve(this.tmpDir, repoId);","};","","// Check if an url is a git dependency url","Git.isUrl = function(giturl) {","    return (giturl.indexOf(GIT_PREFIX) === 0);","};","","// Parse and extract infos","Git.parseUrl = function(giturl) {","    var ref, uri, fileParts, filepath;","","    if (!Git.isUrl(giturl)) return null;","    giturl = giturl.slice(GIT_PREFIX.length);","","    uri = new URI(giturl);","    ref = uri.fragment() || null;","    uri.fragment(null);","","    // Extract file inside the repo (after the .git)","    fileParts = uri.path().split('.git');","    filepath = fileParts.length > 1? fileParts.slice(1).join('.git') : '';","    if (filepath[0] == '/') {","        filepath = filepath.slice(1);","    }","","    // Recreate pathname without the real filename","    uri.path(fileParts[0] + '.git');","","    return {","        host: uri.toString(),","        ref: ref,","        filepath: filepath","    };","};","","module.exports = Git;",""],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"7":1,"8":1,"9":1,"11":1,"13":1,"14":0,"15":0,"19":1,"20":0,"24":1,"25":0,"27":0,"29":0,"31":0,"36":1,"37":0,"39":0,"44":0,"47":0,"49":0,"52":0,"56":0,"58":0,"59":0,"66":1,"68":0,"69":0,"70":0,"72":0,"73":0,"76":0,"78":0,"83":1,"84":0,"87":0,"90":0,"91":0,"92":0,"93":0,"97":0,"101":1,"102":0,"106":1,"107":0,"109":0,"110":0,"112":0,"113":0,"114":0,"117":0,"118":0,"119":0,"120":0,"124":0,"126":0,"133":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/themesLoader.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/templating/themesLoader.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":10},"end":{"line":10,"column":32}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":15},"end":{"line":20,"column":34}}},"3":{"name":"(anonymous_3)","line":47,"loc":{"start":{"line":47,"column":16},"end":{"line":47,"column":27}}},"4":{"name":"(anonymous_4)","line":56,"loc":{"start":{"line":56,"column":19},"end":{"line":56,"column":38}}},"5":{"name":"(anonymous_5)","line":58,"loc":{"start":{"line":58,"column":20},"end":{"line":58,"column":32}}},"6":{"name":"(anonymous_6)","line":61,"loc":{"start":{"line":61,"column":18},"end":{"line":61,"column":37}}},"7":{"name":"(anonymous_7)","line":71,"loc":{"start":{"line":71,"column":21},"end":{"line":71,"column":40}}},"8":{"name":"(anonymous_8)","line":82,"loc":{"start":{"line":82,"column":13},"end":{"line":82,"column":32}}},"9":{"name":"(anonymous_9)","line":102,"loc":{"start":{"line":102,"column":44},"end":{"line":102,"column":63}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":23}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":27}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":41}},"6":{"start":{"line":9,"column":0},"end":{"line":113,"column":3}},"7":{"start":{"line":11,"column":8},"end":{"line":12,"column":33}},"8":{"start":{"line":21,"column":8},"end":{"line":21,"column":35}},"9":{"start":{"line":21,"column":23},"end":{"line":21,"column":35}},"10":{"start":{"line":23,"column":8},"end":{"line":23,"column":48}},"11":{"start":{"line":24,"column":8},"end":{"line":24,"column":58}},"12":{"start":{"line":26,"column":8},"end":{"line":28,"column":9}},"13":{"start":{"line":27,"column":12},"end":{"line":27,"column":24}},"14":{"start":{"line":30,"column":8},"end":{"line":30,"column":53}},"15":{"start":{"line":32,"column":8},"end":{"line":34,"column":73}},"16":{"start":{"line":36,"column":8},"end":{"line":40,"column":10}},"17":{"start":{"line":48,"column":8},"end":{"line":48,"column":20}},"18":{"start":{"line":57,"column":8},"end":{"line":63,"column":15}},"19":{"start":{"line":59,"column":16},"end":{"line":59,"column":33}},"20":{"start":{"line":62,"column":16},"end":{"line":62,"column":70}},"21":{"start":{"line":72,"column":8},"end":{"line":72,"column":62}},"22":{"start":{"line":73,"column":8},"end":{"line":73,"column":86}},"23":{"start":{"line":83,"column":8},"end":{"line":83,"column":43}},"24":{"start":{"line":86,"column":8},"end":{"line":88,"column":9}},"25":{"start":{"line":87,"column":12},"end":{"line":87,"column":56}},"26":{"start":{"line":91,"column":8},"end":{"line":91,"column":58}},"27":{"start":{"line":92,"column":8},"end":{"line":92,"column":58}},"28":{"start":{"line":96,"column":8},"end":{"line":99,"column":9}},"29":{"start":{"line":97,"column":12},"end":{"line":97,"column":71}},"30":{"start":{"line":98,"column":12},"end":{"line":98,"column":62}},"31":{"start":{"line":102,"column":8},"end":{"line":109,"column":11}},"32":{"start":{"line":103,"column":12},"end":{"line":103,"column":47}},"33":{"start":{"line":105,"column":12},"end":{"line":108,"column":14}},"34":{"start":{"line":110,"column":8},"end":{"line":110,"column":39}},"35":{"start":{"line":110,"column":27},"end":{"line":110,"column":39}},"36":{"start":{"line":111,"column":8},"end":{"line":111,"column":46}},"37":{"start":{"line":115,"column":0},"end":{"line":115,"column":30}}},"branchMap":{"1":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":21,"column":8}},{"start":{"line":21,"column":8},"end":{"line":21,"column":8}}]},"2":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":8},"end":{"line":26,"column":8}},{"start":{"line":26,"column":8},"end":{"line":26,"column":8}}]},"3":{"line":62,"type":"binary-expr","locations":[{"start":{"line":62,"column":24},"end":{"line":62,"column":32}},{"start":{"line":62,"column":36},"end":{"line":62,"column":68}}]},"4":{"line":73,"type":"cond-expr","locations":[{"start":{"line":73,"column":35},"end":{"line":73,"column":78}},{"start":{"line":73,"column":81},"end":{"line":73,"column":85}}]},"5":{"line":86,"type":"if","locations":[{"start":{"line":86,"column":8},"end":{"line":86,"column":8}},{"start":{"line":86,"column":8},"end":{"line":86,"column":8}}]},"6":{"line":86,"type":"binary-expr","locations":[{"start":{"line":86,"column":12},"end":{"line":86,"column":40}},{"start":{"line":86,"column":44},"end":{"line":86,"column":48}}]},"7":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":8},"end":{"line":96,"column":8}},{"start":{"line":96,"column":8},"end":{"line":96,"column":8}}]},"8":{"line":106,"type":"binary-expr","locations":[{"start":{"line":106,"column":16},"end":{"line":106,"column":41}},{"start":{"line":107,"column":19},"end":{"line":107,"column":35}}]},"9":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":8},"end":{"line":110,"column":8}},{"start":{"line":110,"column":8},"end":{"line":110,"column":8}}]}},"code":["var Immutable = require('immutable');","var nunjucks = require('nunjucks');","var fs = require('fs');","var path = require('path');","","var PathUtils = require('../utils/path');","","","var ThemesLoader = nunjucks.Loader.extend({","    init: function(searchPaths) {","        this.searchPaths = Immutable.List(searchPaths)","            .map(path.normalize);","    },","","    /**","     * Read source of a resolved filepath","     * @param {String}","     * @return {Object}","     */","    getSource: function(fullpath) {","        if (!fullpath) return null;","","        fullpath = this.resolve(null, fullpath);","        var templateName = this.getTemplateName(fullpath);","","        if(!fullpath) {","            return null;","        }","","        var src = fs.readFileSync(fullpath, 'utf-8');","","        src = '{% do %}var template = template || {}; template.stack = template.stack || []; template.stack.push(template.self); template.self = ' + JSON.stringify(templateName) + '{% enddo %}\\n' +","            src +","            '\\n{% do %}template.self = template.stack.pop();{% enddo %}';","","        return {","            src: src,","            path: fullpath,","            noCache: true","        };","    },","","    /**","     * Nunjucks calls \"isRelative\" to determine when to call \"resolve\".","     * We handle absolute paths ourselves in \".resolve\" so we always return true","     */","    isRelative: function() {","        return true;","    },","","    /**","     * Get original search path containing a template","     * @param {String} filepath","     * @return {String} searchPath","     */","    getSearchPath: function(filepath) {","        return this.searchPaths","            .sortBy(function(s) {","                return -s.length;","            })","            .find(function(basePath) {","                return (filepath && filepath.indexOf(basePath) === 0);","            });","    },","","    /**","     * Get template name from a filepath","     * @param {String} filepath","     * @return {String} name","     */","    getTemplateName: function(filepath) {","        var originalSearchPath = this.getSearchPath(filepath);","        return originalSearchPath? path.relative(originalSearchPath, filepath) : null;","    },","","    /**","     * Resolve a template from a current template","     * @param {String|null} from","     * @param {String} to","     * @return {String|null}","     */","    resolve: function(from, to) {","        var searchPaths = this.searchPaths;","","        // Relative template like \"./test.html\"","        if (PathUtils.isPureRelative(to) && from) {","            return path.resolve(path.dirname(from), to);","        }","","        // Determine in which search folder we currently are","        var originalSearchPath = this.getSearchPath(from);","        var originalFilename = this.getTemplateName(from);","","        // If we are including same file from a different search path","        // Slice the search paths to avoid including from previous ones","        if (originalFilename == to) {","            var currentIndex = searchPaths.indexOf(originalSearchPath);","            searchPaths = searchPaths.slice(currentIndex + 1);","        }","","        // Absolute template to resolve in root folder","        var resultFolder = searchPaths.find(function(basePath) {","            var p = path.resolve(basePath, to);","","            return (","                p.indexOf(basePath) === 0","                && fs.existsSync(p)","            );","        });","        if (!resultFolder) return null;","        return path.resolve(resultFolder, to);","    }","});","","module.exports = ThemesLoader;",""],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"9":1,"11":0,"21":0,"23":0,"24":0,"26":0,"27":0,"30":0,"32":0,"36":0,"48":0,"57":0,"59":0,"62":0,"72":0,"73":0,"83":0,"86":0,"87":0,"91":0,"92":0,"96":0,"97":0,"98":0,"102":0,"103":0,"105":0,"110":0,"111":0,"115":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/createTemplateEngine.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/createTemplateEngine.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0,"33":0,"34":0,"35":0,"36":1,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"templateFolder","line":23,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":29}}},"2":{"name":"createTemplateEngine","line":34,"loc":{"start":{"line":34,"column":0},"end":{"line":34,"column":51}}},"3":{"name":"fileExists","line":61,"loc":{"start":{"line":61,"column":4},"end":{"line":61,"column":34}}},"4":{"name":"getArticleByPath","line":75,"loc":{"start":{"line":75,"column":4},"end":{"line":75,"column":40}}},"5":{"name":"getPageByPath","line":87,"loc":{"start":{"line":87,"column":4},"end":{"line":87,"column":37}}},"6":{"name":"t","line":109,"loc":{"start":{"line":109,"column":15},"end":{"line":109,"column":29}}},"7":{"name":"(anonymous_7)","line":118,"loc":{"start":{"line":118,"column":25},"end":{"line":118,"column":44}}},"8":{"name":"(anonymous_8)","line":123,"loc":{"start":{"line":123,"column":26},"end":{"line":123,"column":45}}},"9":{"name":"(anonymous_9)","line":140,"loc":{"start":{"line":140,"column":24},"end":{"line":140,"column":43}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":51}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":31}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":47}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":38}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":52}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":35}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":44}},"10":{"start":{"line":11,"column":0},"end":{"line":11,"column":60}},"11":{"start":{"line":12,"column":0},"end":{"line":12,"column":65}},"12":{"start":{"line":13,"column":0},"end":{"line":13,"column":63}},"13":{"start":{"line":14,"column":0},"end":{"line":14,"column":45}},"14":{"start":{"line":15,"column":0},"end":{"line":15,"column":51}},"15":{"start":{"line":17,"column":0},"end":{"line":17,"column":47}},"16":{"start":{"line":18,"column":0},"end":{"line":18,"column":61}},"17":{"start":{"line":23,"column":0},"end":{"line":25,"column":1}},"18":{"start":{"line":24,"column":4},"end":{"line":24,"column":43}},"19":{"start":{"line":34,"column":0},"end":{"line":149,"column":1}},"20":{"start":{"line":35,"column":4},"end":{"line":35,"column":32}},"21":{"start":{"line":36,"column":4},"end":{"line":36,"column":34}},"22":{"start":{"line":37,"column":4},"end":{"line":37,"column":31}},"23":{"start":{"line":38,"column":4},"end":{"line":38,"column":34}},"24":{"start":{"line":39,"column":4},"end":{"line":39,"column":36}},"25":{"start":{"line":40,"column":4},"end":{"line":40,"column":40}},"26":{"start":{"line":43,"column":4},"end":{"line":43,"column":46}},"27":{"start":{"line":44,"column":4},"end":{"line":44,"column":57}},"28":{"start":{"line":47,"column":4},"end":{"line":47,"column":61}},"29":{"start":{"line":50,"column":4},"end":{"line":50,"column":47}},"30":{"start":{"line":53,"column":4},"end":{"line":53,"column":43}},"31":{"start":{"line":61,"column":4},"end":{"line":68,"column":5}},"32":{"start":{"line":62,"column":8},"end":{"line":64,"column":9}},"33":{"start":{"line":63,"column":12},"end":{"line":63,"column":25}},"34":{"start":{"line":66,"column":8},"end":{"line":66,"column":71}},"35":{"start":{"line":67,"column":8},"end":{"line":67,"column":39}},"36":{"start":{"line":75,"column":4},"end":{"line":80,"column":5}},"37":{"start":{"line":76,"column":8},"end":{"line":76,"column":50}},"38":{"start":{"line":77,"column":8},"end":{"line":77,"column":39}},"39":{"start":{"line":77,"column":22},"end":{"line":77,"column":39}},"40":{"start":{"line":79,"column":8},"end":{"line":79,"column":55}},"41":{"start":{"line":87,"column":4},"end":{"line":92,"column":5}},"42":{"start":{"line":88,"column":8},"end":{"line":88,"column":44}},"43":{"start":{"line":89,"column":8},"end":{"line":89,"column":36}},"44":{"start":{"line":89,"column":19},"end":{"line":89,"column":36}},"45":{"start":{"line":91,"column":8},"end":{"line":91,"column":51}},"46":{"start":{"line":94,"column":4},"end":{"line":148,"column":7}},"47":{"start":{"line":110,"column":16},"end":{"line":110,"column":43}},"48":{"start":{"line":119,"column":16},"end":{"line":119,"column":62}},"49":{"start":{"line":120,"column":16},"end":{"line":120,"column":76}},"50":{"start":{"line":124,"column":16},"end":{"line":124,"column":70}},"51":{"start":{"line":125,"column":16},"end":{"line":125,"column":58}},"52":{"start":{"line":126,"column":16},"end":{"line":126,"column":80}},"53":{"start":{"line":129,"column":16},"end":{"line":131,"column":17}},"54":{"start":{"line":130,"column":20},"end":{"line":130,"column":58}},"55":{"start":{"line":133,"column":16},"end":{"line":133,"column":57}},"56":{"start":{"line":141,"column":16},"end":{"line":141,"column":51}},"57":{"start":{"line":151,"column":0},"end":{"line":151,"column":38}}},"branchMap":{"1":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":8},"end":{"line":62,"column":8}},{"start":{"line":62,"column":8},"end":{"line":62,"column":8}}]},"2":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":8},"end":{"line":77,"column":8}},{"start":{"line":77,"column":8},"end":{"line":77,"column":8}}]},"3":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":8},"end":{"line":89,"column":8}},{"start":{"line":89,"column":8},"end":{"line":89,"column":8}}]},"4":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":16},"end":{"line":129,"column":16}},{"start":{"line":129,"column":16},"end":{"line":129,"column":16}}]}},"code":["var path = require('path');","var nunjucks = require('nunjucks');","var DoExtension = require('nunjucks-do')(nunjucks);","","var Api = require('../../api');","var deprecate = require('../../api/deprecate');","var JSONUtils = require('../../json');","var LocationUtils = require('../../utils/location');","var fs = require('../../utils/fs');","var PathUtils = require('../../utils/path');","var TemplateEngine = require('../../models/templateEngine');","var templatesFolder = require('../../constants/templatesFolder');","var defaultFilters = require('../../constants/defaultFilters');","var Templating = require('../../templating');","var listSearchPaths = require('./listSearchPaths');","","var fileToURL = require('../helper/fileToURL');","var resolveFileToURL = require('../helper/resolveFileToURL');","","/**"," * Directory for a theme with the templates"," */","function templateFolder(dir) {","    return path.join(dir, templatesFolder);","}","","/**"," * Create templating engine to render themes"," *"," * @param {Output} output"," * @param {String} currentFile"," * @return {TemplateEngine}"," */","function createTemplateEngine(output, currentFile) {","    var book = output.getBook();","    var state = output.getState();","    var i18n = state.getI18n();","    var config = book.getConfig();","    var summary = book.getSummary();","    var outputFolder = output.getRoot();","","    // Search paths for templates","    var searchPaths = listSearchPaths(output);","    var tplSearchPaths = searchPaths.map(templateFolder);","","    // Create loader","    var loader = new Templating.ThemesLoader(tplSearchPaths);","","    // Get languages","    var language = config.getValue('language');","","    // Create API context","    var context = Api.encodeGlobal(output);","","","    /**","     * Check if a file exists","     * @param {String} fileName","     * @return {Boolean}","     */","    function fileExists(fileName) {","        if (!fileName) {","            return false;","        }","","        var filePath = PathUtils.resolveInRoot(outputFolder, fileName);","        return fs.existsSync(filePath);","    }","","    /**","     * Return an article by its path","     * @param {String} filePath","     * @return {Object|undefined}","     */","    function getArticleByPath(filePath) {","        var article = summary.getByPath(filePath);","        if (!article) return undefined;","","        return JSONUtils.encodeSummaryArticle(article);","    }","","    /**","     * Return a page by its path","     * @param {String} filePath","     * @return {Object|undefined}","     */","    function getPageByPath(filePath) {","        var page = output.getPage(filePath);","        if (!page) return undefined;","","        return JSONUtils.encodePage(page, summary);","    }","","    return TemplateEngine.create({","        loader: loader,","","        context: context,","","        globals: {","            getArticleByPath: getArticleByPath,","            getPageByPath: getPageByPath,","            fileExists: fileExists","        },","","        filters: defaultFilters.merge({","            /**","             * Translate a sentence","             */","            t: function t(s) {","                return i18n.t(language, s);","            },","","            /**","             * Resolve an absolute file path into a","             * relative path.","             * it also resolve pages","             */","            resolveFile: function(filePath) {","                filePath = resolveFileToURL(output, filePath);","                return LocationUtils.relativeForFile(currentFile, filePath);","            },","","            resolveAsset: function(filePath) {","                filePath = LocationUtils.toAbsolute(filePath, '', '');","                filePath = path.join('gitbook', filePath);","                filePath = LocationUtils.relativeForFile(currentFile, filePath);","","                // Use assets from parent if language book","                if (book.isLanguageBook()) {","                    filePath = path.join('../', filePath);","                }","","                return LocationUtils.normalize(filePath);","            },","","","            fileExists: deprecate.method(book, 'fileExists', fileExists, 'Filter \"fileExists\" is deprecated, use \"fileExists(filename)\" '),","            getArticleByPath: deprecate.method(book, 'getArticleByPath', fileExists, 'Filter \"getArticleByPath\" is deprecated, use \"getArticleByPath(filename)\" '),","","            contentURL: function(filePath) {","                return fileToURL(output, filePath);","            }","        }),","","        extensions: {","            'DoExtension': new DoExtension()","        }","    });","}","","module.exports = createTemplateEngine;",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"17":1,"18":1,"23":1,"24":0,"34":1,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"43":0,"44":0,"47":0,"50":0,"53":0,"61":1,"62":0,"63":0,"66":0,"67":0,"75":1,"76":0,"77":0,"79":0,"87":1,"88":0,"89":0,"91":0,"94":0,"110":0,"119":0,"120":0,"124":0,"125":0,"126":0,"129":0,"130":0,"133":0,"141":0,"151":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/templateEngine.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/templateEngine.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":1,"11":0,"12":1,"13":0,"14":1,"15":0,"16":1,"17":0,"18":1,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"fnMap":{"1":{"name":"(anonymous_1)","line":24,"loc":{"start":{"line":24,"column":37},"end":{"line":24,"column":48}}},"2":{"name":"(anonymous_2)","line":28,"loc":{"start":{"line":28,"column":38},"end":{"line":28,"column":49}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":38},"end":{"line":32,"column":49}}},"4":{"name":"(anonymous_4)","line":36,"loc":{"start":{"line":36,"column":40},"end":{"line":36,"column":51}}},"5":{"name":"(anonymous_5)","line":40,"loc":{"start":{"line":40,"column":37},"end":{"line":40,"column":48}}},"6":{"name":"(anonymous_6)","line":44,"loc":{"start":{"line":44,"column":38},"end":{"line":44,"column":49}}},"7":{"name":"(anonymous_7)","line":48,"loc":{"start":{"line":48,"column":41},"end":{"line":48,"column":52}}},"8":{"name":"(anonymous_8)","line":58,"loc":{"start":{"line":58,"column":36},"end":{"line":58,"column":51}}},"9":{"name":"(anonymous_9)","line":60,"loc":{"start":{"line":60,"column":23},"end":{"line":60,"column":39}}},"10":{"name":"(anonymous_10)","line":70,"loc":{"start":{"line":70,"column":38},"end":{"line":70,"column":61}}},"11":{"name":"(anonymous_11)","line":97,"loc":{"start":{"line":97,"column":20},"end":{"line":97,"column":51}}},"12":{"name":"(anonymous_12)","line":102,"loc":{"start":{"line":102,"column":19},"end":{"line":102,"column":35}}},"13":{"name":"(anonymous_13)","line":110,"loc":{"start":{"line":110,"column":20},"end":{"line":110,"column":54}}},"14":{"name":"(anonymous_14)","line":115,"loc":{"start":{"line":115,"column":23},"end":{"line":115,"column":46}}},"15":{"name":"(anonymous_15)","line":128,"loc":{"start":{"line":128,"column":24},"end":{"line":128,"column":38}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":35}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":22,"column":21}},"4":{"start":{"line":24,"column":0},"end":{"line":26,"column":2}},"5":{"start":{"line":25,"column":4},"end":{"line":25,"column":30}},"6":{"start":{"line":28,"column":0},"end":{"line":30,"column":2}},"7":{"start":{"line":29,"column":4},"end":{"line":29,"column":31}},"8":{"start":{"line":32,"column":0},"end":{"line":34,"column":2}},"9":{"start":{"line":33,"column":4},"end":{"line":33,"column":31}},"10":{"start":{"line":36,"column":0},"end":{"line":38,"column":2}},"11":{"start":{"line":37,"column":4},"end":{"line":37,"column":33}},"12":{"start":{"line":40,"column":0},"end":{"line":42,"column":2}},"13":{"start":{"line":41,"column":4},"end":{"line":41,"column":30}},"14":{"start":{"line":44,"column":0},"end":{"line":46,"column":2}},"15":{"start":{"line":45,"column":4},"end":{"line":45,"column":31}},"16":{"start":{"line":48,"column":0},"end":{"line":50,"column":2}},"17":{"start":{"line":49,"column":4},"end":{"line":49,"column":34}},"18":{"start":{"line":58,"column":0},"end":{"line":63,"column":2}},"19":{"start":{"line":59,"column":4},"end":{"line":59,"column":34}},"20":{"start":{"line":60,"column":4},"end":{"line":62,"column":7}},"21":{"start":{"line":61,"column":8},"end":{"line":61,"column":40}},"22":{"start":{"line":70,"column":0},"end":{"line":120,"column":2}},"23":{"start":{"line":71,"column":4},"end":{"line":71,"column":34}},"24":{"start":{"line":72,"column":4},"end":{"line":72,"column":34}},"25":{"start":{"line":73,"column":4},"end":{"line":73,"column":36}},"26":{"start":{"line":74,"column":4},"end":{"line":74,"column":36}},"27":{"start":{"line":75,"column":4},"end":{"line":75,"column":42}},"28":{"start":{"line":76,"column":4},"end":{"line":76,"column":36}},"29":{"start":{"line":78,"column":4},"end":{"line":94,"column":6}},"30":{"start":{"line":97,"column":4},"end":{"line":99,"column":7}},"31":{"start":{"line":98,"column":8},"end":{"line":98,"column":58}},"32":{"start":{"line":102,"column":4},"end":{"line":107,"column":7}},"33":{"start":{"line":103,"column":8},"end":{"line":103,"column":47}},"34":{"start":{"line":104,"column":8},"end":{"line":104,"column":61}},"35":{"start":{"line":106,"column":8},"end":{"line":106,"column":45}},"36":{"start":{"line":110,"column":4},"end":{"line":112,"column":7}},"37":{"start":{"line":111,"column":8},"end":{"line":111,"column":47}},"38":{"start":{"line":115,"column":4},"end":{"line":117,"column":7}},"39":{"start":{"line":116,"column":8},"end":{"line":116,"column":39}},"40":{"start":{"line":119,"column":4},"end":{"line":119,"column":15}},"41":{"start":{"line":128,"column":0},"end":{"line":137,"column":2}},"42":{"start":{"line":129,"column":4},"end":{"line":136,"column":7}},"43":{"start":{"line":139,"column":0},"end":{"line":139,"column":32}}},"branchMap":{"1":{"line":130,"type":"binary-expr","locations":[{"start":{"line":130,"column":35},"end":{"line":130,"column":45}},{"start":{"line":130,"column":49},"end":{"line":130,"column":51}}]},"2":{"line":131,"type":"binary-expr","locations":[{"start":{"line":131,"column":34},"end":{"line":131,"column":48}},{"start":{"line":131,"column":52},"end":{"line":131,"column":54}}]},"3":{"line":132,"type":"binary-expr","locations":[{"start":{"line":132,"column":34},"end":{"line":132,"column":45}},{"start":{"line":132,"column":49},"end":{"line":132,"column":51}}]},"4":{"line":133,"type":"binary-expr","locations":[{"start":{"line":133,"column":34},"end":{"line":133,"column":45}},{"start":{"line":133,"column":49},"end":{"line":133,"column":51}}]}},"code":["var nunjucks = require('nunjucks');","var Immutable = require('immutable');","","var TemplateEngine = Immutable.Record({","    // Map of {TemplateBlock}","    blocks:     Immutable.Map(),","","    // Map of Extension","    extensions: Immutable.Map(),","","    // Map of filters: {String} name -> {Function} fn","    filters:    Immutable.Map(),","","    // Map of globals: {String} name -> {Mixed}","    globals:    Immutable.Map(),","","    // Context for filters / blocks","    context:    Object(),","","    // Nunjucks loader","    loader:     nunjucks.FileSystemLoader('views')","}, 'TemplateEngine');","","TemplateEngine.prototype.getBlocks = function() {","    return this.get('blocks');","};","","TemplateEngine.prototype.getGlobals = function() {","    return this.get('globals');","};","","TemplateEngine.prototype.getFilters = function() {","    return this.get('filters');","};","","TemplateEngine.prototype.getShortcuts = function() {","    return this.get('shortcuts');","};","","TemplateEngine.prototype.getLoader = function() {","    return this.get('loader');","};","","TemplateEngine.prototype.getContext = function() {","    return this.get('context');","};","","TemplateEngine.prototype.getExtensions = function() {","    return this.get('extensions');","};","","/**","    Return a block by its name (or undefined)","","    @param {String} name","    @return {TemplateBlock}","*/","TemplateEngine.prototype.getBlock = function(name) {","    var blocks = this.getBlocks();","    return blocks.find(function(block) {","        return block.getName() === name;","    });","};","","/**","    Return a nunjucks environment from this configuration","","    @return {Nunjucks.Environment}","*/","TemplateEngine.prototype.toNunjucks = function(blocksOutput) {","    var loader = this.getLoader();","    var blocks = this.getBlocks();","    var filters = this.getFilters();","    var globals = this.getGlobals();","    var extensions = this.getExtensions();","    var context = this.getContext();","","    var env = new nunjucks.Environment(","        loader,","        {","            // Escaping is done after by the asciidoc/markdown parser","            autoescape: false,","","            // Syntax","            tags: {","                blockStart: '{%',","                blockEnd: '%}',","                variableStart: '{{',","                variableEnd: '}}',","                commentStart: '{###',","                commentEnd: '###}'","            }","        }","    );","","    // Add filters","    filters.forEach(function(filterFn, filterName) {","        env.addFilter(filterName, filterFn.bind(context));","    });","","    // Add blocks","    blocks.forEach(function(block) {","        var extName = block.getExtensionName();","        var Ext = block.toNunjucksExt(context, blocksOutput);","","        env.addExtension(extName, new Ext());","    });","","    // Add globals","    globals.forEach(function(globalValue, globalName) {","        env.addGlobal(globalName, globalValue);","    });","","    // Add other extensions","    extensions.forEach(function(ext, extName) {","        env.addExtension(extName, ext);","    });","","    return env;","};","","/**","    Create a template engine","","    @param {Object} def","    @return {TemplateEngine}","*/","TemplateEngine.create = function(def) {","    return new TemplateEngine({","        blocks:     Immutable.List(def.blocks || []),","        extensions: Immutable.Map(def.extensions || {}),","        filters:    Immutable.Map(def.filters || {}),","        globals:    Immutable.Map(def.globals || {}),","        context:    def.context,","        loader:     def.loader","    });","};","","module.exports = TemplateEngine;",""],"l":{"1":1,"2":1,"4":1,"24":1,"25":0,"28":1,"29":0,"32":1,"33":0,"36":1,"37":0,"40":1,"41":0,"44":1,"45":0,"48":1,"49":0,"58":1,"59":0,"60":0,"61":0,"70":1,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"78":0,"97":0,"98":0,"102":0,"103":0,"104":0,"106":0,"110":0,"111":0,"115":0,"116":0,"119":0,"128":1,"129":0,"139":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/templatesFolder.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/templatesFolder.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":2,"column":28}}},"branchMap":{},"code":["","module.exports = '_layouts';",""],"l":{"2":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/defaultFilters.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/defaultFilters.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":10},"end":{"line":7,"column":33}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":17},"end":{"line":12,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":31}},"3":{"start":{"line":4,"column":0},"end":{"line":15,"column":3}},"4":{"start":{"line":8,"column":8},"end":{"line":8,"column":43}},"5":{"start":{"line":13,"column":8},"end":{"line":13,"column":38}}},"branchMap":{},"code":["var Immutable = require('immutable');","var moment = require('moment');","","module.exports = Immutable.Map({","    // Format a date","    // ex: 'MMMM Do YYYY, h:mm:ss a","    date: function(time, format) {","        return moment(time).format(format);","    },","","    // Relative Time","    dateFromNow: function(time) {","        return moment(time).fromNow();","    }","});",""],"l":{"1":1,"2":1,"4":1,"8":0,"13":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/onPage.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/onPage.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":1},"b":{},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"onPage","line":20,"loc":{"start":{"line":20,"column":0},"end":{"line":20,"column":30}}},"2":{"name":"(anonymous_2)","line":41,"loc":{"start":{"line":41,"column":10},"end":{"line":41,"column":31}}},"3":{"name":"(anonymous_3)","line":49,"loc":{"start":{"line":49,"column":26},"end":{"line":49,"column":37}}},"4":{"name":"(anonymous_4)","line":70,"loc":{"start":{"line":70,"column":14},"end":{"line":70,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":32}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":45}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":39}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":38}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":52}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":40}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":47}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":46}},"10":{"start":{"line":11,"column":0},"end":{"line":11,"column":61}},"11":{"start":{"line":12,"column":0},"end":{"line":12,"column":53}},"12":{"start":{"line":20,"column":0},"end":{"line":74,"column":1}},"13":{"start":{"line":21,"column":4},"end":{"line":21,"column":40}},"14":{"start":{"line":22,"column":4},"end":{"line":22,"column":42}},"15":{"start":{"line":24,"column":4},"end":{"line":24,"column":35}},"16":{"start":{"line":26,"column":4},"end":{"line":26,"column":37}},"17":{"start":{"line":27,"column":4},"end":{"line":27,"column":40}},"18":{"start":{"line":28,"column":4},"end":{"line":28,"column":38}},"19":{"start":{"line":29,"column":4},"end":{"line":29,"column":41}},"20":{"start":{"line":31,"column":4},"end":{"line":31,"column":62}},"21":{"start":{"line":34,"column":4},"end":{"line":34,"column":56}},"22":{"start":{"line":37,"column":4},"end":{"line":37,"column":47}},"23":{"start":{"line":38,"column":4},"end":{"line":38,"column":79}},"24":{"start":{"line":40,"column":4},"end":{"line":73,"column":7}},"25":{"start":{"line":43,"column":8},"end":{"line":43,"column":73}},"26":{"start":{"line":44,"column":8},"end":{"line":46,"column":10}},"27":{"start":{"line":48,"column":8},"end":{"line":61,"column":10}},"28":{"start":{"line":50,"column":16},"end":{"line":59,"column":18}},"29":{"start":{"line":64,"column":8},"end":{"line":64,"column":36}},"30":{"start":{"line":67,"column":8},"end":{"line":72,"column":11}},"31":{"start":{"line":71,"column":12},"end":{"line":71,"column":68}},"32":{"start":{"line":76,"column":0},"end":{"line":76,"column":24}}},"branchMap":{},"code":["var path = require('path');","var omit = require('omit-keys');","","var Templating = require('../../templating');","var Plugins = require('../../plugins');","var JSONUtils = require('../../json');","var LocationUtils = require('../../utils/location');","var Modifiers = require('../modifiers');","var writeFile = require('../helper/writeFile');","var getModifiers = require('../getModifiers');","var createTemplateEngine = require('./createTemplateEngine');","var fileToOutput = require('../helper/fileToOutput');","","/**"," * Write a page as a json file"," *"," * @param {Output} output"," * @param {Page} page"," */","function onPage(output, page) {","    var options   = output.getOptions();","    var prefix    = options.get('prefix');","","    var file      = page.getFile();","","    var book      = output.getBook();","    var plugins   = output.getPlugins();","    var state     = output.getState();","    var resources = state.getResources();","","    var engine = createTemplateEngine(output, page.getPath());","","    // Output file path","    var filePath = fileToOutput(output, file.getPath());","","    // Calcul relative path to the root","    var outputDirName = path.dirname(filePath);","    var basePath = LocationUtils.normalize(path.relative(outputDirName, './'));","","    return Modifiers.modifyHTML(page, getModifiers(output, page))","    .then(function(resultPage) {","        // Generate the context","        var context = JSONUtils.encodeOutputWithPage(output, resultPage);","        context.plugins = {","            resources: Plugins.listResources(plugins, resources).toJS()","        };","","        context.template = {","            getJSContext: function() {","                return {","                    page: omit(context.page, 'content'),","                    config: context.config,","                    file: context.file,","                    gitbook: context.gitbook,","                    basePath: basePath,","                    book: {","                        language: book.getLanguage()","                    }","                };","            }","        };","","        // We should probabbly move it to \"template\" or a \"site\" namespace","        context.basePath = basePath;","","        // Render the theme","        return Templating.renderFile(engine, prefix + '/page.html', context)","","        // Write it to the disk","        .then(function(tplOut) {","            return writeFile(output, filePath, tplOut.getContent());","        });","    });","}","","module.exports = onPage;",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"20":1,"21":0,"22":0,"24":0,"26":0,"27":0,"28":0,"29":0,"31":0,"34":0,"37":0,"38":0,"40":0,"43":0,"44":0,"48":0,"50":0,"64":0,"67":0,"71":0,"76":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/onAsset.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/website/onAsset.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1},"b":{},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"onAsset","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":32}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":10},"end":{"line":19,"column":21}}},"3":{"name":"(anonymous_3)","line":21,"loc":{"start":{"line":21,"column":14},"end":{"line":21,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":10,"column":0},"end":{"line":26,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":32}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":38}},"6":{"start":{"line":13,"column":4},"end":{"line":13,"column":37}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":43}},"8":{"start":{"line":16,"column":4},"end":{"line":16,"column":55}},"9":{"start":{"line":18,"column":4},"end":{"line":25,"column":25}},"10":{"start":{"line":20,"column":8},"end":{"line":23,"column":11}},"11":{"start":{"line":22,"column":12},"end":{"line":22,"column":54}},"12":{"start":{"line":28,"column":0},"end":{"line":28,"column":25}}},"branchMap":{},"code":["var path = require('path');","var fs = require('../../utils/fs');","","/**","    Copy an asset to the output folder","","    @param {Output} output","    @param {Page} page","*/","function onAsset(output, asset) {","    var book = output.getBook();","    var options = output.getOptions();","    var bookFS = book.getContentFS();","","    var outputFolder = options.get('root');","    var outputPath = path.resolve(outputFolder, asset);","","    return fs.ensureFile(outputPath)","    .then(function() {","        return bookFS.readAsStream(asset)","        .then(function(stream) {","            return fs.writeStream(outputPath, stream);","        });","    })","    .thenResolve(output);","}","","module.exports = onAsset;",""],"l":{"1":1,"2":1,"10":1,"11":0,"12":0,"13":0,"15":0,"16":0,"18":0,"20":0,"22":0,"28":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/index.js","s":{"1":1,"2":1,"3":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":45}},"3":{"start":{"line":4,"column":0},"end":{"line":9,"column":3}}},"branchMap":{},"code":["var extend = require('extend');","var WebsiteGenerator = require('../website');","","module.exports = extend({}, WebsiteGenerator, {","    name: 'ebook',","    Options: require('./options'),","    onPage: require('./onPage'),","    onFinish: require('./onFinish')","});",""],"l":{"1":1,"2":1,"4":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/options.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/options.js","s":{"1":1,"2":1,"3":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":15,"column":3}},"3":{"start":{"line":17,"column":0},"end":{"line":17,"column":25}}},"branchMap":{},"code":["var Immutable = require('immutable');","","var Options = Immutable.Record({","    // Root folder for the output","    root:               String(),","","    // Prefix for generation","    prefix:             String('ebook'),","","    // Format to generate using ebook-convert","    format:             String(),","","    // Force use of absolute urls (\"index.html\" instead of \"/\")","    directoryIndex:     Boolean(false)","});","","module.exports = Options;",""],"l":{"1":1,"3":1,"17":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/onPage.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/onPage.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"onPage","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":30}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":10},"end":{"line":19,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":45}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":40}},"3":{"start":{"line":10,"column":0},"end":{"line":22,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":38}},"5":{"start":{"line":14,"column":4},"end":{"line":21,"column":7}},"6":{"start":{"line":20,"column":8},"end":{"line":20,"column":59}},"7":{"start":{"line":24,"column":0},"end":{"line":24,"column":24}}},"branchMap":{},"code":["var WebsiteGenerator = require('../website');","var Modifiers = require('../modifiers');","","/**","    Write a page for ebook output","","    @param {Output} output","    @param {Output}","*/","function onPage(output, page) {","    var options = output.getOptions();","","    // Inline assets","    return Modifiers.modifyHTML(page, [","        Modifiers.inlineAssets(options.get('root'), page.getFile().getPath())","    ])","","    // Write page using website generator","    .then(function(resultPage) {","        return WebsiteGenerator.onPage(output, resultPage);","    });","}","","module.exports = onPage;",""],"l":{"1":1,"2":1,"10":1,"11":0,"14":0,"20":0,"24":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/onFinish.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/onFinish.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":1,"34":0,"35":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"writeSummary","line":20,"loc":{"start":{"line":20,"column":0},"end":{"line":20,"column":30}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":10},"end":{"line":32,"column":27}}},"3":{"name":"runEbookConvert","line":43,"loc":{"start":{"line":43,"column":0},"end":{"line":43,"column":33}}},"4":{"name":"(anonymous_4)","line":54,"loc":{"start":{"line":54,"column":10},"end":{"line":54,"column":28}}},"5":{"name":"(anonymous_5)","line":63,"loc":{"start":{"line":63,"column":18},"end":{"line":63,"column":33}}},"6":{"name":"(anonymous_6)","line":66,"loc":{"start":{"line":66,"column":14},"end":{"line":66,"column":28}}},"7":{"name":"onFinish","line":86,"loc":{"start":{"line":86,"column":0},"end":{"line":86,"column":26}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":38}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":45}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":45}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":41}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":45}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":47}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":55}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":34}},"11":{"start":{"line":20,"column":0},"end":{"line":35,"column":1}},"12":{"start":{"line":21,"column":4},"end":{"line":21,"column":38}},"13":{"start":{"line":22,"column":4},"end":{"line":22,"column":39}},"14":{"start":{"line":24,"column":4},"end":{"line":24,"column":32}},"15":{"start":{"line":25,"column":4},"end":{"line":25,"column":73}},"16":{"start":{"line":26,"column":4},"end":{"line":26,"column":49}},"17":{"start":{"line":29,"column":4},"end":{"line":34,"column":7}},"18":{"start":{"line":33,"column":8},"end":{"line":33,"column":64}},"19":{"start":{"line":43,"column":0},"end":{"line":78,"column":1}},"20":{"start":{"line":44,"column":4},"end":{"line":44,"column":36}},"21":{"start":{"line":45,"column":4},"end":{"line":45,"column":38}},"22":{"start":{"line":46,"column":4},"end":{"line":46,"column":39}},"23":{"start":{"line":47,"column":4},"end":{"line":47,"column":40}},"24":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"25":{"start":{"line":50,"column":8},"end":{"line":50,"column":31}},"26":{"start":{"line":53,"column":4},"end":{"line":77,"column":25}},"27":{"start":{"line":55,"column":8},"end":{"line":60,"column":20}},"28":{"start":{"line":62,"column":8},"end":{"line":75,"column":11}},"29":{"start":{"line":64,"column":12},"end":{"line":64,"column":31}},"30":{"start":{"line":67,"column":12},"end":{"line":72,"column":13}},"31":{"start":{"line":68,"column":16},"end":{"line":71,"column":19}},"32":{"start":{"line":74,"column":12},"end":{"line":74,"column":40}},"33":{"start":{"line":86,"column":0},"end":{"line":89,"column":1}},"34":{"start":{"line":87,"column":4},"end":{"line":88,"column":27}},"35":{"start":{"line":91,"column":0},"end":{"line":91,"column":26}}},"branchMap":{"1":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":4},"end":{"line":49,"column":4}},{"start":{"line":49,"column":4},"end":{"line":49,"column":4}}]},"2":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":12},"end":{"line":67,"column":12}},{"start":{"line":67,"column":12},"end":{"line":67,"column":12}}]}},"code":["var path = require('path');","","var WebsiteGenerator = require('../website');","var JSONUtils = require('../../json');","var Templating = require('../../templating');","var Promise = require('../../utils/promise');","var error = require('../../utils/error');","var command = require('../../utils/command');","var writeFile = require('../helper/writeFile');","","var getConvertOptions = require('./getConvertOptions');","var SUMMARY_FILE = 'SUMMARY.html';","","/**","    Write the SUMMARY.html","","    @param {Output}","    @return {Output}","*/","function writeSummary(output) {","    var options = output.getOptions();","    var prefix = options.get('prefix');","","    var filePath = SUMMARY_FILE;","    var engine = WebsiteGenerator.createTemplateEngine(output, filePath);","    var context = JSONUtils.encodeOutput(output);","","    // Render the theme","    return Templating.renderFile(engine, prefix + '/summary.html', context)","","    // Write it to the disk","    .then(function(tplOut) {","        return writeFile(output, filePath, tplOut.getContent());","    });","}","","/**","    Generate the ebook file as \"index.pdf\"","","    @param {Output}","    @return {Output}","*/","function runEbookConvert(output) {","    var logger = output.getLogger();","    var options = output.getOptions();","    var format = options.get('format');","    var outputFolder = output.getRoot();","","    if (!format) {","        return Promise(output);","    }","","    return getConvertOptions(output)","    .then(function(options) {","        var cmd = [","            'ebook-convert',","            path.resolve(outputFolder, SUMMARY_FILE),","            path.resolve(outputFolder, 'index.' + format),","            command.optionsToShellArgs(options)","        ].join(' ');","","        return command.exec(cmd)","        .progress(function(data) {","            logger.debug(data);","        })","        .fail(function(err) {","            if (err.code == 127) {","                throw error.RequireInstallError({","                    cmd: 'ebook-convert',","                    install: 'Install it from Calibre: https://calibre-ebook.com'","                });","            }","","            throw error.EbookError(err);","        });","    })","    .thenResolve(output);","}","","/**","    Finish the generation, generates the SUMMARY.html","","    @param {Output}","    @return {Output}","*/","function onFinish(output) {","    return writeSummary(output)","    .then(runEbookConvert);","}","","module.exports = onFinish;",""],"l":{"1":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"11":1,"12":1,"20":1,"21":0,"22":0,"24":0,"25":0,"26":0,"29":0,"33":0,"43":1,"44":0,"45":0,"46":0,"47":0,"49":0,"50":0,"53":0,"55":0,"62":0,"64":0,"67":0,"68":0,"74":0,"86":1,"87":0,"91":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/getConvertOptions.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/getConvertOptions.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"getConvertOptions","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":35}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":10},"end":{"line":21,"column":21}}},"3":{"name":"(anonymous_3)","line":50,"loc":{"start":{"line":50,"column":16},"end":{"line":50,"column":47}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":49}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":45}},"5":{"start":{"line":13,"column":0},"end":{"line":70,"column":1}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":38}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":39}},"8":{"start":{"line":17,"column":4},"end":{"line":17,"column":32}},"9":{"start":{"line":18,"column":4},"end":{"line":18,"column":34}},"10":{"start":{"line":20,"column":4},"end":{"line":69,"column":7}},"11":{"start":{"line":22,"column":8},"end":{"line":22,"column":45}},"12":{"start":{"line":23,"column":8},"end":{"line":40,"column":10}},"13":{"start":{"line":42,"column":8},"end":{"line":44,"column":9}},"14":{"start":{"line":43,"column":12},"end":{"line":43,"column":27}},"15":{"start":{"line":46,"column":8},"end":{"line":68,"column":11}},"16":{"start":{"line":51,"column":12},"end":{"line":51,"column":59}},"17":{"start":{"line":53,"column":12},"end":{"line":67,"column":15}},"18":{"start":{"line":73,"column":0},"end":{"line":73,"column":35}}},"branchMap":{"1":{"line":29,"type":"binary-expr","locations":[{"start":{"line":29,"column":44},"end":{"line":29,"column":62}},{"start":{"line":29,"column":66},"end":{"line":29,"column":93}}]},"2":{"line":39,"type":"cond-expr","locations":[{"start":{"line":39,"column":63},"end":{"line":39,"column":67}},{"start":{"line":39,"column":70},"end":{"line":39,"column":79}}]},"3":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":8},"end":{"line":42,"column":8}},{"start":{"line":42,"column":8},"end":{"line":42,"column":8}}]}},"code":["var extend = require('extend');","","var Promise = require('../../utils/promise');","var getPDFTemplate = require('./getPDFTemplate');","var getCoverPath = require('./getCoverPath');","","/**","    Generate options for ebook-convert","","    @param {Output}","    @return {Promise<Object>}","*/","function getConvertOptions(output) {","    var options = output.getOptions();","    var format = options.get('format');","","    var book = output.getBook();","    var config = book.getConfig();","","    return Promise()","    .then(function() {","        var coverPath = getCoverPath(output);","        var options = {","            '--cover':                      coverPath,","            '--title':                      config.getValue('title'),","            '--comments':                   config.getValue('description'),","            '--isbn':                       config.getValue('isbn'),","            '--authors':                    config.getValue('author'),","            '--language':                   book.getLanguage() || config.getValue('language'),","            '--book-producer':              'GitBook',","            '--publisher':                  'GitBook',","            '--chapter':                    'descendant-or-self::*[contains(concat(\\' \\', normalize-space(@class), \\' \\'), \\' book-chapter \\')]',","            '--level1-toc':                 'descendant-or-self::*[contains(concat(\\' \\', normalize-space(@class), \\' \\'), \\' book-chapter-1 \\')]',","            '--level2-toc':                 'descendant-or-self::*[contains(concat(\\' \\', normalize-space(@class), \\' \\'), \\' book-chapter-2 \\')]',","            '--level3-toc':                 'descendant-or-self::*[contains(concat(\\' \\', normalize-space(@class), \\' \\'), \\' book-chapter-3 \\')]',","            '--max-levels':                 '1',","            '--no-chapters-in-toc':         true,","            '--breadth-first':              true,","            '--dont-split-on-page-breaks':  format === 'epub'? true : undefined","        };","","        if (format !== 'pdf') {","            return options;","        }","","        return Promise.all([","            getPDFTemplate(output, 'header'),","            getPDFTemplate(output, 'footer')","        ])","        .spread(function(headerTpl, footerTpl) {","            var pdfOptions = config.getValue('pdf').toJS();","","            return options = extend(options, {","                '--chapter-mark':           String(pdfOptions.chapterMark),","                '--page-breaks-before':     String(pdfOptions.pageBreaksBefore),","                '--margin-left':            String(pdfOptions.margin.left),","                '--margin-right':           String(pdfOptions.margin.right),","                '--margin-top':             String(pdfOptions.margin.top),","                '--margin-bottom':          String(pdfOptions.margin.bottom),","                '--pdf-default-font-size':  String(pdfOptions.fontSize),","                '--pdf-mono-font-size':     String(pdfOptions.fontSize),","                '--paper-size':             String(pdfOptions.paperSize),","                '--pdf-page-numbers':       Boolean(pdfOptions.pageNumbers),","                '--pdf-sans-family':        String(pdfOptions.fontFamily),","                '--pdf-header-template':    headerTpl,","                '--pdf-footer-template':    footerTpl","            });","        });","    });","}","","","module.exports = getConvertOptions;",""],"l":{"1":1,"3":1,"4":1,"5":1,"13":1,"14":0,"15":0,"17":0,"18":0,"20":0,"22":0,"23":0,"42":0,"43":0,"46":0,"51":0,"53":0,"73":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/getPDFTemplate.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/getPDFTemplate.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"getPDFTemplate","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":38}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":10},"end":{"line":32,"column":27}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":29}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":38}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":45}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":45}},"6":{"start":{"line":16,"column":0},"end":{"line":39,"column":1}},"7":{"start":{"line":17,"column":4},"end":{"line":17,"column":43}},"8":{"start":{"line":18,"column":4},"end":{"line":18,"column":38}},"9":{"start":{"line":19,"column":4},"end":{"line":19,"column":73}},"10":{"start":{"line":22,"column":4},"end":{"line":22,"column":49}},"11":{"start":{"line":23,"column":4},"end":{"line":26,"column":6}},"12":{"start":{"line":29,"column":4},"end":{"line":38,"column":7}},"13":{"start":{"line":33,"column":8},"end":{"line":37,"column":11}},"14":{"start":{"line":41,"column":0},"end":{"line":41,"column":32}}},"branchMap":{},"code":["var juice = require('juice');","","var WebsiteGenerator = require('../website');","var JSONUtils = require('../../json');","var Templating = require('../../templating');","var Promise = require('../../utils/promise');","","","/**","    Generate PDF header/footer templates","","    @param {Output} output","    @param {String} type","    @return {String}","*/","function getPDFTemplate(output, type) {","    var filePath = 'pdf_' + type + '.html';","    var outputRoot = output.getRoot();","    var engine = WebsiteGenerator.createTemplateEngine(output, filePath);","","    // Generate context","    var context = JSONUtils.encodeOutput(output);","    context.page = {","        num: '_PAGENUM_',","        title: '_SECTION_'","    };","","    // Render the theme","    return Templating.renderFile(engine, 'ebook/' + filePath, context)","","    // Inline css and assets","    .then(function(tplOut) {","        return Promise.nfcall(juice.juiceResources, tplOut.getContent(), {","            webResources: {","                relativeTo: outputRoot","            }","        });","    });","}","","module.exports = getPDFTemplate;",""],"l":{"1":1,"3":1,"4":1,"5":1,"6":1,"16":1,"17":0,"18":0,"19":0,"22":0,"23":0,"29":0,"33":0,"41":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/getCoverPath.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/ebook/getCoverPath.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"getCoverPath","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":30}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":10,"column":0},"end":{"line":28,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":38}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":32}},"6":{"start":{"line":13,"column":4},"end":{"line":13,"column":34}},"7":{"start":{"line":14,"column":4},"end":{"line":14,"column":58}},"8":{"start":{"line":17,"column":4},"end":{"line":17,"column":51}},"9":{"start":{"line":18,"column":4},"end":{"line":20,"column":5}},"10":{"start":{"line":19,"column":8},"end":{"line":19,"column":21}},"11":{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},"12":{"start":{"line":24,"column":8},"end":{"line":24,"column":68}},"13":{"start":{"line":27,"column":4},"end":{"line":27,"column":17}},"14":{"start":{"line":30,"column":0},"end":{"line":30,"column":30}}},"branchMap":{"1":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":18,"column":4}},{"start":{"line":18,"column":4},"end":{"line":18,"column":4}}]},"2":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":23,"column":4}},{"start":{"line":23,"column":4},"end":{"line":23,"column":4}}]}},"code":["var path = require('path');","var fs = require('../../utils/fs');","","/**","    Resolve path to cover file to use","","    @param {Output}","    @return {String}","*/","function getCoverPath(output) {","    var outputRoot = output.getRoot();","    var book = output.getBook();","    var config = book.getConfig();","    var coverName = config.getValue('cover', 'cover.jpg');","","    // Resolve to absolute","    var cover = fs.pickFile(outputRoot, coverName);","    if (cover) {","        return cover;","    }","","    // Multilingual? try parent folder","    if (book.isLanguageBook()) {","        cover = fs.pickFile(path.join(outputRoot, '..'), coverName);","    }","","    return cover;","}","","module.exports = getCoverPath;",""],"l":{"1":1,"2":1,"10":1,"11":0,"12":0,"13":0,"14":0,"17":0,"18":0,"19":0,"23":0,"24":0,"27":0,"30":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/generateBook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/generateBook.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":1,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"fnMap":{"1":{"name":"processOutput","line":22,"loc":{"start":{"line":22,"column":0},"end":{"line":22,"column":47}}},"2":{"name":"(anonymous_2)","line":31,"loc":{"start":{"line":31,"column":12},"end":{"line":31,"column":29}}},"3":{"name":"(anonymous_3)","line":38,"loc":{"start":{"line":38,"column":12},"end":{"line":38,"column":37}}},"4":{"name":"(anonymous_4)","line":52,"loc":{"start":{"line":52,"column":12},"end":{"line":52,"column":29}}},"5":{"name":"(anonymous_5)","line":55,"loc":{"start":{"line":55,"column":12},"end":{"line":55,"column":29}}},"6":{"name":"(anonymous_6)","line":61,"loc":{"start":{"line":61,"column":10},"end":{"line":61,"column":27}}},"7":{"name":"(anonymous_7)","line":72,"loc":{"start":{"line":72,"column":9},"end":{"line":72,"column":26}}},"8":{"name":"(anonymous_8)","line":86,"loc":{"start":{"line":86,"column":38},"end":{"line":86,"column":57}}},"9":{"name":"(anonymous_9)","line":105,"loc":{"start":{"line":105,"column":12},"end":{"line":105,"column":29}}},"10":{"name":"(anonymous_10)","line":108,"loc":{"start":{"line":108,"column":12},"end":{"line":108,"column":29}}},"11":{"name":"(anonymous_11)","line":114,"loc":{"start":{"line":114,"column":10},"end":{"line":114,"column":27}}},"12":{"name":"(anonymous_12)","line":124,"loc":{"start":{"line":124,"column":12},"end":{"line":124,"column":29}}},"13":{"name":"(anonymous_13)","line":127,"loc":{"start":{"line":127,"column":12},"end":{"line":127,"column":29}}},"14":{"name":"generateBook","line":155,"loc":{"start":{"line":155,"column":0},"end":{"line":155,"column":48}}},"15":{"name":"(anonymous_15)","line":170,"loc":{"start":{"line":170,"column":10},"end":{"line":170,"column":27}}},"16":{"name":"(anonymous_16)","line":182,"loc":{"start":{"line":182,"column":10},"end":{"line":182,"column":27}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":41}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":42}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":32}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":37}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":49}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":45}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":47}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":49}},"11":{"start":{"line":13,"column":0},"end":{"line":13,"column":47}},"12":{"start":{"line":22,"column":0},"end":{"line":132,"column":1}},"13":{"start":{"line":23,"column":4},"end":{"line":131,"column":6}},"14":{"start":{"line":32,"column":16},"end":{"line":32,"column":44}},"15":{"start":{"line":33,"column":16},"end":{"line":33,"column":46}},"16":{"start":{"line":34,"column":16},"end":{"line":34,"column":48}},"17":{"start":{"line":36,"column":16},"end":{"line":36,"column":37}},"18":{"start":{"line":39,"column":16},"end":{"line":39,"column":44}},"19":{"start":{"line":40,"column":16},"end":{"line":40,"column":46}},"20":{"start":{"line":42,"column":16},"end":{"line":42,"column":53}},"21":{"start":{"line":43,"column":16},"end":{"line":43,"column":50}},"22":{"start":{"line":44,"column":16},"end":{"line":44,"column":48}},"23":{"start":{"line":53,"column":16},"end":{"line":53,"column":26}},"24":{"start":{"line":56,"column":16},"end":{"line":56,"column":30}},"25":{"start":{"line":62,"column":8},"end":{"line":64,"column":9}},"26":{"start":{"line":63,"column":12},"end":{"line":63,"column":26}},"27":{"start":{"line":66,"column":8},"end":{"line":66,"column":40}},"28":{"start":{"line":73,"column":8},"end":{"line":73,"column":36}},"29":{"start":{"line":75,"column":8},"end":{"line":77,"column":9}},"30":{"start":{"line":76,"column":12},"end":{"line":76,"column":19}},"31":{"start":{"line":79,"column":8},"end":{"line":79,"column":38}},"32":{"start":{"line":80,"column":8},"end":{"line":80,"column":36}},"33":{"start":{"line":81,"column":8},"end":{"line":81,"column":42}},"34":{"start":{"line":82,"column":8},"end":{"line":82,"column":42}},"35":{"start":{"line":83,"column":8},"end":{"line":83,"column":38}},"36":{"start":{"line":84,"column":8},"end":{"line":84,"column":42}},"37":{"start":{"line":86,"column":8},"end":{"line":100,"column":11}},"38":{"start":{"line":88,"column":12},"end":{"line":88,"column":97}},"39":{"start":{"line":89,"column":12},"end":{"line":95,"column":15}},"40":{"start":{"line":97,"column":12},"end":{"line":97,"column":31}},"41":{"start":{"line":98,"column":12},"end":{"line":98,"column":83}},"42":{"start":{"line":99,"column":12},"end":{"line":99,"column":56}},"43":{"start":{"line":106,"column":16},"end":{"line":106,"column":26}},"44":{"start":{"line":109,"column":16},"end":{"line":109,"column":30}},"45":{"start":{"line":115,"column":8},"end":{"line":117,"column":9}},"46":{"start":{"line":116,"column":12},"end":{"line":116,"column":26}},"47":{"start":{"line":119,"column":8},"end":{"line":119,"column":42}},"48":{"start":{"line":125,"column":16},"end":{"line":125,"column":26}},"49":{"start":{"line":128,"column":16},"end":{"line":128,"column":30}},"50":{"start":{"line":155,"column":0},"end":{"line":191,"column":1}},"51":{"start":{"line":156,"column":4},"end":{"line":156,"column":41}},"52":{"start":{"line":157,"column":4},"end":{"line":157,"column":71}},"53":{"start":{"line":158,"column":4},"end":{"line":158,"column":27}},"54":{"start":{"line":160,"column":4},"end":{"line":190,"column":7}},"55":{"start":{"line":171,"column":8},"end":{"line":171,"column":40}},"56":{"start":{"line":172,"column":8},"end":{"line":172,"column":42}},"57":{"start":{"line":174,"column":8},"end":{"line":174,"column":63}},"58":{"start":{"line":175,"column":8},"end":{"line":176,"column":33}},"59":{"start":{"line":183,"column":8},"end":{"line":183,"column":40}},"60":{"start":{"line":184,"column":8},"end":{"line":184,"column":29}},"61":{"start":{"line":185,"column":8},"end":{"line":185,"column":42}},"62":{"start":{"line":187,"column":8},"end":{"line":187,"column":93}},"63":{"start":{"line":189,"column":8},"end":{"line":189,"column":22}},"64":{"start":{"line":193,"column":0},"end":{"line":193,"column":30}}},"branchMap":{"1":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":8},"end":{"line":62,"column":8}},{"start":{"line":62,"column":8},"end":{"line":62,"column":8}}]},"2":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":8},"end":{"line":75,"column":8}},{"start":{"line":75,"column":8},"end":{"line":75,"column":8}}]},"3":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":8},"end":{"line":115,"column":8}},{"start":{"line":115,"column":8},"end":{"line":115,"column":8}}]},"4":{"line":157,"type":"cond-expr","locations":[{"start":{"line":157,"column":33},"end":{"line":157,"column":52}},{"start":{"line":157,"column":55},"end":{"line":157,"column":70}}]}},"code":["var path = require('path');","var Immutable = require('immutable');","","var Output = require('../models/output');","var Promise = require('../utils/promise');","var fs = require('../utils/fs');","","var callHook = require('./callHook');","var preparePlugins = require('./preparePlugins');","var preparePages = require('./preparePages');","var prepareAssets = require('./prepareAssets');","var generateAssets = require('./generateAssets');","var generatePages = require('./generatePages');","","/**"," * Process an output to generate the book"," *"," * @param {Generator} generator"," * @param {Output} output"," * @return {Promise<Output>}"," */","function processOutput(generator, startOutput) {","    return Promise(startOutput)","    .then(preparePlugins)","    .then(preparePages)","    .then(prepareAssets)","","    .then(","        callHook.bind(null,","            'config',","            function(output) {","                var book = output.getBook();","                var config = book.getConfig();","                var values = config.getValues();","","                return values.toJS();","            },","            function(output, result) {","                var book = output.getBook();","                var config = book.getConfig();","","                config = config.updateValues(result);","                book = book.set('config', config);","                return output.set('book', book);","            }","        )","    )","","    .then(","        callHook.bind(null,","            'init',","            function(output) {","                return {};","            },","            function(output) {","                return output;","            }","        )","    )","","    .then(function(output) {","        if (!generator.onInit) {","            return output;","        }","","        return generator.onInit(output);","    })","","    .then(generateAssets.bind(null, generator))","    .then(generatePages.bind(null, generator))","","    .tap(function(output) {","        var book = output.getBook();","","        if (!book.isMultilingual()) {","            return;","        }","","        var logger = book.getLogger();","        var books = book.getBooks();","        var outputRoot = output.getRoot();","        var plugins = output.getPlugins();","        var state = output.getState();","        var options = output.getOptions();","","        return Promise.forEach(books, function(langBook) {","            // Inherits plugins list, options and state","            var langOptions = options.set('root', path.join(outputRoot, langBook.getLanguage()));","            var langOutput = new Output({","                book:       langBook,","                options:    langOptions,","                state:      state,","                generator:  generator.name,","                plugins:    plugins","            });","","            logger.info.ln('');","            logger.info.ln('generating language \"' + langBook.getLanguage() + '\"');","            return processOutput(generator, langOutput);","        });","    })","","    .then(callHook.bind(null,","        'finish:before',","            function(output) {","                return {};","            },","            function(output) {","                return output;","            }","        )","    )","","    .then(function(output) {","        if (!generator.onFinish) {","            return output;","        }","","        return generator.onFinish(output);","    })","","    .then(callHook.bind(null,","        'finish',","            function(output) {","                return {};","            },","            function(output) {","                return output;","            }","        )","    );","}","","/**"," * Generate a book using a generator."," *"," * The overall process is:"," *     1. List and load plugins for this book"," *     2. Call hook \"config\""," *     3. Call hook \"init\""," *     4. Initialize generator"," *     5. List all assets and pages"," *     6. Copy all assets to output"," *     7. Generate all pages"," *     8. Call hook \"finish:before\""," *     9. Finish generation"," *     10. Call hook \"finish\""," *"," *"," * @param {Generator} generator"," * @param {Book} book"," * @param {Object} options"," * @return {Promise<Output>}"," */","function generateBook(generator, book, options) {","    options = generator.Options(options);","    var state = generator.State? generator.State({}) : Immutable.Map();","    var start = Date.now();","","    return Promise(","        new Output({","            book: book,","            options: options,","            state: state,","            generator: generator.name","        })","    )","","    // Cleanup output folder","    .then(function(output) {","        var logger = output.getLogger();","        var rootFolder = output.getRoot();","","        logger.debug.ln('cleanup folder \"' + rootFolder + '\"');","        return fs.ensureFolder(rootFolder)","            .thenResolve(output);","    })","","    .then(processOutput.bind(null, generator))","","    // Log duration and end message","    .then(function(output) {","        var logger = output.getLogger();","        var end = Date.now();","        var duration = (end - start)/1000;","","        logger.info.ok('generation finished with success in ' + duration.toFixed(1) + 's !');","","        return output;","    });","}","","module.exports = generateBook;",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"22":1,"23":0,"32":0,"33":0,"34":0,"36":0,"39":0,"40":0,"42":0,"43":0,"44":0,"53":0,"56":0,"62":0,"63":0,"66":0,"73":0,"75":0,"76":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"86":0,"88":0,"89":0,"97":0,"98":0,"99":0,"106":0,"109":0,"115":0,"116":0,"119":0,"125":0,"128":0,"155":1,"156":0,"157":0,"158":0,"160":0,"171":0,"172":0,"174":0,"175":0,"183":0,"184":0,"185":0,"187":0,"189":0,"193":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/output.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/models/output.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":0,"9":1,"10":0,"11":1,"12":0,"13":1,"14":0,"15":1,"16":0,"17":1,"18":0,"19":1,"20":0,"21":0,"22":0,"23":1,"24":0,"25":1,"26":0,"27":1,"28":0,"29":1,"30":0,"31":1},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":27},"end":{"line":28,"column":38}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":32},"end":{"line":32,"column":43}}},"3":{"name":"(anonymous_3)","line":36,"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":41}}},"4":{"name":"(anonymous_4)","line":40,"loc":{"start":{"line":40,"column":28},"end":{"line":40,"column":39}}},"5":{"name":"(anonymous_5)","line":44,"loc":{"start":{"line":44,"column":30},"end":{"line":44,"column":41}}},"6":{"name":"(anonymous_6)","line":48,"loc":{"start":{"line":48,"column":29},"end":{"line":48,"column":40}}},"7":{"name":"(anonymous_7)","line":52,"loc":{"start":{"line":52,"column":28},"end":{"line":52,"column":39}}},"8":{"name":"(anonymous_8)","line":62,"loc":{"start":{"line":62,"column":27},"end":{"line":62,"column":46}}},"9":{"name":"(anonymous_9)","line":74,"loc":{"start":{"line":74,"column":27},"end":{"line":74,"column":38}}},"10":{"name":"(anonymous_10)","line":84,"loc":{"start":{"line":84,"column":28},"end":{"line":84,"column":47}}},"11":{"name":"(anonymous_11)","line":94,"loc":{"start":{"line":94,"column":30},"end":{"line":94,"column":51}}},"12":{"name":"(anonymous_12)","line":103,"loc":{"start":{"line":103,"column":29},"end":{"line":103,"column":40}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":49}},"4":{"start":{"line":6,"column":0},"end":{"line":26,"column":3}},"5":{"start":{"line":28,"column":0},"end":{"line":30,"column":2}},"6":{"start":{"line":29,"column":4},"end":{"line":29,"column":28}},"7":{"start":{"line":32,"column":0},"end":{"line":34,"column":2}},"8":{"start":{"line":33,"column":4},"end":{"line":33,"column":33}},"9":{"start":{"line":36,"column":0},"end":{"line":38,"column":2}},"10":{"start":{"line":37,"column":4},"end":{"line":37,"column":31}},"11":{"start":{"line":40,"column":0},"end":{"line":42,"column":2}},"12":{"start":{"line":41,"column":4},"end":{"line":41,"column":29}},"13":{"start":{"line":44,"column":0},"end":{"line":46,"column":2}},"14":{"start":{"line":45,"column":4},"end":{"line":45,"column":31}},"15":{"start":{"line":48,"column":0},"end":{"line":50,"column":2}},"16":{"start":{"line":49,"column":4},"end":{"line":49,"column":30}},"17":{"start":{"line":52,"column":0},"end":{"line":54,"column":2}},"18":{"start":{"line":53,"column":4},"end":{"line":53,"column":29}},"19":{"start":{"line":62,"column":0},"end":{"line":67,"column":2}},"20":{"start":{"line":63,"column":4},"end":{"line":63,"column":49}},"21":{"start":{"line":65,"column":4},"end":{"line":65,"column":32}},"22":{"start":{"line":66,"column":4},"end":{"line":66,"column":31}},"23":{"start":{"line":74,"column":0},"end":{"line":76,"column":2}},"24":{"start":{"line":75,"column":4},"end":{"line":75,"column":41}},"25":{"start":{"line":84,"column":0},"end":{"line":86,"column":2}},"26":{"start":{"line":85,"column":4},"end":{"line":85,"column":39}},"27":{"start":{"line":94,"column":0},"end":{"line":96,"column":2}},"28":{"start":{"line":95,"column":4},"end":{"line":95,"column":43}},"29":{"start":{"line":103,"column":0},"end":{"line":105,"column":2}},"30":{"start":{"line":104,"column":4},"end":{"line":104,"column":38}},"31":{"start":{"line":107,"column":0},"end":{"line":107,"column":24}}},"branchMap":{},"code":["var Immutable = require('immutable');","","var Book = require('./book');","var LocationUtils = require('../utils/location');","","var Output = Immutable.Record({","    book:       Book(),","","    // Name of the generator being used","    generator:  String(),","","    // Map of plugins to use (String -> Plugin)","    plugins:    Immutable.OrderedMap(),","","    // Map pages to generation (String -> Page)","    pages:      Immutable.OrderedMap(),","","    // List assets (String)","    assets:     Immutable.List(),","","    // Option for the generation","    options:    Immutable.Map(),","","    // Internal state for the generation","    state:      Immutable.Map()","});","","Output.prototype.getBook = function() {","    return this.get('book');","};","","Output.prototype.getGenerator = function() {","    return this.get('generator');","};","","Output.prototype.getPlugins = function() {","    return this.get('plugins');","};","","Output.prototype.getPages = function() {","    return this.get('pages');","};","","Output.prototype.getOptions = function() {","    return this.get('options');","};","","Output.prototype.getAssets = function() {","    return this.get('assets');","};","","Output.prototype.getState = function() {","    return this.get('state');","};","","/**","    Return a page byt its file path","","    @param {String} filePath","    @return {Page|undefined}","*/","Output.prototype.getPage = function(filePath) {","    filePath = LocationUtils.normalize(filePath);","","    var pages = this.getPages();","    return pages.get(filePath);","};","","/**","    Get root folder for output","","    @return {String}","*/","Output.prototype.getRoot = function() {","    return this.getOptions().get('root');","};","","/**","    Update state of output","","    @param {Map} newState","    @return {Output}","*/","Output.prototype.setState = function(newState) {","    return this.set('state', newState);","};","","/**","    Update options","","    @param {Map} newOptions","    @return {Output}","*/","Output.prototype.setOptions = function(newOptions) {","    return this.set('options', newOptions);","};","","/**","    Return logegr for this output (same as book)","","    @return {Logger}","*/","Output.prototype.getLogger = function() {","    return this.getBook().getLogger();","};","","module.exports = Output;",""],"l":{"1":1,"3":1,"4":1,"6":1,"28":1,"29":0,"32":1,"33":0,"36":1,"37":0,"40":1,"41":0,"44":1,"45":0,"48":1,"49":0,"52":1,"53":0,"62":1,"63":0,"65":0,"66":0,"74":1,"75":0,"84":1,"85":0,"94":1,"95":0,"103":1,"104":0,"107":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/callHook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/callHook.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"defaultGetArgument","line":5,"loc":{"start":{"line":5,"column":0},"end":{"line":5,"column":30}}},"2":{"name":"defaultHandleResult","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":45}}},"3":{"name":"callHook","line":22,"loc":{"start":{"line":22,"column":0},"end":{"line":22,"column":59}}},"4":{"name":"(anonymous_4)","line":41,"loc":{"start":{"line":41,"column":14},"end":{"line":41,"column":28}}},"5":{"name":"(anonymous_5)","line":42,"loc":{"start":{"line":42,"column":43},"end":{"line":42,"column":66}}},"6":{"name":"(anonymous_6)","line":53,"loc":{"start":{"line":53,"column":14},"end":{"line":53,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":40}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":28}},"4":{"start":{"line":5,"column":0},"end":{"line":7,"column":1}},"5":{"start":{"line":6,"column":4},"end":{"line":6,"column":21}},"6":{"start":{"line":9,"column":0},"end":{"line":11,"column":1}},"7":{"start":{"line":10,"column":4},"end":{"line":10,"column":18}},"8":{"start":{"line":22,"column":0},"end":{"line":58,"column":1}},"9":{"start":{"line":23,"column":4},"end":{"line":23,"column":52}},"10":{"start":{"line":24,"column":4},"end":{"line":24,"column":55}},"11":{"start":{"line":26,"column":4},"end":{"line":26,"column":36}},"12":{"start":{"line":27,"column":4},"end":{"line":27,"column":38}},"13":{"start":{"line":29,"column":4},"end":{"line":29,"column":51}},"14":{"start":{"line":32,"column":4},"end":{"line":32,"column":43}},"15":{"start":{"line":34,"column":4},"end":{"line":57,"column":6}},"16":{"start":{"line":42,"column":12},"end":{"line":49,"column":20}},"17":{"start":{"line":43,"column":16},"end":{"line":43,"column":48}},"18":{"start":{"line":44,"column":16},"end":{"line":46,"column":17}},"19":{"start":{"line":45,"column":20},"end":{"line":45,"column":32}},"20":{"start":{"line":48,"column":16},"end":{"line":48,"column":48}},"21":{"start":{"line":54,"column":12},"end":{"line":54,"column":55}},"22":{"start":{"line":55,"column":12},"end":{"line":55,"column":48}},"23":{"start":{"line":60,"column":0},"end":{"line":60,"column":26}}},"branchMap":{"1":{"line":23,"type":"binary-expr","locations":[{"start":{"line":23,"column":18},"end":{"line":23,"column":29}},{"start":{"line":23,"column":33},"end":{"line":23,"column":51}}]},"2":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":19},"end":{"line":24,"column":31}},{"start":{"line":24,"column":35},"end":{"line":24,"column":54}}]},"3":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":16},"end":{"line":44,"column":16}},{"start":{"line":44,"column":16},"end":{"line":44,"column":16}}]}},"code":["var Promise = require('../utils/promise');","var timing = require('../utils/timing');","var Api = require('../api');","","function defaultGetArgument() {","    return undefined;","}","","function defaultHandleResult(output, result) {","    return output;","}","","/**","    Call a \"global\" hook for an output","","    @param {String} name","    @param {Function(Output) -> Mixed} getArgument","    @param {Function(Output, result) -> Output} handleResult","    @param {Output} output","    @return {Promise<Output>}","*/","function callHook(name, getArgument, handleResult, output) {","    getArgument = getArgument || defaultGetArgument;","    handleResult = handleResult || defaultHandleResult;","","    var logger = output.getLogger();","    var plugins = output.getPlugins();","","    logger.debug.ln('calling hook \"' + name + '\"');","","    // Create the JS context for plugins","    var context = Api.encodeGlobal(output);","","    return timing.measure(","        'call.hook.' + name,","","        // Get the arguments","        Promise(getArgument(output))","","        // Call the hooks in serie","        .then(function(arg) {","            return Promise.reduce(plugins, function(prev, plugin) {","                var hook = plugin.getHook(name);","                if (!hook) {","                    return prev;","                }","","                return hook.call(context, prev);","            }, arg);","        })","","        // Handle final result","        .then(function(result) {","            output = Api.decodeGlobal(output, context);","            return handleResult(output, result);","        })","    );","}","","module.exports = callHook;",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":0,"9":1,"10":0,"22":1,"23":0,"24":0,"26":0,"27":0,"29":0,"32":0,"34":0,"42":0,"43":0,"44":0,"45":0,"48":0,"54":0,"55":0,"60":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/preparePlugins.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/preparePlugins.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"preparePlugins","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":32}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":10},"end":{"line":16,"column":21}}},"3":{"name":"(anonymous_3)","line":25,"loc":{"start":{"line":25,"column":10},"end":{"line":25,"column":28}}},"4":{"name":"(anonymous_4)","line":27,"loc":{"start":{"line":27,"column":14},"end":{"line":27,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":36}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":42}},"3":{"start":{"line":10,"column":0},"end":{"line":34,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":32}},"5":{"start":{"line":13,"column":4},"end":{"line":33,"column":7}},"6":{"start":{"line":17,"column":8},"end":{"line":21,"column":9}},"7":{"start":{"line":18,"column":12},"end":{"line":18,"column":39}},"8":{"start":{"line":20,"column":12},"end":{"line":20,"column":45}},"9":{"start":{"line":26,"column":8},"end":{"line":32,"column":11}},"10":{"start":{"line":28,"column":12},"end":{"line":31,"column":15}},"11":{"start":{"line":36,"column":0},"end":{"line":36,"column":32}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":8},"end":{"line":17,"column":8}},{"start":{"line":17,"column":8},"end":{"line":17,"column":8}}]}},"code":["var Plugins = require('../plugins');","var Promise = require('../utils/promise');","","/**"," * Load and setup plugins"," *"," * @param {Output}"," * @return {Promise<Output>}"," */","function preparePlugins(output) {","    var book = output.getBook();","","    return Promise()","","    // Only load plugins for main book","    .then(function() {","        if (book.isLanguageBook()) {","            return output.getPlugins();","        } else {","            return Plugins.loadForBook(book);","        }","    })","","    // Update book's configuration using the plugins","    .then(function(plugins) {","        return Plugins.validateConfig(book, plugins)","        .then(function(newBook) {","            return output.merge({","                book: newBook,","                plugins: plugins","            });","        });","    });","}","","module.exports = preparePlugins;",""],"l":{"1":1,"2":1,"10":1,"11":0,"13":0,"17":0,"18":0,"20":0,"26":0,"28":0,"36":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/preparePages.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/preparePages.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"preparePages","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":30}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":10},"end":{"line":19,"column":26}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":32}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":42}},"3":{"start":{"line":10,"column":0},"end":{"line":24,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":32}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":34}},"6":{"start":{"line":14,"column":4},"end":{"line":16,"column":5}},"7":{"start":{"line":15,"column":8},"end":{"line":15,"column":31}},"8":{"start":{"line":18,"column":4},"end":{"line":23,"column":7}},"9":{"start":{"line":20,"column":8},"end":{"line":20,"column":53}},"10":{"start":{"line":22,"column":8},"end":{"line":22,"column":42}},"11":{"start":{"line":26,"column":0},"end":{"line":26,"column":30}}},"branchMap":{"1":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":4},"end":{"line":14,"column":4}},{"start":{"line":14,"column":4},"end":{"line":14,"column":4}}]}},"code":["var Parse = require('../parse');","var Promise = require('../utils/promise');","","/**","    List and prepare all pages","","    @param {Output}","    @return {Promise<Output>}","*/","function preparePages(output) {","    var book = output.getBook();","    var logger = book.getLogger();","","    if (book.isMultilingual()) {","        return Promise(output);","    }","","    return Parse.parsePagesList(book)","    .then(function(pages) {","        logger.info.ln('found', pages.size, 'pages');","","        return output.set('pages', pages);","    });","}","","module.exports = preparePages;",""],"l":{"1":1,"2":1,"10":1,"11":0,"12":0,"14":0,"15":0,"18":0,"20":0,"22":0,"26":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/prepareAssets.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/prepareAssets.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"prepareAssets","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":31}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":10},"end":{"line":15,"column":27}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":32}},"2":{"start":{"line":9,"column":0},"end":{"line":20,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":10,"column":32}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":34}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":36}},"6":{"start":{"line":14,"column":4},"end":{"line":19,"column":7}},"7":{"start":{"line":16,"column":8},"end":{"line":16,"column":60}},"8":{"start":{"line":18,"column":8},"end":{"line":18,"column":44}},"9":{"start":{"line":22,"column":0},"end":{"line":22,"column":31}}},"branchMap":{},"code":["var Parse = require('../parse');","","/**","    List all assets in the book","","    @param {Output}","    @return {Promise<Output>}","*/","function prepareAssets(output) {","    var book = output.getBook();","    var pages = output.getPages();","    var logger = output.getLogger();","","    return Parse.listAssets(book, pages)","    .then(function(assets) {","        logger.info.ln('found', assets.size, 'asset files');","","        return output.set('assets', assets);","    });","}","","module.exports = prepareAssets;",""],"l":{"1":1,"9":1,"10":0,"11":0,"12":0,"14":0,"16":0,"18":0,"22":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/generateAssets.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/generateAssets.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"generateAssets","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":43}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":59}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":10,"column":0},"end":{"line":24,"column":1}},"3":{"start":{"line":11,"column":4},"end":{"line":11,"column":36}},"4":{"start":{"line":12,"column":4},"end":{"line":12,"column":36}},"5":{"start":{"line":15,"column":4},"end":{"line":17,"column":5}},"6":{"start":{"line":16,"column":8},"end":{"line":16,"column":31}},"7":{"start":{"line":19,"column":4},"end":{"line":23,"column":15}},"8":{"start":{"line":20,"column":8},"end":{"line":20,"column":58}},"9":{"start":{"line":22,"column":8},"end":{"line":22,"column":49}},"10":{"start":{"line":26,"column":0},"end":{"line":26,"column":32}}},"branchMap":{"1":{"line":15,"type":"if","locations":[{"start":{"line":15,"column":4},"end":{"line":15,"column":4}},{"start":{"line":15,"column":4},"end":{"line":15,"column":4}}]}},"code":["var Promise = require('../utils/promise');","","/**","    Output all assets using a generator","","    @param {Generator} generator","    @param {Output} output","    @return {Promise<Output>}","*/","function generateAssets(generator, output) {","    var assets = output.getAssets();","    var logger = output.getLogger();","","    // Is generator ignoring assets?","    if (!generator.onAsset) {","        return Promise(output);","    }","","    return Promise.reduce(assets, function(out, assetFile) {","        logger.debug.ln('copy asset \"' + assetFile + '\"');","","        return generator.onAsset(out, assetFile);","    }, output);","}","","module.exports = generateAssets;",""],"l":{"1":1,"10":1,"11":0,"12":0,"15":0,"16":0,"19":0,"20":0,"22":0,"26":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/generatePages.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/generatePages.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"generatePages","line":11,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":42}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":33},"end":{"line":20,"column":53}}},"3":{"name":"(anonymous_3)","line":26,"loc":{"start":{"line":26,"column":14},"end":{"line":26,"column":35}}},"4":{"name":"(anonymous_4)","line":29,"loc":{"start":{"line":29,"column":14},"end":{"line":29,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":45}},"3":{"start":{"line":11,"column":0},"end":{"line":34,"column":1}},"4":{"start":{"line":12,"column":4},"end":{"line":12,"column":34}},"5":{"start":{"line":13,"column":4},"end":{"line":13,"column":36}},"6":{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},"7":{"start":{"line":17,"column":8},"end":{"line":17,"column":31}},"8":{"start":{"line":20,"column":4},"end":{"line":33,"column":15}},"9":{"start":{"line":21,"column":8},"end":{"line":21,"column":34}},"10":{"start":{"line":23,"column":8},"end":{"line":23,"column":66}},"11":{"start":{"line":25,"column":8},"end":{"line":32,"column":11}},"12":{"start":{"line":27,"column":12},"end":{"line":27,"column":53}},"13":{"start":{"line":30,"column":12},"end":{"line":30,"column":85}},"14":{"start":{"line":31,"column":12},"end":{"line":31,"column":22}},"15":{"start":{"line":36,"column":0},"end":{"line":36,"column":31}}},"branchMap":{"1":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":4},"end":{"line":16,"column":4}},{"start":{"line":16,"column":4},"end":{"line":16,"column":4}}]}},"code":["var Promise = require('../utils/promise');","var generatePage = require('./generatePage');","","/**","    Output all pages using a generator","","    @param {Generator} generator","    @param {Output} output","    @return {Promise<Output>}","*/","function generatePages(generator, output) {","    var pages = output.getPages();","    var logger = output.getLogger();","","    // Is generator ignoring assets?","    if (!generator.onPage) {","        return Promise(output);","    }","","    return Promise.reduce(pages, function(out, page) {","        var file = page.getFile();","","        logger.debug.ln('generate page \"' + file.getPath() + '\"');","","        return generatePage(out, page)","        .then(function(resultPage) {","            return generator.onPage(out, resultPage);","        })","        .fail(function(err) {","            logger.error.ln('error while generating page \"' + file.getPath() + '\":');","            throw err;","        });","    }, output);","}","","module.exports = generatePages;",""],"l":{"1":1,"2":1,"11":1,"12":0,"13":0,"16":0,"17":0,"20":0,"21":0,"23":0,"25":0,"27":0,"30":0,"31":0,"36":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/generatePage.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/generatePage.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"generatePage","line":19,"loc":{"start":{"line":19,"column":0},"end":{"line":19,"column":36}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":14},"end":{"line":26,"column":35}}},"3":{"name":"(anonymous_3)","line":42,"loc":{"start":{"line":42,"column":18},"end":{"line":42,"column":40}}},"4":{"name":"(anonymous_4)","line":47,"loc":{"start":{"line":47,"column":18},"end":{"line":47,"column":36}}},"5":{"name":"(anonymous_5)","line":52,"loc":{"start":{"line":52,"column":18},"end":{"line":52,"column":35}}},"6":{"name":"(anonymous_6)","line":56,"loc":{"start":{"line":56,"column":22},"end":{"line":56,"column":39}}},"7":{"name":"(anonymous_7)","line":62,"loc":{"start":{"line":62,"column":18},"end":{"line":62,"column":35}}},"8":{"name":"(anonymous_8)","line":67,"loc":{"start":{"line":67,"column":18},"end":{"line":67,"column":36}}},"9":{"name":"(anonymous_9)","line":72,"loc":{"start":{"line":72,"column":18},"end":{"line":72,"column":40}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":38}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":40}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":42}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":35}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":61}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":45}},"9":{"start":{"line":19,"column":0},"end":{"line":77,"column":1}},"10":{"start":{"line":20,"column":4},"end":{"line":20,"column":32}},"11":{"start":{"line":21,"column":4},"end":{"line":21,"column":46}},"12":{"start":{"line":23,"column":4},"end":{"line":76,"column":6}},"13":{"start":{"line":27,"column":12},"end":{"line":27,"column":44}},"14":{"start":{"line":28,"column":12},"end":{"line":28,"column":42}},"15":{"start":{"line":29,"column":12},"end":{"line":29,"column":42}},"16":{"start":{"line":30,"column":12},"end":{"line":30,"column":77}},"17":{"start":{"line":32,"column":12},"end":{"line":36,"column":13}},"18":{"start":{"line":33,"column":16},"end":{"line":35,"column":20}},"19":{"start":{"line":39,"column":12},"end":{"line":74,"column":15}},"20":{"start":{"line":43,"column":16},"end":{"line":43,"column":68}},"21":{"start":{"line":48,"column":16},"end":{"line":48,"column":82}},"22":{"start":{"line":49,"column":16},"end":{"line":49,"column":85}},"23":{"start":{"line":53,"column":16},"end":{"line":53,"column":50}},"24":{"start":{"line":55,"column":16},"end":{"line":58,"column":19}},"25":{"start":{"line":57,"column":20},"end":{"line":57,"column":61}},"26":{"start":{"line":63,"column":16},"end":{"line":63,"column":61}},"27":{"start":{"line":68,"column":16},"end":{"line":68,"column":58}},"28":{"start":{"line":73,"column":16},"end":{"line":73,"column":65}},"29":{"start":{"line":79,"column":0},"end":{"line":79,"column":30}}},"branchMap":{"1":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":12},"end":{"line":32,"column":12}},{"start":{"line":32,"column":12},"end":{"line":32,"column":12}}]}},"code":["var path = require('path');","","var Promise = require('../utils/promise');","var error = require('../utils/error');","var timing = require('../utils/timing');","","var Templating = require('../templating');","var JSONUtils = require('../json');","var createTemplateEngine = require('./createTemplateEngine');","var callPageHook = require('./callPageHook');","","/**"," * Prepare and generate HTML for a page"," *"," * @param {Output} output"," * @param {Page} page"," * @return {Promise<Page>}"," */","function generatePage(output, page) {","    var book = output.getBook();","    var engine = createTemplateEngine(output);","","    return timing.measure(","        'page.generate',","        Promise(page)","        .then(function(resultPage) {","            var file = resultPage.getFile();","            var filePath = file.getPath();","            var parser = file.getParser();","            var context = JSONUtils.encodeOutputWithPage(output, resultPage);","","            if (!parser) {","                return Promise.reject(error.FileNotParsableError({","                    filename: filePath","                }));","            }","","            // Call hook \"page:before\"","            return callPageHook('page:before', output, resultPage)","","            // Escape code blocks with raw tags","            .then(function(currentPage) {","                return parser.preparePage(currentPage.getContent());","            })","","            // Render templating syntax","            .then(function(content) {","                var absoluteFilePath = path.join(book.getContentRoot(), filePath);","                return Templating.render(engine, absoluteFilePath, content, context);","            })","","            .then(function(output) {","                var content = output.getContent();","","                return parser.parsePage(content)","                .then(function(result) {","                    return output.setContent(result.content);","                });","            })","","            // Post processing for templating syntax","            .then(function(output) {","                return Templating.postRender(engine, output);","            })","","            // Return new page","            .then(function(content) {","                return resultPage.set('content', content);","            })","","            // Call final hook","            .then(function(currentPage) {","                return callPageHook('page', output, currentPage);","            });","        })","    );","}","","module.exports = generatePage;",""],"l":{"1":1,"3":1,"4":1,"5":1,"7":1,"8":1,"9":1,"10":1,"19":1,"20":0,"21":0,"23":0,"27":0,"28":0,"29":0,"30":0,"32":0,"33":0,"39":0,"43":0,"48":0,"49":0,"53":0,"55":0,"57":0,"63":0,"68":0,"73":0,"79":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/createTemplateEngine.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/createTemplateEngine.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"createTemplateEngine","line":17,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":38}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":57}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":28}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":58}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":60}},"7":{"start":{"line":17,"column":0},"end":{"line":43,"column":1}},"8":{"start":{"line":18,"column":4},"end":{"line":18,"column":38}},"9":{"start":{"line":19,"column":4},"end":{"line":19,"column":32}},"10":{"start":{"line":20,"column":4},"end":{"line":20,"column":43}},"11":{"start":{"line":21,"column":4},"end":{"line":21,"column":34}},"12":{"start":{"line":23,"column":4},"end":{"line":23,"column":47}},"13":{"start":{"line":24,"column":4},"end":{"line":24,"column":45}},"14":{"start":{"line":27,"column":4},"end":{"line":27,"column":41}},"15":{"start":{"line":28,"column":4},"end":{"line":28,"column":44}},"16":{"start":{"line":31,"column":4},"end":{"line":31,"column":69}},"17":{"start":{"line":32,"column":4},"end":{"line":32,"column":79}},"18":{"start":{"line":35,"column":4},"end":{"line":35,"column":43}},"19":{"start":{"line":37,"column":4},"end":{"line":42,"column":7}},"20":{"start":{"line":45,"column":0},"end":{"line":45,"column":38}}},"branchMap":{},"code":["var Templating = require('../templating');","var TemplateEngine = require('../models/templateEngine');","","var Api = require('../api');","var Plugins = require('../plugins');","","var defaultBlocks = require('../constants/defaultBlocks');","var defaultFilters = require('../constants/defaultFilters');","","/**","    Create template engine for an output.","    It adds default filters/blocks, then add the ones from plugins","","    @param {Output} output","    @return {TemplateEngine}","*/","function createTemplateEngine(output) {","    var plugins = output.getPlugins();","    var book = output.getBook();","    var rootFolder = book.getContentRoot();","    var logger = book.getLogger();","","    var filters = Plugins.listFilters(plugins);","    var blocks = Plugins.listBlocks(plugins);","","    // Extend with default","    blocks = defaultBlocks.merge(blocks);","    filters = defaultFilters.merge(filters);","","    // Create loader","    var transformFn = Templating.replaceShortcuts.bind(null, blocks);","    var loader = new Templating.ConrefsLoader(rootFolder, transformFn, logger);","","    // Create API context","    var context = Api.encodeGlobal(output);","","    return new TemplateEngine({","        filters:    filters,","        blocks:     blocks,","        loader:     loader,","        context:    context","    });","}","","module.exports = createTemplateEngine;",""],"l":{"1":1,"2":1,"4":1,"5":1,"7":1,"8":1,"17":1,"18":0,"19":0,"20":0,"21":0,"23":0,"24":0,"27":0,"28":0,"31":0,"32":0,"35":0,"37":0,"45":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/callPageHook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/output/callPageHook.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":1},"b":{},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"callPageHook","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":42}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":22}}},"3":{"name":"(anonymous_3)","line":20,"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":30}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":28}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":12,"column":0},"end":{"line":26,"column":1}},"4":{"start":{"line":13,"column":4},"end":{"line":25,"column":6}},"5":{"start":{"line":17,"column":12},"end":{"line":17,"column":45}},"6":{"start":{"line":21,"column":12},"end":{"line":21,"column":53}},"7":{"start":{"line":28,"column":0},"end":{"line":28,"column":30}}},"branchMap":{},"code":["var Api = require('../api');","var callHook = require('./callHook');","","/**","    Call a hook for a specific page","","    @param {String} name","    @param {Output} output","    @param {Page} page","    @return {Promise<Page>}","*/","function callPageHook(name, output, page) {","    return callHook(","        name,","","        function(out) {","            return Api.encodePage(out, page);","        },","","        function(out, result) {","            return Api.decodePage(out, page, result);","        },","","        output","    );","}","","module.exports = callPageHook;",""],"l":{"1":1,"2":1,"12":1,"13":0,"17":0,"21":0,"28":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/index.js","s":{"1":1,"2":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}},"2":{"start":{"line":3,"column":0},"end":{"line":12,"column":2}}},"branchMap":{},"code":["var buildEbook = require('./buildEbook');","","module.exports = [","    require('./build'),","    require('./serve'),","    require('./install'),","    require('./parse'),","    require('./init'),","    buildEbook('pdf'),","    buildEbook('epub'),","    buildEbook('mobi')","];",""],"l":{"1":1,"3":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/buildEbook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/buildEbook.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":3,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":3,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":17},"end":{"line":13,"column":34}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":14},"end":{"line":20,"column":37}}},"3":{"name":"(anonymous_3)","line":34,"loc":{"start":{"line":34,"column":18},"end":{"line":34,"column":39}}},"4":{"name":"(anonymous_4)","line":42,"loc":{"start":{"line":42,"column":18},"end":{"line":42,"column":35}}},"5":{"name":"(anonymous_5)","line":47,"loc":{"start":{"line":47,"column":64},"end":{"line":47,"column":79}}},"6":{"name":"(anonymous_6)","line":70,"loc":{"start":{"line":70,"column":18},"end":{"line":70,"column":34}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":25}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":42}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":32}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":32}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":34}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":35}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":35}},"9":{"start":{"line":13,"column":0},"end":{"line":78,"column":2}},"10":{"start":{"line":14,"column":4},"end":{"line":77,"column":6}},"11":{"start":{"line":21,"column":12},"end":{"line":21,"column":41}},"12":{"start":{"line":24,"column":12},"end":{"line":24,"column":61}},"13":{"start":{"line":27,"column":12},"end":{"line":27,"column":50}},"14":{"start":{"line":29,"column":12},"end":{"line":29,"column":45}},"15":{"start":{"line":30,"column":12},"end":{"line":30,"column":42}},"16":{"start":{"line":31,"column":12},"end":{"line":31,"column":57}},"17":{"start":{"line":33,"column":12},"end":{"line":75,"column":15}},"18":{"start":{"line":35,"column":16},"end":{"line":38,"column":19}},"19":{"start":{"line":43,"column":16},"end":{"line":43,"column":44}},"20":{"start":{"line":44,"column":16},"end":{"line":44,"column":52}},"21":{"start":{"line":46,"column":16},"end":{"line":66,"column":17}},"22":{"start":{"line":47,"column":20},"end":{"line":60,"column":55}},"23":{"start":{"line":48,"column":24},"end":{"line":48,"column":50}},"24":{"start":{"line":50,"column":24},"end":{"line":53,"column":26}},"25":{"start":{"line":55,"column":24},"end":{"line":58,"column":26}},"26":{"start":{"line":62,"column":20},"end":{"line":65,"column":37}},"27":{"start":{"line":71,"column":16},"end":{"line":71,"column":61}},"28":{"start":{"line":73,"column":16},"end":{"line":73,"column":48}},"29":{"start":{"line":74,"column":16},"end":{"line":74,"column":68}}},"branchMap":{"1":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":29},"end":{"line":24,"column":36}},{"start":{"line":24,"column":41},"end":{"line":24,"column":59}}]},"2":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":16},"end":{"line":46,"column":16}},{"start":{"line":46,"column":16},"end":{"line":46,"column":16}}]}},"code":["var path = require('path');","var tmp = require('tmp');","","var Promise = require('../utils/promise');","var fs = require('../utils/fs');","var Parse = require('../parse');","var Output = require('../output');","","var options = require('./options');","var getBook = require('./getBook');","","","module.exports = function(format) {","    return {","        name: (format + ' [book] [output]'),","        description: 'build a book into an ebook file',","        options: [","            options.log","        ],","        exec: function(args, kwargs) {","            var extension = '.' + format;","","            // Output file will be stored in","            var outputFile = args[1] || ('book' + extension);","","            // Create temporary directory","            var outputFolder = tmp.dirSync().name;","","            var book = getBook(args, kwargs);","            var logger = book.getLogger();","            var Generator = Output.getGenerator('ebook');","","            return Parse.parseBook(book)","            .then(function(resultBook) {","                return Output.generate(Generator, resultBook, {","                    root: outputFolder,","                    format: format","                });","            })","","            // Extract ebook file","            .then(function(output) {","                var book = output.getBook();","                var languages = book.getLanguages();","","                if (book.isMultilingual()) {","                    return Promise.forEach(languages.getList(), function(lang) {","                        var langID = lang.getID();","","                        var langOutputFile = path.join(","                            path.dirname(outputFile),","                            path.basename(outputFile, extension) + '_' + langID + extension","                        );","","                        return fs.copy(","                            path.resolve(outputFolder, langID, 'index' + extension),","                            langOutputFile","                        );","                    })","                    .thenResolve(languages.getCount());","                } else {","                    return fs.copy(","                        path.resolve(outputFolder, 'index' + extension),","                        outputFile","                    ).thenResolve(1);","                }","            })","","            // Log end","            .then(function(count) {","                logger.info.ok(count + ' file(s) generated');","","                logger.debug('cleaning up... ');","                return logger.debug.promise(fs.rmDir(outputFolder));","            });","        }","    };","};",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"7":1,"9":1,"10":1,"13":1,"14":3,"21":0,"24":0,"27":0,"29":0,"30":0,"31":0,"33":0,"35":0,"43":0,"44":0,"46":0,"47":0,"48":0,"50":0,"55":0,"62":0,"71":0,"73":0,"74":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/options.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/options.js","s":{"1":1,"2":1,"3":5,"4":1,"5":1,"6":1},"b":{},"f":{"1":5},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":13},"end":{"line":8,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":40}},"2":{"start":{"line":3,"column":0},"end":{"line":12,"column":2}},"3":{"start":{"line":9,"column":12},"end":{"line":9,"column":35}},"4":{"start":{"line":14,"column":0},"end":{"line":19,"column":2}},"5":{"start":{"line":21,"column":0},"end":{"line":25,"column":2}},"6":{"start":{"line":27,"column":0},"end":{"line":31,"column":2}}},"branchMap":{},"code":["var Logger = require('../utils/logger');","","var logOptions = {","    name: 'log',","    description: 'Minimum log level to display',","    values: Logger.LEVELS","        .keySeq()","        .map(function(s) {","            return s.toLowerCase();","        }).toJS(),","    defaults: 'info'","};","","var formatOption = {","    name: 'format',","    description: 'Format to build to',","    values: ['website', 'json', 'ebook'],","    defaults: 'website'","};","","var timingOption = {","    name: 'timing',","    description: 'Print timing debug information',","    defaults: false","};","","module.exports = {","    log: logOptions,","    format: formatOption,","    timing: timingOption","};",""],"l":{"1":1,"3":1,"9":5,"14":1,"21":1,"27":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/getBook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/getBook.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"getBook","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":41}},"4":{"start":{"line":13,"column":0},"end":{"line":21,"column":1}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":55}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":30}},"7":{"start":{"line":17,"column":4},"end":{"line":17,"column":33}},"8":{"start":{"line":18,"column":4},"end":{"line":18,"column":36}},"9":{"start":{"line":20,"column":4},"end":{"line":20,"column":38}},"10":{"start":{"line":23,"column":0},"end":{"line":23,"column":25}}},"branchMap":{"1":{"line":14,"type":"binary-expr","locations":[{"start":{"line":14,"column":29},"end":{"line":14,"column":36}},{"start":{"line":14,"column":40},"end":{"line":14,"column":53}}]}},"code":["var path = require('path');","var Book = require('../models/book');","var createNodeFS = require('../fs/node');","","/**","    Return a book instance to work on from","    command line args/kwargs","","    @param {Array} args","    @param {Object} kwargs","    @return {Book}","*/","function getBook(args, kwargs) {","    var input = path.resolve(args[0] || process.cwd());","    var logLevel = kwargs.log;","","    var fs = createNodeFS(input);","    var book = Book.createForFS(fs);","","    return book.setLogLevel(logLevel);","}","","module.exports = getBook;",""],"l":{"1":1,"2":1,"3":1,"13":1,"14":0,"15":0,"17":0,"18":0,"20":0,"23":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/build.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/build.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":18,"loc":{"start":{"line":18,"column":10},"end":{"line":18,"column":33}}},"2":{"name":"(anonymous_2)","line":25,"loc":{"start":{"line":25,"column":14},"end":{"line":25,"column":35}}},"3":{"name":"(anonymous_3)","line":30,"loc":{"start":{"line":30,"column":13},"end":{"line":30,"column":24}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":32}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":34}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":40}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":35}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":35}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":51}},"7":{"start":{"line":10,"column":0},"end":{"line":34,"column":2}},"8":{"start":{"line":19,"column":8},"end":{"line":19,"column":41}},"9":{"start":{"line":20,"column":8},"end":{"line":20,"column":49}},"10":{"start":{"line":22,"column":8},"end":{"line":22,"column":59}},"11":{"start":{"line":24,"column":8},"end":{"line":32,"column":11}},"12":{"start":{"line":26,"column":12},"end":{"line":28,"column":15}},"13":{"start":{"line":31,"column":12},"end":{"line":31,"column":61}},"14":{"start":{"line":31,"column":31},"end":{"line":31,"column":61}}},"branchMap":{"1":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":12},"end":{"line":31,"column":12}},{"start":{"line":31,"column":12},"end":{"line":31,"column":12}}]}},"code":["var Parse = require('../parse');","var Output = require('../output');","var timing = require('../utils/timing');","","var options = require('./options');","var getBook = require('./getBook');","var getOutputFolder = require('./getOutputFolder');","","","module.exports = {","    name: 'build [book] [output]',","    description: 'build a book',","    options: [","        options.log,","        options.format,","        options.timing","    ],","    exec: function(args, kwargs) {","        var book = getBook(args, kwargs);","        var outputFolder = getOutputFolder(args);","","        var Generator = Output.getGenerator(kwargs.format);","","        return Parse.parseBook(book)","        .then(function(resultBook) {","            return Output.generate(Generator, resultBook, {","                root: outputFolder","            });","        })","        .fin(function() {","            if (kwargs.timing) timing.dump(book.getLogger());","        });","    }","};",""],"l":{"1":1,"2":1,"3":1,"5":1,"6":1,"7":1,"10":1,"19":0,"20":0,"22":0,"24":0,"26":0,"31":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/getOutputFolder.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/getOutputFolder.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"getOutputFolder","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":9,"column":0},"end":{"line":15,"column":1}},"3":{"start":{"line":10,"column":4},"end":{"line":10,"column":58}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":57}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":89}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":24}},"7":{"start":{"line":17,"column":0},"end":{"line":17,"column":33}}},"branchMap":{"1":{"line":10,"type":"binary-expr","locations":[{"start":{"line":10,"column":32},"end":{"line":10,"column":39}},{"start":{"line":10,"column":43},"end":{"line":10,"column":56}}]},"2":{"line":12,"type":"cond-expr","locations":[{"start":{"line":12,"column":32},"end":{"line":12,"column":68}},{"start":{"line":12,"column":71},"end":{"line":12,"column":88}}]}},"code":["var path = require('path');","","/**","    Return path to output folder","","    @param {Array} args","    @return {String}","*/","function getOutputFolder(args) {","    var bookRoot = path.resolve(args[0] || process.cwd());","    var defaultOutputRoot = path.join(bookRoot, '_book');","    var outputFolder = args[1]? path.resolve(process.cwd(), args[1]) : defaultOutputRoot;","","    return outputFolder;","}","","module.exports = getOutputFolder;",""],"l":{"1":1,"9":1,"10":0,"11":0,"12":0,"14":0,"17":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/serve.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/serve.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"waitForCtrlC","line":20,"loc":{"start":{"line":20,"column":0},"end":{"line":20,"column":24}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":25},"end":{"line":23,"column":36}}},"3":{"name":"generateBook","line":31,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":36}}},"4":{"name":"(anonymous_4)","line":46,"loc":{"start":{"line":46,"column":10},"end":{"line":46,"column":21}}},"5":{"name":"(anonymous_5)","line":48,"loc":{"start":{"line":48,"column":14},"end":{"line":48,"column":35}}},"6":{"name":"(anonymous_6)","line":61,"loc":{"start":{"line":61,"column":10},"end":{"line":61,"column":21}}},"7":{"name":"(anonymous_7)","line":66,"loc":{"start":{"line":66,"column":10},"end":{"line":66,"column":21}}},"8":{"name":"(anonymous_8)","line":82,"loc":{"start":{"line":82,"column":10},"end":{"line":82,"column":21}}},"9":{"name":"(anonymous_9)","line":88,"loc":{"start":{"line":88,"column":14},"end":{"line":88,"column":33}}},"10":{"name":"(anonymous_10)","line":135,"loc":{"start":{"line":135,"column":10},"end":{"line":135,"column":33}}},"11":{"name":"(anonymous_11)","line":141,"loc":{"start":{"line":141,"column":14},"end":{"line":141,"column":25}}},"12":{"name":"(anonymous_12)","line":148,"loc":{"start":{"line":148,"column":18},"end":{"line":148,"column":29}}},"13":{"name":"(anonymous_13)","line":155,"loc":{"start":{"line":155,"column":14},"end":{"line":155,"column":25}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":32}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":27}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":32}},"4":{"start":{"line":7,"column":0},"end":{"line":7,"column":34}},"5":{"start":{"line":8,"column":0},"end":{"line":8,"column":52}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":42}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":35}},"8":{"start":{"line":13,"column":0},"end":{"line":13,"column":35}},"9":{"start":{"line":14,"column":0},"end":{"line":14,"column":51}},"10":{"start":{"line":15,"column":0},"end":{"line":15,"column":33}},"11":{"start":{"line":16,"column":0},"end":{"line":16,"column":31}},"12":{"start":{"line":18,"column":0},"end":{"line":18,"column":29}},"13":{"start":{"line":20,"column":0},"end":{"line":28,"column":1}},"14":{"start":{"line":21,"column":4},"end":{"line":21,"column":28}},"15":{"start":{"line":23,"column":4},"end":{"line":25,"column":7}},"16":{"start":{"line":24,"column":8},"end":{"line":24,"column":20}},"17":{"start":{"line":27,"column":4},"end":{"line":27,"column":21}},"18":{"start":{"line":31,"column":0},"end":{"line":96,"column":1}},"19":{"start":{"line":32,"column":4},"end":{"line":32,"column":27}},"20":{"start":{"line":33,"column":4},"end":{"line":33,"column":45}},"21":{"start":{"line":34,"column":4},"end":{"line":34,"column":37}},"22":{"start":{"line":35,"column":4},"end":{"line":35,"column":55}},"23":{"start":{"line":36,"column":4},"end":{"line":36,"column":36}},"24":{"start":{"line":38,"column":4},"end":{"line":38,"column":35}},"25":{"start":{"line":39,"column":4},"end":{"line":39,"column":42}},"26":{"start":{"line":40,"column":4},"end":{"line":40,"column":33}},"27":{"start":{"line":43,"column":4},"end":{"line":43,"column":59}},"28":{"start":{"line":43,"column":28},"end":{"line":43,"column":59}},"29":{"start":{"line":45,"column":4},"end":{"line":95,"column":7}},"30":{"start":{"line":47,"column":8},"end":{"line":59,"column":11}},"31":{"start":{"line":49,"column":12},"end":{"line":54,"column":13}},"32":{"start":{"line":51,"column":16},"end":{"line":51,"column":52}},"33":{"start":{"line":52,"column":16},"end":{"line":52,"column":72}},"34":{"start":{"line":53,"column":16},"end":{"line":53,"column":62}},"35":{"start":{"line":56,"column":12},"end":{"line":58,"column":15}},"36":{"start":{"line":62,"column":8},"end":{"line":62,"column":22}},"37":{"start":{"line":63,"column":8},"end":{"line":63,"column":43}},"38":{"start":{"line":64,"column":8},"end":{"line":64,"column":48}},"39":{"start":{"line":67,"column":8},"end":{"line":67,"column":62}},"40":{"start":{"line":69,"column":8},"end":{"line":76,"column":9}},"41":{"start":{"line":71,"column":12},"end":{"line":75,"column":15}},"42":{"start":{"line":78,"column":8},"end":{"line":80,"column":9}},"43":{"start":{"line":79,"column":12},"end":{"line":79,"column":52}},"44":{"start":{"line":83,"column":8},"end":{"line":85,"column":9}},"45":{"start":{"line":84,"column":12},"end":{"line":84,"column":34}},"46":{"start":{"line":87,"column":8},"end":{"line":94,"column":11}},"47":{"start":{"line":90,"column":12},"end":{"line":90,"column":30}},"48":{"start":{"line":91,"column":12},"end":{"line":91,"column":66}},"49":{"start":{"line":92,"column":12},"end":{"line":92,"column":28}},"50":{"start":{"line":93,"column":12},"end":{"line":93,"column":46}},"51":{"start":{"line":98,"column":0},"end":{"line":159,"column":2}},"52":{"start":{"line":136,"column":8},"end":{"line":136,"column":30}},"53":{"start":{"line":137,"column":8},"end":{"line":137,"column":39}},"54":{"start":{"line":138,"column":8},"end":{"line":138,"column":46}},"55":{"start":{"line":140,"column":8},"end":{"line":157,"column":11}},"56":{"start":{"line":142,"column":12},"end":{"line":144,"column":13}},"57":{"start":{"line":143,"column":16},"end":{"line":143,"column":23}},"58":{"start":{"line":146,"column":12},"end":{"line":146,"column":34}},"59":{"start":{"line":147,"column":12},"end":{"line":153,"column":15}},"60":{"start":{"line":149,"column":16},"end":{"line":149,"column":82}},"61":{"start":{"line":150,"column":16},"end":{"line":150,"column":56}},"62":{"start":{"line":151,"column":16},"end":{"line":151,"column":32}},"63":{"start":{"line":156,"column":12},"end":{"line":156,"column":46}}},"branchMap":{"1":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":4},"end":{"line":43,"column":4}},{"start":{"line":43,"column":4},"end":{"line":43,"column":4}}]},"2":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":12},"end":{"line":49,"column":12}},{"start":{"line":49,"column":12},"end":{"line":49,"column":12}}]},"3":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":8},"end":{"line":69,"column":8}},{"start":{"line":69,"column":8},"end":{"line":69,"column":8}}]},"4":{"line":69,"type":"binary-expr","locations":[{"start":{"line":69,"column":12},"end":{"line":69,"column":18}},{"start":{"line":69,"column":22},"end":{"line":69,"column":38}}]},"5":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":8},"end":{"line":78,"column":8}},{"start":{"line":78,"column":8},"end":{"line":78,"column":8}}]},"6":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":8},"end":{"line":83,"column":8}},{"start":{"line":83,"column":8},"end":{"line":83,"column":8}}]},"7":{"line":142,"type":"if","locations":[{"start":{"line":142,"column":12},"end":{"line":142,"column":12}},{"start":{"line":142,"column":12},"end":{"line":142,"column":12}}]},"8":{"line":142,"type":"binary-expr","locations":[{"start":{"line":142,"column":16},"end":{"line":142,"column":25}},{"start":{"line":142,"column":29},"end":{"line":142,"column":46}}]}},"code":["/* eslint-disable no-console */","","var tinylr = require('tiny-lr');","var open = require('open');","","var Parse = require('../parse');","var Output = require('../output');","var ConfigModifier = require('../modifiers').Config;","","var Promise = require('../utils/promise');","","var options = require('./options');","var getBook = require('./getBook');","var getOutputFolder = require('./getOutputFolder');","var Server = require('./server');","var watch = require('./watch');","","var server, lrServer, lrPath;","","function waitForCtrlC() {","    var d = Promise.defer();","","    process.on('SIGINT', function() {","        d.resolve();","    });","","    return d.promise;","}","","","function generateBook(args, kwargs) {","    var port = kwargs.port;","    var outputFolder = getOutputFolder(args);","    var book = getBook(args, kwargs);","    var Generator = Output.getGenerator(kwargs.format);","    var browser = kwargs['browser'];","","    var hasWatch = kwargs['watch'];","    var hasLiveReloading = kwargs['live'];","    var hasOpen = kwargs['open'];","","    // Stop server if running","    if (server.isRunning()) console.log('Stopping server');","","    return server.stop()","    .then(function() {","        return Parse.parseBook(book)","        .then(function(resultBook) {","            if (hasLiveReloading) {","                // Enable livereload plugin","                var config = resultBook.getConfig();","                config = ConfigModifier.addPlugin(config, 'livereload');","                resultBook = resultBook.set('config', config);","            }","","            return Output.generate(Generator, resultBook, {","                root: outputFolder","            });","        });","    })","    .then(function() {","        console.log();","        console.log('Starting server ...');","        return server.start(outputFolder, port);","    })","    .then(function() {","        console.log('Serving book on http://localhost:'+port);","","        if (lrPath && hasLiveReloading) {","            // trigger livereload","            lrServer.changed({","                body: {","                    files: [lrPath]","                }","            });","        }","","        if (hasOpen) {","            open('http://localhost:'+port, browser);","        }","    })","    .then(function() {","        if (!hasWatch) {","            return waitForCtrlC();","        }","","        return watch(book.getRoot())","        .then(function(filepath) {","            // set livereload path","            lrPath = filepath;","            console.log('Restart after change in file', filepath);","            console.log('');","            return generateBook(args, kwargs);","        });","    });","}","","module.exports = {","    name: 'serve [book] [output]',","    description: 'serve the book as a website for testing',","    options: [","        {","            name: 'port',","            description: 'Port for server to listen on',","            defaults: 4000","        },","        {","            name: 'lrport',","            description: 'Port for livereload server to listen on',","            defaults: 35729","        },","        {","            name: 'watch',","            description: 'Enable file watcher and live reloading',","            defaults: true","        },","        {","            name: 'live',","            description: 'Enable live reloading',","            defaults: true","        },","        {","            name: 'open',","            description: 'Enable opening book in browser',","            defaults: false","        },","        {","            name: 'browser',","            description: 'Specify browser for opening book',","            defaults: ''","        },","        options.log,","        options.format","    ],","    exec: function(args, kwargs) {","        server = new Server();","        var hasWatch = kwargs['watch'];","        var hasLiveReloading = kwargs['live'];","","        return Promise()","        .then(function() {","            if (!hasWatch || !hasLiveReloading) {","                return;","            }","","            lrServer = tinylr({});","            return Promise.nfcall(lrServer.listen.bind(lrServer), kwargs.lrport)","            .then(function() {","                console.log('Live reload server started on port:', kwargs.lrport);","                console.log('Press CTRL+C to quit ...');","                console.log('');","","            });","        })","        .then(function() {","            return generateBook(args, kwargs);","        });","    }","};",""],"l":{"3":1,"4":1,"6":1,"7":1,"8":1,"10":1,"12":1,"13":1,"14":1,"15":1,"16":1,"18":1,"20":1,"21":0,"23":0,"24":0,"27":0,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"38":0,"39":0,"40":0,"43":0,"45":0,"47":0,"49":0,"51":0,"52":0,"53":0,"56":0,"62":0,"63":0,"64":0,"67":0,"69":0,"71":0,"78":0,"79":0,"83":0,"84":0,"87":0,"90":0,"91":0,"92":0,"93":0,"98":1,"136":0,"137":0,"138":0,"140":0,"142":0,"143":0,"146":0,"147":0,"149":0,"150":0,"151":0,"156":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/server.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/server.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":1,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":1,"63":0,"64":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"fnMap":{"1":{"name":"Server","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":18}}},"2":{"name":"(anonymous_2)","line":22,"loc":{"start":{"line":22,"column":29},"end":{"line":22,"column":40}}},"3":{"name":"(anonymous_3)","line":31,"loc":{"start":{"line":31,"column":24},"end":{"line":31,"column":35}}},"4":{"name":"(anonymous_4)","line":36,"loc":{"start":{"line":36,"column":23},"end":{"line":36,"column":37}}},"5":{"name":"(anonymous_5)","line":56,"loc":{"start":{"line":56,"column":25},"end":{"line":56,"column":45}}},"6":{"name":"(anonymous_6)","line":62,"loc":{"start":{"line":62,"column":10},"end":{"line":62,"column":21}}},"7":{"name":"(anonymous_7)","line":65,"loc":{"start":{"line":65,"column":41},"end":{"line":65,"column":59}}},"8":{"name":"error","line":67,"loc":{"start":{"line":67,"column":12},"end":{"line":67,"column":32}}},"9":{"name":"redirect","line":73,"loc":{"start":{"line":73,"column":12},"end":{"line":73,"column":32}}},"10":{"name":"(anonymous_10)","line":74,"loc":{"start":{"line":74,"column":54},"end":{"line":74,"column":71}}},"11":{"name":"(anonymous_11)","line":95,"loc":{"start":{"line":95,"column":38},"end":{"line":95,"column":56}}},"12":{"name":"(anonymous_12)","line":98,"loc":{"start":{"line":98,"column":31},"end":{"line":98,"column":43}}},"13":{"name":"(anonymous_13)","line":103,"loc":{"start":{"line":103,"column":34},"end":{"line":103,"column":48}}},"14":{"name":"urlTransform","line":124,"loc":{"start":{"line":124,"column":0},"end":{"line":124,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":27}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":25}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":42}},"7":{"start":{"line":9,"column":0},"end":{"line":14,"column":1}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":24}},"9":{"start":{"line":11,"column":4},"end":{"line":11,"column":20}},"10":{"start":{"line":12,"column":4},"end":{"line":12,"column":18}},"11":{"start":{"line":13,"column":4},"end":{"line":13,"column":22}},"12":{"start":{"line":15,"column":0},"end":{"line":15,"column":43}},"13":{"start":{"line":22,"column":0},"end":{"line":24,"column":2}},"14":{"start":{"line":23,"column":4},"end":{"line":23,"column":26}},"15":{"start":{"line":31,"column":0},"end":{"line":49,"column":2}},"16":{"start":{"line":32,"column":4},"end":{"line":32,"column":20}},"17":{"start":{"line":33,"column":4},"end":{"line":33,"column":44}},"18":{"start":{"line":33,"column":27},"end":{"line":33,"column":44}},"19":{"start":{"line":35,"column":4},"end":{"line":35,"column":28}},"20":{"start":{"line":36,"column":4},"end":{"line":42,"column":7}},"21":{"start":{"line":37,"column":8},"end":{"line":37,"column":28}},"22":{"start":{"line":38,"column":8},"end":{"line":38,"column":34}},"23":{"start":{"line":40,"column":8},"end":{"line":41,"column":25}},"24":{"start":{"line":40,"column":17},"end":{"line":40,"column":31}},"25":{"start":{"line":41,"column":13},"end":{"line":41,"column":25}},"26":{"start":{"line":44,"column":4},"end":{"line":46,"column":5}},"27":{"start":{"line":45,"column":8},"end":{"line":45,"column":34}},"28":{"start":{"line":48,"column":4},"end":{"line":48,"column":21}},"29":{"start":{"line":56,"column":0},"end":{"line":114,"column":2}},"30":{"start":{"line":57,"column":4},"end":{"line":57,"column":37}},"31":{"start":{"line":58,"column":4},"end":{"line":58,"column":24}},"32":{"start":{"line":60,"column":4},"end":{"line":60,"column":44}},"33":{"start":{"line":60,"column":26},"end":{"line":60,"column":44}},"34":{"start":{"line":61,"column":4},"end":{"line":113,"column":7}},"35":{"start":{"line":63,"column":8},"end":{"line":63,"column":32}},"36":{"start":{"line":65,"column":8},"end":{"line":93,"column":11}},"37":{"start":{"line":67,"column":12},"end":{"line":70,"column":13}},"38":{"start":{"line":68,"column":16},"end":{"line":68,"column":51}},"39":{"start":{"line":69,"column":16},"end":{"line":69,"column":37}},"40":{"start":{"line":73,"column":12},"end":{"line":82,"column":13}},"41":{"start":{"line":74,"column":16},"end":{"line":77,"column":19}},"42":{"start":{"line":75,"column":20},"end":{"line":75,"column":43}},"43":{"start":{"line":76,"column":20},"end":{"line":76,"column":34}},"44":{"start":{"line":79,"column":16},"end":{"line":79,"column":37}},"45":{"start":{"line":80,"column":16},"end":{"line":80,"column":53}},"46":{"start":{"line":81,"column":16},"end":{"line":81,"column":55}},"47":{"start":{"line":84,"column":12},"end":{"line":84,"column":57}},"48":{"start":{"line":87,"column":12},"end":{"line":92,"column":23}},"49":{"start":{"line":95,"column":8},"end":{"line":101,"column":11}},"50":{"start":{"line":96,"column":12},"end":{"line":96,"column":38}},"51":{"start":{"line":97,"column":12},"end":{"line":97,"column":36}},"52":{"start":{"line":98,"column":12},"end":{"line":100,"column":15}},"53":{"start":{"line":99,"column":16},"end":{"line":99,"column":69}},"54":{"start":{"line":103,"column":8},"end":{"line":110,"column":11}},"55":{"start":{"line":104,"column":12},"end":{"line":104,"column":42}},"56":{"start":{"line":104,"column":21},"end":{"line":104,"column":42}},"57":{"start":{"line":106,"column":12},"end":{"line":106,"column":29}},"58":{"start":{"line":107,"column":12},"end":{"line":107,"column":27}},"59":{"start":{"line":108,"column":12},"end":{"line":108,"column":37}},"60":{"start":{"line":109,"column":12},"end":{"line":109,"column":24}},"61":{"start":{"line":112,"column":8},"end":{"line":112,"column":25}},"62":{"start":{"line":124,"column":0},"end":{"line":126,"column":1}},"63":{"start":{"line":125,"column":4},"end":{"line":125,"column":42}},"64":{"start":{"line":128,"column":0},"end":{"line":128,"column":24}}},"branchMap":{"1":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":4}},{"start":{"line":33,"column":4},"end":{"line":33,"column":4}}]},"2":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":8},"end":{"line":40,"column":8}},{"start":{"line":40,"column":8},"end":{"line":40,"column":8}}]},"3":{"line":58,"type":"binary-expr","locations":[{"start":{"line":58,"column":11},"end":{"line":58,"column":15}},{"start":{"line":58,"column":19},"end":{"line":58,"column":23}}]},"4":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":4},"end":{"line":60,"column":4}},{"start":{"line":60,"column":4},"end":{"line":60,"column":4}}]},"5":{"line":68,"type":"binary-expr","locations":[{"start":{"line":68,"column":33},"end":{"line":68,"column":43}},{"start":{"line":68,"column":47},"end":{"line":68,"column":50}}]},"6":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":12},"end":{"line":104,"column":12}},{"start":{"line":104,"column":12},"end":{"line":104,"column":12}}]}},"code":["var events = require('events');","var http = require('http');","var send = require('send');","var util = require('util');","var url = require('url');","","var Promise = require('../utils/promise');","","function Server() {","    this.running = null;","    this.dir = null;","    this.port = 0;","    this.sockets = [];","}","util.inherits(Server, events.EventEmitter);","","/**","    Return true if the server is running","","    @return {Boolean}","*/","Server.prototype.isRunning = function() {","    return !!this.running;","};","","/**","    Stop the server","","    @return {Promise}","*/","Server.prototype.stop = function() {","    var that = this;","    if (!this.isRunning()) return Promise();","","    var d = Promise.defer();","    this.running.close(function(err) {","        that.running = null;","        that.emit('state', false);","","        if (err) d.reject(err);","        else d.resolve();","    });","","    for (var i = 0; i < this.sockets.length; i++) {","        this.sockets[i].destroy();","    }","","    return d.promise;","};","","/**","    Start the server","","    @return {Promise}","*/","Server.prototype.start = function(dir, port) {","    var that = this, pre = Promise();","    port = port || 8004;","","    if (that.isRunning()) pre = this.stop();","    return pre","    .then(function() {","        var d = Promise.defer();","","        that.running = http.createServer(function(req, res){","            // Render error","            function error(err) {","                res.statusCode = err.status || 500;","                res.end(err.message);","            }","","            // Redirect to directory's index.html","            function redirect() {","                var resultURL = urlTransform(req.url, function(parsed) {","                    parsed.pathname += '/';","                    return parsed;","                });","","                res.statusCode = 301;","                res.setHeader('Location', resultURL);","                res.end('Redirecting to ' + resultURL);","            }","","            res.setHeader('X-Current-Location', req.url);","","            // Send file","            send(req, url.parse(req.url).pathname, {","                root: dir","            })","            .on('error', error)","            .on('directory', redirect)","            .pipe(res);","        });","","        that.running.on('connection', function (socket) {","            that.sockets.push(socket);","            socket.setTimeout(4000);","            socket.on('close', function () {","                that.sockets.splice(that.sockets.indexOf(socket), 1);","            });","        });","","        that.running.listen(port, function(err) {","            if (err) return d.reject(err);","","            that.port = port;","            that.dir = dir;","            that.emit('state', true);","            d.resolve();","        });","","        return d.promise;","    });","};","","/**","    urlTransform is a helper function that allows a function to transform","    a url string in it's parsed form and returns the new url as a string","","    @param {String} uri","    @param {Function} fn","    @return {String}","*/","function urlTransform(uri, fn) {","    return url.format(fn(url.parse(uri)));","}","","module.exports = Server;",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"7":1,"9":1,"10":0,"11":0,"12":0,"13":0,"15":1,"22":1,"23":0,"31":1,"32":0,"33":0,"35":0,"36":0,"37":0,"38":0,"40":0,"41":0,"44":0,"45":0,"48":0,"56":1,"57":0,"58":0,"60":0,"61":0,"63":0,"65":0,"67":1,"68":0,"69":0,"73":1,"74":0,"75":0,"76":0,"79":0,"80":0,"81":0,"84":0,"87":0,"95":0,"96":0,"97":0,"98":0,"99":0,"103":0,"104":0,"106":0,"107":0,"108":0,"109":0,"112":0,"124":1,"125":0,"128":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/watch.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/watch.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1},"b":{},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"watch","line":13,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":20}}},"2":{"name":"(anonymous_2)","line":22,"loc":{"start":{"line":22,"column":31},"end":{"line":22,"column":45}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":24},"end":{"line":32,"column":46}}},"4":{"name":"(anonymous_4)","line":37,"loc":{"start":{"line":37,"column":26},"end":{"line":37,"column":40}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":42}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"5":{"start":{"line":13,"column":0},"end":{"line":44,"column":1}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":28}},"7":{"start":{"line":15,"column":4},"end":{"line":15,"column":28}},"8":{"start":{"line":17,"column":4},"end":{"line":19,"column":6}},"9":{"start":{"line":22,"column":4},"end":{"line":24,"column":7}},"10":{"start":{"line":23,"column":8},"end":{"line":23,"column":33}},"11":{"start":{"line":26,"column":4},"end":{"line":30,"column":7}},"12":{"start":{"line":32,"column":4},"end":{"line":36,"column":7}},"13":{"start":{"line":33,"column":8},"end":{"line":33,"column":24}},"14":{"start":{"line":35,"column":8},"end":{"line":35,"column":28}},"15":{"start":{"line":37,"column":4},"end":{"line":41,"column":7}},"16":{"start":{"line":38,"column":8},"end":{"line":38,"column":24}},"17":{"start":{"line":40,"column":8},"end":{"line":40,"column":22}},"18":{"start":{"line":43,"column":4},"end":{"line":43,"column":21}},"19":{"start":{"line":46,"column":0},"end":{"line":46,"column":23}}},"branchMap":{},"code":["var path = require('path');","var chokidar = require('chokidar');","","var Promise = require('../utils/promise');","var parsers = require('../parsers');","","/**","    Watch a folder and resolve promise once a file is modified","","    @param {String} dir","    @return {Promise}","*/","function watch(dir) {","    var d = Promise.defer();","    dir = path.resolve(dir);","","    var toWatch = [","        'book.json', 'book.js', '_layouts/**'","    ];","","    // Watch all parsable files","    parsers.extensions.forEach(function(ext) {","        toWatch.push('**/*'+ext);","    });","","    var watcher = chokidar.watch(toWatch, {","        cwd: dir,","        ignored: '_book/**',","        ignoreInitial: true","    });","","    watcher.once('all', function(e, filepath) {","        watcher.close();","","        d.resolve(filepath);","    });","    watcher.once('error', function(err) {","        watcher.close();","","        d.reject(err);","    });","","    return d.promise;","}","","module.exports = watch;",""],"l":{"1":1,"2":1,"4":1,"5":1,"13":1,"14":0,"15":0,"17":0,"22":0,"23":0,"26":0,"32":0,"33":0,"35":0,"37":0,"38":0,"40":0,"43":0,"46":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/install.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/install.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":10},"end":{"line":13,"column":33}}},"2":{"name":"(anonymous_2)","line":17,"loc":{"start":{"line":17,"column":14},"end":{"line":17,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":35}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":32}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"5":{"start":{"line":7,"column":0},"end":{"line":21,"column":2}},"6":{"start":{"line":14,"column":8},"end":{"line":14,"column":41}},"7":{"start":{"line":16,"column":8},"end":{"line":19,"column":11}},"8":{"start":{"line":18,"column":12},"end":{"line":18,"column":54}}},"branchMap":{},"code":["var options = require('./options');","var getBook = require('./getBook');","","var Parse = require('../parse');","var Plugins = require('../plugins');","","module.exports = {","    name: 'install [book]',","    description: 'install all plugins dependencies',","    options: [","        options.log","    ],","    exec: function(args, kwargs) {","        var book = getBook(args, kwargs);","","        return Parse.parseConfig(book)","        .then(function(resultBook) {","            return Plugins.installPlugins(resultBook);","        });","    }","};",""],"l":{"1":1,"2":1,"4":1,"5":1,"7":1,"14":0,"16":0,"18":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/parse.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/parse.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"printBook","line":6,"loc":{"start":{"line":6,"column":0},"end":{"line":6,"column":25}}},"2":{"name":"printMultingualBook","line":38,"loc":{"start":{"line":38,"column":0},"end":{"line":38,"column":35}}},"3":{"name":"(anonymous_3)","line":45,"loc":{"start":{"line":45,"column":22},"end":{"line":45,"column":37}}},"4":{"name":"(anonymous_4)","line":58,"loc":{"start":{"line":58,"column":10},"end":{"line":58,"column":33}}},"5":{"name":"(anonymous_5)","line":63,"loc":{"start":{"line":63,"column":14},"end":{"line":63,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":35}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":32}},"4":{"start":{"line":6,"column":0},"end":{"line":36,"column":1}},"5":{"start":{"line":7,"column":4},"end":{"line":7,"column":34}},"6":{"start":{"line":9,"column":4},"end":{"line":9,"column":34}},"7":{"start":{"line":10,"column":4},"end":{"line":10,"column":38}},"8":{"start":{"line":12,"column":4},"end":{"line":12,"column":36}},"9":{"start":{"line":13,"column":4},"end":{"line":13,"column":40}},"10":{"start":{"line":15,"column":4},"end":{"line":15,"column":34}},"11":{"start":{"line":16,"column":4},"end":{"line":16,"column":38}},"12":{"start":{"line":18,"column":4},"end":{"line":18,"column":38}},"13":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"14":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"15":{"start":{"line":22,"column":8},"end":{"line":22,"column":70}},"16":{"start":{"line":25,"column":4},"end":{"line":27,"column":5}},"17":{"start":{"line":26,"column":8},"end":{"line":26,"column":69}},"18":{"start":{"line":29,"column":4},"end":{"line":31,"column":5}},"19":{"start":{"line":30,"column":8},"end":{"line":30,"column":67}},"20":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"21":{"start":{"line":34,"column":8},"end":{"line":34,"column":75}},"22":{"start":{"line":38,"column":0},"end":{"line":50,"column":1}},"23":{"start":{"line":39,"column":4},"end":{"line":39,"column":34}},"24":{"start":{"line":40,"column":4},"end":{"line":40,"column":40}},"25":{"start":{"line":41,"column":4},"end":{"line":41,"column":32}},"26":{"start":{"line":43,"column":4},"end":{"line":43,"column":50}},"27":{"start":{"line":45,"column":4},"end":{"line":49,"column":7}},"28":{"start":{"line":46,"column":8},"end":{"line":46,"column":53}},"29":{"start":{"line":47,"column":8},"end":{"line":47,"column":43}},"30":{"start":{"line":48,"column":8},"end":{"line":48,"column":27}},"31":{"start":{"line":52,"column":0},"end":{"line":79,"column":2}},"32":{"start":{"line":59,"column":8},"end":{"line":59,"column":41}},"33":{"start":{"line":60,"column":8},"end":{"line":60,"column":38}},"34":{"start":{"line":62,"column":8},"end":{"line":77,"column":11}},"35":{"start":{"line":64,"column":12},"end":{"line":64,"column":44}},"36":{"start":{"line":65,"column":12},"end":{"line":65,"column":54}},"37":{"start":{"line":67,"column":12},"end":{"line":67,"column":59}},"38":{"start":{"line":68,"column":12},"end":{"line":70,"column":13}},"39":{"start":{"line":69,"column":16},"end":{"line":69,"column":69}},"40":{"start":{"line":72,"column":12},"end":{"line":76,"column":13}},"41":{"start":{"line":73,"column":16},"end":{"line":73,"column":48}},"42":{"start":{"line":75,"column":16},"end":{"line":75,"column":38}}},"branchMap":{"1":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":4}},{"start":{"line":21,"column":4},"end":{"line":21,"column":4}}]},"2":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":4}},{"start":{"line":25,"column":4},"end":{"line":25,"column":4}}]},"3":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":29,"column":4}},{"start":{"line":29,"column":4},"end":{"line":29,"column":4}}]},"4":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":4}},{"start":{"line":33,"column":4},"end":{"line":33,"column":4}}]},"5":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":12},"end":{"line":68,"column":12}},{"start":{"line":68,"column":12},"end":{"line":68,"column":12}}]},"6":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":12},"end":{"line":72,"column":12}},{"start":{"line":72,"column":12},"end":{"line":72,"column":12}}]}},"code":["var options = require('./options');","var getBook = require('./getBook');","","var Parse = require('../parse');","","function printBook(book) {","    var logger = book.getLogger();","","    var config = book.getConfig();","    var configFile = config.getFile();","","    var summary = book.getSummary();","    var summaryFile = summary.getFile();","","    var readme = book.getReadme();","    var readmeFile = readme.getFile();","","    var glossary = book.getGlossary();","    var glossaryFile = glossary.getFile();","","    if (configFile.exists()) {","        logger.info.ln('Configuration file is', configFile.getPath());","    }","","    if (readmeFile.exists()) {","        logger.info.ln('Introduction file is', readmeFile.getPath());","    }","","    if (glossaryFile.exists()) {","        logger.info.ln('Glossary file is', glossaryFile.getPath());","    }","","    if (summaryFile.exists()) {","        logger.info.ln('Table of Contents file is', summaryFile.getPath());","    }","}","","function printMultingualBook(book) {","    var logger = book.getLogger();","    var languages = book.getLanguages();","    var books = book.getBooks();","","    logger.info.ln(languages.size + ' languages');","","    languages.forEach(function(lang) {","        logger.info.ln('Language:', lang.getTitle());","        printBook(books.get(lang.getID()));","        logger.info.ln('');","    });","}","","module.exports = {","    name: 'parse [book]',","    description: 'parse and print debug information about a book',","    options: [","        options.log","    ],","    exec: function(args, kwargs) {","        var book = getBook(args, kwargs);","        var logger = book.getLogger();","","        return Parse.parseBook(book)","        .then(function(resultBook) {","            var rootFolder = book.getRoot();","            var contentFolder = book.getContentRoot();","","            logger.info.ln('Book located in:', rootFolder);","            if (contentFolder != rootFolder) {","                logger.info.ln('Content located in:', contentFolder);","            }","","            if (resultBook.isMultilingual()) {","                printMultingualBook(resultBook);","            } else {","                printBook(resultBook);","            }","        });","    }","};",""],"l":{"1":1,"2":1,"4":1,"6":1,"7":0,"9":0,"10":0,"12":0,"13":0,"15":0,"16":0,"18":0,"19":0,"21":0,"22":0,"25":0,"26":0,"29":0,"30":0,"33":0,"34":0,"38":1,"39":0,"40":0,"41":0,"43":0,"45":0,"46":0,"47":0,"48":0,"52":1,"59":0,"60":0,"62":0,"64":0,"65":0,"67":0,"68":0,"69":0,"72":0,"73":0,"75":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/init.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/cli/init.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":10},"end":{"line":12,"column":33}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":35}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":34}},"4":{"start":{"line":6,"column":0},"end":{"line":17,"column":2}},"5":{"start":{"line":13,"column":8},"end":{"line":13,"column":68}},"6":{"start":{"line":15,"column":8},"end":{"line":15,"column":34}}},"branchMap":{"1":{"line":13,"type":"binary-expr","locations":[{"start":{"line":13,"column":51},"end":{"line":13,"column":58}},{"start":{"line":13,"column":62},"end":{"line":13,"column":66}}]}},"code":["var path = require('path');","","var options = require('./options');","var initBook = require('../init');","","module.exports = {","    name: 'init [book]',","    description: 'setup and create files for chapters',","    options: [","        options.log","    ],","    exec: function(args, kwargs) {","        var bookRoot = path.resolve(process.cwd(), args[0] || './');","","        return initBook(bookRoot);","    }","};",""],"l":{"1":1,"3":1,"4":1,"6":1,"13":0,"15":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/book.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/book.js","s":{"1":1,"2":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":36}},"2":{"start":{"line":3,"column":0},"end":{"line":23,"column":2}}},"branchMap":{},"code":["var pkg = require('./package.json');","","module.exports = {","    // Documentation for GitBook is stored under \"docs\"","    root: './docs',","    title: 'GitBook Toolchain Documentation',","","    // Enforce use of GitBook v3","    gitbook: '3.1.1',","","    // Use the \"official\" theme","    plugins: ['theme-official@2.1.1', '-sharing', '-fontsettings', 'sitemap'],","","    variables: {","        version: pkg.version","    },","","    pluginsConfig: {","        sitemap: {","            hostname: 'https://toolchain.gitbook.com'","        }","    }","};",""],"l":{"1":1,"3":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/bin/gitbook.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/bin/gitbook.js","s":{"1":1,"2":1,"3":1,"4":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":34}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":123}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":96}},"4":{"start":{"line":8,"column":0},"end":{"line":8,"column":94}}},"branchMap":{},"code":["//#! /usr/bin/env node","/* eslint-disable no-console */","","var color = require('bash-color');","","console.log(color.red('You need to install \"gitbook-cli\" to have access to the gitbook command anywhere on your system.'));","console.log(color.red('If you\\'ve installed this package globally, you need to uninstall it.'));","console.log(color.red('>> Run \"npm uninstall -g gitbook\" then \"npm install -g gitbook-cli\"'));",""],"l":{"4":1,"6":1,"7":1,"8":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/testing/setup.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/testing/setup.js","s":{"1":2,"2":2,"3":2,"4":2,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":16},"end":{"line":12,"column":35}}},"2":{"name":"(anonymous_2)","line":24,"loc":{"start":{"line":24,"column":19},"end":{"line":24,"column":38}}},"3":{"name":"(anonymous_3)","line":40,"loc":{"start":{"line":40,"column":17},"end":{"line":40,"column":28}}},"4":{"name":"(anonymous_4)","line":51,"loc":{"start":{"line":51,"column":20},"end":{"line":51,"column":31}}},"5":{"name":"(anonymous_5)","line":64,"loc":{"start":{"line":64,"column":22},"end":{"line":64,"column":41}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":23}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":31}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":33}},"6":{"start":{"line":7,"column":0},"end":{"line":70,"column":3}},"7":{"start":{"line":13,"column":8},"end":{"line":13,"column":56}},"8":{"start":{"line":14,"column":8},"end":{"line":14,"column":45}},"9":{"start":{"line":16,"column":8},"end":{"line":21,"column":10}},"10":{"start":{"line":22,"column":8},"end":{"line":22,"column":20}},"11":{"start":{"line":25,"column":8},"end":{"line":25,"column":56}},"12":{"start":{"line":26,"column":8},"end":{"line":26,"column":45}},"13":{"start":{"line":28,"column":8},"end":{"line":33,"column":10}},"14":{"start":{"line":34,"column":8},"end":{"line":34,"column":20}},"15":{"start":{"line":41,"column":8},"end":{"line":44,"column":10}},"16":{"start":{"line":45,"column":8},"end":{"line":45,"column":20}},"17":{"start":{"line":52,"column":8},"end":{"line":56,"column":10}},"18":{"start":{"line":57,"column":8},"end":{"line":57,"column":20}},"19":{"start":{"line":65,"column":8},"end":{"line":65,"column":42}},"20":{"start":{"line":66,"column":8},"end":{"line":66,"column":30}},"21":{"start":{"line":68,"column":8},"end":{"line":68,"column":80}},"22":{"start":{"line":72,"column":0},"end":{"line":72,"column":23}}},"branchMap":{"1":{"line":42,"type":"binary-expr","locations":[{"start":{"line":42,"column":14},"end":{"line":42,"column":39}},{"start":{"line":42,"column":43},"end":{"line":42,"column":63}}]},"2":{"line":53,"type":"binary-expr","locations":[{"start":{"line":53,"column":13},"end":{"line":53,"column":38}},{"start":{"line":53,"column":42},"end":{"line":53,"column":62}}]}},"code":["var is = require('is');","var path = require('path');","var fs = require('fs');","var expect = require('expect');","var cheerio = require('cheerio');","","expect.extend({","    /**","     * Check that a file is created in a directory:","     * expect('myFolder').toHaveFile('hello.md');","     */","    toHaveFile: function(fileName) {","        var filePath = path.join(this.actual, fileName);","        var exists = fs.existsSync(filePath);","","        expect.assert(","            exists,","            'expected %s to have file %s',","            this.actual,","            fileName","        );","        return this;","    },","    toNotHaveFile: function(fileName) {","        var filePath = path.join(this.actual, fileName);","        var exists = fs.existsSync(filePath);","","        expect.assert(","            !exists,","            'expected %s to not have file %s',","            this.actual,","            fileName","        );","        return this;","    },","","    /**","     * Check that a value is defined (not null nor undefined)","     */","    toBeDefined: function() {","        expect.assert(","            !(is.undefined(this.actual) || is.null(this.actual)),","            'expected to be defined'","        );","        return this;","    },","","    /**","     * Check that a value is defined (not null nor undefined)","     */","    toNotBeDefined: function() {","        expect.assert(","            (is.undefined(this.actual) || is.null(this.actual)),","            'expected %s to be not defined',","            this.actual","        );","        return this;","    },","","    /**","     * Check that a dom element exists in HTML","     * @param {String} selector","     */","    toHaveDOMElement: function(selector) {","        var $ = cheerio.load(this.actual);","        var $el = $(selector);","","        expect.assert($el.length > 0, 'expected HTML to contains %s', selector);","    }","});","","global.expect = expect;",""],"l":{"1":2,"2":2,"3":2,"4":2,"5":0,"7":0,"13":0,"14":0,"16":0,"22":0,"25":0,"26":0,"28":0,"34":0,"41":0,"45":0,"52":0,"57":0,"65":0,"66":0,"68":0,"72":0}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/pluginHooks.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/constants/pluginHooks.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":8,"column":2}}},"branchMap":{},"code":["module.exports = [","    'init',","    'finish',","    'finish:before',","    'config',","    'page',","    'page:before'","];",""],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/toNames.js":{"path":"/home/travis/build/npmtest/node-npmtest-gitbook/node_modules/gitbook/lib/plugins/toNames.js","s":{"1":1,"2":0,"3":0,"4":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"toNames","line":8,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":26}}},"2":{"name":"(anonymous_2)","line":10,"loc":{"start":{"line":10,"column":13},"end":{"line":10,"column":30}}}},"statementMap":{"1":{"start":{"line":8,"column":0},"end":{"line":14,"column":1}},"2":{"start":{"line":9,"column":4},"end":{"line":13,"column":19}},"3":{"start":{"line":11,"column":12},"end":{"line":11,"column":36}},"4":{"start":{"line":16,"column":0},"end":{"line":16,"column":25}}},"branchMap":{},"code":["","/**"," * Return list of plugin names. This method is nly used in unit tests."," *"," * @param {OrderedMap<String:Plugin} plugins"," * @return {Array<String>}"," */","function toNames(plugins) {","    return plugins","        .map(function(plugin) {","            return plugin.getName();","        })","        .toArray();","}","","module.exports = toNames;",""],"l":{"8":1,"9":0,"11":0,"16":1}}}